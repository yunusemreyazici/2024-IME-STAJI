{
  "version": 3,
  "sources": ["../src/q/arrays.ts", "../src/q/system.ts", "../src/q/strings.ts", "../src/q/localtext.ts", "../src/globals/jquery-module.ts", "../src/q/html.ts", "../src/q/toastr2.ts", "../src/q/notify.ts", "../src/q/config.ts", "../src/globals/bootstrap-module.ts", "../src/q/dialogs.ts", "../src/q/errorhandling.ts", "../src/q/blockui.ts", "../src/q/services.ts", "../src/q/formatting.ts", "../src/q/scriptdata.ts", "../src/q/authorization.ts", "../src/q/debounce.ts", "../src/q/layouttimer.ts", "../src/q/router.ts", "../src/q/layout.ts", "../src/q/lookup.ts", "../src/q/propertyitem.ts", "../src/q/servicetypes.ts", "../src/globals/jquery.validation-module.ts", "../src/q/validation.ts", "../src/q/validateoptions.ts", "../src/q/criteria.ts", "../src/slick/aggregators.ts", "../src/slick/remoteview.ts", "../src/decorators/index.ts", "../src/interfaces/ibooleanvalue.ts", "../src/interfaces/idoublevalue.ts", "../src/interfaces/idialog.ts", "../src/interfaces/ieditdialog.ts", "../src/interfaces/igeteditvalue.ts", "../src/interfaces/ireadonly.ts", "../src/interfaces/iseteditvalue.ts", "../src/interfaces/istringvalue.ts", "../src/interfaces/ivalidaterequired.ts", "../src/types/captureoperationtype.ts", "../src/types/reflectionutils.ts", "../src/types/commontyperegistry.ts", "../src/types/dialogtyperegistry.ts", "../src/patch/jquerypatch.ts", "../src/ui/widgets/widget.ts", "../src/types/editortyperegistry.ts", "../src/types/enumtyperegistry.ts", "../src/ui/helpers/lazyloadhelper.ts", "../src/ui/widgets/prefixedcontext.ts", "../src/ui/widgets/toolbar.ts", "../src/ui/widgets/templatedwidget.ts", "../src/ui/widgets/flexify.ts", "../src/ui/dialogs/dialogextensions.ts", "../src/ui/dialogs/templateddialog.ts", "../src/ui/widgets/templatedpanel.ts", "../src/ui/helpers/validationhelper.ts", "../src/ui/editors/cascadedwidgetlink.ts", "../src/ui/helpers/tabsextensions.ts", "../src/ui/widgets/reflectionoptionssetter.ts", "../src/ui/editors/editorutils.ts", "../src/ui/widgets/propertygrid.ts", "../src/ui/widgets/propertypanel.ts", "../src/ui/helpers/subdialoghelper.ts", "../src/ui/dialogs/propertydialog.ts", "../src/ui/editors/stringeditor.ts", "../src/ui/editors/passwordeditor.ts", "../src/ui/editors/textareaeditor.ts", "../src/ui/editors/booleaneditor.ts", "../src/ui/editors/decimaleditor.ts", "../src/ui/editors/integereditor.ts", "../src/ui/editors/dateeditor.ts", "../src/ui/editors/datetimeeditor.ts", "../src/ui/editors/timeeditor.ts", "../src/ui/editors/emaileditor.ts", "../src/ui/editors/emailaddresseditor.ts", "../src/ui/editors/urleditor.ts", "../src/ui/editors/radiobuttoneditor.ts", "../src/globals/select2-module.ts", "../src/ui/editors/select2editor.ts", "../src/ui/editors/selecteditor.ts", "../src/ui/editors/dateyeareditor.ts", "../src/ui/editors/enumeditor.ts", "../src/ui/editors/lookupeditor.ts", "../src/ui/editors/servicelookupeditor.ts", "../src/ui/editors/htmlcontenteditor.ts", "../src/ui/editors/maskededitor.ts", "../src/ui/editors/recaptcha.ts", "../src/ui/helpers/uploadhelper.ts", "../src/ui/editors/uploadeditors.ts", "../src/ui/datagrid/quickfilterbar.ts", "../src/ui/datagrid/quicksearchinput.ts", "../src/ui/filtering/filteroperator.ts", "../src/ui/filtering/filterstore.ts", "../src/ui/filtering/filtering.ts", "../src/ui/filtering/filterwidgetbase.ts", "../src/ui/filtering/filterpanel.ts", "../src/ui/filtering/filterdialog.ts", "../src/ui/filtering/filterdisplaybar.ts", "../src/ui/datagrid/slickpager.ts", "../src/ui/formatters/formatters.ts", "../src/types/formattertyperegistry.ts", "../src/ui/helpers/slickhelpers.ts", "../src/ui/datagrid/datagrid.ts", "../src/ui/datagrid/columnpickerdialog.ts", "../src/ui/datagrid/treegridmixin.ts", "../src/ui/editors/checktreeeditor.ts", "../src/ui/datagrid/entitygrid.ts", "../src/ui/dialogs/entitydialog.ts", "../src/ui/widgets/jsx.ts", "../src/ui/widgets/reporting.ts", "../src/ui/widgets/scriptcontext.ts", "../src/interfaces/iasyncinit.ts", "../src/ui/widgets/wx.ts", "../src/ui/widgets/googlemap.ts", "../src/ui/editors/select2ajaxeditor.ts"],
  "sourcesContent": ["\uFEFF/**\n * Tests if any of array elements matches given predicate. Prefer Array.some() over this function (e.g. `[1, 2, 3].some(predicate)`).\n * @param array Array to test.\n * @param predicate Predicate to test elements.\n * @returns True if any element matches.\n */\nexport function any<TItem>(array: TItem[], predicate: (x: TItem) => boolean): boolean {\n    return array.some(predicate);\n}\n\n/**\n * Counts number of array elements that matches a given predicate.\n * @param array Array to test.\n * @param predicate Predicate to test elements.\n */\nexport function count<TItem>(array: TItem[], predicate: (x: TItem) => boolean): number {\n    let count = 0;\n    for (let x of array)\n        if (predicate(x))\n            count++;\n\n    return count;\n}\n\n/**\n * Gets first element in an array that matches given predicate similar to LINQ's First.\n * Throws an error if no match is found.\n * @param array Array to test.\n * @param predicate Predicate to test elements.\n * @returns First element that matches.\n */\nexport function first<TItem>(array: TItem[], predicate: (x: TItem) => boolean): TItem {\n    for (let x of array)\n        if (predicate(x))\n            return x;\n\n    throw new Error(\"first:No element satisfies the condition.!\");\n}\n\n/**\n * A group item returned by `groupBy()`.\n */\nexport type GroupByElement<TItem> = {\n    /** index of the item in `inOrder` array */\n    order: number;\n    /** key of the group */\n    key: string;\n    /** the items in the group */\n    items: TItem[];\n    /** index of the first item of this group in the original array */\n    start: number;\n}\n\n/**\n * Return type of the `groupBy` function.\n */\nexport type GroupByResult<TItem> = {\n    byKey: { [key: string]: GroupByElement<TItem> };\n    inOrder: GroupByElement<TItem>[];\n};\n\n/**\n * Groups an array with keys determined by specified getKey() callback.\n * Resulting object contains group objects in order and a dictionary to access by key.\n * This is similar to LINQ's ToLookup function with some additional details like start index.\n * @param items Array to group.\n * @param getKey Function that returns key for each item.\n * @returns GroupByResult object.\n */\nexport function groupBy<TItem>(items: TItem[], getKey: (x: TItem) => any): GroupByResult<TItem> {\n    let result: GroupByResult<TItem> = {\n        byKey: Object.create(null),\n        inOrder: []\n    };\n\n    for (var index = 0; index < items.length; index++) {\n        var item = items[index];\n        let key = getKey(item) ?? \"\";\n        var group = result.byKey[key];\n        if (group === undefined) {\n            group = {\n                order: result.inOrder.length,\n                key: key,\n                items: [item],\n                start: index\n            }\n            result.byKey[key] = group;\n            result.inOrder.push(group);\n        }\n        else {\n            group.items.push(item);\n        }\n    }\n\n    return result;\n}\n\n/**\n * Gets index of first element in an array that matches given predicate.\n * @param array Array to test.\n * @param predicate Predicate to test elements.\n */\nexport function indexOf<TItem>(array: TItem[], predicate: (x: TItem) => boolean): number {\n    for (var i = 0; i < array.length; i++)\n        if (predicate(array[i]))\n            return i;\n\n    return -1;\n}\n\n/**\n * Inserts an item to the array at specified index. Prefer Array.splice unless\n * you need to support IE.\n * @param obj Array or array like object to insert to.\n * @param index Index to insert at.\n * @param item Item to insert.\n * @throws Error if object does not support insert.\n * @example\n * insert([1, 2, 3], 1, 4); // [1, 4, 2, 3]\n * insert({ insert: (index, item) => { this.splice(index, 0, item); } }\n */\nexport function insert(obj: any, index: number, item: any): void {\n    if (obj.insert)\n        obj.insert(index, item);\n    else if (Array.isArray(obj))\n        obj.splice(index, 0, item);\n    else\n        throw new Error(\"Object does not support insert!\");\n}\n\n/**\n * Determines if the object is an array. Prefer Array.isArray over this function (e.g. `Array.isArray(obj)`).\n * @param obj Object to test.\n * @returns True if the object is an array.\n * @example\n * isArray([1, 2, 3]); // true\n * isArray({}); // false\n */\nexport const isArray = Array.isArray;\n\n/**\n* Gets first element in an array that matches given predicate.\n* Throws an error if no matches is found, or there are multiple matches.\n* @param array Array to test.\n* @param predicate Predicate to test elements.\n* @returns First element that matches.\n* @example\n* first([1, 2, 3], x => x == 2); // 2\n* first([1, 2, 3], x => x == 4); // throws error.\n*/\nexport function single<TItem>(array: TItem[], predicate: (x: TItem) => boolean): TItem {\n    let match: any;\n    let found = false;\n    for (let x of array)\n        if (predicate(x)) {\n            if (found)\n                throw new Error(\"single:sequence contains more than one element.\");\n\n            found = true;\n            match = x;\n        }\n\n    if (!found)\n        throw new Error(\"single:No element satisfies the condition.\");\n\n    return match;\n}\n\nexport type Grouping<TItem> = { [key: string]: TItem[] };\n\n/**\n * Maps an array into a dictionary with keys determined by specified getKey() callback,\n * and values that are arrays containing elements for a particular key.\n * @param items Array to map.\n * @param getKey Function that returns key for each item.\n * @returns Grouping object.\n * @example\n * toGrouping([1, 2, 3], x => x % 2 == 0 ? \"even\" : \"odd\"); // { odd: [1, 3], even: [2] }\n */\nexport function toGrouping<TItem>(items: TItem[], getKey: (x: TItem) => any): Grouping<TItem> {\n    let lookup: Grouping<TItem> = {};\n    for (let x of items) {\n        let key = getKey(x) ?? \"\";\n        let d = lookup[key];\n        if (!d) {\n            d = lookup[key] = [];\n        }\n\n        d.push(x);\n    }\n    return lookup;\n}\n\n/**\n * Gets first element in an array that matches given predicate (similar to LINQ's FirstOrDefault).\n * Returns null if no match is found.\n * @param array Array to test.\n * @param predicate Predicate to test elements.\n * @returns First element that matches.\n * @example\n * tryFirst([1, 2, 3], x => x == 2); // 2\n * tryFirst([1, 2, 3], x => x == 4); // null\n */\nexport function tryFirst<TItem>(array: TItem[], predicate: (x: TItem) => boolean): TItem {\n    for (let x of array)\n        if (predicate(x))\n            return x;\n}", "\uFEFFexport type Dictionary<TItem> = { [key: string]: TItem };\n\nexport function coalesce(a: any, b: any): any {\n    return a != null ? a : b;\n}\n\nexport function isValue(a: any): boolean {\n    return a != null;\n}\n\nexport let today = (): Date => {\n    var d = new Date();\n    return new Date(d.getFullYear(), d.getMonth(), d.getDate());\n}\n\nexport function extend<T = any>(a: T, b: T): T {\n    for (var key in b)\n        if (Object.prototype.hasOwnProperty.call(b, key))\n            a[key] = b[key];\n    return a;\n}\n\nexport function deepClone<T = any>(a: T, a2?: any, a3?: any): T {\n    // for backward compatibility\n    if (a2 != null || a3 != null) {\n        return extend(extend(deepClone(a || {}), deepClone(a2 || {})), deepClone(a3 || {}));\n    }\n\n    // https://github.com/angus-c/just/blob/master/packages/collection-clone/index.js\n    var result = a;\n    var type = {}.toString.call(a).slice(8, -1);\n    if (type == 'Set') {\n        return new Set([...(a as any)].map(value => deepClone(value))) as any;\n    }\n    if (type == 'Map') {\n        return new Map([...(a as any)].map(kv => [deepClone(kv[0]), deepClone(kv[1])])) as any;\n    }\n    if (type == 'Date') {\n        return new Date((a as any).getTime()) as any;\n    }\n    if (type == 'RegExp') {\n        return RegExp((a as any).source, getRegExpFlags(a as any)) as any;\n    }\n    if (type == 'Array' || type == 'Object') {\n        result = (Array.isArray(a) ? [] : {}) as any;\n        for (var key in a) {\n            // include prototype properties\n            result[key] = deepClone(a[key]);\n        }\n    }\n    // primitives and non-supported objects (e.g. functions) land here\n    return result;\n}\n\nfunction getRegExpFlags(regExp: RegExp) {\n    if (typeof (regExp.source as any).flags == 'string') {\n        return (regExp.source as any).flags;\n    } else {\n        var flags = [];\n        regExp.global && flags.push('g');\n        regExp.ignoreCase && flags.push('i');\n        regExp.multiline && flags.push('m');\n        regExp.sticky && flags.push('y');\n        regExp.unicode && flags.push('u');\n        return flags.join('');\n    }\n}\n\ninterface TypeExt {\n    __interface?: boolean;\n    __interfaces?: any[];\n    __isAssignableFrom?: (from: any) => boolean;\n    __isInstanceOfType?: (instance: any) => boolean;\n    __metadata?: TypeMetadata;\n    __typeName?: string;\n}\n\ninterface TypeMetadata {\n    enumFlags?: boolean;\n    attr?: any[];\n    members?: TypeMember[];\n}\n\nexport type Type = Function | Object;\n\nexport interface TypeMember {\n    name: string;\n    type: MemberType;\n    attr?: any[];\n    getter?: string;\n    setter?: string;\n}\n\nfunction getTypeStore() {\n    return getStateStore(\"__types\");\n}\n\nexport function getNested(from: any, name: string) {\n    var a = name.split('.');\n    for (var i = 0; i < a.length; i++) {\n        from = from[a[i]];\n        if (from == null)\n            return null;\n    }\n    return from;\n}\n\nconst globalObj: any = \n    (typeof globalThis !== \"undefined\" && globalThis) || \n    (typeof window !== \"undefined\" && window) || \n    (typeof self !== \"undefined\" && self) ||\n    // @ts-ignore check for global\n    (typeof global !== \"undefined\" && global) ||\n    (function () { return this; })() || Function('return this')();\n\nexport function getGlobalThis(): any {\n    return globalObj;\n}\n\nexport function getType(name: string, target?: any): Type  {\n    var type: any;\n    const types = getTypeStore();\n    if (target == null) {\n        type = types[name];\n        if (type != null || globalObj == void 0 || name === \"Object\")\n            return type;\n\n        target = globalObj;\n    }\n\n    type = getNested(target, name)\n    if (typeof type !== 'function')\n        return null;\n\n    return type;\n}\n\nexport function getTypeNameProp(type: Type): string {\n    return (Object.prototype.hasOwnProperty.call(type, \"__typeName\") && (type as TypeExt).__typeName) || void 0;\n}\n\nexport function setTypeNameProp(type: Type, value: string) {\n    Object.defineProperty(type, \"__typeName\", { value, configurable: true });\n}\n\nexport function getTypeFullName(type: Type): string {\n    return getTypeNameProp(type) || (type as any).name ||\n        (type.toString().match(/^\\s*function\\s*([^\\s(]+)/) || [])[1] || 'Object';\n};\n\nexport function getTypeShortName(type: Type): string {\n    var fullName = getTypeFullName(type);\n    var bIndex = fullName.indexOf('[');\n    var nsIndex = fullName.lastIndexOf('.', bIndex >= 0 ? bIndex : fullName.length);\n    return nsIndex > 0 ? fullName.substr(nsIndex + 1) : fullName;\n};\n\nexport function getInstanceType(instance: any): any {\n    if (instance == null)\n        throw new ArgumentNullException(\"instance\", \"Can't get instance type of null or undefined!\");\n\n    // Have to catch as constructor cannot be looked up on native COM objects\n    try {\n        return instance.constructor;\n    }\n    catch (ex) {\n        return Object;\n    }\n};\n\nexport function isAssignableFrom(target: any, type: Type) {\n    if (target === type || (type as any).prototype instanceof target)\n        return true;\n\n    if (typeof (target as TypeExt).__isAssignableFrom === 'function')\n        return (target as TypeExt).__isAssignableFrom(type);\n\n    return false;\n};\n\nexport function isInstanceOfType(instance: any, type: Type) {\n    if (instance == null)\n        return false;\n\n    if (typeof (type as TypeExt).__isInstanceOfType === 'function')\n        return (type as TypeExt).__isInstanceOfType(instance);\n\n    return isAssignableFrom(type, getInstanceType(instance));\n};\n\nexport function safeCast(instance: any, type: Type) {\n    return isInstanceOfType(instance, type) ? instance : null;\n};\n\nexport function cast(instance: any, type: Type) {\n    if (instance == null)\n        return instance;\n    else if (isInstanceOfType(instance, type))\n        return instance;\n    throw new InvalidCastException('Cannot cast object to type ' + getTypeFullName(type));\n}\n\nexport function getBaseType(type: any) {\n    if (type === Object ||\n        !type.prototype ||\n        (type as TypeExt).__interface === true) {\n        return null;\n    }\n    else if (Object.getPrototypeOf) {\n        return Object.getPrototypeOf(type.prototype).constructor;\n    }\n    else {\n        var p = type.prototype;\n        if (Object.prototype.hasOwnProperty.call(p, 'constructor')) {\n            try {\n                var ownValue = p.constructor;\n                delete p.constructor;\n                return p.constructor;\n            }\n            finally {\n                p.constructor = ownValue;\n            }\n        }\n        return p.constructor;\n    }\n};\n\nexport function getAttributes(type: any, attrType: any, inherit?: boolean) {\n    var result = [];\n    if (inherit) {\n        var b = getBaseType(type);\n        if (b) {\n            var a: any = getAttributes(b, attrType, true);\n            for (var i = 0; i < a.length; i++) {\n                var t = getInstanceType(a[i]);\n                result.push(a[i]);\n            }\n        }\n    }\n    var attr = (type as TypeExt).__metadata?.attr;\n    if (attr != null) {\n        for (var i = 0; i < attr.length; i++) {\n            var a: any = attr[i];\n            if (attrType == null || isInstanceOfType(a, attrType)) {\n                var t = getInstanceType(a);\n                for (var j = result.length - 1; j >= 0; j--) {\n                    if (isInstanceOfType(result[j], t))\n                        result.splice(j, 1);\n                }\n                result.push(a);\n            }\n        }\n    }\n    return result;\n};\n\nexport enum MemberType {\n    field = 4,\n    property = 16\n}\n\nexport function getMembers(type: any, memberTypes: MemberType): TypeMember[] {\n    var result: TypeMember[] = [];\n    var b = getBaseType(type);\n    if (b)\n        result = getMembers(b, memberTypes & ~1);\n\n    var members = (type as TypeExt).__metadata?.members;\n    if (members != null) {\n        for (var m of members) {\n            if (memberTypes & m.type)\n                result.push(m);\n        }\n    }\n\n    return result;\n};\n\nexport function addTypeMember(type: any, member: TypeMember): TypeMember {\n\n    var name = member.name;\n    var md = ensureMetadata(type);\n    md.members = md.members || [];\n\n    let existing: TypeMember;\n    for (var m of md.members) {\n        if (m.name == name) {\n            existing = m;\n            break;\n        }\n    }\n\n    if (existing) {\n        if (member.type != null)\n            existing.type = member.type;\n        if (member.attr != null)\n            existing.attr = merge(existing.attr, member.attr);\n        if (member.getter != null)\n            existing.getter = member.getter;\n        if (member.setter != null)\n            existing.setter = member.setter;\n        return existing;\n    }\n    else {\n        md.members.push(member);\n        return member;\n    }\n}\n\nexport function getTypes(from?: any): any[] {\n    const types = getTypeStore();\n    var result = [];\n    if (!from) {\n        for (var t in types) {\n            if (Object.prototype.hasOwnProperty.call(types, t))\n                result.push(types[t]);\n        }\n    }\n    else {\n        var traverse = function (s: any, n: string) {\n            for (var c in s) {\n                if (Object.prototype.hasOwnProperty.call(s, c))\n                    traverse(s[c], c);\n            }\n            if (typeof (s) === 'function' &&\n                n.charAt(0).toUpperCase() === n.charAt(0) &&\n                n.charAt(0).toLowerCase() !== n.charAt(0))\n                result.push(s);\n        };\n        traverse(from, '');\n    }\n    return result;\n};\n\nexport function clearKeys(d: any) {\n    for (var n in d) {\n        if (Object.prototype.hasOwnProperty.call(d, n))\n            delete d[n];\n    }\n}\n\nexport function delegateCombine(delegate1: any, delegate2: any) {\n    if (!delegate1) {\n        if (!delegate2._targets) {\n            return delegate2;\n        }\n        return delegate2;\n    }\n    if (!delegate2) {\n        if (!delegate1._targets) {\n            return delegate1;\n        }\n        return delegate1;\n    }\n\n    var targets1 = delegate1._targets ? delegate1._targets : [null, delegate1];\n    var targets2 = delegate2._targets ? delegate2._targets : [null, delegate2];\n\n    return _mkdel(targets1.concat(targets2));\n};\n\nconst fallbackStore: any = {};\n\n\nexport function getStateStore(key?: string): any {\n\n    let store: any;\n    if (globalObj) {\n        if (!globalObj.Q)\n            globalObj.Q = {};\n\n        store = globalObj.Q.__stateStore;\n        if (!store)\n            globalObj.Q.__stateStore = store = Object.create(null);\n    }\n    else\n        store = fallbackStore;\n\n    if (key == null)\n        return store;\n\n    var s = store[key];\n    if (s == null)\n        store[key] = s = Object.create(null);\n    return s;\n}\n\nexport namespace Enum {\n    export let toString = (enumType: any, value: number): string => {\n        var values = enumType;\n        if (value === 0 || !((enumType as TypeExt).__metadata?.enumFlags)) {\n            for (var i in values) {\n                if (values[i] === value) {\n                    return i;\n                }\n            }\n            return value == null ? \"\" : value.toString();\n        }\n        else {\n            var parts: string[] = [];\n            for (var i in values) {\n                if (values[i] & value) {\n                    parts.push(i);\n                }\n                else\n                    parts.push(value == null ? \"\" : value.toString());\n            }\n            return parts.join(' | ');\n        }\n    };\n\n    export let getValues = (enumType: any) => {\n        var parts = [];\n        var values = enumType;\n        for (var i in values) {\n            if (Object.prototype.hasOwnProperty.call(values, i) &&\n                typeof values[i] === \"number\")\n                parts.push(values[i]);\n        }\n        return parts;\n    };\n}\n\nfunction delegateContains(targets: any[], object: any, method: any) {\n    for (var i = 0; i < targets.length; i += 2) {\n        if (targets[i] === object && targets[i + 1] === method) {\n            return true;\n        }\n    }\n    return false;\n};\n\n\nlet _mkdel = (targets: any[]): any => {\n    var delegate: any = function () {\n        if (targets.length === 2) {\n            return targets[1].apply(targets[0], arguments);\n        }\n        else {\n            var clone = targets.slice();\n            for (var i = 0; i < clone.length; i += 2) {\n                if (delegateContains(targets, clone[i], clone[i + 1])) {\n                    clone[i + 1].apply(clone[i], arguments);\n                }\n            }\n            return null;\n        }\n    };\n    delegate._targets = targets;\n\n    return delegate;\n};\n\nexport let delegateRemove = (delegate1: any, delegate2: any) => {\n    if (!delegate1 || (delegate1 === delegate2)) {\n        return null;\n    }\n    if (!delegate2) {\n        return delegate1;\n    }\n\n    var targets = delegate1._targets;\n    var object = null;\n    var method;\n    if (delegate2._targets) {\n        object = delegate2._targets[0];\n        method = delegate2._targets[1];\n    }\n    else {\n        method = delegate2;\n    }\n\n    for (var i = 0; i < targets.length; i += 2) {\n        if ((targets[i] === object) && (targets[i + 1] === method)) {\n            if (targets.length === 2) {\n                return null;\n            }\n            var t = targets.slice();\n            t.splice(i, 2);\n            return _mkdel(t);\n        }\n    }\n\n    return delegate1;\n};\n\nexport let isEnum = (type: any) => {\n    return typeof type !== \"function\" &&\n        (type as TypeExt).__interface === null;\n};\n\nexport function initFormType(typ: Function, nameWidgetPairs: any[]) {\n    for (var i = 0; i < nameWidgetPairs.length - 1; i += 2) {\n        (function (name: string, widget: any) {\n            Object.defineProperty(typ.prototype, name, {\n                get: function () {\n                    return this.w(name, widget);\n                },\n                enumerable: true,\n                configurable: true\n            });\n        })(nameWidgetPairs[i], nameWidgetPairs[i + 1]);\n    }\n}\n\nexport function prop(type: any, name: string, getter?: string, setter?: string) {\n    getter = getter || \"get_\" + name;\n    setter = setter || \"set_\" + name;\n\n    Object.defineProperty(type.prototype, name, {\n        get: function () {\n            return this[getter]();\n        },\n        set: function (value) {\n            return this[setter](value);\n        },\n        configurable: true,\n        enumerable: true\n    });\n}\n\nfunction ensureMetadata(target: Type): TypeMetadata {\n\n    if (!Object.prototype.hasOwnProperty.call(target, '__metadata') ||\n        !(target as TypeExt).__metadata) {\n        (target as TypeExt).__metadata = Object.create(null);\n    }\n\n    return (target as TypeExt).__metadata;\n}\n\nfunction distinct(arr: any[]) {\n    return arr.filter((item, pos) => arr.indexOf(item) === pos);\n}\n\nconst _fieldsProxy = new Proxy({}, { get: (_, p) => p }) as any;\n\nexport function fieldsProxy<TRow>(): Readonly<Record<keyof TRow, string>> {\n    return _fieldsProxy\n}\n\nexport function keyOf<T>(prop: keyof T) {\n    return prop;\n}\n\nfunction merge(arr1: any[], arr2: any[]) {\n    if (!arr1 || !arr2)\n        return (arr1 || arr2 || []).slice();\n\n    return distinct(arr1.concat(arr2));\n}\n\nfunction interfaceIsAssignableFrom(from: any) {\n    return from != null && \n        Array.isArray((from as TypeExt).__interfaces) && \n        (from as TypeExt).__interfaces.some(x => \n            x === this ||\n            (getTypeNameProp(this)?.length && \n                x.__interface &&\n                getTypeNameProp(x) === this.__typeName));\n}\n\nfunction registerType(type: any, name: string, intf: any[]) {\n    const types = getTypeStore();\n    if (name && name.length) {\n        setTypeNameProp(type, name);\n        types[name] = type;\n    }\n    else if (getTypeNameProp(type as TypeExt)?.length)\n        types[(type as TypeExt).__typeName] = type;\n\n    if (intf != null && intf.length)\n        Object.defineProperty(type, \"__interfaces\", {\n            value: merge((type as TypeExt).__interfaces, intf),\n            configurable: true\n        });\n}\n\nexport function registerClass(type: any, name: string, intf?: any[]) {\n    registerType(type, name, intf);\n    Object.defineProperty(type, \"__interface\", { value: false, configurable: true });\n}\n\nexport function registerEditor(type: any, name: string, intf?: any[]) {\n    registerClass(type, name, intf);\n    addAttribute(type, new EditorAttribute());\n}\n\nexport function registerEnum(type: any, name: string, enumKey?: string) {\n    registerType(type, name, undefined);\n    if (enumKey && enumKey != name) {\n        const types = getTypeStore();\n        if (!types[enumKey])\n            types[enumKey] = type;\n    }\n    Object.defineProperty(type, \"__interface\", { value: null, configurable: true });\n}\n\nexport function registerInterface(type: any, name: string, intf?: any[]) {\n    registerType(type, name, intf);\n    Object.defineProperty(type, \"__interface\", { value: true, configurable: true });\n    Object.defineProperty(type, \"__isAssignableFrom\", { value: interfaceIsAssignableFrom, configurable: true });\n}\n\nexport function addAttribute(type: any, attr: any) {\n    var md = ensureMetadata(type);\n    md.attr = md.attr || [];\n    md.attr.push(attr);\n}\n\nexport class ISlickFormatter {\n}\n\nregisterInterface(ISlickFormatter, 'Serenity.ISlickFormatter');\n\nexport class EditorAttribute {\n}\n\nregisterClass(EditorAttribute, 'Serenity.EditorAttribute');\n\nexport function initializeTypes(root: any, pre: string, limit: number) {\n\n    if (!root)\n        return;\n\n    const types = getTypeStore();\n\n    for (var k of Object.keys(root)) {\n        if (k.charAt(0) < 'A' || \n            k.charAt(0) > 'Z' || \n            k.indexOf('$') >= 0 || \n            !Object.prototype.hasOwnProperty.call(root, k))\n            continue;\n\n        var obj = root[k];\n\n        if (obj == void 0 ||\n            Array.isArray(obj) ||\n            obj instanceof Date ||\n            (typeof obj != \"function\" &&\n             typeof obj != \"object\"))\n            continue;\n\n        // no explict __typeName, e.g. not registered with a name,\n        // a function but not an html element, or registered without name\n        if (!getTypeNameProp(obj) && \n            ((typeof obj === \"function\" && typeof obj.nodeType !== \"number\") || \n             (Object.prototype.hasOwnProperty.call(obj, \"__interface\") &&\n              (obj as TypeExt).__interface !== undefined))) {\n   \n            // legacy formatter with registerClass\n            if (typeof obj == \"function\" && \n                !obj.__interfaces && \n                obj.prototype?.format &&\n                k.substr(-9) === \"Formatter\") {\n                if ((obj as TypeExt).__interface === undefined)\n                    Object.defineProperty(obj, \"__interface\", { value: false, configurable: true });\n                (obj as TypeExt).__interfaces = [ISlickFormatter]\n            }\n\n            // only register types that should\n            if ((obj as TypeExt).__interface !== undefined) {\n                setTypeNameProp(obj, pre + k);\n                types[pre + k] = obj;\n            }\n        }\n        \n        if (limit > 0) \n            initializeTypes(obj, pre + k + \".\", limit - 1);\n    }\n}\n\nexport class Exception extends Error {\n    constructor(message: string) {\n        super(message);\n        this.name = \"Exception\";\n    }\n}\n\nexport class ArgumentNullException extends Exception {\n    constructor(paramName: string, message?: string) {\n        super((message || 'Value cannot be null.') + '\\nParameter name: ' + paramName);\n        this.name = \"ArgumentNullException\";\n    }\n}\n\nexport class InvalidCastException extends Exception {\n    constructor(message: string) {\n        super(message);\n        this.name = \"InvalidCastException\";\n    }\n}\n\nexport {}", "\uFEFF/**\n * Checks if the string ends with the specified substring.\n * @param s String to check.\n * @param suffix Suffix to check.\n * @returns True if the string ends with the specified substring.\n */\nexport function endsWith(s: string, suffix: string): boolean {\n    return s.endsWith(suffix);\n}\n\n/**\n * Checks if the string is empty or null.\n * @param s String to check.\n * @returns True if the string is empty or null.\n */\nexport function isEmptyOrNull(s: string) {\n    return s == null || s.length === 0;\n}\n\n/**\n * Checks if the string is empty or null or whitespace.\n * @param s String to check.\n * @returns True if the string is empty or null or whitespace.\n */\nexport function isTrimmedEmpty(s: string) {\n    return trimToNull(s) == null;\n}\n\n/**\n * Pads the string to the left with the specified character.\n * @param s String to pad.\n * @param len Target length of the string.\n * @param ch Character to pad with.\n * @returns Padded string.\n */\nexport function padLeft(s: string | number, len: number, ch: string = ' ') {\n    s = s == null ? '' : s.toString();\n    if ((s as any).padStart)\n        return (s as any).padStart(len, ch);\n    while (s.length < len)\n        s = ch + s;\n    return s;\n}\n\n/**\n * Checks if the string starts with the prefix\n * @param s String to check.\n * @param prefix Prefix to check.\n * @returns True if the string starts with the prefix.\n */\nexport function startsWith(s: string, prefix: string): boolean {\n    return s.startsWith(prefix);\n}\n\n/**\n * Converts the string to single line by removing line end characters\n * @param str String to convert.\n */\nexport function toSingleLine(str: string) {\n    return replaceAll(replaceAll(trimToEmpty(str), '\\r\\n', ' '), '\\n', ' ').trim();\n}\n\n/**\n * Trims the whitespace characters from the end of the string\n */\nexport var trimEnd = function(s: string) {\n    return (s ?? \"\" as any).trimEnd?.() ?? s.replace(/\\s*$/, '');\n};\n\n/**\n * Trims the whitespace characters from the start of the string\n */\nexport var trimStart = function(s: string) {\n    return (s ?? \"\" as any).trimStart?.() ?? s.replace(/^\\s*/, '');\n};\n\n/**\n * Trims the whitespace characters from the start and end of the string\n * This returns empty string even when the string is null or undefined.\n */\nexport function trim(s: string) {\n    return s?.trim() ?? '';\n}\n\n/**\n * Trims the whitespace characters from the start and end of the string\n * Returns empty string if the string is null or undefined.\n */\nexport function trimToEmpty(s: string) {\n    return (s ?? \"\").trim();\n}\n\n/**\n * Trims the whitespace characters from the start and end of the string\n * Returns null if the string is null, undefined or whitespace.\n */\nexport function trimToNull(s: string) {\n    if (s == null)\n        return null;\n    s = trim(s);\n    return s.length === 0 ? null : s;\n}\n\n/**\n * Replaces all occurrences of the search string with the replacement string.\n * @param str String to replace.\n * @param find String to find.\n * @param replace String to replace with.\n * @returns Replaced string.\n */\nexport function replaceAll(str: string, find: string, replace: string): string {\n    str = str || '';\n    return (str as any).replaceAll?.(find, replace) ?? str.split(find).join(replace);\n}\n\n/**\n * Pads the start of string to make it the specified length.\n * @param s String to pad.\n * @param len Target length of the string.\n */\nexport function zeroPad(n: number, len: number): string {\n    if (n == null)\n        return \"\";\n    let s = n.toString();\n    while (s.length < len)\n        s = \"0\" + s;\n    return s;\n}", "\uFEFFimport { getStateStore } from \"./system\";\nimport { isEmptyOrNull, startsWith } from \"./strings\";\n\nexport function localText(key: string): string {\n    let t: string = getTable()[key];\n    if (t == null) {\n        t = key ?? '';\n    }\n    return t;\n}\n\n/** @obsolete prefer localText for better discoverability */\nexport const text = localText;\n\nexport function dbText(prefix: string): ((key: string) => string) {\n    return function (key: string) {\n        return localText(\"Db.\" + prefix + \".\" + key);\n    }\n}\n\nfunction getTable(): { [key: string]: string } {\n    return getStateStore(\"__localText\");\n}\n\nexport function prefixedText(prefix: string) {\n\n    return function (text: string, key: string | ((p?: string) => string)) {\n\n        if (text != null && !startsWith(text, '`')) {\n            var local = tryGetText(text);\n            if (local != null) {\n                return local;\n            }\n        }\n\n        if (text != null && startsWith(text, '`')) {\n            text = text.substr(1);\n        }\n\n        if (!isEmptyOrNull(prefix)) {\n            var textKey = typeof (key) == \"function\" ? key(prefix) : (prefix + key);\n            var localText = tryGetText(textKey);\n            if (localText != null) {\n                return localText;\n            }\n        }\n\n        return text;\n    }\n}\n\nexport function tryGetText(key: string): string {\n    var value = getTable()[key];\n    return value;\n}\n\nexport function dbTryText(prefix: string): ((key: string) => string) {\n    return function (key: string) {\n        return localText(\"Db.\" + prefix + \".\" + key);\n    }\n}\n\nexport function proxyTexts(o: Record<string, any>, p: string, t: Record<string, any>): Object {\n    if (typeof window != 'undefined' && window['Proxy']) {\n        return new window['Proxy'](o, {\n            get: (x: Object, y: string) => {\n                var tv = t[y];\n                if (tv == null)\n                    return localText(p + y);\n                else {\n                    var z = o[y];\n                    if (z != null)\n                        return z;\n                    o[y] = z = proxyTexts({}, p + y + '.', tv);\n                    return z;\n                }\n            },\n            ownKeys: (x: Object) => Object.keys(t)\n        });\n    }\n    else {\n        for (var k of Object.keys(t)) {\n            if (typeof t[k] == 'number')\n                Object.defineProperty(o, k, {\n                    get: () => localText(p + k)\n                });\n            else\n                o[k] = proxyTexts({}, p + k + '.', t[k]);\n        }\n        return o;\n    }\n}\n\nexport class LT {\n    static empty: LT = new LT('');\n\n    constructor(private key: string) {\n    }\n\n    static add(key: string, value: string): void;\n    static add(obj: any, pre?: string) {\n        if (!obj) {\n            return;\n        }\n        \n        let table = getTable();\n\n        if (typeof obj === \"string\") {\n            table[obj] = pre;\n            return;\n        }\n\n        pre = pre || '';\n        for (let k of Object.keys(obj)) {\n            let actual = pre + k;\n            let o = obj[k];\n            if (typeof (o) === 'object') {\n                LT.add(o, actual + '.');\n            }\n            else {\n                table[actual] = o;\n            }\n        }\n    }\n\n    get() {\n        var t = getTable()[this.key];\n        if (t == null) {\n            t = this.key || '';\n        }\n        return t;\n    }\n\n    toString() {\n        var t = getTable()[this.key];\n        if (t == null) {\n            t = this.key || '';\n        }\n        return t;\n    }\n\n    static initializeTextClass = function (type: any, prefix: string) {\n        var $t1 = Object.keys(type).slice();\n        var table = getTable();\n        for (var $t2 = 0; $t2 < $t1.length; $t2++) {\n            var member = $t1[$t2];\n            var value = type[member];\n            if (value instanceof LT) {\n                var lt = value;\n                var key = prefix + member;\n                table[key] = lt.key;\n                type[member] = new LT(key);\n            }\n        }\n    }\n\n    static getDefault = function (key: string, defaultText: string) {\n        var t = getTable()[key];\n        if (t == null) {\n            t = defaultText;\n            if (t == null) {\n                t = key || '';\n            }\n        }\n        return t;\n    }\n}\n\nif (typeof globalThis !== \"undefined\") {\n    const Q = (globalThis as any).Q || ((globalThis as any).Q = {});\n    if (Q.LT == null)\n        Q.LT = LT;\n}", "\uFEFF/// <reference types=\"jquery\" />\nconst $: JQueryStatic = typeof jQuery === \"function\" ? jQuery : typeof globalThis.$ === \"function\" ? globalThis.$ :\n    typeof window !== \"undefined\" ? (window.jQuery ?? window.$) : undefined;\n\nexport default $;", "\uFEFFimport { localText } from \"./localtext\";\nimport $ from \"@optionaldeps/jquery\";\n\n/**\n * Adds an empty option to the select.\n * @param select the select element\n */\nexport function addEmptyOption(select: JQuery | HTMLSelectElement) {\n    addOption(select, '', localText(\"Controls.SelectEditor.EmptyItemText\"));\n}\n\n/**\n * Adds an option to the select.\n */\nexport function addOption(select: JQuery | HTMLSelectElement, key: string, text: string) {\n    $('<option/>').attr(\"value\", key ?? \"\").text(text ?? \"\").appendTo(select);\n}\n\n/** @obsolete use htmlEncode as it also encodes quotes */\nexport const attrEncode = htmlEncode;\n\n/** Clears the options in the select element */\nexport function clearOptions(select: JQuery) {\n    select.html('');\n}\n\n/**\n * Finds the first element with the given relative id to the source element.\n * It can handle underscores in the source element id.\n * @param element the source element\n * @param relativeId the relative id to the source element\n * @param context the context element (optional)\n * @returns the element with the given relative id to the source element.\n */\nexport function findElementWithRelativeId(element: JQuery, relativeId: string, context?: HTMLElement): JQuery;\n/**\n * Finds the first element with the given relative id to the source element.\n * It can handle underscores in the source element id.\n * @param element the source element\n * @param relativeId the relative id to the source element\n * @param context the context element (optional)\n * @returns the element with the given relative id to the source element.\n */\nexport function findElementWithRelativeId(element: HTMLElement, relativeId: string, context?: HTMLElement): HTMLElement;\nexport function findElementWithRelativeId(element: JQuery | HTMLElement, relativeId: string, context?: HTMLElement): JQuery | Element {\n\n    const isJQuery = element instanceof $ && element != null;\n    const from: HTMLElement = isJQuery ? (element as JQuery).get(0) : element as HTMLElement;\n    const doc = typeof document === \"undefined\" ? null : document;\n\n    if (from == null)\n        return null;\n\n    var noContext = false;\n    if (context === undefined) {\n        context = from.getRootNode() as HTMLElement;\n        noContext = true;\n    }\n\n    let fromId = from.id ?? \"\";\n    while (true) {\n        var res = context?.querySelector(\"#\" + fromId + relativeId);\n        \n        if (!res && noContext)\n            res = doc?.getElementById(fromId + relativeId);\n\n        if (!res && fromId.length) {\n            res = context?.querySelector(\"#\" + fromId + \"_\" + relativeId);\n            if (!res && noContext)\n                res = doc?.getElementById(fromId + \"_\" + relativeId);\n        }\n\n        if (res || !fromId.length)\n            return isJQuery ? $(res ?? null) : (res ?? null);\n\n        let idx = fromId.lastIndexOf('_');\n        if (idx <= 0)\n            fromId = \"\";\n        else\n            fromId = fromId.substring(0, idx);\n    }\n}\n\nconst esc: Record<string, string> = {\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": \"&#39;\",\n    '&': '&amp;',\n}\n\nfunction escFunc(a: string): string {\n    return esc[a];\n}\n\n/**\n * Html encodes a string (encodes single and double quotes, & (ampersand), > and < characters)\n * @param s String (or number etc.) to be HTML encoded\n */\nexport function htmlEncode(s: any): string {\n    if (s == null)\n        return '';\n\n    if (typeof s !== \"string\")\n        s = \"\" + s;\n\n    return s.replace(/[<>\"'&]/g, escFunc)\n}\n\n/**\n * Creates a new DIV and appends it to the body.\n * @returns the new DIV element.\n */\nexport function newBodyDiv(): JQuery {\n    return $('<div/>').appendTo(document.body);\n}\n\n/**\n * Returns the outer HTML of the element.\n */\nexport function outerHtml(element: JQuery) {\n    return $('<i/>').append(element.eq(0).clone()).html();\n}\n\n\n/** \n * Toggles the class on the element handling spaces like jQuery addClass does.\n * @param el the element\n * @param cls the class to toggle\n * @param remove if true, the class will be added, if false the class will be removed, otherwise it will be toggled.\n */\nexport function toggleClass(el: Element, cls: string, remove?: boolean) {\n    if (cls == null || !cls.length)\n        return;\n\n    if (cls.indexOf(' ') < 0) {\n        el.classList.toggle(cls, remove);\n        return;\n    }\n\n    var k = cls.split(' ').map(x => x.trim()).filter(x => x.length);\n    for (var a of k)\n        el.classList.toggle(a, remove);\n}\n", "\uFEFF// adapted from https://github.com/JPeer264/toastr2\n\nimport { htmlEncode, toggleClass } from \"./html\";\n\nexport type ToastContainerOptions = {\n    containerId?: string;\n    positionClass?: string;\n    target?: string;\n}\n\nexport type ToastrOptions = ToastContainerOptions & {\n    tapToDismiss?: boolean;\n    toastClass?: string;\n    showDuration?: number;\n    onShown?: () => void;\n    hideDuration?: number;\n    onHidden?: () => void;\n    closeMethod?: boolean;\n    closeDuration?: number | false;\n    closeEasing?: boolean;\n    closeOnHover?: boolean;\n    extendedTimeOut?: number;\n    iconClass?: string;\n    positionClass?: string;\n    timeOut?: number; // Set timeOut and extendedTimeOut to 0 to make it sticky\n    titleClass?: string;\n    messageClass?: string;\n    escapeHtml?: boolean;\n    target?: string;\n    closeHtml?: string;\n    closeClass?: string;\n    newestOnTop?: boolean;\n    preventDuplicates?: boolean;\n    onclick?: (event: MouseEvent) => void;\n    onCloseClick?: (event: Event) => void;\n    closeButton?: boolean;\n    rtl?: boolean;\n}\n\nexport type NotifyMap = {\n    type: string;\n    iconClass: string;\n    title?: string;\n    message?: string;\n}\n\nconst initialOptions: ToastrOptions = {\n    tapToDismiss: true,\n    toastClass: 'toast',\n    containerId: 'toast-container',\n    showDuration: 300,\n    onShown: () => { },\n    hideDuration: 1000,\n    onHidden: () => { },\n    closeMethod: false,\n    closeDuration: false,\n    closeEasing: false,\n    closeOnHover: true,\n    extendedTimeOut: 1000,\n    iconClass: 'toast-info',\n    positionClass: 'toast-top-right',\n    timeOut: 5000, // Set timeOut and extendedTimeOut to 0 to make it sticky\n    titleClass: 'toast-title',\n    messageClass: 'toast-message',\n    escapeHtml: true,\n    target: 'body',\n    closeHtml: '<button type=\"button\">&times;</button>',\n    closeClass: 'toast-close-button',\n    newestOnTop: true,\n    preventDuplicates: false,\n    rtl: false,\n    onCloseClick: () => { },\n    closeButton: false,\n    onclick: () => { },\n}\n\nvar initialInstance: Toastr = null;\n\nexport class Toastr {\n    private listener: any;\n\n    private toastId = 0;\n\n    private previousToast: string | null = null;\n\n    public options: ToastrOptions;\n\n    public constructor(options?: ToastrOptions) {\n        this.options = Object.assign(Object.assign({}, initialInstance?.options ?? initialOptions), options);\n        this.createContainer(options);\n    }\n\n    private createContainer(options: ToastContainerOptions = this.options): HTMLElement {\n        var container = document.createElement('div');\n\n        container.setAttribute('id', options.containerId);\n        if (options.positionClass)\n            toggleClass(container, options.positionClass, true);\n\n        const target = document.getElementsByTagName(options.target);\n\n        if (target && target[0]) {\n            target[0].appendChild(container);\n        }\n\n        return container;\n    }\n\n    public getContainer(options?: ToastContainerOptions, create = false): HTMLElement {\n        const container = document.getElementById(options?.containerId ?? this.options.containerId);\n\n        if (container)\n            return container;\n\n        if (create)\n            return this.createContainer(options ?? this.options);\n\n        return null;\n    }\n\n    public error(\n        message?: string,\n        title?: string,\n        opt?: ToastrOptions,\n    ): HTMLElement | null {\n        return this.notify({\n            type: 'error',\n            iconClass: 'toast-error',\n            message,\n            title,\n        }, opt);\n    }\n\n    public warning(\n        message?: string,\n        title?: string,\n        opt?: ToastrOptions,\n    ): HTMLElement | null {\n        return this.notify({\n            type: 'warning',\n            iconClass: 'toast-warning',\n            message,\n            title,\n        }, opt);\n    }\n\n    public success(\n        message?: string,\n        title?: string,\n        opt?: ToastrOptions,\n    ): HTMLElement | null {\n        return this.notify({\n            type: 'success',\n            iconClass: 'toast-success',\n            message,\n            title,\n        }, opt);\n    }\n\n    public info(\n        message?: string,\n        title?: string,\n        opt?: ToastrOptions,\n    ): HTMLElement | null {\n        return this.notify({\n            type: 'info',\n            iconClass: 'toast-info',\n            message,\n            title,\n        }, opt);\n    }\n\n    public subscribe(callback: (response: Toastr) => void): void {\n        this.listener = callback;\n    }\n\n    public publish(args: Toastr): void {\n        if (!this.listener) {\n            return;\n        }\n\n        this.listener(args);\n    }\n\n    public clear(toastElement?: HTMLElement | null, clearOptions: { force?: boolean } = {}) {\n        if (!this.clearToast(toastElement, this.options, clearOptions)) {\n            this.clearContainer(this.options);\n        }\n    }\n\n    public remove(toastElement?: HTMLElement | null) {\n        var container = this.getContainer(this.options);\n        if (!container)\n            return;\n\n        if (toastElement && toastElement !== document.activeElement) {\n            this.removeToast(toastElement);\n\n            return;\n        }\n\n        if (!container.hasChildNodes()) {\n            const parentNode = container.parentElement;\n\n            if (parentNode) {\n                parentNode.removeChild(container);\n            }\n        }\n    }\n\n    public removeToast(toastElement: HTMLElement, options = this.options) {\n        var container = this.getContainer(options);\n\n        if (!container || !toastElement.parentNode) {\n            return;\n        }\n\n        // todo set after visible state\n        // as this will be a transition of css\n        toastElement.parentNode.removeChild(toastElement);\n        // check if visible\n        if (toastElement.offsetWidth > 0 && toastElement.offsetHeight > 0) {\n            return;\n        }\n\n        if (!container.hasChildNodes()) {\n            if (container.parentNode) {\n                container.parentNode.removeChild(container);\n            }\n\n            this.previousToast = null;\n        }\n    }\n\n    private clearContainer(options: Partial<ToastrOptions> = this.options) {\n        var container = this.getContainer(options);\n        if (!container)\n            return;\n\n        const toastsToClear = Array.from(container.childNodes) as HTMLElement[];\n\n        for (let i = toastsToClear.length - 1; i >= 0; i -= 1) {\n            this.clearToast(toastsToClear[i]);\n        }\n    }\n\n    private clearToast(\n        toastElement?: HTMLElement | null,\n        options?: ToastContainerOptions,\n        clearOptions: { force?: boolean } = {},\n    ): boolean {\n        if (!toastElement) {\n            return false;\n        }\n\n        const force = clearOptions.force || false;\n\n        if (toastElement && (force || toastElement !== document.activeElement)) {\n            this.removeToast(toastElement, options);\n            return true;\n        }\n\n        return false;\n    }\n\n    private notify(map: NotifyMap, opt: ToastrOptions): HTMLElement | null {\n        opt = Object.assign(Object.assign(Object.assign({}, this.options), map), opt);\n\n        const shouldExit = (opts: ToastrOptions, exitMap: NotifyMap): boolean => {\n            if (opts.preventDuplicates) {\n                if (exitMap.message === this.previousToast) {\n                    return true;\n                }\n\n                this.previousToast = exitMap.message || '';\n            }\n            return false;\n        };\n\n\n        if (shouldExit(opt, map)) {\n            return null;\n        }\n\n        this.toastId += 1;\n\n        var container = this.getContainer(opt, true);\n\n        let intervalId: number = null;\n        const toastElement = document.createElement('div');\n        const $titleElement = document.createElement('div');\n        const $messageElement = document.createElement('div');\n        const createdElement = document.createElement('div');\n        createdElement.innerHTML = opt.closeHtml.trim();\n        const closeElement = createdElement.firstChild as HTMLElement | null;\n\n        const response: any = {\n            toastId: this.toastId,\n            state: 'visible',\n            startTime: new Date(),\n            endTime: undefined,\n            opt,\n            map,\n        };\n\n        const hideToast = (override: any = null): void => {\n            if (toastElement === document.activeElement && !override) {\n                return;\n            }\n\n            this.removeToast(toastElement);\n\n            if (intervalId) {\n                clearTimeout(intervalId);\n            }\n\n            if (opt.onHidden && response.state !== 'hidden') {\n                opt.onHidden();\n            }\n\n            response.state = 'hidden';\n            response.endTime = new Date();\n            this.publish(response);\n        };\n\n        const setAria = (): void => {\n            let ariaValue = '';\n\n            switch (opt.iconClass) {\n                case 'toast-success':\n                case 'toast-info':\n                    ariaValue = 'polite';\n\n                    break;\n\n                default:\n                    ariaValue = 'assertive';\n            }\n\n            toastElement.setAttribute('aria-live', ariaValue);\n        };\n\n        const delayedHideToast = (): void => {\n            if (opt.timeOut > 0 || opt.extendedTimeOut > 0) {\n                intervalId = setTimeout(hideToast, opt.extendedTimeOut);\n            }\n        };\n\n        const stickAround = (): void => {\n            if (intervalId) {\n                clearTimeout(intervalId);\n            }\n        };\n\n        const handleEvents = (): void => {\n            if (opt.closeOnHover) {\n                toastElement.addEventListener('mouseover', () => stickAround());\n                toastElement.addEventListener('mouseout', () => delayedHideToast());\n            }\n\n            if (!opt.onclick && opt.tapToDismiss) {\n                toastElement.addEventListener('click', hideToast);\n            }\n\n            if (opt.closeButton && closeElement) {\n                closeElement.addEventListener('click', (event) => {\n                    event.stopPropagation();\n\n                    if (opt.onCloseClick) {\n                        opt.onCloseClick(event);\n                    }\n\n                    hideToast(true);\n                });\n            }\n\n            if (opt.onclick) {\n                toastElement.addEventListener('click', (event) => {\n                    // ts needs another check here\n                    if (opt.onclick) {\n                        opt.onclick(event);\n                    }\n\n                    hideToast();\n                });\n            }\n        };\n\n        const setTitle = (): void => {\n            if (map.title) {\n                let suffix = map.title;\n                if (opt.escapeHtml) {\n                    suffix = htmlEncode(map.title);\n                }\n                $titleElement.innerHTML = suffix;\n                toggleClass($titleElement, opt.titleClass, true);\n                toastElement.appendChild($titleElement);\n            }\n        };\n\n        const setMessage = (): void => {\n            if (map.message) {\n                let suffix = map.message;\n\n                if (opt.escapeHtml) {\n                    suffix = htmlEncode(map.message);\n                }\n\n                $messageElement.innerHTML = suffix;\n                toggleClass($messageElement, opt.messageClass, true);\n                toastElement.appendChild($messageElement);\n            }\n        };\n\n        const setCloseButton = (): void => {\n            if (opt.closeButton && closeElement) {\n                toggleClass(closeElement, opt.closeClass, true);\n                closeElement.setAttribute('role', 'button');\n                toastElement.insertBefore(closeElement, toastElement.firstChild);\n            }\n        };\n\n        const setSequence = (): void => {\n            if (opt.newestOnTop) {\n                container.insertBefore(toastElement, container.firstChild);\n            } else {\n                container.appendChild(toastElement);\n            }\n        };\n\n        const displayToast = (): void => {\n            if (opt.onShown) {\n                opt.onShown();\n            }\n\n            if (opt.timeOut > 0) {\n                intervalId = setTimeout(hideToast, opt.timeOut);\n\n            }\n        };\n\n        const personalizeToast = (): void => {\n            toastElement.classList.add('show');\n            opt.rtl && toastElement.classList.add('rtl');\n            opt.toastClass && toggleClass(toastElement, opt.toastClass, true);\n            opt.iconClass && toggleClass(toastElement, opt.iconClass, true);\n            setTitle();\n            setMessage();\n            setCloseButton();\n            setSequence();\n            setAria();\n        };\n\n        personalizeToast();\n        displayToast();\n        handleEvents();\n        this.publish(response);\n        return toastElement;\n    }\n}\n\ninitialInstance = new Toastr();\n\nexport default initialInstance;\n", "\uFEFFimport { htmlEncode } from \"./html\";\nimport { localText } from \"./localtext\";\nimport { extend } from \"./system\";\nimport initialInstance, { ToastrOptions } from \"./toastr2\";\n\n// set default for toastr itself, possible security issue\nif (typeof initialInstance !== \"undefined\" && initialInstance.options)\n    initialInstance.options.escapeHtml = true;\n\nexport let defaultNotifyOptions: ToastrOptions = {\n    timeOut: 3000,\n    showDuration: 250,\n    hideDuration: 500,\n    escapeHtml: true,\n    extendedTimeOut: 500,\n    positionClass: 'position-toast toast-top-full-width'\n}\n\nfunction getToastrOptions(options: ToastrOptions) {\n    options = extend(extend({}, defaultNotifyOptions), options);\n    positionToastContainer(true, options);\n    return options;\n}\n\nfunction showToast(type: string, message: string, title?: string, options?: ToastrOptions) {\n    if (typeof initialInstance !== \"undefined\" && (typeof (initialInstance as any)[type]) === 'function') {\n        (initialInstance as any)[type](message, title, getToastrOptions(options));\n        return;\n    }\n\n    if (typeof document === \"undefined\" || !document.body) {\n        console.error(`no document found! can't show toast: ${type} - ${title}: ${message}`);\n        return;\n    }\n\n    var container = document.getElementById('toast-container') as HTMLDivElement;\n    if (!container) {\n        container = document.createElement('div');\n        container.id = \"toast-container\"\n        container.className = \"toast-container top-0 end-0 p-3\";\n        document.body.append(container);\n\n        var toast = document.createElement('div');\n        toast.className = \"toast\";\n        toast.role = \"alert\";\n        toast.ariaLive = \"assertive\";\n        toast.ariaAtomic = \"true\";\n        toast.innerHTML = `<div class=\"toast-header bg-${htmlEncode(type)} text-${htmlEncode(type)}\">\n          <strong class=\"me-auto\">${htmlEncode(title)}</strong>\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"toast\" aria-label=\"${htmlEncode(localText(\"Dialogs.CloseButton\"))}\"></button>\n        </div>\n        <div class=\"toast-body\">\n        ${htmlEncode(message)}\n        </div>\n      </div>`;\n        container.appendChild(toast);\n\n        // @ts-ignore\n        if (typeof bootstrap === \"undefined\") {\n            toast.querySelector('.btn-close').addEventListener('click', function(this: HTMLButtonElement) { this.remove(); });\n            setTimeout(function() { this.remove(); }, 10000);\n        }\n    }\n}\n\nexport function notifyWarning(message: string, title?: string, options?: ToastrOptions): void {\n    showToast('warning', message, title, getToastrOptions(options));\n}\n\nexport function notifySuccess(message: string, title?: string, options?: ToastrOptions): void {\n    showToast('success', message, title, getToastrOptions(options));\n}\n\nexport function notifyInfo(message: string, title?: string, options?: ToastrOptions): void {\n    showToast('info', message, title, getToastrOptions(options));\n}\n\nexport function notifyError(message: string, title?: string, options?: ToastrOptions): void {\n    showToast('error', message, title, getToastrOptions(options));\n}\n\nexport function positionToastContainer(create: boolean, options?: ToastrOptions) {\n    if (typeof initialInstance === 'undefined') {\n        return;\n    }\n\n    var container = initialInstance.getContainer(options, create);\n    if (!container || !container.classList.contains('position-toast'))\n        return;\n\n    var dialog = typeof $ !== \"undefined\" ? $(window.document.body).children('.ui-dialog:visible, .modal.in, .modal.show').last() : [] as any;\n    if (dialog.length > 0) {\n        var position = dialog.position();\n        container.classList.add('positioned-toast');\n        container.style.position = 'absolute';\n        container.style.top = position.top + 28 + 'px';\n        container.style.left = position.left + 6 + 'px';\n        container.style.width = dialog.width() - 12 + 'px';\n    }\n    else if (container.classList.contains('positioned-toast')) {\n        container.classList.remove('positioned-toast');\n        container.style.position = '';\n        container.style.top = '';\n        container.style.left = '';\n        container.style.width = '';\n    }\n}", "\uFEFFvar Config = {\n    /**\n     * This is the root path of your application. If your application resides under http://localhost/mysite/,\n     * your root path is \"mysite/\". This variable is automatically initialized by reading from a <link> element\n     * with ID \"ApplicationPath\" from current page, which is usually located in your _LayoutHead.cshtml file\n     */\n    applicationPath: '/',\n\n    /**\n     * Email validation by default only allows ASCII characters. Set this to true if you want to allow unicode.\n     */\n    emailAllowOnlyAscii: true,\n\n    /**\n     * @Obsolete defaulted to false before for backward compatibility, now it is true by default\n     */\n    responsiveDialogs: true,\n\n    /**\n     * Set this to true, to prefer bootstrap dialogs over jQuery UI dialogs by default for message dialogs\n     */\n    bootstrapMessages: false,\n\n    /**\n     * This is the list of root namespaces that may be searched for types. For example, if you specify an editor type\n     * of \"MyEditor\", first a class with name \"MyEditor\" will be searched, if not found, search will be followed by\n     * \"Serenity.MyEditor\" and \"MyApp.MyEditor\" if you added \"MyApp\" to the list of root namespaces.\n     *\n     * You should usually add your application root namespace to this list in ScriptInit(ialization).ts file.\n     */\n    rootNamespaces: ['Serenity'],\n\n    /**\n     * This is an optional method for handling when user is not logged in. If a users session is expired \n     * and when a NotAuthorized response is received from a service call, Serenity will call this handler, so\n     * you may intercept it and notify user about this situation and ask if she wants to login again...\n     */\n    notLoggedInHandler: <Function>null\n}\n\nif (typeof document !== 'undefined') {\n    var pathLink = document.querySelector('link#ApplicationPath') as HTMLLinkElement;\n    if (pathLink != null) {\n        Config.applicationPath = pathLink.getAttribute('href');\n    }\n}\n\nexport { Config };\n", "\uFEFFconst _bootstrap: {\n    Modal?: {\n        new (div: HTMLElement, opt?: { backdrop?: boolean }): { show: () => void, hide: () => void };\n        VERSION?: string;\n        getInstance(el: HTMLElement): { hide: () => void, show: () => void };\n    }\n// @ts-ignore\n} = typeof bootstrap !== \"undefined\" ? bootstrap : undefined;\n\nexport default _bootstrap;", "\uFEFFimport { Config } from \"./config\";\nimport { extend } from \"./system\";\nimport { htmlEncode, toggleClass } from \"./html\";\nimport { startsWith } from \"./strings\";\nimport { tryGetText } from \"./localtext\";\nimport $ from \"@optionaldeps/jquery\";\nimport bootstrap from \"@optionaldeps/bootstrap\";\n\n/**\n * Options for a message dialog button\n */\nexport interface DialogButton {\n    /** Button text */\n    text?: string;\n    /** Button hint */\n    hint?: string;\n    /** Button icon */\n    icon?: string;\n    /** Click handler */\n    click?: (e: MouseEvent) => void;\n    /** CSS class for button */\n    cssClass?: string;\n    /** HTML encode button text. Default is true. */\n    htmlEncode?: boolean;\n    /** The code that is returned from message dialog function when this button is clicked */\n    result?: string;\n}\n\n/**\n * Options that apply to all message dialog types\n */\nexport interface CommonDialogOptions {\n    /** Event handler that is called when dialog is opened */\n    onOpen?: () => void;\n    /** Event handler that is called when dialog is closed */\n    onClose?: (result: string) => void;\n    /** Dialog title */\n    title?: string;\n    /** HTML encode the message, default is true */\n    htmlEncode?: boolean;\n    /** Wrap the message in a `<pre>` element, so that line endings are preserved, default is true */\n    preWrap?: boolean;\n    /** Dialog css class. Default is based on the message dialog type */\n    dialogClass?: string;\n    /** List of buttons to show on the dialog */\n    buttons?: DialogButton[];\n    /** Class to use for the modal element for Bootstrap dialogs */\n    modalClass?: string;\n    /** True to use Bootstrap dialogs even when jQuery UI  present, default is based on `Q.Config.bootstrapMessages */\n    bootstrap?: boolean;\n    /** The result code of the button used to close the dialog is returned via this variable in the options object */\n    result?: string;\n}\n\n// if both jQuery UI and bootstrap button exists, prefer jQuery UI button as UI dialog needs them\nif (typeof $ !== \"undefined\" && ($.fn as any)?.button?.noConflict && ($ as any).ui?.button) {\n    ($.fn as any).btn = ($ as any).fn.button.noConflict();\n}\n\nfunction toIconClass(icon: string): string {\n    if (!icon)\n        return null;\n    if (startsWith(icon, 'fa-'))\n        return 'fa ' + icon;\n    if (startsWith(icon, 'glyphicon-'))\n        return 'glyphicon ' + icon;\n    return icon;\n}\n\nfunction internalUIDialog(options: CommonDialogOptions, bodyHtml: string, dialogClass: string) {\n    var opt = extend(<any>{\n        modal: true,\n        width: '40%',\n        maxWidth: 450,\n        minWidth: 180,\n        resizable: false,\n        open: function () {\n            if (options.onOpen)\n                options.onOpen.call(this);\n        },\n        close: function () {\n            ($(this) as any).dialog?.('destroy');\n            if (options.onClose)\n                options.onClose.call(this, options.result);\n        }\n    }, options);\n\n    opt.dialogClass = 's-MessageDialog' + (dialogClass ? (' ' + dialogClass) : '');\n\n    if (options.buttons) {\n        opt.buttons = options.buttons.map(x => {\n            var btn = dialogButtonToUI(x);\n            btn.click = function (e: any) {\n                options.result = x.result;\n                ($(this) as any).dialog('close');\n                x.click && x.click.call(this, e);\n            }\n            return btn;\n        });\n    }\n\n    return ($('<div>' + bodyHtml + '</div>') as any).dialog(opt);\n}\n\nlet _isBS3: boolean;\nlet _isBS5Plus: boolean;\n\n/** Returns true if Bootstrap 3 is loaded */\nexport function isBS3(): boolean {\n    if (_isBS3 != null)\n        return _isBS3;\n    // @ts-ignore\n    return (_isBS3 = !!(typeof $ !== \"undefined\" && $?.fn?.modal?.Constructor?.VERSION && ($.fn.modal.Constructor.VERSION + \"\").charAt(0) == '3'));\n}\n\n/** Returns true if Bootstrap 5+ is loaded */\nexport function isBS5Plus(): boolean {\n    if (_isBS5Plus != null)\n        return _isBS5Plus;\n    return (_isBS5Plus = typeof bootstrap !== \"undefined\" && (!bootstrap.Modal || !bootstrap.Modal.VERSION || (!bootstrap.Modal.VERSION + \"\").charAt(0) != '4'));\n}\n\nconst defaultTxt: Record<string, string> = {\n    AlertTitle: 'Alert',\n    InformationTitle: 'Information',\n    WarningTitle: 'Warning',\n    ConfirmationTitle: 'Confirm',\n    OkButton: 'OK',\n    YesButton: 'Yes',\n    NoButton: 'No',\n    CancelButton: 'Cancel',\n    CloseButton: 'Close'\n};\n\nfunction txt(k: string) {\n    return htmlEncode(tryGetText(\"Dialogs.\" + k) ?? defaultTxt[k]);\n}\n\n/** \n * Builds HTML DIV element for a Bootstrap modal dialog\n * @param title Modal title\n * @param body Modal body, it will not be HTML encoded, so make sure it is encoded \n * @param modalClass Optional class to add to the modal element\n * @param escapeHtml True to html encode body, default is true\n * @returns \n */\nexport function bsModalMarkup(title: string, body: string, modalClass?: string, escapeHtml: boolean = true): HTMLDivElement {\n    var closeButton = `<button type=\"button\" class=\"${isBS5Plus() ? \"btn-\" : \"\"}close\" data-${isBS5Plus() ? \"bs-\" : \"\"}dismiss=\"modal\" aria-label=\"${txt('CloseButton')}\">` +\n        `${isBS5Plus() ? \"\" : '<span aria-hidden=\"true\">&times;</span>'}</button>`;\n    var div = document.createElement(\"div\");\n    div.classList.add(\"modal\");\n    if (modalClass?.length)\n        toggleClass(div, modalClass, true);\n    div.setAttribute(\"tabindex\", \"-1\");\n    div.setAttribute(\"role\", \"dialog\");\n    div.innerHTML = `<div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n        <div class=\"modal-header\">\n            ${(isBS3() ? closeButton : \"\")}<h5 class=\"modal-title\">${htmlEncode(title)}</h5>${(isBS3() ? \"\" : closeButton)}\n        </div>\n        <div class=\"modal-body\">${escapeHtml ? htmlEncode(body) : body}</div>\n        <div class=\"modal-footer\"></div>\n    </div>\n</div>`;\n    return div;\n}\n\n/** Converts a `DialogButton` declaration to Bootstrap button element \n * @param x Dialog button declaration\n * @returns Bootstrap button element\n*/\nexport function dialogButtonToBS(x: DialogButton): HTMLButtonElement {\n    var html = x.htmlEncode == null || x.htmlEncode ? htmlEncode(x.text) : x.text;\n    var iconClass = toIconClass(x.icon);\n    if (iconClass?.length)\n        html = '<i class=\"' + htmlEncode(iconClass) + '\"><i>' + (html ? (\" \" + html) : \"\");\n    var button = document.createElement(\"button\");\n    button.classList.add(\"btn\");\n    if (x.cssClass?.length)\n        toggleClass(button, x.cssClass, true);\n    if (x.hint?.length)\n        button.setAttribute(\"title\", x.hint);\n    button.innerHTML = html;\n    return button;\n}\n\n/** Converts a `DialogButton` declaration to jQuery UI button type\n * @param x Dialog button declaration\n * @returns jQuery UI button type\n */\nexport function dialogButtonToUI(x: DialogButton): any {\n    var html = x.htmlEncode == null || x.htmlEncode ? htmlEncode(x.text) : x.text;\n    var iconClass = toIconClass(x.icon);\n    if (iconClass?.length)\n        html = '<i class=\"' + htmlEncode(iconClass) + '\"></i>' + (html ? (\" \" + html) : \"\");\n    var button = {\n        text: html,\n        click: x.click\n    } as any;\n    if (x.cssClass?.length)\n        button.cssClass = x.cssClass;\n    return button;\n}\n\nfunction internalBSModal(options: CommonDialogOptions, bodyHtml: string, modalClass: string) {\n    var modalDiv = bsModalMarkup(options.title, bodyHtml, \"s-MessageModal\" + (modalClass ? (\" \" + modalClass) : \"\"), false);\n    var footer = modalDiv.querySelector('.modal-footer') as HTMLElement;\n    var rawBS5 = typeof $ === \"undefined\" && isBS5Plus();\n\n    function createButton(x: DialogButton) {\n\n        if (!footer) {\n            return;\n        }\n\n        var button = dialogButtonToBS(x);\n        footer.append(button);\n        button.addEventListener(\"click\", e => {\n            options.result = x.result;\n            if (rawBS5) {\n                bootstrap.Modal.getInstance(modalDiv)?.hide();\n            }\n            else\n                ($(modalDiv) as any).modal('hide');\n            x.click && x.click.call(this, e);\n        });\n    }\n\n    if (options.buttons) {\n        for (var button of options.buttons) {\n            createButton(button);\n        }\n    }\n\n    if (rawBS5) {\n        document.body.appendChild(modalDiv);\n        if (options.onOpen)\n            modalDiv.addEventListener(\"shown.bs.modal\", options.onOpen);\n\n        modalDiv.addEventListener('hidden.bs.modal', e => {\n            try {\n                options.onClose && options.onClose(options.result);\n            }\n            finally {\n                modalDiv.remove();\n            }\n        });\n\n        document.body.appendChild(modalDiv);\n        new bootstrap.Modal(modalDiv, {\n            backdrop: false\n        }).show();\n    }\n    else {\n        var div = $(modalDiv).appendTo(document.body);\n\n        if (options.onOpen)\n            div.one('shown.bs.modal', options.onOpen);\n\n        div.one('hidden.bs.modal', e => {\n            try {\n                options.onClose && options.onClose(options.result);\n            }\n            finally {\n                div.remove();\n            }\n        });\n\n        if (isBS5Plus()) {\n\n            // @ts-ignore\n            (div as any).modal({\n                backdrop: false,\n            });\n            (div as any).modal('show');\n        }\n        else {\n            (div as any).modal({\n                backdrop: false,\n                show: true\n            } as any);\n        }\n\n        if (isBS5Plus())\n            (div as any).modal('show');\n    }\n}\n\nlet _useBrowserDialogs: boolean;\nfunction useBrowserDialogs() {\n    if (_useBrowserDialogs == null) {\n        _useBrowserDialogs = !isBS5Plus() && (typeof $ === 'undefined' || ((!($ as any).ui || !($ as any).ui?.dialog) && (!$.fn || !(($.fn as any).modal))));\n    }\n    return _useBrowserDialogs;\n}\n\nfunction useBSModal(options: CommonDialogOptions): boolean {\n    return Config.bootstrapMessages || options.bootstrap || !($ as any)?.ui?.dialog;\n}\n\nfunction getMessageBodyHtml(message: string, options?: CommonDialogOptions): string {\n    var encode = options == null || options.htmlEncode == null || options.htmlEncode;\n    if (encode)\n        message = htmlEncode(message);\n\n    var preWrap = options == null || (options.preWrap == null && encode) || options.preWrap;\n    return '<div class=\"message\"' + (preWrap ? ' style=\"white-space: pre-wrap\">' : '>') + message + '</div>';\n}\n\n/**\n * Additional options for Alert dialogs\n */\nexport interface AlertOptions extends CommonDialogOptions {\n    /** The title of OK button, or false to hide the OK button */\n    okButton?: string | boolean;\n    /** CSS class for OK button */\n    okButtonClass?: string;\n}\n\n/** \n * Displays an alert dialog \n * @param message The message to display\n * @param options Additional options. \n * @see AlertOptions \n * @example \n * alertDialog(\"An error occured!\"); }\n */\nexport function alertDialog(message: string, options?: AlertOptions) {\n\n    if (useBrowserDialogs()) {\n        window.alert(message);\n        return;\n    }\n\n    options ??= {};\n    let useBS = useBSModal(options);\n\n    if (options.htmlEncode == null)\n        options.htmlEncode = true;\n\n    if (options.okButton == null)\n        options.okButton = txt('OkButton');\n\n    if (options.title == null)\n        options.title = txt('AlertTitle')\n\n    if (options.buttons == null) {\n        options.buttons = [];\n        if (options.okButton == null || options.okButton) {\n            options.buttons.push({\n                text: typeof options.okButton == \"boolean\" ? txt('OkButton') : options.okButton,\n                cssClass: options.okButtonClass ?? (useBS ? 'btn-danger' : undefined),\n                result: 'ok'\n            });\n        }\n    }\n\n    var bodyHtml = getMessageBodyHtml(message, options);\n\n    if (useBS)\n        internalBSModal(options, bodyHtml, options.modalClass ?? \"s-AlertModal\");\n    else\n        internalUIDialog(options, bodyHtml, options.dialogClass ?? \"s-AlertDialog\");\n}\n\n/** @obsolete use alertDialog */\nexport const alert = alertDialog;\n\n/** Additional options for confirm dialog */\nexport interface ConfirmOptions extends CommonDialogOptions {\n    /** Title of the Yes button, or false to hide the Yes button. Default is value of local text: \"Dialogs.YesButton\" */\n    yesButton?: string | boolean;\n    /** CSS class for the Yes button. */\n    yesButtonClass?: string;\n    /** Title of the NO button, or false to hide the No button. Default is value of local text: \"Dialogs.NoButton\" */\n    noButton?: string | boolean;\n    /** Title of the CANCEL button, or false to hide the Cancel button. Default is value of local text: \"Dialogs.NoButton\" */\n    cancelButton?: string | boolean;\n    /** Event handler for cancel button click */\n    onCancel?: () => void;\n    /** Event handler for no button click */\n    onNo?: () => void;\n}\n\n/** \n * Display a confirmation dialog \n * @param message The message to display\n * @param onYes Callback for Yes button click \n * @param options Additional options. \n * @see ConfirmOptions \n * @example \n * confirmDialog(\"Are you sure you want to delete?\", () => { \n *     // do something when yes is clicked\n * }\n */\nexport function confirmDialog(message: string, onYes: () => void, options?: ConfirmOptions): void {\n    if (useBrowserDialogs()) {\n        if (window.confirm(message))\n            onYes && onYes();\n        return;\n    }\n\n    options ??= {};\n    let useBS = useBSModal(options);\n\n    if (options.htmlEncode == null)\n        options.htmlEncode = true;\n\n    if (options.yesButton == null)\n        options.yesButton = txt('YesButton');\n\n    if (options.noButton == null)\n        options.noButton = txt('NoButton');\n\n    if (typeof options.title === \"undefined\")\n        options.title = txt('ConfirmationTitle');\n\n    if (options.buttons == null) {\n        options.buttons = [];\n        if (options.yesButton == null || options.yesButton) {\n            options.buttons.push({\n                text: typeof options.yesButton == \"boolean\" ? txt('YesButton') : options.yesButton,\n                cssClass: options.yesButtonClass ?? (useBS ? 'btn-primary' : undefined),\n                result: 'yes',\n                click: onYes\n            });\n        }\n        if (options.noButton == null || options.noButton) {\n            options.buttons.push({\n                text: typeof options.noButton == \"boolean\" ? txt('NoButton') : options.noButton,\n                cssClass: useBS ? (isBS5Plus() ? 'btn-danger' : 'btn-default') : undefined,\n                result: 'no',\n                click: options.onNo\n            });\n        }\n        if (options.cancelButton) {\n            options.buttons.push({\n                text: typeof options.cancelButton == \"boolean\" ? txt('CancelButton') : options.cancelButton,\n                cssClass: useBS ? (isBS5Plus() ? 'btn-secondary' : 'btn-default') : undefined,\n                result: 'cancel',\n                click: options.onCancel\n            });\n        }\n    }\n\n    message = getMessageBodyHtml(message, options);\n    if (useBS)\n        internalBSModal(options, message, options.modalClass ?? \"s-ConfirmModal\");\n    else\n        internalUIDialog(options, message, options.dialogClass ?? \"s-ConfirmDialog\");\n}\n\n/** @obsolete use confirmDialog */\nexport const confirm = confirmDialog;\n\n/** Options for `iframeDialog` **/\nexport interface IFrameDialogOptions {\n    html?: string;\n}\n\n/** \n * Display a dialog that shows an HTML block in an IFRAME, which is usually returned from server callbacks\n * @param options The options\n */\nexport function iframeDialog(options: IFrameDialogOptions) {\n\n    if (useBrowserDialogs()) {\n        window.alert(options.html);\n        return;\n    }\n\n    var doc: Document;\n    function onOpen(div: HTMLElement) {\n        if (div) {\n            var iframe = div.appendChild(document.createElement('iframe'));\n            iframe.setAttribute(\"style\", \"border: none; width: 100%; height: 100%;\");\n            doc = iframe.contentDocument;\n            if (doc) {\n                doc.open();\n                doc.write(options.html);\n                doc.close();\n            }\n        }\n    }\n\n    if (useBSModal(options as any)) {\n        internalBSModal({\n            title: txt('AlertTitle'),\n            modalClass: 'modal-lg',\n            onOpen: function () { onOpen(this.querySelector(\".modal-body>div\")) }\n        }, '<div style=\"overflow: hidden\"></div>', 's-IFrameModal');\n        return;\n    }\n\n    var div = document.createElement('div');\n    div.style.overflow = \"hidden\";\n    document.body.appendChild(div);\n    let settings: IFrameDialogOptions = extend<any>({\n        autoOpen: true,\n        modal: true,\n        width: '60%',\n        height: '400',\n        title: txt('AlertTitle'),\n        open: function () {\n            onOpen(div);\n        },\n        close: function () {\n            ($(div) as any).dialog?.('destroy').html('')?.remove?.();\n        }\n    }, options);\n    ($(div) as any).dialog?.(settings);\n}\n\n/** \n * Display an information dialog \n * @param message The message to display\n * @param onOk Callback for OK button click \n * @param options Additional options. \n * @see ConfirmOptions \n * @example \n * informationDialog(\"Operation complete\", () => { \n *     // do something when OK is clicked\n * }\n */\nexport function informationDialog(message: string, onOk?: () => void, options?: ConfirmOptions) {\n    if (useBrowserDialogs()) {\n        window.alert(message);\n        onOk && onOk();\n        return;\n    }\n\n    confirmDialog(message, onOk, extend<ConfirmOptions>({\n        title: txt(\"InformationTitle\"),\n        dialogClass: \"s-InformationDialog\",\n        modalClass: \"s-InformationModal\",\n        yesButton: txt(\"OkButton\"),\n        yesButtonClass: 'btn-info',\n        noButton: false,\n    }, options));\n}\n\n/** @obsolete use informationDialog */\nexport const information = informationDialog;\n\n/** \n * Display a success dialog \n * @param message The message to display\n * @param onOk Callback for OK button click \n * @param options Additional options. \n * @see ConfirmOptions \n * @example \n * successDialog(\"Operation complete\", () => { \n *     // do something when OK is clicked\n * }\n */\nexport function successDialog(message: string, onOk?: () => void, options?: ConfirmOptions) {\n    if (useBrowserDialogs()) {\n        window.alert(message);\n        onOk && onOk();\n        return;\n    }\n\n    confirmDialog(message, onOk, extend<ConfirmOptions>({\n        title: txt(\"SuccessTitle\"),\n        dialogClass: \"s-SuccessDialog\",\n        modalClass: \"s-SuccessModal\",\n        yesButton: txt(\"OkButton\"),\n        yesButtonClass: 'btn-success',\n        noButton: false,\n    }, options));\n}\n\n/** @obsolete use successDialog */\nexport const success = successDialog;\n\n/** \n * Display a warning dialog \n * @param message The message to display\n * @param options Additional options. \n * @see AlertOptions \n * @example \n * warningDialog(\"Something is odd!\");\n */\nexport function warningDialog(message: string, options?: AlertOptions) {\n    alertDialog(message, extend<AlertOptions>({\n        title: txt(\"WarningTitle\"),\n        dialogClass: \"s-WarningDialog\",\n        modalClass: \"s-WarningModal\",\n        okButtonClass: 'btn-warning'\n    }, options));\n}\n\n/** @obsolete use warningDialog */\nexport const warning = warningDialog;\n\n/** \n * Closes a panel, triggering panelbeforeclose and panelclose events on the panel element.\n * If the panelbeforeclose prevents the default, the operation is cancelled.\n * @param element The panel element\n * @param e  The event triggering the close\n */\nexport function closePanel(element: JQuery | HTMLElement, e?: Event) {\n\n    var el = ($ && element instanceof $) ? (element as JQuery).get(0) : element as HTMLElement;\n    if (!el || !el.classList.contains(\"s-Panel\") || el.classList.contains(\"hidden\"))\n        return;\n\n    var event: any;\n    if ($) {\n        event = $.Event(e as any);\n        event.type = 'panelbeforeclose';\n        event.target = el\n        $(element).trigger(event);\n        if (event.isDefaultPrevented())\n            return;\n        event = $.Event(\"panelclosing\", { panel: el });\n        $(window).trigger(event);\n    }\n    else {\n        event = new Event(\"panelbeforeclose\", { cancelable: true });\n        el.dispatchEvent(event);\n        if (event.defaultPrevented) {\n            return;\n        }\n        event = new Event(\"panelclosing\");\n        event.panel = el;\n        window.dispatchEvent(event);\n    }\n\n    el.classList.add(\"hidden\");\n\n    var uniqueName = el.dataset.paneluniquename;\n    if (uniqueName?.length) {\n        document.querySelectorAll(`[data-panelhiddenby=\"${uniqueName}\"]`).forEach(e => {\n            e.classList.remove(\"panel-hidden\")\n            e.removeAttribute(\"data-panelhiddenby\");\n        });\n    }\n\n    if ($) {\n        $(window).triggerHandler('resize');\n        $('.require-layout:visible').triggerHandler('layout');\n        event = $.Event(e as any);\n        event.type = 'panelclose';\n        event.target = el;\n        $(el).trigger(event);\n        event = $.Event(\"panelclosed\", { panel: el });\n        $(window).trigger(event);\n    }\n    else {\n        window.dispatchEvent(new Event(\"resize\"));\n\n        var layoutEvent = new Event(\"layout\");\n        document.querySelectorAll(\".require-layout\").forEach((rl: HTMLElement) => {\n            if (rl.offsetWidth > 0 || rl.offsetHeight > 0)\n                rl.dispatchEvent(layoutEvent);\n        });\n\n        el.dispatchEvent(new Event(\"panelclose\"));\n        event = new Event(\"panelclosed\");\n        event.panel = el;\n        window.dispatchEvent(event);\n    }\n}\n\n/** \n * Opens a panel, triggering panelbeforeopen and panelopen events on the panel element,\n * and panelopening and panelopened events on the window.\n * If the panelbeforeopen prevents the default, the operation is cancelled.\n * @param element The panel element\n * @param uniqueName A unique name for the panel. If not specified, the panel id is used. If the panel has no id, a timestamp is used.\n * @param e The event triggering the open\n */\n export function openPanel(element: JQuery | HTMLElement, uniqueName?: string) {\n\n    var el = ($ && element instanceof $) ? (element as JQuery).get(0) : element as HTMLElement\n    if (!el)\n        return;\n    var event: any;\n\n    if ($) {\n        event = $.Event('panelopening', { panel: el });\n        $(window).trigger(event);\n    }\n    else {\n        event = new Event(\"panelopening\") as any;\n        event.panel = el;\n        window.dispatchEvent(event);\n    }\n\n    var container = document.querySelector('.panels-container') ?? document.querySelector('section.content') as HTMLElement;\n\n    el.dataset.paneluniquename = uniqueName ?? el.id ?? new Date().getTime().toString();\n    function hide(e: HTMLElement) {\n        if (e === el ||\n            e.tagName === \"LINK\" ||\n            e.tagName === \"SCRIPT\" ||\n            e.classList.contains('panel-hidden') ||\n            ((e.classList.contains(\"ui-dialog\") || e.classList.contains(\"ui-widget-overlay\")) && e.offsetWidth <= 0 && e.offsetHeight <= 0))\n            return;\n\n        e.classList.add(\"panel-hidden\");\n        e.setAttribute('data-panelhiddenby', el.dataset.paneluniquename);\n    }\n\n    if (container) {\n        var c = container.children;\n        const cl = c.length;\n        for (var i = 0; i < cl; i++) {\n            hide(c[i] as HTMLElement);\n        }\n\n        if (el.parentElement !== container)\n            container.appendChild(el);\n    }\n\n    document.querySelectorAll('.ui-dialog, .ui-widget-overlay, .modal.show, .modal.in').forEach(hide);\n\n    el.classList.remove(\"hidden\");\n    el.classList.remove(\"panel-hidden\");\n    el.classList.add(\"s-Panel\");\n\n    if ($) {\n        $(el).trigger('panelopen');\n        event = $.Event('panelopened', { panel: el });\n        $(window).trigger(event);\n    }\n    else {\n        el.dispatchEvent(new Event(\"panelopen\"));\n        event = new Event(\"panelopened\") as any;\n        event.panel = el;\n        window.dispatchEvent(event);\n    }\n}", "\uFEFFimport { alertDialog } from \"./dialogs\";\nimport { htmlEncode } from \"./html\";\nimport { notifyError } from \"./notify\";\nimport { ServiceError } from \"./servicetypes\";\n\nexport namespace ErrorHandling {\n\n    /**\n     * Shows a service error as an alert dialog. If the error\n     * is null, has no message or code, it shows \"??ERROR??\".\n     */\n    export function showServiceError(error: ServiceError) {\n        alertDialog(error?.Message ?? error?.Code ?? \"??ERROR??\");\n    }\n\n    /**\n     * Runtime error handler that shows a runtime error as a notification\n     * by default only in development mode (@see isDevelopmentMode)\n     * This function is assigned as window.onerror handler in \n     * ScriptInit.ts for Serenity applications so that developers\n     * can notice an error without having to check the browser console.\n     */\n    export function runtimeErrorHandler(message: string, filename?: string,\n        lineno?: number, colno?: number, error?: Error) {\n        try {\n            if (!ErrorHandling.isDevelopmentMode())\n                return;\n            var errorInfo = error?.stack ?? error?.toString();\n\n            message =\n                '<p></p><p>Message: ' + htmlEncode(message) +\n                '</p><p>File: ' + htmlEncode(filename) +\n                ', Line: ' + lineno + ', Column: ' + colno +\n                (errorInfo ? ('</p><p>' + htmlEncode(errorInfo)) : \"\") + '</p>';\n\n            window.setTimeout(function () {\n                try {\n                    notifyError(message, \"SCRIPT ERROR! See browser console (F12) for details.\", {\n                        escapeHtml: false,\n                        timeOut: 15000\n                    });\n                }\n                catch {\n                }\n            }, 0);\n        }\n        catch {\n        }\n    }\n\n    /** \n     * Determines if the current environment is development mode.\n     * The runtimeErrorHandler (window.onerror) shows error notifications only\n     * when this function returns true. The default implementation considers \n     * the environment as development mode if the host is localhost, 127.0.0.1, ::1,\n     * or a domain name that ends with .local/.localhost.\n     * @returns true if the current environment is development mode, false otherwise. \n     */\n    export function isDevelopmentMode() {\n        var hostname = (window.location.hostname ?? \"\").toLowerCase();\n        return (hostname === \"localhost\" ||\n            hostname === \"127.0.0.1\" ||\n            hostname === \"[::1]\" ||\n            hostname.endsWith(\".local\") ||\n            hostname.endsWith(\".localhost\"));\n    }\n}", "\uFEFFimport $ from \"@optionaldeps/jquery\";\n\n/** Options for the BlockUI plugin. */\nexport interface JQBlockUIOptions {\n    useTimeout?: boolean;\n}\n\nlet blockUICount: number = 0;\n\nfunction blockUIWithCheck(opt: JQBlockUIOptions) {\n    if (blockUICount > 0) {\n        blockUICount++;\n        return;\n    }\n\n    if (($ as any)?.blockUI) {\n        ($ as any).blockUI(opt);\n    }\n    else if (typeof document !== \"undefined\") {\n        var div = document.createElement(\"div\");\n        div.className = \"blockUI blockOverlay\";\n        div.setAttribute(\"style\", \"z-index: 2000; border: none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px; opacity: 0; cursor: wait; position: fixed;\");\n        document.body.appendChild(div);\n    }\n    blockUICount++;\n}\n\n/**\n * Uses jQuery BlockUI plugin to block access to whole page (default) or \n * a part of it, by using a transparent overlay covering the whole area.\n * @param options Parameters for the BlockUI plugin\n * @remarks If options are not specified, this function blocks \n * whole page with a transparent overlay. Default z-order of the overlay\n * div is 2000, so a higher z-order shouldn't be used in page.\n */\nexport function blockUI(options: JQBlockUIOptions) {\n    options = Object.assign(<any>{\n        baseZ: 2000,\n        message: '',\n        overlayCSS: {\n            opacity: '0.0',\n            zIndex: 2000,\n            cursor: 'wait'\n        }, fadeOut: 0\n    }, options);\n\n    if (options.useTimeout) {\n        window.setTimeout(function () {\n            blockUIWithCheck(options);\n        }, 0);\n    }\n    else {\n        blockUIWithCheck(options);\n    }\n}\n\n/**\n * Unblocks the page. \n */\nexport function blockUndo() {\n    if (blockUICount > 1) {\n        blockUICount--;\n        return;\n    }\n\n    blockUICount--;\n    if (($ as any)?.unblockUI)\n        ($ as any).unblockUI({ fadeOut: 0 });\n    else if (typeof document !== \"undefined\")\n        document.body.querySelector(':scope > .blockUI.blockOverlay')?.remove();\n}", "\uFEFFimport { extend } from \"./system\";\nimport { Config } from \"./config\"\nimport { ErrorHandling } from \"./errorhandling\";\nimport { alertDialog, iframeDialog } from \"./dialogs\";\nimport { blockUI, blockUndo } from \"./blockui\";\nimport { ListRequest, ServiceOptions, ServiceResponse } from \"./servicetypes\";\n\nexport function getCookie(name: string) {\n    if (($ as any).cookie)\n        return ($ as any).cookie(name);\n\n    name += '=';\n    for (var ca = document.cookie.split(/;\\s*/), i = ca.length - 1; i >= 0; i--)\n        if (!ca[i].indexOf(name))\n            return ca[i].replace(name, '');\n}\n\ntypeof $ != 'undefined' && $.ajaxSetup && $.ajaxSetup({\n    beforeSend: function (xhr, opt) {\n        if (!opt || !opt.crossDomain) {\n            var token = getCookie('CSRF-TOKEN');\n            if (token)\n                xhr.setRequestHeader('X-CSRF-TOKEN', token);\n        }\n    }\n});\n\nexport function serviceCall<TResponse extends ServiceResponse>(options: ServiceOptions<TResponse>) {\n    let handleError = function (response: any) {\n        if (Config.notLoggedInHandler != null &&\n            response &&\n            response.Error &&\n            response.Error.Code == 'NotLoggedIn' &&\n            Config.notLoggedInHandler(options, response)) {\n            return;\n        }\n\n        if (options.onError != null) {\n            options.onError(response);\n            return;\n        }\n\n        ErrorHandling.showServiceError(response.Error);\n    };\n\n    var url = options.service;\n    if (url && url.length && url.charAt(0) != '~' && url.charAt(0) != '/' && url.indexOf('://') < 0)\n        url = resolveUrl(\"~/Services/\") + url;\n\n    options = extend<ServiceOptions<TResponse>>({\n        dataType: 'json',\n        contentType: 'application/json',\n        type: 'POST',\n        cache: false,\n        blockUI: true,\n        url: url,\n        data: JSON.stringify(options.request),\n        success: function (data: any, textStatus: string, request: any) {\n            try {\n                if (!data.Error && options.onSuccess) {\n                    options.onSuccess(data);\n                }\n            }\n            finally {\n                if (options.blockUI) {\n                    blockUndo();\n                }\n                options.onCleanup && options.onCleanup();\n            }\n        },\n        error: function (xhr: any, status: any, ev: any) {\n            try {\n                if (xhr.status === 403) {\n                    var l: any = null;\n                    try {\n                        l = xhr.getResponseHeader('Location');\n                    }\n                    catch ($t1) {\n                        l = null;\n                    }\n                    if (l) {\n                        window.top.location.href = l;\n                        return;\n                    }\n                }\n                if ((xhr.getResponseHeader('content-type') || '')\n                    .toLowerCase().indexOf('application/json') >= 0) {\n                    var json = $.parseJSON(xhr.responseText);\n                    if (json && json.Error) {\n                        handleError(json);\n                        return;\n                    }\n                }\n                var html = xhr.responseText;\n                if (!html) {\n                    if (!xhr.status) {\n                        if (xhr.statusText != \"abort\")\n                            alertDialog(\"An unknown AJAX connection error occurred! Check browser console for details.\");\n                    }\n                    else if (xhr.status == 500)\n                        alertDialog(\"HTTP 500: Connection refused! Check browser console for details.\");\n                    else\n                        alertDialog(\"HTTP \" + xhr.status + ' error! Check browser console for details.');\n                }\n                else\n                    iframeDialog({ html: html });\n            }\n            finally {\n                if (options.blockUI) {\n                    blockUndo();\n                }\n                options.onCleanup && options.onCleanup();\n            }\n        }\n    }, options);\n\n    if (options.blockUI) {\n        blockUI(null);\n    }\n\n    return $.ajax(options);\n}\n\nexport function serviceRequest<TResponse extends ServiceResponse>(service: string, request?: any,\n    onSuccess?: (response: TResponse) => void, options?: ServiceOptions<TResponse>) {\n    return serviceCall(extend<ServiceOptions<TResponse>>({\n        service: service,\n        request: request,\n        onSuccess: onSuccess\n    }, options));\n}\n\nexport function setEquality(request: ListRequest, field: string, value: any) {\n    if (request.EqualityFilter == null) {\n        request.EqualityFilter = {};\n    }\n    request.EqualityFilter[field] = value;\n}\n\nexport interface PostToServiceOptions {\n    url?: string;\n    service?: string;\n    target?: string;\n    request: any;\n}\n\nexport interface PostToUrlOptions {\n    url?: string;\n    target?: string;\n    params: any;\n}\n\nexport function parseQueryString(s?: string): {} {\n    let qs: string;\n    if (s === undefined)\n        qs = location.search.substring(1, location.search.length);\n    else\n        qs = s || '';\n    let result: Record<string, string> = {};\n    let parts = qs.split('&');\n    for (let i = 0; i < parts.length; i++) {\n        let pair = parts[i].split('=');\n        let name = decodeURIComponent(pair[0]);\n        result[name] = (pair.length >= 2 ? decodeURIComponent(pair[1]) : name);\n    }\n    return result;\n}\n\nexport function postToService(options: PostToServiceOptions) {\n    let form = $('<form/>')\n        .attr('method', 'POST')\n        .attr('action', options.url ? (resolveUrl(options.url)) : resolveUrl('~/Services/' + options.service))\n        .appendTo(document.body);\n    if (options.target)\n        form.attr('target', options.target);\n    let div = $('<div/>').appendTo(form);\n    $('<input/>').attr('type', 'hidden').attr('name', 'request')\n        .val($['toJSON'](options.request))\n        .appendTo(div);\n    var csrfToken = getCookie('CSRF-TOKEN');\n    if (csrfToken) {\n        $('<input/>').attr('type', 'hidden').attr('name', '__RequestVerificationToken')\n            .appendTo(div).val(csrfToken);\n    }\n    $('<input/>').attr('type', 'submit')\n        .appendTo(div);\n    form.submit();\n    window.setTimeout(function () { form.remove(); }, 0);\n}\n\nexport function postToUrl(options: PostToUrlOptions) {\n    let form = $('<form/>')\n        .attr('method', 'POST')\n        .attr('action', resolveUrl(options.url))\n        .appendTo(document.body);\n    if (options.target)\n        form.attr('target', options.target);\n    let div = $('<div/>').appendTo(form);\n    if (options.params != null) {\n        for (let k in options.params) {\n            $('<input/>').attr('type', 'hidden').attr('name', k)\n                .val(options.params[k])\n                .appendTo(div);\n        }\n    }\n    var csrfToken = getCookie('CSRF-TOKEN');\n    if (csrfToken) {\n        $('<input/>').attr('type', 'hidden').attr('name', '__RequestVerificationToken')\n            .appendTo(div).val(csrfToken);\n    }\n    $('<input/>').attr('type', 'submit')\n        .appendTo(div);\n    form.submit();\n    window.setTimeout(function () { form.remove(); }, 0);\n}\n\nexport function resolveUrl(url: string) {\n    if (url && url.substr(0, 2) === '~/') {\n        return Config.applicationPath + url.substr(2);\n    }\n\n    return url;\n}", "\uFEFFimport { padLeft, startsWith, trim, trimToNull, zeroPad } from \"./strings\";\n\n/**\n * Interface for number formatting, similar to .NET's NumberFormatInfo\n */\nexport interface NumberFormat {\n    /** Decimal separator */\n    decimalSeparator: string;\n    /** Group separator */\n    groupSeparator?: string;\n    /** Number of digits after decimal separator */\n    decimalDigits?: number;\n    /** Positive sign */\n    positiveSign?: string;\n    /** Negative sign */\n    negativeSign?: string;\n    /** Zero symbol */\n    nanSymbol?: string;\n    /** Percentage symbol */\n    percentSymbol?: string;\n    /** Currency symbol */\n    currencySymbol?: string;\n}\n\n/** Interface for date formatting, similar to .NET's DateFormatInfo */\nexport interface DateFormat {\n    /** Date separator */\n    dateSeparator?: string;\n    /** Default date format string */\n    dateFormat?: string;\n    /** Date order, like dmy, or ymd */\n    dateOrder?: string;\n    /** Default date time format string */\n    dateTimeFormat?: string;\n    /** AM designator */\n    amDesignator?: string;\n    /** PM designator */\n    pmDesignator?: string;\n    /** Time separator */\n    timeSeparator?: string;\n    /** First day of week, 0 = Sunday, 1 = Monday */\n    firstDayOfWeek?: number;\n    /** Array of day names */\n    dayNames?: string[];\n    /** Array of short day names */\n    shortDayNames?: string[];\n    /** Array of two letter day names */\n    minimizedDayNames?: string[];\n    /** Array of month names */\n    monthNames?: string[];\n    /** Array of short month names */\n    shortMonthNames?: string[];\n}\n\n/** Interface for a locale, similar to .NET's CultureInfo */\nexport interface Locale extends NumberFormat, DateFormat {\n    /** Locale string comparison function, similar to .NET's StringComparer */\n    stringCompare?: (a: string, b: string) => number;\n    /** Locale string to upper case function */\n    toUpper?: (a: string) => string;\n}\n\n/** Invariant locale (e.g. CultureInfo.InvariantCulture) */\nexport let Invariant: Locale = {\n    decimalSeparator: '.',\n    groupSeparator: ',',\n    decimalDigits: 2,\n    negativeSign: '-',\n    positiveSign: '+',\n    percentSymbol: '%',\n    currencySymbol: '$',\n    dateSeparator: '/',\n    dateOrder: 'mdy',\n    dateFormat: 'MM/dd/yyyy',\n    dateTimeFormat: 'MM/dd/yyyy HH:mm:ss',\n    amDesignator: 'AM',\n    pmDesignator: 'PM',\n    timeSeparator: ':',\n    firstDayOfWeek: 0,\n    dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n    shortDayNames: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    minimizedDayNames: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n    monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December', ''],\n    shortMonthNames: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', ''],\n    stringCompare: (a, b) => a < b ? -1 : (a > b ? 1 : 0)\n}\n\n/** \n * Factory for a function that compares two strings, based on a character order \n * passed in the `order` argument.\n */\nexport function compareStringFactory(order: string): ((a: string, b: string) => number) {\n\n    var o: { [key: string]: number } = {};\n    for (let z = 0; z < order.length; z++) {\n        o[order.charAt(z)] = z + 1;\n    }\n\n    return function (a: string, b: string) {\n        a = a || \"\";\n        b = b || \"\";\n        if (a == b)\n            return 0;\n\n        let c: number;\n        for (let i = 0, _len = Math.min(a.length, b.length); i < _len; i++) {\n            let x = a.charAt(i), y = b.charAt(i);\n            if (x === y) {\n                continue;\n            }\n            let ix = o[x], iy = o[y];\n            if (ix != null && iy != null)\n                return ix < iy ? -1 : 1;\n            c = x.localeCompare(y);\n            if (c == 0)\n                continue;\n            return c;\n        }\n        if (c != null)\n            return c;\n        return a.localeCompare(b);\n    }\n}\n\n/**\n * Current culture, e.g. CultureInfo.CurrentCulture. This is overridden by\n * settings passed from a `<script>` element in the page with id `ScriptCulture`\n * containing a JSON object if available. This element is generally created in \n * the _LayoutHead.cshtml file for Serenity applications, so that the culture\n * settings determined server, can be passed to the client.\n */\nexport let Culture: Locale = {\n    decimalSeparator: '.',\n    groupSeparator: ',',\n    dateSeparator: '/',\n    dateOrder: 'dmy',\n    dateFormat: 'dd/MM/yyyy',\n    dateTimeFormat: 'dd/MM/yyyy HH:mm:ss',\n    stringCompare: compareStringFactory(\"AaBbCc\u00C7\u00E7FfGg\u011E\u011FHhI\u0131\u0130iJjKkLlMmNnOo\u00D6\u00F6PpRrSs\u015E\u015FTtUu\u00DC\u00FCVvYyZz\")\n};\n\n(function () {\n    let k: string;\n    for (k in Invariant)\n        if ((Culture as any)[k] === undefined && Object.prototype.hasOwnProperty.call(Invariant, k))\n            (Culture as any)[k] = (Invariant as any)[k];\n\n    if (typeof document !== \"undefined\" && (k = trimToNull(document.querySelector('script#ScriptCulture')?.textContent)) != null) {\n        var sc = JSON.parse(k);\n        if (sc.DecimalSeparator != null)\n            Culture.decimalSeparator = sc.DecimalSeparator;\n        if (sc.GroupSeparator != null && sc.GroupSeparator != Culture.decimalSeparator)\n            Culture.groupSeparator = sc.GroupSeparator;\n        else if (Culture.groupSeparator == Culture.decimalSeparator)\n            Culture.groupSeparator = Culture.decimalSeparator == '.' ? ',' : '.';\n\n        delete sc.GroupSeparator;\n        delete sc.DecimalSeparator;\n        for (k in sc) {\n            if ((Culture as any)[k] === undefined && Object.prototype.hasOwnProperty.call(sc, k))\n                (Culture as any)[k.charAt(0).toLowerCase() + k.substr(1)] = sc[k];\n        }\n    }\n})();\n\n/**\n * A string to lowercase function that handles special Turkish\n * characters like '\u0131'. Left in for compatibility reasons.\n */\nexport function turkishLocaleToLower(a: string): string {\n    if (!a)\n        return a;\n    return a.replace(/i/g, '\u0130').replace(/\u0131/g, 'I').toLowerCase();\n}\n\n/**\n * A string to uppercase function that handles special Turkish\n * characters like '\u0131'. Left in for compatibility reasons.\n */\nexport function turkishLocaleToUpper(a: string): string {\n    if (!a)\n        return a;\n    return a.replace(/i/g, '\u0130').replace(/\u0131/g, 'I').toUpperCase();\n}\n\n/**\n * This is an alias for Culture.stringCompare, left in for compatibility reasons.\n */\nexport let turkishLocaleCompare = Culture.stringCompare;\n\nfunction insertGroupSeperator(num: string, dec: string, grp: string, neg: string) {\n    var decPart = null;\n    var decIndex = num.indexOf(dec);\n    if (decIndex > 0) {\n        decPart = num.substring(decIndex);\n        num = num.substr(0, decIndex);\n    }\n\n    var negative = startsWith(num, neg);\n    if (negative) {\n        num = num.substring(1);\n    }\n\n    var groupSize = 3;\n    if (num.length < groupSize) {\n        return (negative ? neg : '') + (decPart ? num + decPart : num);\n    }\n\n    var index = num.length;\n    var s = '';\n    var done = false;\n    while (!done) {\n        var length = groupSize;\n        var startIndex = index - length;\n        if (startIndex < 0) {\n            groupSize += startIndex;\n            length += startIndex;\n            startIndex = 0;\n            done = true;\n        }\n\n        if (!length)\n            break;\n\n        var part = num.substring(startIndex, startIndex + length);\n        if (s.length)\n            s = part + grp + s;\n        else\n            s = part;\n        index -= length;\n    }\n\n    if (negative)\n        s = '-' + s;\n    return decPart ? s + decPart : s;\n}\n\nvar _formatRE = /\\{\\{|\\}\\}|\\{[^\\}\\{]+\\}/g;\n\nfunction _formatString(format: string, l: Locale, values: IArguments, from: number) {\n\n    return format.replace(_formatRE,\n        function (m) {\n            if (m === '{{' || m === '}}')\n                return m.charAt(0);\n            var index = parseInt(m.substr(1), 10);\n            var value = values[index + from];\n            if (value == null) {\n                return '';\n            }\n            var formatSpec = null;\n            var formatIndex = m.indexOf(':');\n            if (formatIndex > 0) {\n                formatSpec = m.substring(formatIndex + 1, m.length - 1);\n            }\n            return _formatObject(value, formatSpec, l);\n        });\n};\n\n\n/**\n * Formats a string with parameters similar to .NET's String.Format function\n * using current `Culture` locale settings.\n */\nexport function format(format: string, ...prm: any[]): string {\n    return _formatString(format, Culture, arguments, 1);\n}\n\n/**\n * Formats a string with parameters similar to .NET's String.Format function\n * using the locale passed as the first argument.\n */\nexport function localeFormat(l: Locale, format: string, ...prm: any[]): string {\n    return _formatString(format, l, arguments, 2);\n}\n\nfunction _formatObject(obj: any, format: string, fmt?: Locale): string {\n    if (typeof (obj) === 'number')\n        return formatNumber(obj, format, fmt);\n    else if (Object.prototype.toString.call(obj) === '[object Date]')\n        return formatDate(obj, format, fmt);\n    else if (obj.format)\n        return obj.format(format, fmt ?? Culture);\n    return String(obj);\n};\n\n/** \n * Rounds a number to specified digits or an integer number if digits are not specified.\n * @param n the number to round \n * @param d the number of digits to round to. default is zero.\n * @param rounding whether to use banker's rounding\n * @returns the rounded number \n */\nexport let round = (n: number, d?: number, rounding?: boolean) => {\n    var m = Math.pow(10, d || 0);\n    n *= m;\n    var sign = ((n > 0) as any) | -(n < 0);\n    if (n % 1 === 0.5 * sign) {\n        var f = Math.floor(n);\n        return (f + (rounding ? (sign > 0) as any : (f % 2 * sign))) / m;\n    }\n\n    return Math.round(n) / m;\n};\n\n/**\n * Truncates a number to an integer number.\n */\nexport let trunc = (n: number): number => n != null ? (n > 0 ? Math.floor(n) : Math.ceil(n)) : null;\n\n/**\n * Formats a number using the current `Culture` locale (or the passed locale) settings.\n * It supports format specifiers similar to .NET numeric formatting strings.\n * @param num the number to format\n * @param format the format specifier. default is 'g'.\n * See .NET numeric formatting strings documentation for more information.\n */\nexport function formatNumber(num: number, format?: string, decOrLoc?: string | NumberFormat, grp?: string): string {\n\n    if (num == null)\n        return \"\";\n\n    var fmt: NumberFormat = typeof decOrLoc !== \"string\" ? (decOrLoc ?? Culture) : {\n        decimalSeparator: decOrLoc,\n        groupSeparator: grp ?? (decOrLoc == \",\" ? \".\" : \",\")\n    }\n\n    if (isNaN(num)) {\n        return fmt.nanSymbol ?? Culture.nanSymbol;\n    }\n\n    if (format === 'i') {\n        return num.toString();\n    }\n\n    if (format == null || format == '') {\n        format = 'g';\n    }\n\n    var dec = fmt.decimalSeparator ?? Culture.decimalSeparator;\n    grp = grp ?? fmt.groupSeparator ?? Culture.groupSeparator;\n    var neg = fmt.negativeSign ?? Culture.negativeSign;\n\n    var s = '';\n    var precision = -1;\n\n    if (format.length > 1) {\n        precision = parseInt(format.substring(1), 10);\n    }\n\n    var fs = format.charAt(0);\n    switch (fs) {\n        case 'g':\n        case 'G':\n            if (precision != -1)\n                s = num.toFixed(precision);\n            else\n                s = num.toString();\n            if (dec != '.')\n                s = s.replace('.', dec);\n            break;\n        case 'd':\n        case 'D':\n            s = parseInt(Math.abs(num) as any).toString();\n            if (precision != -1)\n                s = padLeft(s, precision, '0');\n            if (num < 0)\n                s = neg + s;\n            break;\n        case 'x': case 'X':\n            s = parseInt(Math.abs(num) as any).toString(16);\n            if (fs == 'X')\n                s = s.toUpperCase();\n            if (precision != -1)\n                s = padLeft(s, precision, '0');\n            break;\n        case 'e':\n        case 'E':\n            if (precision == -1)\n                s = num.toExponential(6);\n            else\n                s = num.toExponential(precision);\n            if (fs == 'E')\n                s = s.toUpperCase();\n            break;\n        case 'f':\n        case 'F':\n        case 'n':\n        case 'N':\n            if (precision == -1) {\n                precision = fmt.decimalDigits ?? Culture.decimalDigits;\n            }\n            s = num.toFixed(precision).toString();\n            if (precision && (dec != '.')) {\n                var index = s.indexOf('.');\n                s = s.substring(0, index) + dec + s.substring(index + 1);\n            }\n            if ((fs == 'n') || (fs == 'N')) {\n                s = insertGroupSeperator(s, dec, grp, neg);\n            }\n            break;\n        case 'c': case 'C':\n        case 'p': case 'P':\n            if (precision == -1) {\n                precision = fmt.decimalDigits ?? Culture.decimalDigits;\n            }\n            var symbol: string;\n            if (fs === 'p' || fs == 'P') {\n                num *= 100;\n                symbol = fmt.percentSymbol ?? Culture.percentSymbol;\n            }\n            else {\n                symbol = fmt.currencySymbol ?? Culture.currencySymbol;\n            }\n            s = num.toFixed(precision).toString();\n            if (precision && (dec != '.')) {\n                var index = s.indexOf('.');\n                s = s.substring(0, index) + dec + s.substring(index + 1);\n            }\n            s = insertGroupSeperator(s, dec, grp, neg) + symbol;\n            break;\n\n        default:\n            var prefix = '';\n            var mid = '';\n            var suffix = '';\n            var endPrefix = false;\n            var inQuote = false;\n            for (var i = 0; i < format.length; i++) {\n                var c = format.charAt(i);\n                if (c == \"'\") {\n                    inQuote = !inQuote;\n                    continue;\n                }\n                else if (!inQuote) {\n                    if (c == '\\\\') {\n                        var c = (format.charAt(i + 1) || '');\n                        i++;\n                    }\n                    else if (c == '#' || c == ',' || c == '.' || c == '0') {\n                        endPrefix = true;\n                        mid += c;\n                        continue;\n                    }\n                }\n                endPrefix ? (suffix += c) : (prefix += c);\n            }\n\n            format = mid;\n\n            let r = \"\";\n            if (format.indexOf(\".\") > -1) {\n                let dp = dec;\n                let df = format.substring(format.lastIndexOf(\".\") + 1);\n                num = roundNumber(num, df.length);\n                let dv = num % 1;\n                let ds = new String(dv.toFixed(df.length));\n                ds = ds.substring(ds.lastIndexOf(\".\") + 1);\n                for (let i = 0; i < df.length; i++) {\n                    if (df.charAt(i) == '#' && ds.charAt(i) != '0') {\n                        dp += ds.charAt(i);\n                        continue;\n                    }\n                    else if (df.charAt(i) == '#' && ds.charAt(i) == '0') {\n                        let notParsed = ds.substring(i);\n                        if (notParsed.match('[1-9]')) {\n                            dp += ds.charAt(i);\n                            continue;\n                        }\n                        else\n                            break;\n                    }\n                    else if (df.charAt(i) == \"0\")\n                        dp += ds.charAt(i);\n                    else\n                        dp += df.charAt(i);\n                }\n                r += dp;\n            }\n            else\n                num = Math.round(num);\n\n            let ones = Math.floor(num);\n            if (num < 0)\n                ones = Math.ceil(num);\n            let of = \"\";\n            if (format.indexOf(\".\") == -1)\n                of = format;\n            else\n                of = format.substring(0, format.indexOf(\".\"));\n\n            let op = \"\";\n            if (!(ones == 0 && of.substr(of.length - 1) == '#')) {\n                // find how many digits are in the group\n                let oneText = new String(Math.abs(ones));\n                let gl = 9999;\n                if (of.lastIndexOf(\",\") != -1)\n                    gl = of.length - of.lastIndexOf(\",\") - 1;\n                let gc = 0;\n                for (let i = oneText.length - 1; i > -1; i--) {\n                    op = oneText.charAt(i) + op;\n                    gc++;\n                    if (gc == gl && i != 0) {\n                        op = grp + op;\n                        gc = 0;\n                    }\n                }\n\n                // account for any pre-data padding\n                if (of.length > op.length) {\n                    let padStart = of.indexOf('0');\n                    if (padStart != -1) {\n                        let padLen = of.length - padStart;\n                        // pad to left with 0's or group char\n                        let pos = of.length - op.length - 1;\n                        while (op.length < padLen) {\n                            let pc = of.charAt(pos);\n                            // replace with real group char if needed\n                            if (pc == ',')\n                                pc = grp;\n                            op = pc + op;\n                            pos--;\n                        }\n                    }\n                }\n            }\n\n            if (!op && of.indexOf('0', of.length - 1) !== -1)\n                op = '0';\n\n            r = op + r;\n            if (num < 0)\n                r = neg + r;\n\n            if (r.lastIndexOf(dec) == r.length - 1) {\n                r = r.substring(0, r.length - 1);\n            }\n\n            return prefix + r + suffix;\n    }\n\n    return s;\n}\n\n/**\n * Converts a string to an integer. The difference between parseInt and parseInteger \n * is that parseInteger will return null if the string is empty or null, whereas\n * parseInt will return NaN and parseInteger will use the current culture's group\n * and decimal separators.\n * @param s the string to parse\n */\nexport function parseInteger(s: string): number {\n    if (s == null)\n        return null;\n    s = trim(s.toString());\n    if (!s.length)\n        return null;\n    let ts = Culture.groupSeparator;\n    if (s && s.length && s.indexOf(ts) > 0) {\n        s = s.replace(new RegExp(\"(\\\\b\\\\d{1,3})\\\\\" + ts + \"(?=\\\\d{3}(\\\\D|$))\", \"g\"), '$1');\n    }\n    if (!(/^[-\\+]?\\d+$/.test(s)))\n        return NaN;\n    return parseInt(s, 10);\n}\n\n/**\n * Converts a string to a decimal. The difference between parseFloat and parseDecimal\n * is that parseDecimal will return null if the string is empty or null, whereas\n * parseFloat will return NaN and parseDecimal will use the current culture's group\n * and decimal separators.\n * @param s the string to parse\n */\nexport function parseDecimal(s: string): number {\n    if (s == null)\n        return null;\n\n    s = trim(s.toString());\n    if (s.length == 0)\n        return null;\n\n    let ts = Culture.groupSeparator;\n\n    if (s && s.length && s.indexOf(ts) > 0) {\n        s = s.replace(new RegExp(\"(\\\\b\\\\d{1,3})\\\\\" + ts + \"(?=\\\\d{3}(\\\\D|$))\", \"g\"), '$1');\n    }\n\n    if (!(new RegExp(\"^\\\\s*([-\\\\+])?(\\\\d*)\\\\\" + Culture.decimalSeparator + \"?(\\\\d*)\\\\s*$\").test(s)))\n        return NaN;\n\n    return parseFloat(s.toString().replace(Culture.decimalSeparator, '.'));\n}\n\n/** \n * Rounds a number to a specified number of decimal places.\n * @param n the number to round\n * @param dec the number of decimal places to round to\n * @returns the rounded number\n */\nfunction roundNumber(n: number, dec?: number): number {\n    let power = Math.pow(10, dec || 0);\n    let value = (Math.round(n * power) / power).toString();\n    // ensure the decimal places are there\n    if (dec > 0) {\n        let dp = value.indexOf(\".\");\n        if (dp == -1) {\n            value += '.';\n            dp = 0;\n        }\n        else {\n            dp = value.length - (dp + 1);\n        }\n        while (dp < dec) {\n            value += '0';\n            dp++;\n        }\n    }\n    return parseFloat(value);\n}\n\n/**\n * Converts a string to an ID. If the string is a number, it is returned as-is.\n * If the string is empty, null or whitespace, null is returned.\n * Otherwise, it is converted to a number if possible. If the string is not a\n * valid number or longer than 14 digits, the trimmed string is returned as-is.\n * @param id the string to convert to an ID\n */\nexport function toId(id: any): any {\n    if (id == null)\n        return null;\n    if (typeof id == \"number\")\n        return id;\n    if (typeof id == \"string\")\n        id = trim(id);\n    if (!id.length)\n        return null;\n    if (id.length >= 15 || !(/^-?\\d+$/.test(id)))\n        return id;\n    return parseInt(id, 10);\n}\n\nvar _dateFormatRE = /'.*?[^\\\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|\\//g;\n\n/** \n * Formats a date using the specified format string and optional culture.\n * Supports .NET style format strings including custom formats.\n * See .NET documentation for supported formats.\n * @param d the date to format. If null, it returns empty string.\n * @param format the format string to use. If null, it uses the current culture's default format.\n * 'G' uses the culture's datetime format.\n * 'g' uses the culture's datetime format with secs removed. \n * 'd' uses the culture's date format.\n * 't' uses the culture's time format.\n * 'u' uses the sortable ISO format with UTC time.\n * 'U' uses the culture's date format with UTC time.\n * @param locale the locale to use\n * @returns the formatted date\n * @example\n * // returns \"2019-01-01\"\n * formatDate(new Date(2019, 0, 1), \"yyyy-MM-dd\");\n * @example\n * // returns \"2019-01-01 12:00:00\"\n * formatDate(new Date(2019, 0, 1, 12), \"yyyy-MM-dd HH:mm:ss\");\n * @example\n * // returns \"2019-01-01 12:00:00.000\"\n * formatDate(new Date(2019, 0, 1, 12), \"yyyy-MM-dd HH:mm:ss.fff\");\n * @example\n * // returns \"2019-01-01 12:00:00.000 AM\"\n * formatDate(new Date(2019, 0, 1, 12), \"yyyy-MM-dd HH:mm:ss.fff tt\");\n */\nexport function formatDate(d: Date | string, format?: string, locale?: Locale) {\n    if (!d)\n        return '';\n\n    let date: Date;\n    if (typeof d == \"string\") {\n        date = parseDate(d, locale?.dateOrder);\n        if (!date)\n            return '';\n\n        if (isNaN(date.valueOf()))\n            return d;\n    }\n    else\n        date = d;\n\n    if (format == 'i')\n        return date.toString();\n    if (format == 'id')\n        return date.toDateString();\n    if (format == 'it')\n        return date.toTimeString();\n\n    if (locale == null)\n        locale = Culture;\n\n    if (format == null || format == \"d\")\n        format = locale.dateFormat ?? Culture.dateFormat;\n    else if (format.length == 1) {\n        switch (format) {\n            case \"g\": format = (locale.dateTimeFormat ?? Culture.dateTimeFormat).replace(\":ss\", \"\"); break;\n            case \"G\": format = (locale.dateTimeFormat ?? Culture.dateTimeFormat); break;\n            case \"s\": format = \"yyyy-MM-ddTHH:mm:ss\"; break;\n            case 't': format = (locale.dateTimeFormat && locale.dateFormat) ? locale.dateTimeFormat.replace(locale.dateFormat + \" \", \"\") : \"HH:mm\"; break;\n            case 'u':\n            case 'U':\n                format = format == 'u' ? 'yyyy-MM-ddTHH:mm:ss.fffZ' : locale.dateTimeFormat ?? Culture.dateTimeFormat;\n                date = new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(),\n                    date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds());\n                break;\n        }\n    }\n\n    if (format.charAt(0) == '%') {\n        format = format.substr(1);\n    }\n\n    var re = _dateFormatRE;\n    var sb = [];\n\n    re.lastIndex = 0;\n    while (true) {\n        var index = re.lastIndex;\n        var match = re.exec(format);\n\n        sb.push(format.slice(index, match ? match.index : format.length));\n        if (!match) {\n            break;\n        }\n\n        var fs = match[0];\n        var part: any = fs;\n        switch (fs) {\n            case '/':\n                part = locale.dateSeparator ?? Culture.dateSeparator;\n                break;\n            case 'dddd':\n                part = (locale.dayNames ?? Culture.dayNames)[date.getDay()];\n                break;\n            case 'ddd':\n                part = (locale.shortDayNames ?? Culture.shortDayNames)[date.getDay()];\n                break;\n            case 'dd':\n                part = padLeft(date.getDate().toString(), 2, '0');\n                break;\n            case 'd':\n                part = date.getDate();\n                break;\n            case 'MMMM':\n                part = (locale.monthNames ?? Culture.monthNames)[date.getMonth()];\n                break;\n            case 'MMM':\n                part = (locale.shortMonthNames ?? Culture.shortMonthNames)[date.getMonth()];\n                break;\n            case 'MM':\n                part = padLeft(date.getMonth() + 1, 2, '0');\n                break;\n            case 'M':\n                part = (date.getMonth() + 1);\n                break;\n            case 'yyyy':\n                part = padLeft(date.getFullYear(), 4, '0');\n                break;\n            case 'yy':\n                part = padLeft(date.getFullYear() % 100, 2, '0');\n                break;\n            case 'y':\n                part = date.getFullYear() % 100;\n                break;\n            case 'h': case 'hh':\n                part = date.getHours() % 12;\n                if (!part) {\n                    part = '12';\n                }\n                else if (fs == 'hh') {\n                    part = padLeft(part, 2, '0');\n                }\n                break;\n            case 'HH':\n                part = padLeft(date.getHours(), 2, '0');\n                break;\n            case 'H':\n                part = date.getHours();\n                break;\n            case 'mm':\n                part = padLeft(date.getMinutes(), 2, '0');\n                break;\n            case 'm':\n                part = date.getMinutes();\n                break;\n            case 'ss':\n                part = padLeft(date.getSeconds().toString(), 2, '0');\n                break;\n            case 's':\n                part = date.getSeconds();\n                break;\n            case 't': case 'tt':\n                part = (date.getHours() < 12) ? (locale.amDesignator ?? Culture.amDesignator) : (locale.pmDesignator ?? Culture.pmDesignator);\n                if (fs == 't') {\n                    part = part.charAt(0);\n                }\n                break;\n            case 'fff':\n                part = padLeft(date.getMilliseconds(), 3, '0');\n                break;\n            case 'ff':\n                part = padLeft(date.getMilliseconds(), 3, '0').substr(0, 2);\n                break;\n            case 'f':\n                part = padLeft(date.getMilliseconds(), 3, '0').charAt(0);\n                break;\n            case 'z':\n                part = date.getTimezoneOffset() / 60;\n                part = ((part >= 0) ? '-' : '+') + Math.floor(Math.abs(part));\n                break;\n            case 'zz':\n            case 'zzz':\n                part = date.getTimezoneOffset() / 60;\n                part = ((part >= 0) ? '-' : '+') +\n                    padLeft(Math.floor(Math.abs(part)), 2, '0');\n                if (fs == 'zzz') {\n                    part += (locale.timeSeparator ?? Culture.timeSeparator) +\n                        padLeft(Math.abs(date.getTimezoneOffset() % 60), 2, '0');\n                }\n                break;\n            default:\n                if (part.charAt(0) == '\\'') {\n                    part = part.substr(1, part.length - 2).replace(/\\\\'/g, '\\'');\n                }\n                break;\n        }\n        sb.push(part);\n    }\n\n    return sb.join('');\n}\n\n/**\n * Formats a number containing number of minutes into a string in the format \"d.hh:mm\".\n * @param n The number of minutes.\n */\nexport function formatDayHourAndMin(n: number): string {\n    if (n == null)\n        return \"\";\n    if (n === 0)\n        return '0';\n    let days = Math.floor(n / 24 / 60);\n    let txt = \"\";\n    if (days > 0) {\n        txt += days.toString();\n    }\n    let mins = zeroPad(Math.floor((n % (24 * 60)) / (60)), 2) + ':' + zeroPad(n % 60, 2);\n    if (mins != '00:00') {\n        if (days > 0)\n            txt += \".\";\n        txt += mins;\n    }\n    return txt;\n}\n\n/**\n * Formats a date as the ISO 8601 UTC date/time format.\n * @param n The number of minutes.\n */\nexport function formatISODateTimeUTC(d: Date): string {\n    if (d == null)\n        return \"\";\n    let zeropad = function (num: number) { return ((num < 10) ? '0' : '') + num; };\n    let str = d.getUTCFullYear() + \"-\" +\n        zeropad(d.getUTCMonth() + 1) + \"-\" +\n        zeropad(d.getUTCDate()) + \"T\" +\n        zeropad(d.getUTCHours()) + \":\" +\n        zeropad(d.getUTCMinutes());\n    let secs = Number(d.getUTCSeconds() + \".\" +\n        ((d.getUTCMilliseconds() < 100) ? '0' : '') +\n        zeropad(d.getUTCMilliseconds()));\n    str += \":\" + zeropad(secs) + \"Z\";\n    return str;\n}\n\nlet isoRegexp = /(\\d{4,})(?:-(\\d{1,2})(?:-(\\d{1,2})(?:[T ](\\d{1,2}):(\\d{1,2})(?::(\\d{1,2})(?:\\.(\\d+))?)?(?:(Z)|([+-])(\\d{1,2})(?::(\\d{1,2}))?)?)?)?)?/;\n\n/**\n * Parses a string in the ISO 8601 UTC date/time format.\n * @param s The string to parse.\n */\nexport function parseISODateTime(s: string): Date {\n    if (s == null)\n        return null;\n\n    if (typeof s !== \"string\")\n        s = s + \"\";\n\n    if (!s.length)\n        return null;\n\n    if (!isoRegexp.test(s))\n        return new Date(NaN);\n\n    return new Date(s + (s.length == 10 ? \"T00:00:00\" : \"\"));\n}\n\n/**\n * Parses a time string in the format \"hh:mm\" into a number containing number of minutes.\n * Returns NaN if the hours not in range 0-23 or minutes not in range 0-59.\n * @param s The string to parse.\n */\nexport function parseHourAndMin(value: string): number {\n    let v = trim(value);\n    if (!v.length)\n        return null;\n    if (v.length < 4 || v.length > 5)\n        return NaN;\n    let h: number, m: number;\n    if (v.charAt(1) == ':') {\n        h = parseInteger(v.substr(0, 1));\n        m = parseInteger(v.substr(2, 2));\n    }\n    else {\n        if (v.charAt(2) != ':')\n            return NaN;\n        h = parseInteger(v.substr(0, 2));\n        m = parseInteger(v.substr(3, 2));\n    }\n    if (isNaN(h) || isNaN(m) || h < 0 || h > 23 || m < 0 || m > 59)\n        return NaN;\n    return h * 60 + m;\n}\n\n/**\n * Parses a string in the format \"d.hh:mm\" into a number containing number of minutes.\n * Returns NaN if the hours not in range 0-23 or minutes not in range 0-59.\n * Returns NULL if the string is empty or whitespace.\n */\nexport function parseDayHourAndMin(s: string): number {\n    let days: number;\n    let v = trim(s);\n    if (!v.length)\n        return null;\n    let p = v.split('.');\n    if (p.length == 1) {\n        days = parseInteger(p[0]);\n        if (!isNaN(days))\n            return days * 24 * 60;\n        return parseHourAndMin(p[0]);\n    }\n    else if (p.length == 2) {\n        days = parseInteger(p[0]);\n        let hm = parseHourAndMin(p[1]);\n        if (isNaN(days) || !hm || isNaN(hm))\n            return NaN;\n        return days * 24 * 60 + hm;\n    }\n    else\n        return NaN;\n}\n\n/**\n * Parses a string to a date. If the string is empty or whitespace, returns null.\n * Returns a NaN Date if the string is not a valid date.\n * @param s The string to parse.\n * @param dateOrder The order of the date parts in the string. Defaults to culture's default date order.\n  */\nexport function parseDate(s: string, dateOrder?: string): Date {\n    if (!s || !s.length)\n        return null;\n\n    s = trim(s);\n    if (!s.length)\n        return null;\n\n    if (s.length >= 10 && s.charAt(4) === '-' && s.charAt(7) === '-' &&\n        (s.length === 10 || (s.length > 10 && s.charAt(10) === 'T'))) {\n        return parseISODateTime(s);\n    }\n\n    if (s.indexOf(' ') > 0 && s.indexOf(':') > s.indexOf(' ') + 1) {\n        var datePart = parseDate(s.substring(0, s.indexOf(' ')));\n        if (!datePart || isNaN(datePart.valueOf()))\n            return new Date(NaN);\n        return parseISODateTime(formatDate(datePart, 'yyyy-MM-dd') + 'T' + trim(s.substring(s.indexOf(' ') + 1)));\n    }\n\n    let d: number, m: number, y: number;\n    let dArray = splitDateString(s);\n    if (dArray.length == 3) {\n        if (dArray.some(x => !/^[0-9]+$/.test(x)))\n            return new Date(NaN);\n\n        dateOrder = dateOrder || Culture.dateOrder;\n        switch (dateOrder) {\n            case \"dmy\":\n                d = parseInt(dArray[0], 10);\n                m = parseInt(dArray[1], 10) - 1;\n                y = parseInt(dArray[2], 10);\n                break;\n            case \"ymd\":\n                d = parseInt(dArray[2], 10);\n                m = parseInt(dArray[1], 10) - 1;\n                y = parseInt(dArray[0], 10);\n                break;\n            case \"mdy\":\n            default:\n                d = parseInt(dArray[1], 10);\n                m = parseInt(dArray[0], 10) - 1;\n                y = parseInt(dArray[2], 10);\n                break;\n        }\n\n        if (isNaN(d) || isNaN(m) || isNaN(y) || d < 1 || d > 31 || m < 0 || m > 11 || y > 9999 || y < 0)\n            return new Date(NaN);\n\n        if (y < 100) {\n            let fullYear = new Date().getFullYear();\n            let shortYearCutoff = (fullYear % 100) + 10;\n            y += fullYear - fullYear % 100 + (y <= shortYearCutoff ? 0 : -100);\n        }\n\n        return new Date(y, m, d);\n    }\n    else if (dArray.length == 1) {\n        try {\n            return new Date(dArray[0]);\n        }\n        catch (e) {\n            return new Date(NaN);\n        }\n    }\n\n    return new Date(NaN);\n}\n\n/**\n * Splits a date string into an array of strings, each containing a single date part.\n * It can handle separators \"/\", \".\", \"-\" and \"\\\".\n * @param s The string to split.\n */\nexport function splitDateString(s: string): string[] {\n    s = trim(s);\n    if (!s.length)\n        return null;\n    if (s.indexOf(\"/\") >= 0)\n        return s.split(\"/\");\n    else if (s.indexOf(\".\") >= 0)\n        return s.split(\".\");\n    else if (s.indexOf(\"-\") >= 0)\n        return s.split(\"-\");\n    else if (s.indexOf(\"\\\\\") >= 0)\n        return s.split(\"\\\\\");\n    else\n        return [s];\n}", "\uFEFFimport { resolveUrl } from \"./services\";\nimport { startsWith, trimToNull } from \"./strings\";\nimport { blockUI, blockUndo } from \"./blockui\";\nimport { alertDialog, iframeDialog } from \"./dialogs\";\nimport { notifyError } from \"./notify\";\nimport { format } from \"./formatting\";\nimport { PropertyItem, PropertyItemsData } from \"./propertyitem\";\nimport { getStateStore } from \"./system\";\nimport { Lookup } from \"./lookup\";\n\nfunction getHash(key: string, reload?: boolean): string {\n    let k: string;\n\n    const stateStore = getStateStore();\n    if (stateStore.__scriptHash == null &&\n        typeof document !== \"undefined\" && \n        (k = trimToNull((document.querySelector('script#RegisteredScripts') || {}).innerHTML)) != null &&\n        k.charAt(0) == '{') {\n        var regs = JSON.parse(k);\n        ScriptData.setRegisteredScripts(regs);\n    }\n\n    if (stateStore.__scriptHash == null) {\n        if (reload)\n            stateStore.__scriptHash = {};\n        else\n            return null;\n    }\n\n    if (reload)\n        return (stateStore.__scriptHash[key] = new Date().getTime().toString());\n\n    return stateStore.__scriptHash[key];\n}\n\nfunction setHash(key: string, value: string): void {\n    getStateStore(\"__scriptHash\")[key] = value;\n}\n\nfunction getLoadedData(name: string): any {\n    return getStateStore(\"__scriptData\")[name];\n}\n\nfunction setLoadedData(name: string, value: any): void {\n    getStateStore(\"__scriptData\")[name] = value;\n}\n\nexport namespace ScriptData {\n    \n    export function bindToChange(name: string, regClass: string, onChange: () => void) {\n        typeof $ !== \"undefined\" && typeof document !== \"undefined\" && ($(document.body) as any).bind('scriptdatachange.' + regClass, function (e: any, s: string) {\n            if (s == name) {\n                onChange();\n            }\n        });\n    }\n\n    export function triggerChange(name: string) {\n        typeof $ !== \"undefined\" && typeof document !== \"undefined\" && $(document.body).triggerHandler('scriptdatachange', [name]);\n    }\n\n    export function unbindFromChange(regClass: string) {\n        typeof $ !== \"undefined\" && typeof document !== \"undefined\" && $(document.body).unbind('scriptdatachange.' + regClass);\n    }\n\n    function loadOptions(name: string, async: boolean): JQueryAjaxSettings {\n        return {\n            async: async,\n            cache: true,\n            type: 'GET',\n            url: resolveUrl('~/DynJS.axd/') + name + '.js?v=' + (getHash(name) ?? new Date().getTime()),\n            data: null,\n            dataType: 'text',\n            converters: {\n                \"text script\": function (text: string) {\n                    return text;\n                }\n            },\n            success: function (data, textStatus, jqXHR) {\n                $.globalEval(data);\n            },\n            error: function (xhr, textStatus, errorThrown) {\n                var isLookup = startsWith(name, \"Lookup.\");\n                if (xhr.status == 403 && isLookup) {\n                    notifyError('<p>Access denied while trying to load the lookup: \"<b>' +\n                        name.substr(7) + '</b>\". Please check if current user has required permissions for this lookup.</p> ' +\n                        '<p><em>Lookups use the ReadPermission of their row by default. You may override that for the lookup ' +\n                        'like [LookupScript(\"Some.Lookup\", Permission = \"?\")] to grant all ' +\n                        'authenticated users to read it (or use \"*\" for public).</em></p>' + \n                        '<p><em>Note that this might be a security risk if the lookup contains sensitive data, ' +\n                        'so it could be better to set a separate permission for lookups, like \"MyModule:Lookups\".</em></p>', null, {\n                            timeOut: 10000,\n                            escapeHtml: false\n                        });\n                    return;\n                }\n\n                notifyError(\"An error occurred while trying to load \" +\n                    (isLookup ? ' the lookup: \"' + name.substr(7) :\n                        ' dynamic script: \"' + name) +\n                    '\"!. Please check the error message displayed in the dialog below for more info.');\n\n                var html = xhr.responseText;\n                if (!html) {\n                    if (!xhr.status)\n                        alertDialog(\"An unknown connection error occurred! Check browser console for details.\");\n                    else if (xhr.status == 500)\n                        alertDialog(\"HTTP 500: Connection refused! Check browser console for details.\");\n                    else\n                        alertDialog(\"HTTP \" + xhr.status + ' error! Check browser console for details.');\n                }\n                else\n                    iframeDialog({ html: html });\n            }\n        }\n    }\n\n    let loadScriptPromises: { [key: string]: Promise<any> }  = {}\n\n    function loadScriptAsync(name: string): Promise<any> {\n        let key = name + '?' + (getHash(name) ?? '');\n\n        var promise = loadScriptPromises[key];\n        if (promise)\n            return promise;\n\n        let options = loadOptions(name, true);\n        blockUI(null);\n        loadScriptPromises[key] = promise = Promise.resolve(\n            $.ajax(options).always(function () {\n                delete loadScriptPromises[key];\n                blockUndo();\n            }));\n\n        return promise;\n    }\n\n    function loadScriptData(name: string) {\n        $.ajax(loadOptions(name, false));\n    }\n\n    async function loadScriptDataAsync(name: string): Promise<any> {\n        return await loadScriptAsync(name);\n    }\n\n    function loadError(name: string) {\n        var message;\n\n        if (name != null &&\n            name.startsWith('Lookup.')) {\n            message = 'No lookup with key \"' + name.substring(7) + '\" is registered. Please make sure you have a' +\n                ' [LookupScript(\"' + name.substring(7) + '\")] attribute in server side code on top of a row / custom lookup and ' +\n                ' its key is exactly the same.';\n        } else {\n            message = format(\"Can't load script data: {0}!\", name);\n        }\n\n        notifyError(message);\n        throw new Error(message);\n    }\n\n    export function ensure<TData = any>(name: string): TData {\n        var data = getLoadedData(name);\n        if (data == null) {\n            loadScriptData(name);\n        }\n\n        data = getLoadedData(name);\n\n        if (data == null) \n            loadError(name);\n\n        return data;\n    }\n\n    export async function ensureAsync<TData = any>(name: string): Promise<TData> {\n        var data = getLoadedData(name);\n        if (data != null)\n            return data;\n        await loadScriptDataAsync(name);\n        data = getLoadedData(name);\n        if (data == null)\n            loadError(name);\n        return data;\n    }\n\n    export function reload<TData = any>(name: string): TData {\n        getHash(name, true);\n        loadScriptData(name);\n        var data = getLoadedData(name);\n        return data;\n    }\n\n    export async function reloadAsync<TData = any>(name: string): Promise<TData> {\n        getHash(name, true);\n        await loadScriptDataAsync(name);\n        return getLoadedData(name);\n    }\n\n    export function canLoad(name: string) {\n        return getLoadedData(name) != null || getHash(name) != null;\n    }\n\n    export function setRegisteredScripts(scripts: any[]) {\n        var t = new Date().getTime().toString();\n        for (var k in scripts) {\n            setHash(k, scripts[k] || t);\n        }\n    }\n\n    export function set(name: string, value: any) {\n        setLoadedData(name, value);\n        triggerChange(name);\n    }\n}\n\nexport function getRemoteData<TData = any>(key: string): TData {\n    return ScriptData.ensure('RemoteData.' + key);\n}\n\nexport async function getRemoteDataAsync<TData = any>(key: string): Promise<TData> {\n    return await ScriptData.ensureAsync('RemoteData.' + key);\n}\n\nexport function getLookup<TItem>(key: string): Lookup<TItem> {\n    return ScriptData.ensure('Lookup.' + key);\n}\n\nexport async function getLookupAsync<TItem>(key: string): Promise<Lookup<TItem>> {\n    return await ScriptData.ensureAsync('Lookup.' + key);\n}\n\nexport function reloadLookup<TItem = any>(key: string): Lookup<TItem> {\n    return ScriptData.reload('Lookup.' + key);\n}\n\nexport async function reloadLookupAsync<TItem = any>(key: string): Promise<Lookup<TItem>> {\n    return await ScriptData.reloadAsync('Lookup.' + key);\n}\n\nexport function getColumns(key: string): PropertyItem[] {\n    return getColumnsData(key).items;\n}\n\nexport function getColumnsData(key: string): PropertyItemsData {\n    return ScriptData.ensure('Columns.' + key);\n}\n\nexport async function getColumnsAsync(key: string): Promise<PropertyItem[]> {\n    return (await getColumnsDataAsync(key)).items;\n}\n\nexport async function getColumnsDataAsync(key: string): Promise<PropertyItemsData> {\n    return ScriptData.ensureAsync('Columns.' + key);\n}\n\nexport function getForm(key: string): PropertyItem[] {\n    return getFormData(key).items;\n}\n\nexport function getFormData(key: string): PropertyItemsData {\n    return ScriptData.ensure('Form.' + key);\n}\n\nexport async function getFormAsync(key: string): Promise<PropertyItem[]> {\n    return (await getFormDataAsync(key)).items;\n}\n\nexport async function getFormDataAsync(key: string): Promise<PropertyItemsData> {\n    return await ScriptData.ensureAsync('Form.' + key);\n}\n\nexport function getTemplate(key: string): string {\n    return ScriptData.ensure('Template.' + key);\n}\n\nexport async function getTemplateAsync(key: string): Promise<string> {\n    return await ScriptData.ensureAsync('Template.' + key);\n}\n\nexport function canLoadScriptData(name: string): boolean {\n    return ScriptData.canLoad(name);\n}\n\nvar exported = {\n    canLoadScriptData,\n    getColumns,\n    getColumnsAsync,\n    getForm,\n    getFormAsync,\n    getLookup,\n    getLookupAsync,\n    getRemoteData, \n    getRemoteDataAsync,\n    getTemplate,\n    getTemplateAsync,\n    reloadLookup,\n    reloadLookupAsync,\n    ScriptData\n}\n\nif (typeof globalThis !== \"undefined\") {\n    const Q = (globalThis as any).Q || ((globalThis as any).Q = {});\n    for (var i in exported)\n        if (Q[i] == null)\n            Q[i] = (exported as any)[i];\n}", "\uFEFFimport { localText } from \"./localtext\";\nimport { notifyError } from \"./notify\";\nimport { getRemoteData, getRemoteDataAsync } from \"./scriptdata\";\nimport { UserDefinition } from \"./userdefinition\";\n\nconst andOrRegex = /[|&]/;\n\n/**\n * Contains permission related functions.\n * \n * ## Note\n * We use a namespace here both for compatibility and for allowing users to override\n * these functions easily in ES modules environment, which is normally hard to do.\n */\nexport namespace Authorization {\n\n    /** \n     * Checks if the current user has the permission specified.\n     * This should only be used for UI purposes and it is strongly recommended to check permissions server side.\n     * \n     * > Please prefer the `hasPermissionAsync` variant as this may block the UI thread if the `UserData` script is not already loaded.\n     * @param permission Permission key. It may contain logical operators like A&B|C.\n     * @returns `false` for \"null or undefined\", true for \"*\", `IsLoggedIn` for \"?\". For other permissions, \n     * if the user has the permission or if the user has the `IsAdmin` flag (super admin) `true`, otherwise `false`.\n     */\n    export function hasPermission(permission: string) {\n        if (permission == null)\n            return false;\n\n        if (permission == \"*\")\n            return true;\n\n        // normally in server side empty permission would return false\n        // here we are more tolerant for compatibility reasons and\n        // as it is less risky\n        if (permission == \"\" || permission == \"?\")\n            return !!Authorization.isLoggedIn;\n\n        var ud = Authorization.userDefinition;\n        if (!ud)\n            return false;\n\n        if (ud.IsAdmin)\n            return true;\n\n        return isPermissionInSet(ud.Permissions, permission);\n    }\n\n    /** \n     * Checks if the current user has the permission specified.\n     * This should only be used for UI purposes and it is strongly recommended to check permissions server side.\n     * \n     * @param permission Permission key. It may contain logical operators like A&B|C.\n     * @returns `false` for \"null or undefined\", true for \"*\", `IsLoggedIn` for \"?\". For other permissions, \n     * if the user has the permission or if the user has the `IsAdmin` flag (super admin) `true`, otherwise `false`.\n     */\n    export async function hasPermissionAsync(permission: string): Promise<boolean> {\n        if (permission == null)\n            return false;\n\n        if (permission == \"*\")\n            return true;\n\n        if (permission == \"\" || permission == \"?\")\n            return await Authorization.isLoggedInAsync;\n\n        var ud = await Authorization.userDefinitionAsync;\n        if (!ud)\n            return false;\n\n        if (ud.IsAdmin)\n            return true;\n\n        return isPermissionInSet(ud.Permissions, permission);\n    }\n\n    /**\n     * Checks if the hashset contains the specified permission, also handling logical \"|\" and \"&\" operators\n     * @param permissionSet Set of permissions\n     * @param permission Permission key or a permission expression containing & | operators\n     * @returns true if set contains permission\n     */\n    export function isPermissionInSet(permissionSet: { [key: string]: boolean }, permission: string) {\n        if (!permissionSet || permission == null)\n            return false;\n\n        if (permissionSet[permission])\n            return true;\n\n        if (!andOrRegex.test(permission))\n            return false;\n\n        var orParts = permission.split('|');\n        for (var r of orParts) {\n            if (!r.length)\n                continue;\n\n            var andParts = r.split('&');\n\n            let anyFalse = false;\n            for (var n of andParts) {\n                if (!n || !permissionSet[n]) {\n                    anyFalse = true;\n                    break;\n                }\n            }\n\n            if (!anyFalse)\n                return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Throws an error if the current user does not have the specified permission. \n     * Prefer `await validatePermissionAsync()` as this one might block the UI if the `UserData`\n     * is not already loaded.\n     * @param permission Permission key. It may contain logical operators like A&B|C.\n     */\n    export function validatePermission(permission: string) {\n        if (!hasPermission(permission)) {\n            notifyError(localText(\"Authorization.AccessDenied\"));\n            throw new Error(localText(\"Authorization.AccessDenied\"));\n        }\n    }\n\n    /**\n    * Throws an error if the current user does not have the specified permission.\n    * @param permission Permission key. It may contain logical operators like A&B|C.\n    * @example \n    * await Authorization.validatePermissionAsync(\"A&B|C\");\n    */\n    export async function validatePermissionAsync(permission: string): Promise<void> {\n        if (!(await hasPermissionAsync(permission))) {\n            notifyError(localText(\"Authorization.AccessDenied\"));\n            throw new Error(localText(\"Authorization.AccessDenied\"));\n        }\n    }\n}\n\nexport declare namespace Authorization {\n    /** \n     * Checks if the current user is logged in. Prefer `isLoggedInAsync` as this one might block the UI if the `UserData`\n     * is not already loaded.\n     * @returns `true` if the user is logged in, `false` otherwise. \n     * @example \n     * if (Authorization.isLoggedIn) {\n     *     // do something\n     * }\n     */\n    export let isLoggedIn: boolean;\n\n    /** \n     * Checks if the current user is logged in.\n     * @returns `true` if the user is logged in, `false` otherwise. \n     * @example \n     * if (await Authorization.isLoggedInAsync) {\n     *     // do something\n     * }\n     */\n    export let isLoggedInAsync: Promise<boolean>;\n\n    /** Returns the username for currently logged user. Prefer `usernameAsync` as this one might block the UI if the `UserData`\n     * is not already loaded.\n     * @returns Username for currently logged user.\n     * @example \n     * if (Authorization.username) {\n     *     // do something\n     * } \n     */\n    export let username: string;\n\n    /** Returns the username for currently logged user.\n     * @returns Username for currently logged user.\n     * @example \n     * if (await Authorization.usernameAsync) {\n     *     // do something\n     * }\n     */\n    export let usernameAsync: Promise<string>;\n\n    /** Returns the user data for currently logged user. Prefer `userDefinitionAsync` as this one might block the UI if the `UserData`\n     * is not already loaded.\n     * @returns User data for currently logged user.\n     * @example \n     * if (Authorization.userDefinition.IsAdmin) {\n     *     // do something\n     * }\n     */\n    export let userDefinition: UserDefinition;\n\n    /** Returns the user data for currently logged user.\n     * @returns User data for currently logged user.\n     * @example \n     * if ((await Authorization.userDefinitionAsync).IsAdmin) {\n     *     // do something\n     * }\n     */\n    export let userDefinitionAsync: Promise<UserDefinition>;\n}\n\nObject.defineProperty(Authorization, \"isLoggedIn\", {\n    get: function () {\n        return !!(Authorization.userDefinition?.Username?.length);\n    },\n    configurable: true\n});\n\nObject.defineProperty(Authorization, \"isLoggedInAsync\", {\n    get: async function () {\n        return !!((await Authorization.userDefinitionAsync)?.Username?.length);\n    },\n    configurable: true\n});\n\nObject.defineProperty(Authorization, \"userDefinition\", {\n    get: function () {\n        return getRemoteData<UserDefinition>(\"UserData\");\n    },\n    configurable: true\n});\n\nObject.defineProperty(Authorization, \"userDefinitionAsync\", {\n    get: async function () {\n        return await getRemoteDataAsync<UserDefinition>(\"UserData\");\n    },\n    configurable: true\n});\n\nObject.defineProperty(Authorization, \"username\", {\n    get: function () {\n        return Authorization.userDefinition?.Username;\n    },\n    configurable: true\n});\n\nObject.defineProperty(Authorization, \"usernameAsync\", {\n    get: async function () {\n        return (await Authorization.userDefinitionAsync)?.Username;\n    },\n    configurable: true\n});", "\uFEFFexport interface DebouncedFunction<T extends (...args: any[]) => any> {\n    /**\n     * Call the original function, but applying the debounce rules.\n     *\n     * If the debounced function can be run immediately, this calls it and returns its return\n     * value.\n     *\n     * Otherwise, it returns the return value of the last invocation, or undefined if the debounced\n     * function was not invoked yet.\n     */\n    (...args: Parameters<T>): ReturnType<T> | undefined;\n\n    /**\n     * Throw away any pending invocation of the debounced function.\n     */\n    clear(): void;\n\n    /**\n     * If there is a pending invocation of the debounced function, invoke it immediately and return\n     * its return value.\n     *\n     * Otherwise, return the value from the last invocation, or undefined if the debounced function\n     * was never invoked.\n     */\n    flush(): ReturnType<T> | undefined;\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function also has a property 'clear' that can be used \n * to clear the timer to prevent previously scheduled executions, and flush method\n * to invoke scheduled executions now if any.\n * @param wait The function will be called after it stops being called for\n * N milliseconds. \n * @param immediate If passed, trigger the function on the leading edge, instead of the trailing. \n *\n * @source underscore.js\n */\nexport function debounce<T extends (...args: any) => any>(func: T, wait?: number, immediate?: boolean): DebouncedFunction<T> {\n    var timeout: any, args: any, context: any, timestamp: number, result: any;\n    if (null == wait) wait = 100;\n\n    var later = function () {\n        var last = Date.now() - timestamp;\n\n        if (last < wait && last >= 0) {\n            timeout = setTimeout(later, wait - last);\n        } else {\n            timeout = null;\n            if (!immediate)\n                result = func.apply(context, args);\n            if (!timeout)\n                context = args = null;\n        }\n    };\n\n    var debounced = function () {\n        context = this;\n        args = arguments;\n        timestamp = Date.now();\n        if (!timeout) {\n            timeout = setTimeout(later, wait);\n            if (immediate)\n                result = func.apply(context, args);\n        }\n        return result;\n    };\n\n    (debounced as any).clear = function () {\n        if (timeout) {\n            clearTimeout(timeout);\n            timeout = null;\n        }\n    };\n\n    (debounced as any).flush = function () {\n        if (timeout) {\n            result = func.apply(context, args);\n            context = args = null;\n\n            clearTimeout(timeout);\n            timeout = null;\n        }\n    };\n\n    return debounced as DebouncedFunction<T>;\n};", "\uFEFFexport {}\n\ninterface LayoutTimerReg {\n    handler: () => void;\n    element: () => HTMLElement;\n    width: boolean;\n    height: boolean;\n    storedWidth?: number;\n    storedHeight?: number;\n}\n\nexport namespace LayoutTimer {\n\n    var timeout: number;\n    var nextKey: number = 0;\n    var regCount: number = 0;\n    var regs: { [key: number]: LayoutTimerReg; } = {};\n\n    function startTimer() {\n        if (timeout == null && regCount > 0) {\n            timeout = window.setTimeout(onTimeout, 100);\n        }\n    }\n\n    function clearTimer() {\n        if (timeout != null) {\n            window.clearTimeout(timeout);\n            timeout = null;\n        }\n    }\n\n    function onTimeout() {\n        for (var key in regs) {\n            var reg = regs[key];\n            try {\n                var el = reg.element();\n                if (!el)\n                    continue;\n\n                var w = el.offsetWidth;\n                var h = el.offsetHeight;\n                try {\n\n                    if ((reg.width && reg.storedWidth !== w) ||\n                        (reg.height && reg.storedHeight !== h) ||\n                        (!reg.width && !reg.height && (!w !== !reg.storedWidth || !h !== !reg.storedHeight))) {\n                            if (w > 0 && h > 0) {\n                                try {\n                                    reg.handler();\n                                }\n                                finally {\n                                    w = el.offsetWidth;\n                                    h = el.offsetHeight;\n                                }\n                            }\n                    }\n                }\n                finally {\n                    reg.storedWidth = w;\n                    reg.storedHeight = h;\n                }\n            }\n            catch (e) {\n                console.log(e);\n            }\n        }\n        clearTimer();\n        startTimer();\n    }\n\n    export function store(key: number) {\n        var reg = regs[key];\n        if (!reg)\n            return;\n\n        var el = reg.element();\n        if (!el)\n            return;\n\n        reg.storedWidth = el.offsetWidth;\n        reg.storedHeight = el.offsetHeight;\n    }\n\n    export function trigger(key: number) {\n        var reg = regs[key];\n        if (!reg)\n            return;\n        store(key);\n        if (reg.storedWidth >= 0 &&\n            reg.storedHeight >= 0) {\n            reg.handler();\n        }\n        store(key);\n    }\n\n    export function onSizeChange(element: () => HTMLElement, handler: () => void, width?: boolean, height?: boolean): number {\n        if (handler == null)\n            throw \"Layout handler can't be null!\";\n\n        regs[++nextKey] = {\n            element: element,\n            handler: handler,\n            width: width !== false,\n            height: height !== false\n        }\n        regCount++;\n        store(nextKey)\n        startTimer();\n        return nextKey;\n    }\n\n    export function onWidthChange(element: () => HTMLElement, handler: () => void) {\n        return onSizeChange(element, handler, true, false);\n    }\n\n    export function onHeightChange(element: () => HTMLElement, handler: () => void) {\n        return onSizeChange(element, handler, false, true);\n    }\n\n    export function onShown(element: () => HTMLElement, handler: () => void) {\n        return onSizeChange(element, handler, false, false);\n    }\n\n    export function off(key: number): number {\n        var reg = regs[key];\n        if (!reg) \n            return 0;\n            \n        delete regs[key];\n        regCount--;\n        if (regCount <= 0)\n            clearTimer();\n\n        return 0;\n    }\n}\n\nexport function executeOnceWhenVisible(element: JQuery, callback: Function): void {\n    var el = element && element[0];\n    if (!el)\n        return;\n    \n    if (el.offsetWidth > 0 && el.offsetHeight > 0) {\n        callback();\n        return;\n    }\n\n    var timer = LayoutTimer.onShown(() => el, () => {\n        LayoutTimer.off(timer);\n        callback();\n    });\n}\n\nexport function executeEverytimeWhenVisible(element: JQuery, callback: Function, callNowIfVisible: boolean): void {\n    var el = element && element[0];\n    if (!el)\n        return;\n    \n    if (callNowIfVisible && el.offsetWidth > 0 && el.offsetHeight > 0) {\n        callback();\n    }\n\n    LayoutTimer.onShown(() => el, () => {\n        callback();\n    });\n}\n", "\uFEFFimport { startsWith } from \"./strings\";\nimport { closePanel } from \"./dialogs\";\nimport $ from \"@optionaldeps/jquery\";\n\nexport interface HandleRouteEventArgs {\n    handled: boolean,\n    route: string,\n    parts: string[],\n    index: number\n}\n\nexport namespace Router {\n    let oldURL: string;\n    let resolving: number = 0;\n    let autoinc: number = 0;\n    let ignoreHash: number = 0;\n    let ignoreTime: number = 0;\n\n    export let enabled: boolean = true;\n\n    function isEqual(url1: string, url2: string) {\n        return url1 == url2 || url1 == url2 + '#' || url2 == url1 + '#';\n    }\n\n    export function navigate(hash: string, tryBack?: boolean, silent?: boolean) {\n        if (!enabled || resolving > 0)\n            return;\n\n        hash = hash || '';\n        hash = hash.replace(/^#/, '');\n        hash = (!hash ? \"\" : '#' + hash);\n        var newURL = window.location.href.replace(/#$/, '')\n            .replace(/#.*$/, '') + hash;\n        if (newURL != window.location.href) {\n            if (tryBack && oldURL != null && isEqual(oldURL, newURL)) {\n                if (silent)\n                    ignoreChange();\n\n                var prior = window.location.href;\n                oldURL = null;\n                window.history.back();\n                return;\n            }\n\n            if (silent)\n                ignoreChange();\n\n            oldURL = window.location.href;\n            window.location.hash = hash;\n        }\n    }\n\n    export function replace(hash: string, tryBack?: boolean) {\n        navigate(hash, tryBack, true);\n    }\n\n    export function replaceLast(hash: string, tryBack?: boolean) {\n        if (!enabled)\n            return;\n\n        var current = window.location.hash || '';\n        if (current.charAt(0) == '#')\n            current = current.substr(1, current.length - 1);\n\n        var parts = current.split('/+/');\n\n        if (parts.length > 1) {\n            if (hash && hash.length) {\n                parts[parts.length - 1] = hash;\n                hash = parts.join(\"/+/\");\n            }\n            else {\n                parts.splice(parts.length - 1, 1);\n                hash = parts.join(\"/+/\");\n            }\n        }\n        replace(hash, tryBack);\n    }\n\n    function visibleDialogs() {\n        return $('.ui-dialog-content:visible, .ui-dialog.panel-hidden>.ui-dialog-content, .s-Panel').toArray().sort((a, b) => {\n            return ($(a).data('qrouterorder') || 0) - ($(b).data('qrouterorder') || 0);\n        });\n    }\n\n    function dialogOpen(owner: JQuery, element: JQuery, hash: () => string) {\n        var route = [];\n        var isDialog = owner.hasClass(\".ui-dialog-content\") || owner.hasClass('.s-Panel');\n        var dialog = isDialog ? owner :\n            owner.closest('.ui-dialog-content, .s-Panel');\n        var value = hash();\n\n        var idPrefix: string;\n        if (dialog.length) {\n            var dialogs = visibleDialogs();\n            var index = dialogs.indexOf(dialog[0]);\n\n            for (var i = 0; i <= index; i++) {\n                var q = $(dialogs[i]).data(\"qroute\") as string;\n                if (q && q.length)\n                    route.push(q);\n            }\n\n            if (!isDialog) {\n                idPrefix = dialog.attr(\"id\");\n                if (idPrefix) {\n                    idPrefix += \"_\";\n                    var id = owner.attr(\"id\");\n                    if (id && startsWith(id, idPrefix))\n                        value = id.substr(idPrefix.length) + '@' + value;\n                }\n            }\n        }\n        else {\n            var id = owner.attr(\"id\");\n            if (id && (!owner.hasClass(\"route-handler\") ||\n                $('.route-handler').first().attr(\"id\") != id))\n                value = id + \"@\" + value;\n        }\n\n        route.push(value);\n        element.data(\"qroute\", value);\n        replace(route.join(\"/+/\"));\n\n        element.bind(\"dialogclose.qrouter panelclose.qrouter\", e => {\n            element.data(\"qroute\", null);\n            element.unbind(\".qrouter\");\n            var prhash = element.data(\"qprhash\");\n            var tryBack = $(e.target).closest('.s-MessageDialog').length > 0 || (e && e.originalEvent &&\n                ((e.originalEvent.type == \"keydown\" && (e.originalEvent as any).keyCode == 27) ||\n                $(e.originalEvent.target).hasClass(\"ui-dialog-titlebar-close\") ||\n                $(e.originalEvent.target).hasClass(\"panel-titlebar-close\")));\n            if (prhash != null)\n                replace(prhash, tryBack);\n            else\n                replaceLast('', tryBack);\n        });\n    }\n\n    export function dialog(owner: JQuery, element: JQuery, hash: () => string) {\n        if (!enabled)\n            return;\n        \n        element.on(\"dialogopen.qrouter panelopen.qrouter\", e => {\n            dialogOpen(owner, element, hash);\n        });\n    }\n\n    export function resolve(hash?: string) {\n        if (!enabled)\n            return;\n\n        resolving++;\n        try {\n            hash = hash ?? window.location.hash ?? '';\n            if (hash.charAt(0) == '#')\n                hash = hash.substr(1, hash.length - 1);\n\n            var dialogs = visibleDialogs();\n            var newParts = hash.split(\"/+/\");\n            var oldParts = dialogs.map(el => $(el).data('qroute') as string);\n\n            var same = 0;\n            while (same < dialogs.length &&\n                same < newParts.length &&\n                oldParts[same] == newParts[same]) {\n                same++;\n            }\n\n            for (var i = same; i < dialogs.length; i++) {\n                var d = $(dialogs[i]);\n                if (d.hasClass('ui-dialog-content'))\n                    (d as any).dialog?.('close');\n                else if (d.hasClass('s-Panel'))\n                    closePanel(d);\n            }\n\n            for (var i = same; i < newParts.length; i++) {\n                var route = newParts[i];\n                var routeParts = route.split('@');\n                var handler: JQuery;\n                if (routeParts.length == 2) {\n                    var dialog = i > 0 ? $(dialogs[i - 1]) : $([]);\n                    if (dialog.length) {\n                        var idPrefix = dialog.attr(\"id\");\n                        if (idPrefix) {\n                            handler = $('#' + idPrefix + \"_\" + routeParts[0]);\n                            if (handler.length) {\n                                route = routeParts[1];\n                            }\n                        }\n                    }\n\n                    if (!handler || !handler.length) {\n                        handler = $('#' + routeParts[0]);\n                        if (handler.length) {\n                            route = routeParts[1];\n                        }\n                    }\n                }\n\n                if (!handler || !handler.length) {\n                    handler = i > 0 ? $(dialogs[i - 1]) :\n                        $('.route-handler').first();\n                }\n\n                handler.triggerHandler(\"handleroute\", <HandleRouteEventArgs>{\n                    handled: false,\n                    route: route,\n                    parts: newParts,\n                    index: i\n                });\n            }\n        }\n        finally {\n            resolving--;\n        }\n    }\n\n    function hashChange(e: any, o: string) {\n        if (ignoreHash > 0) {\n            if (new Date().getTime() - ignoreTime > 1000) {\n                ignoreHash = 0;\n            }\n            else {\n                ignoreHash--;\n                return;\n            }\n        }\n        resolve();\n    }\n\n    function ignoreChange() {\n        ignoreHash++;\n        ignoreTime = new Date().getTime();\n    }\n\n    window.addEventListener(\"hashchange\", hashChange as any, false);\n\n    let routerOrder = 1;\n\n    typeof document !== \"undefined\" && typeof $ !== \"undefined\" &&\n        $.fn && $(document).on(\"dialogopen panelopen\", \".ui-dialog-content, .s-Panel\", function (event, ui) {\n        if (!enabled)\n            return;\n\n        var dlg = $(event.target);\n        dlg.data(\"qrouterorder\", routerOrder++);\n\n        if (dlg.data(\"qroute\"))\n            return;\n\n        dlg.data(\"qprhash\", window.location.hash);\n        var owner = $(visibleDialogs).not(dlg).last();\n        if (!owner.length)\n            owner = $('html');\n\n        dialogOpen(owner, dlg, () => {\n            return \"!\" + (++autoinc).toString(36);\n        });\n    });\n}", "\uFEFFimport { Config } from \"./config\";\nimport { executeEverytimeWhenVisible } from \"./layouttimer\";\nimport { Router } from \"./router\";\nimport { getNested, getGlobalThis, initializeTypes } from \"./system\";\nimport $ from \"@optionaldeps/jquery\";\n   \nexport function initFullHeightGridPage(gridDiv: JQuery | HTMLElement, opt?: { noRoute?: boolean, setHeight?: boolean }) {\n    var el = ($ && gridDiv instanceof $) ? (gridDiv as JQuery).get(0) : gridDiv as HTMLElement\n    document.documentElement.classList.add('full-height-page');\n    el.classList.add('responsive-height');\n\n    let setHeight = opt?.setHeight ?? ($ && (!el.classList.contains('s-DataGrid') &&\n        !el.classList.contains('s-Panel')));\n\n    let layout = function () {\n        setHeight && layoutFillHeight($(el));\n        $ ? $(el).triggerHandler('layout') : el.dispatchEvent(new Event('layout'));\n    };\n\n    if (document.body.classList.contains('has-layout-event')) {\n        $ ? $(document.body).on('layout', layout) : el.addEventListener('layout', layout);\n    }\n    else if ((window as any).Metronic?.addResizeHandler) {\n        (window as any).Metronic.addResizeHandler(layout);\n    }\n    else {\n        $ ? $(window).resize(layout) : window.addEventListener('resize', layout);\n    }\n\n    layout();\n\n    $ && $(el).one('remove', () => {\n        $(window).off('resize', layout);\n        $('body').off('layout', layout);\n    });\n\n    if (!opt?.noRoute && \n        typeof document !== \"undefined\" &&\n        !$(document.body).attr('data-fhrouteinit')) {\n            $(document.body).attr('data-fhrouteinit', 'true');\n            // ugly, but to it is to make old pages work without having to add this\n            typeof Router !== \"undefined\" && Router.resolve?.();\n    }\n}\n\nexport function layoutFillHeightValue(element: JQuery) {\n    let h = 0;\n    element.parent().children().not(element).each(function (i, e) {\n        let q = $(e);\n        if (q.is(':visible')) {\n            h += q.outerHeight(true);\n        }\n    });\n    h = element.parent().height() - h;\n    if (element.css('box-sizing') !== 'border-box') {\n        h = h - (element.outerHeight(true) - element.height());\n    }\n    return h;\n}\n\nexport function layoutFillHeight(element: JQuery) {\n    let h = layoutFillHeightValue(element);\n    let n = Math.round(h) + 'px';\n    if (element.css('height') != n) {\n        element.css('height', n);\n    }\n}\n\nexport function isMobileView() {\n    return typeof window !== 'undefined' &&\n        (window.matchMedia?.('(max-width: 767px)')?.matches ??\n         window.innerWidth < 768);\n}\n\nfunction initOnLoad() {\n    var globalObj = getGlobalThis();\n    if (globalObj && Config.rootNamespaces) {\n        for (var ns of Config.rootNamespaces) {\n            var obj = getNested(globalObj, ns);\n            if (obj != null)\n                initializeTypes(obj, ns + \".\", 3);\n        }\n    }\n}\n\nif (typeof $ !== \"undefined\")\n    $(initOnLoad);\nelse if (typeof document !== \"undefined\" && document.readyState === 'loading')\n    document.addEventListener('DOMContentLoaded', initOnLoad);\nelse\n    initOnLoad();\n\nexport function triggerLayoutOnShow(element: JQuery) {\n    executeEverytimeWhenVisible(element, function () {\n        element.triggerHandler('layout');\n    }, true);\n}\n\nexport function centerDialog(el: JQuery) {\n    el = el.closest(\".ui-dialog\");\n    (el as any).position?.({ at: 'center center', of: window });\n    let pos = el.position();\n    if (pos.left < 0)\n        el.css(\"left\", \"0px\");\n    if (pos.top < 0)\n        el.css(\"top\", \"0px\");\n}", "\uFEFFexport interface LookupOptions<TItem> {\n    idField?: string;\n    parentIdField?: string;\n    textField?: string;\n    textFormatter?(item: TItem): string;\n}\n\nexport interface Lookup<TItem> {\n    items: TItem[];\n    itemById: { [key: string]: TItem };\n    idField: string;\n    parentIdField: string;\n    textField: string;\n    textFormatter: (item: TItem) => string;\n}\n\nexport class Lookup<TItem> {\n    public items: TItem[] = [];\n    public itemById: { [key: string]: TItem } = {};\n    public idField: string;\n    public parentIdField: string;\n    public textField: string;\n    public textFormatter: (item: TItem) => string;\n\n    constructor(options: LookupOptions<TItem>, items?: TItem[]) {\n        options = options || {};\n        this.textFormatter = options.textFormatter;\n        this.idField = options.idField;\n        this.parentIdField = options.parentIdField;\n        this.textField = options.textField;\n        this.textFormatter = options.textFormatter;\n\n        if (items != null)\n            this.update(items);\n    }\n\n    update?(value: TItem[]) {\n        this.items = [];\n        this.itemById = {};\n        if (value) {\n            for (var k of value)\n                this.items.push(k);\n        }\n        var idField = this.idField;\n        if (idField) {\n            for (var r of this.items) {\n                var v = (r as any)[idField];\n                if (v != null) {\n                    this.itemById[v] = r;\n                }\n            }\n        }\n    }\n}", "\uFEFFimport { registerEnum } from \"./system\";\n\nexport interface PropertyItem {\n    name?: string;\n    title?: string;\n    hint?: string;\n    placeholder?: string;\n    editorType?: string;\n    editorParams?: any;\n    category?: string;\n    collapsible?: boolean;\n    collapsed?: boolean;\n    tab?: string;\n    cssClass?: string;\n    headerCssClass?: string;\n    formCssClass?: string;\n    maxLength?: number;\n    required?: boolean;\n    insertable?: boolean;\n    insertPermission?: string;\n    hideOnInsert?: boolean;\n    updatable?: boolean;\n    updatePermission?: string;\n    hideOnUpdate?: boolean;\n    readOnly?: boolean;\n    readPermission?: string;\n    oneWay?: boolean;\n    defaultValue?: any;\n    localizable?: boolean;\n    visible?: boolean;\n    allowHide?: boolean;\n    formatterType?: string;\n    formatterParams?: any;\n    displayFormat?: string;\n    alignment?: string;\n    width?: number;\n    widthSet?: boolean;\n    minWidth?: number;\n    maxWidth?: number;\n    labelWidth?: string;\n    resizable?: boolean;\n    sortable?: boolean;\n    sortOrder?: number;\n    groupOrder?: number;\n    summaryType?: SummaryType;\n    editLink?: boolean;\n    editLinkItemType?: string;\n    editLinkIdField?: string;\n    editLinkCssClass?: string;\n    filteringType?: string;\n    filteringParams?: any;\n    filteringIdField?: string;\n    notFilterable?: boolean;\n    filterOnly?: boolean;\n    quickFilter?: boolean;\n    quickFilterParams?: any;\n    quickFilterSeparator?: boolean;\n    quickFilterCssClass?: string;\n}\n\nexport interface PropertyItemsData {\n    items: PropertyItem[];\n    additionalItems: PropertyItem[];\n}\n   \nexport enum SummaryType {\n    Disabled = -1,\n    None = 0,\n    Sum = 1,\n    Avg = 2,\n    Min = 3,\n    Max = 4\n}\n\nregisterEnum(SummaryType, 'Serenity.SummaryType');", "\uFEFFexport interface ServiceError {\n    Code?: string;\n    Arguments?: string;\n    Message?: string;\n    Details?: string;\n    ErrorId?: string;\n}               \n      \nexport interface ServiceResponse {\n    Error?: ServiceError;\n}\n    \nexport interface ServiceRequest {\n}\n    \nexport interface ServiceOptions<TResponse extends ServiceResponse> extends JQueryAjaxSettings {\n    request?: any;\n    service?: string;\n    blockUI?: boolean;\n    onError?(response: TResponse): void;\n    onSuccess?(response: TResponse): void;\n    onCleanup?(): void;\n}\n\nexport interface SaveRequest<TEntity> extends ServiceRequest {\n    EntityId?: any;\n    Entity?: TEntity;\n    Localizations?: any;\n}\n    \nexport interface SaveRequestWithAttachment<TEntity> extends SaveRequest<TEntity> {\n    Attachments?: any[];\n}\n    \nexport interface SaveResponse extends ServiceResponse {\n    EntityId?: any;\n}\n    \nexport interface SaveWithLocalizationRequest<TEntity> extends SaveRequest<TEntity> {\n    Localizations?: { [key: string]: TEntity };\n}\n    \nexport interface DeleteRequest extends ServiceRequest {\n    EntityId?: any;\n}\n    \nexport interface DeleteResponse extends ServiceResponse {\n}\n    \nexport interface UndeleteRequest extends ServiceRequest {\n    EntityId?: any;\n}\n    \nexport interface UndeleteResponse extends ServiceResponse {\n}\n    \nexport enum ColumnSelection {\n    List = 0,\n    KeyOnly = 1,\n    Details = 2,\n    None = 3,\n    IdOnly = 4,\n    Lookup = 5\n}\n    \nexport enum RetrieveColumnSelection {\n    details = 0,\n    keyOnly = 1,\n    list = 2,\n    none = 3,\n    idOnly = 4,\n    lookup = 5\n}\n    \nexport interface ListRequest extends ServiceRequest {\n    Skip?: number;\n    Take?: number;\n    Sort?: string[];\n    ContainsText?: string;\n    ContainsField?: string;\n    Criteria?: any[];\n    EqualityFilter?: any;\n    IncludeDeleted?: boolean;\n    ExcludeTotalCount?: boolean;\n    ColumnSelection?: ColumnSelection;\n    IncludeColumns?: string[];\n    ExcludeColumns?: string[];\n    ExportColumns?: string[];\n    DistinctFields?: string[];\n}\n    \nexport interface ListResponse<TEntity> extends ServiceResponse {\n    Entities?: TEntity[];\n    Values?: any[];\n    TotalCount?: number;\n    Skip?: number;\n    Take?: number;\n}\n    \nexport interface RetrieveRequest extends ServiceRequest {\n    EntityId?: any;\n    ColumnSelection?: RetrieveColumnSelection;\n    IncludeColumns?: string[];\n    ExcludeColumns?: string[];\n}\n    \nexport interface RetrieveResponse<TEntity> extends ServiceResponse {\n    Entity?: TEntity;\n}\n    \nexport interface RetrieveLocalizationRequest extends RetrieveRequest {\n}\n    \nexport interface RetrieveLocalizationResponse<TEntity> extends ServiceResponse {\n    Entities?: { [key: string]: TEntity };\n}\n", "\uFEFF/// <reference types=\"jquery.validation\" />\nimport $ from \"@optionaldeps/jquery\"\n\nexport default $?.validator;", "\uFEFFimport { extend } from \"./system\";\nimport { Config } from \"./config\";\nimport { Exception } from \"./system\";\nimport { tryGetText } from \"./localtext\";\nimport { parseDate, parseHourAndMin, parseDayHourAndMin, parseDecimal, parseInteger } from \"./formatting\";\nimport { isBS3 } from \"./dialogs\";\nimport { htmlEncode } from \"./html\";\nimport validator from \"@optionaldeps/jquery.validation\";\n\nif (validator && validator.methods && validator.addMethod) {\n\n    if ((validator as any).prototype.showLabel) {\n        var orgShowLabel = (validator as any).prototype.showLabel;\n        (validator as any).prototype.showLabel = function(element: any, message: any) {\n            if (message != null)\n                message = htmlEncode(message);\n            orgShowLabel.call(this, element, message);\n        }\n    }\n\n    validator.addMethod('customValidate', function (value: any, element: any) {\n        var result = this.optional(element) as any;\n        if (element == null || !!result) {\n            return result;\n        }\n        var events = ($ as any)._data(element, 'events');\n        if (!events) {\n            return true;\n        }\n        var handlers = events.customValidate;\n        if (handlers == null || handlers.length === 0) {\n            return true;\n        }\n\n        var el = $(element);\n        for (var i = 0; !!(i < handlers.length); i++) {\n            if ($.isFunction(handlers[i].handler)) {\n                var message = handlers[i].handler(el);\n                if (message != null) {\n                    el.data('customValidationMessage', message);\n                    return false;\n                }\n            }\n        }\n        return true;\n    }, function (o: any, e: any) {\n        return $(e).data('customValidationMessage');\n    });\n\n    validator.addMethod(\"dateQ\", function (value, element) {\n        var o = this.optional(element);\n        if (o)\n            return o;\n\n        var d = parseDate(value);\n        if (!d || isNaN(d.valueOf()))\n            return false;\n\n        var z = new Date(d);\n        z.setHours(0, 0, 0, 0);\n        return z.getTime() === d.getTime();\n    });\n\n    validator.addMethod(\"dateTimeQ\", function (value, element) {\n        var o = this.optional(element);\n        if (o)\n            return o;\n\n        var d = parseDate(value);\n        if (!d || isNaN(d.valueOf()))\n            return false;\n\n        return true;\n    });        \n\n    validator.addMethod(\"hourAndMin\", function (value, element) {\n        return this.optional(element) || !isNaN(parseHourAndMin(value));\n    });\n\n    validator.addMethod(\"dayHourAndMin\", function (value, element) {\n        return this.optional(element) || !isNaN(parseDayHourAndMin(value));\n    });\n\n    validator.addMethod(\"decimalQ\", function (value, element) {\n        return this.optional(element) || !isNaN(parseDecimal(value));\n    });\n\n    validator.addMethod(\"integerQ\", function (value, element) {\n        return this.optional(element) || !isNaN(parseInteger(value));\n    });\n\n    let oldEmail = validator.methods['email'];\n    let emailRegex: RegExp = null;\n    validator.addMethod(\"email\", function (value, element) {\n        if (Config.emailAllowOnlyAscii)\n            return oldEmail.call(this, value, element);\n\n        if (emailRegex == null) \n            emailRegex = new RegExp(\"^((([a-z]|\\\\d|[!#\\\\$%&'\\\\*\\\\+\\\\-\\\\/=\\\\?\\\\^_`{\\\\|}~]|\" +\n                \"[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])+(\\\\.([a-z]|\\\\d|\" +\n                \"[!#\\\\$%&'\\\\*\\\\+\\\\-\\\\/=\\\\?\\\\^_`{\\\\|}~]|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])+)*)|\" +\n                \"((\\\\x22)((((\\\\x20|\\\\x09)*(\\\\x0d\\\\x0a))?(\\\\x20|\\\\x09)+)?(([\\\\x01-\\\\x08\\\\x0b\\\\x0c\\\\x0e-\\\\x1f\\\\x7f]|\" +\n                \"\\\\x21|[\\\\x23-\\\\x5b]|[\\\\x5d-\\\\x7e]|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])|(\\\\\\\\([\\\\x01-\\\\x09\\\\x0b\\\\x0c\\\\x0d-\\\\x7f]|\" +\n                \"[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF]))))*(((\\\\x20|\\\\x09)*(\\\\x0d\\\\x0a))?(\\\\x20|\\\\x09)+)?(\\\\x22)))@((([a-z]|\\\\d|\" +\n                \"[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])|(([a-z]|\\\\d|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])\" +\n                \"([a-z]|\\\\d|-|\\\\.|_|~|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])*([a-z]|\\\\d|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])))\\\\.)\" +\n                \"+(([a-z]|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])|(([a-z]|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])([a-z]|\\\\d|-|\\\\.|_|~|\" +\n                \"[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])*([a-z]|[\\\\u00A0-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFEF])))$\", \"i\");\n                \n        return emailRegex.test(value);\n    });\n\n    $(loadValidationErrorMessages);\n}\n\nexport function loadValidationErrorMessages() {\n\n    const addMsg = (m: string, k: string) => {\n        var txt = tryGetText(\"Validation.\" + k);\n        if (txt)\n            validator.messages[m] = txt;\n        else if (!validator.messages[m])\n            validator.messages[m] = k + \"?\";\n    }\n\n    addMsg(\"required\", \"Required\");\n    addMsg(\"email\", \"Email\");\n    addMsg(\"minlength\", \"MinLength\");\n    addMsg(\"maxlength\", \"MaxLength\");\n    addMsg(\"digits\", \"Digits\");\n    addMsg(\"range\", \"Range\");\n    addMsg(\"xss\", \"Xss\");\n    addMsg(\"dateQ\", \"DateInvalid\");\n    addMsg(\"decimalQ\", \"Decimal\");\n    addMsg(\"integerQ\", \"Integer\");\n    addMsg(\"url\", \"Url\");\n}\n\nfunction setTooltip(el: JQuery, val: string, show: boolean): JQuery {\n    if (isBS3())\n        (el.attr('data-original-title', val || '') as any)?.tooltip?.('fixTitle');\n    else\n        (el.attr('title', val || '') as any)?.tooltip?.('_fixTitle');\n    if (show != null)\n        (el as any).tooltip?.(show ? 'show' : 'hide');\n    return el;\n}\n\nexport function getHighlightTarget(el: HTMLElement) {\n    var hl = el.dataset.vxHighlight;\n    if (hl)\n        return document.getElementById(hl);\n    else if (el.classList.contains(\"select2-offscreen\") && el.id)\n        return document.getElementById('s2id_' + el.id);\n}\n\nexport function baseValidateOptions(): JQueryValidation.ValidationOptions {\n    return <any>{\n        errorClass: 'error',\n        ignore: ':hidden, .no-validate',\n        ignoreTitle: true,\n        normalizer: function (value: any) {\n            return $.trim(value);\n        },\n        highlight: function (element: HTMLElement, errorClass: string, validClass: string) {\n            if ((element as any).type === \"radio\") {\n                this.findByName((element as any).name).addClass(errorClass).removeClass(validClass);\n            } else {\n                if (errorClass != null && errorClass.length)\n                    element.classList.add(errorClass);\n                if (validClass != null && validClass.length)\n                    element.classList.remove(validClass);\n                var hl = getHighlightTarget(element);\n                if (hl && hl.classList) {\n                    if (errorClass != null && errorClass.length)\n                        hl.classList.add(errorClass);\n                    if (validClass != null && validClass.length)\n                        hl.classList.remove(validClass);\n                }\n            }\n        },\n        unhighlight: function (element: HTMLElement, errorClass: string, validClass: string) {\n            if ((element as any).type === \"radio\") {\n                this.findByName((element as any).name).removeClass(errorClass).addClass(validClass);\n            } else {\n                if (errorClass != null && errorClass.length)\n                    element.classList.remove(errorClass);\n                if (validClass != null && validClass.length)\n                    element.classList.add(validClass);\n                var hl = getHighlightTarget(element);\n                if (hl && hl.classList) {\n                    if (errorClass != null && errorClass.length)\n                        hl.classList.remove(errorClass);\n                    if (validClass != null && validClass.length)\n                        hl.classList.add(validClass);\n                }\n            }\n        },\n        showErrors: function () {\n            if (($?.fn as any)?.tooltip) {\n                var i: number, elements: any, error: any, $el: any, hl: any;\n                for (i = 0; this.errorList[i]; i++) {\n                    error = this.errorList[i];\n                    hl = getHighlightTarget(error.element);\n                    if (hl != null)\n                        $el = $(hl);\n                    else\n                        $el = $(error.element);\n                    if (i != 0)\n                        setTooltip($el, '', false);\n                    else\n                        setTooltip($el, error.message, true);\n                }\n\n                for (i = 0, elements = this.validElements(); elements[i]; i++) {\n                    hl = getHighlightTarget(error.element);\n                    if (hl != null)\n                        $el = $(hl);\n                    else\n                        $el = $(error.element);\n                    setTooltip($el, '', false);\n                }\n            }\n\n            (validator as any)[\"prototype\"].defaultShowErrors.call(this);\n        }\n    }\n}\n\nexport function validateForm(form: JQuery, opt: JQueryValidation.ValidationOptions): JQueryValidation.Validator {\n    return form.validate(extend(baseValidateOptions(), opt));\n}\n\nexport function addValidationRule(element: JQuery, eventClass: string, rule: (p1: JQuery) => string): JQuery {\n    if (!element.length)\n        return element;\n    if (rule == null)\n        throw new Exception('rule is null!');\n    element.addClass('customValidate').bind('customValidate.' + eventClass, rule as any);\n    return element;\n}\n\nexport function removeValidationRule(element: JQuery, eventClass: string): JQuery {\n    element.unbind('customValidate.' + eventClass);\n    return element;\n}", "\uFEFFimport { extend } from \"./system\";\nimport { notifyError } from \"./notify\";\nimport { localText } from \"./localtext\";\nimport { baseValidateOptions, getHighlightTarget } from \"./validation\";\nimport { isBS3 } from \"./dialogs\";\n\nlet oldShowLabel: (e: HTMLElement, message: string) => void;\n\nfunction validateShowLabel(element: HTMLElement, message: string) {\n    oldShowLabel.call(this, element, message);\n    this.errorsFor(element).each(function (i: number, e: any) {\n        var $e = $(e);\n        if ($e.parent('.vx').length) {\n            $e.attr('title', $e.text());\n            if (message && $e.hasClass('error'))\n                $e.removeClass('checked');\n        }\n    });\n};\n\nfunction jQueryValidationInitialization() {\n\n    if (typeof $ === \"undefined\" ||\n        !$.validator)\n        return;\n\n    let p: any = $.validator;\n    p = p.prototype;\n    oldShowLabel = p.showLabel;\n    p.showLabel = validateShowLabel;\n\n    p.oldfocusInvalid = p.focusInvalid;\n    p.focusInvalid = function () {\n        if (this.settings.abortHandler)\n            this.settings.abortHandler(this);\n        this.oldfocusInvalid.call(this);\n    };\n    p.oldstopRequest = p.focusInvalid;\n    p.stopRequest = function (element: any, valid: boolean) {\n        let formSubmitted = this.formSubmitted;\n        this.oldfocusInvalid.call(this, [element, valid]);\n        if (!valid && this.pendingRequest == 0 && formSubmitted && this.settings.abortHandler) {\n            this.settings.abortHandler(this);\n        }\n    };\n    p.resetAll = function () {\n        this.submitted = {};\n        this.prepareForm();\n        this.hideErrors();\n        this.elements().removeClass(this.settings.errorClass);\n    };\n};\n\nexport function validatorAbortHandler(validator: any) {\n    validator.settings.abortHandler = null;\n    validator.settings.submitHandler = function () {\n        return false;\n    };\n};\n\nexport function validateOptions(options?: JQueryValidation.ValidationOptions) {\n    var opt = baseValidateOptions();\n    delete opt.showErrors;\n    return extend(extend(opt, {\n        meta: 'v',\n        errorPlacement: function (error: any, element: any) {\n            let field: any = null;\n            let vx = element.attr('data-vx-id');\n            if (vx) {\n                field = $('#' + vx);\n                if (!field.length)\n                    field = null;\n                else\n                    field = field[0];\n            }\n            if (field == null) {\n                field = element.parents('div.field');\n                if (field.length) {\n                    let inner = $('div.vx', field[0]);\n                    if (inner.length)\n                        field = inner[0];\n                }\n                else\n                    field = element.parent();\n            }\n            error.appendTo(field);\n        },\n        submitHandler: function () {\n            return false;\n        },\n        invalidHandler: function (event: any, validator: JQueryValidation.Validator) {\n            notifyError(localText(\"Validation.InvalidFormMessage\"));\n\n            $(validator.errorList.map(x => x.element))\n                .closest('.category.collapsed')\n                .children('.category-title')\n                .each((i, x) => {\n                    $(x).click();\n                    return true;\n                });\n\n            if (validator.errorList.length)\n            {\n                var el = validator.errorList[0].element;\n                if (el) {\n                    var bsPane = $(el).closest('.tab-pane');\n                    if (!bsPane.hasClass(\"active\") &&\n                        bsPane.parent().hasClass('tab-content')) {\n                        var bsPaneId = bsPane.attr('id');\n                        if (bsPaneId) {\n                            $('a[href=\"#' + bsPaneId + '\"]').click();\n                        }\n                    }\n\n                    if (($.fn as any).tooltip) {\n                        var $el: any;\n                        var hl = getHighlightTarget(el);\n                        if (hl)\n                            $el = $(hl);\n                        else\n                            $el = $(el);\n\n                        ($.fn as any).tooltip && $el.tooltip({\n                            title: validator.errorList[0].message,\n                            trigger: 'manual'\n                        }).tooltip('show');\n\n                        window.setTimeout(function () {\n                            $el.tooltip(isBS3() ? 'destroy' : 'dispose');\n                        }, 1500);\n                    }\n                }\n            }\n        },\n        success: function (label: JQuery) {\n            label.addClass('checked');\n        }\n    }), options);\n};\n\nif (typeof $ !== \"undefined\") {\n    if ($.validator)\n        jQueryValidationInitialization();\n    else\n        $(jQueryValidationInitialization);\n}\nelse if (typeof document !== \"undefined\") {\n    if (document.readyState === 'loading')\n        document.addEventListener('DOMContentLoaded', jQueryValidationInitialization);\n    else\n        setTimeout(jQueryValidationInitialization, 100);\n}", "\uFEFF/**\n * CriteriaBuilder is a class that allows to build unary or binary criteria with completion support.\n */\nexport class CriteriaBuilder extends Array {\n    /**\n     * Creates a between criteria.\n     * @param fromInclusive from value\n     * @param toInclusive to value\n     */\n    bw(fromInclusive: any, toInclusive: any): Array<any> {\n        return [[this, '>=', fromInclusive], 'and', [this, '<=', toInclusive]];\n    }\n\n    /**\n     * Creates a contains criteria\n     * @param value contains value\n     */\n    contains(value: string): Array<any> {\n        return [this, 'like', '%' + value + '%'];\n    }\n\n    /**\n     * Creates a endsWith criteria\n     * @param value endsWith value\n     */\n    endsWith(value: string): Array<any> {\n        return [this, 'like', '%' + value];\n    }\n\n    /**\n     * Creates an equal (=) criteria\n     * @param value equal value\n     */\n    eq(value: any): Array<any> {\n        return [this, '=', value];\n    }\n\n    /**\n     * Creates a greater than criteria\n     * @param value greater than value\n     */\n    gt(value: any): Array<any> {\n        return [this, '>', value];\n    }\n\n    /**\n     * Creates a greater than or equal criteria\n     * @param value greater than or equal value\n     */\n    ge(value: any): Array<any> {\n        return [this, '>=', value];\n    }\n\n    /**\n     * Creates a in criteria\n     * @param values in values\n     */\n    in(values: any[]): Array<any> {\n        return [this, 'in', [values]];\n    }\n\n    /**\n     * Creates a IS NULL criteria\n     */\n    isNull(): Array<any> {\n        return ['is null', this];\n    }\n\n    /**\n     * Creates a IS NOT NULL criteria\n     */\n    isNotNull(): Array<any> {\n        return ['is not null', this];\n    }\n\n    /**\n     * Creates a less than or equal to criteria\n     * @param value less than or equal to value\n     */\n    le(value: any): Array<any> {\n        return [this, '<=', value];\n    }\n\n    /**\n     * Creates a less than criteria\n     * @param value less than value\n     */\n    lt(value: any): Array<any> {\n        return [this, '<', value];\n    }\n\n    /**\n     * Creates a not equal criteria\n     * @param value not equal value\n     */\n    ne(value: any): Array<any> {\n        return [this, '!=', value];\n    }\n\n    /**\n     * Creates a LIKE criteria\n     * @param value like value\n     */\n    like(value: any): Array<any> {\n        return [this, 'like', value];\n    }\n\n    /**\n     * Creates a STARTS WITH criteria\n     * @param value startsWith value\n     */\n    startsWith(value: string): Array<any> {\n        return [this, 'like', value + '%'];\n    }\n\n    /**\n     * Creates a NOT IN criteria\n     * @param values array of NOT IN values\n     */\n    notIn(values: any[]): Array<any> {\n        return [this, 'not in', [values]];\n    }\n\n    /**\n     * Creates a NOT LIKE criteria\n     * @param value not like value\n     */\n    notLike(value: any): Array<any> {\n        return [this, 'not like', value];\n    }\n}\n\nconst TOKEN_IDENTIFIER = 1;\nconst TOKEN_OPERATOR = 2;\nconst TOKEN_VALUE = 3;\nconst TOKEN_PARAM = 4;\n\ninterface Token {\n    t: number;\n    v: any;\n}\n\ninterface ParseError {\n    error: string;\n    pos: number;\n}\n\nconst ParseError: any = function (expression: string, error: string, position: number) {\n    this.expression = expression;\n    this.error = error;\n    this.position = position;\n    this.toString = function () {\n        return 'Error parsing expression: \"' + expression + '\", \"' +\n            error + ', position: ' + position;\n    };\n}\n\nfunction tokenize(expression: string): Token[] {\n    var end: number, v: any;\n    var tokens: Token[] = [];\n    var l = expression.length;\n    var l1 = expression.length - 1;\n    var openParens = 0;\n    var index: number;\n    var ch: string;\n\n    function skipWhiteSpace() {\n        while (index < l) {\n            ch = expression.charAt(index);\n\n            if (ch === ' ' || ch === '\\t') {\n                index++;\n                continue;\n            }\n\n            break;\n        }\n    }\n\n    function readString() {\n        end = index;\n        var foundDoubles = false;\n        while (end++ < l1) {\n            ch = expression.charAt(end);\n            if (ch === \"'\") {\n                if (end < l1 && expression.charAt(end + 1) === \"'\") {\n                    end++;\n                    foundDoubles = true;\n                    continue;\n                }\n                else\n                    break;\n            }\n        }\n\n        if (end === index ||\n            expression.charAt(end) !== \"'\")\n            throw new ParseError(expression, 'unterminated string', index);\n\n        v = expression.substr(index + 1, end - index - 1);\n        if (foundDoubles)\n            v = v.replace(/''/g, \"'\");\n    }\n\n    function readNumber() {\n        end = index;\n        var foundDot = false;\n        while (end < l1) {\n            ch = expression.charAt(end + 1);\n            if ((ch >= '0' && ch <= '9') ||\n                (!foundDot && (ch === '.'))) {\n                if (ch === '.')\n                    foundDot = true;\n                end++;\n            }\n            else\n                break;\n        }\n\n        v = parseFloat(expression.substring(index, end + 1));\n    }\n\n    function readIdentifier() {\n        end = index;\n        while (end < l1) {\n            ch = expression.charAt(end + 1);\n            if (ch == '_' ||\n                (ch >= 'A' && ch <= 'Z') ||\n                (ch >= 'a' && ch <= 'z') ||\n                (ch >= '0' && ch <= '9')) {\n                end++;\n            }\n            else\n                break;\n        }\n\n        v = expression.substr(index, end - index + 1);\n    }\n\n    function readParam() {\n        index++;\n        readIdentifier();\n        if (!v.length)\n            throw new ParseError(expression, 'expected parameter name', index);\n    }\n\n    function readArrayList() {\n        skipWhiteSpace();\n\n        if (index >= l || expression.charAt(index) != '(') {\n            if (index < l && expression.charAt(index) == '@') {\n                readParam();\n                index = end;\n                return;\n            }\n            throw new ParseError(expression, 'expected parenthesis', index);\n        }\n\n        index++;\n\n        let values = [];\n\n        while (true) {\n            skipWhiteSpace();\n\n            if (index >= l)\n                throw new ParseError(expression, 'expected parenthesis', index);\n\n            ch = expression.charAt(index);\n\n            if (ch == ',') {\n                if (values.length == 0)\n                    throw new ParseError(expression, 'unexpected comma', index);\n                index++;\n                skipWhiteSpace();\n                ch = expression.charAt(index);\n            }\n            else if (ch == ')') {\n                break;\n            }\n            else if (values.length > 0)\n                throw new ParseError(expression, 'expected comma', index);\n\n\n            if (ch === \"'\") {\n                readString();\n\n                values.push(v);\n                index = end + 1;\n                continue;\n            }\n\n            if (ch >= '0' && ch <= '9') {\n                readNumber();\n\n                values.push(v);\n                index = end + 1;\n                continue;\n            }\n\n            if (ch == 'n') {\n                readIdentifier();\n\n                if (v === 'null') {\n                    values.push(null)\n                    index = end + 1;\n                    continue;\n                }\n            }\n\n            throw new ParseError(expression, 'unexpected token', index);\n        }\n\n        v = values;\n    }\n\n    for (index = 0; index < l; index++) {\n        ch = expression.charAt(index);\n        if (ch === ' ' || ch === '\\t')\n            continue;\n\n        if (ch == '_' ||\n            (ch >= 'A' && ch <= 'Z') ||\n            (ch >= 'a' && ch <= 'z')) {\n            readIdentifier();\n            var w = v.toLowerCase();\n            if (w == 'is') {\n                index = end + 1;\n                skipWhiteSpace();\n\n                readIdentifier();\n                w = v.toLowerCase();\n                if (w === 'not') {\n                    index = end + 1;\n                    skipWhiteSpace();\n                    readIdentifier();\n                    if (v.toLowerCase() === 'null') {\n                        tokens.push({\n                            t: TOKEN_OPERATOR,\n                            v: 'is not null'\n                        });\n                    }\n                    else\n                        throw new ParseError(expression, 'expected \"null\"', index);\n                }\n                else if (w === 'null') {\n                    tokens.push({\n                        t: TOKEN_OPERATOR,\n                        v: 'is null'\n                    });\n                }\n                else\n                    throw new ParseError(expression, 'expected \"null\" or \"not\" keyword', index);\n            }\n            else if (w === 'and' || w === 'or' || w === 'xor') {\n                tokens.push({\n                    t: TOKEN_OPERATOR,\n                    v: w\n                });\n            }\n            else if (w === 'not') {\n                const currentEnd = end;\n\n                index = end + 1;\n                skipWhiteSpace();\n\n                readIdentifier();\n                w = v.toLowerCase();\n\n                if (w === 'in') {\n                    index = end + 1;\n\n                    tokens.push({\n                        t: TOKEN_OPERATOR,\n                        v: 'not in'\n                    });\n\n                    readArrayList();\n\n                    if (typeof v === \"string\") {\n                        tokens.push({\n                            t: TOKEN_PARAM,\n                            v: v\n                        })\n                    }\n                    else {\n                        tokens.push({\n                            t: TOKEN_VALUE,\n                            v: v\n                        });\n                    }\n                }\n                else if (w === \"like\") {\n                    tokens.push({\n                        t: TOKEN_OPERATOR,\n                        v: 'not like'\n                    });\n\n                    index = end;\n                } else {\n                    tokens.push({\n                        t: TOKEN_OPERATOR,\n                        v: 'not'\n                    });\n\n                    index = currentEnd;\n                }\n\n                continue;\n            }\n            else if (w === 'in') {\n                tokens.push({\n                    t: TOKEN_OPERATOR,\n                    v: 'in'\n                });\n\n                index = end + 1;\n\n                readArrayList();\n\n                if (typeof v === \"string\") {\n                    tokens.push({\n                        t: TOKEN_PARAM,\n                        v: v\n                    })\n                }\n                else {\n                    tokens.push({\n                        t: TOKEN_VALUE,\n                        v: v\n                    });\n                }\n\n                continue;\n            }\n            else if (w === \"like\") {\n                tokens.push({\n                    t: TOKEN_OPERATOR,\n                    v: 'like'\n                });\n            }\n            else {\n                tokens.push({\n                    t: TOKEN_IDENTIFIER,\n                    v: v\n                });\n            }\n\n            index = end;\n            continue;\n        }\n\n        if (ch === '@') {\n            readParam();\n            tokens.push({\n                t: TOKEN_PARAM,\n                v: v\n            });\n            index = end;\n            continue;\n        }\n\n        if ((((ch === '-') || (ch === '+')) &&\n            index < l1 &&\n            expression.charAt(index + 1) >= '0' &&\n            expression.charAt(index + 1) <= '9') ||\n            (ch >= '0' && ch <= '9')) {\n            end = index;\n            readNumber();\n\n            tokens.push({\n                t: TOKEN_VALUE,\n                v: v\n            });\n\n            index = end;\n            continue;\n        }\n\n        if (ch === \"'\") {\n            end = index;\n            readString();\n\n            tokens.push({\n                t: TOKEN_VALUE,\n                v: v\n            });\n            index = end;\n            continue;\n        }\n\n        if (ch === '=') {\n            tokens.push({\n                t: TOKEN_OPERATOR,\n                v: ch\n            });\n            continue;\n        }\n\n        if (ch === '(') {\n            openParens++;\n            tokens.push({\n                t: TOKEN_OPERATOR,\n                v: ch\n            });\n            continue;\n        }\n\n        if (ch == ')') {\n            if (openParens <= 0)\n                throw new ParseError(expression, 'unexpected parenthesis', index);\n\n            openParens--;\n            tokens.push({\n                t: TOKEN_OPERATOR,\n                v: ch\n            });\n            continue;\n        }\n\n        if (ch === '>' || ch === '<') {\n            if (index < l1 &&\n                expression.charAt(index + 1) === '=') {\n                tokens.push({\n                    t: TOKEN_OPERATOR,\n                    v: ch + '='\n                });\n                index++;\n            }\n            else {\n                tokens.push({\n                    t: TOKEN_OPERATOR,\n                    v: ch\n                });\n            }\n            continue;\n        }\n\n        throw new ParseError(expression, 'unknown token', index);\n    }\n\n    if (openParens > 0)\n        throw new ParseError(expression, 'missing parenthesis', index);\n\n    return tokens;\n}\n\nconst operatorPrecedence: Record<string, number> = {\n    '=': 4,\n    '>': 4,\n    '<': 4,\n    '>=': 4,\n    '<=': 4,\n    '<>': 4,\n    '!=': 4,\n    'like': 5,\n    'not like': 5,\n    'in': 5,\n    'not in': 5,\n    'is null': 5,\n    'is not null': 5,\n    'not': 6,\n    'and': 7,\n    'xor': 8,\n    'or': 9\n}\n\nfunction shuntingYard(tokens: Token[]): Token[] {\n    var result: Token[] = [];\n    var stack: Token[] = [];\n    for (var token of tokens) {\n        if (token.t === TOKEN_OPERATOR) {\n            var precedence = operatorPrecedence[token.v];\n\n            if (precedence != null) {\n                while (stack.length) {\n                    var prev = stack[stack.length - 1];\n                    if (prev.t !== TOKEN_OPERATOR || prev.v == '(')\n                        break;\n                    var prevPrecedence = operatorPrecedence[prev.v];\n                    if (prevPrecedence == null || prevPrecedence > precedence)\n                        break;\n\n                    result.push(stack.pop());\n                }\n\n                stack.push(token);\n            }\n            else if (token.v === '(') {\n                stack.push(token);\n            }\n            else if (token.v === ')') {\n                while (stack.length &&\n                    (stack[stack.length - 1].t !== TOKEN_OPERATOR ||\n                        stack[stack.length - 1].v !== '(')) {\n                    result.push(stack.pop());\n                }\n\n                stack.pop();\n            }\n            else\n                result.push(token);\n        }\n        else\n            result.push(token);\n    }\n\n    while (stack.length) {\n        var tok = stack.pop();\n\n        if (tok.t == TOKEN_OPERATOR &&\n            (tok.v === '(' || tok.v === ')'))\n            throw \"Mismatched parentheses in criteria expression!\";\n\n        result.push(tok);\n    }\n\n    return result;\n}\n\nfunction rpnTokensToCriteria(rpnTokens: Token[], getParam?: (name: string) => any): any[] {\n    var stack: any[] = [];\n\n    for (var token of rpnTokens) {\n        switch (token.t) {\n            case TOKEN_IDENTIFIER:\n                {\n                    stack.push([token.v]);\n                    break;\n                }\n\n            case TOKEN_VALUE:\n                {\n                    stack.push(Array.isArray(token.v) ? [token.v] : token.v);\n                    break;\n                }\n\n            case TOKEN_PARAM:\n                {\n                    if (!getParam)\n                        throw new Error(\"getParam must be passed for parameterized expressions!\");\n                    var prm = getParam(token.v)\n                    stack.push(Array.isArray(prm) ? [prm] : prm);\n                    break;\n                }\n\n            case TOKEN_OPERATOR:\n                {\n                    switch (token.v as string) {\n                        case 'not':\n                        case 'is null':\n                        case 'is not null':\n                            if (!stack.length)\n                                throw new Error(\"Unary operator \" + token.v + \" requires a value!\");\n\n                            stack.push([token.v, stack.pop()]);\n                            break;\n                        default:\n                            if (stack.length < 2)\n                                throw new Error(\"Binary operator \" + token.v + \" requires two values!\");\n\n                            var r = stack.pop();\n                            var l = stack.pop();\n                            stack.push([l, token.v, r]);\n                            break;\n                    }\n                    break;\n                }\n            default:\n                throw new Error(\"Invalid operator type: \" + token.t + \"!\");\n        }\n    }\n\n    if (stack.length != 1)\n        throw new Error(\"Error evaluating expression!\");\n\n    return stack.pop();\n}\n\nfunction internalParse(expression: string, getParam?: (name: string) => any) {\n    var tokens = tokenize(expression);\n    var rpnTokens = shuntingYard(tokens);\n    return rpnTokensToCriteria(rpnTokens, getParam);\n}\n\n/** \n * Parses a criteria expression to Serenity Criteria array format.\n * The string may optionally contain parameters like `A >= @p1 and B < @p2`.\n * @param expression The criteria expression.\n * @param params The dictionary containing parameter values like { p1: 10, p2: 20 }.\n * @example\n * parseCriteria('A >= @p1 and B < @p2', { p1: 5, p2: 4 }) // [[[a], '>=' 5], 'and', [[b], '<', 4]]\n */\nexport function parseCriteria(expression: string, params?: any): any[];\n/** \n * Parses a criteria expression to Serenity Criteria array format.\n * The expression may contain parameter placeholders like `A >= ${p1}`\n * where p1 is a variable in the scope.\n * @param strings The string fragments.\n * @param values The tagged template arguments.\n * @example \n * var a = 5, b = 4;\n * parseCriteria`A >= ${a} and B < ${b}` // [[[a], '>=' 5], 'and', [[b], '<', 4]]\n */\nexport function parseCriteria(strings: TemplateStringsArray, ...values: any[]): any[];\nexport function parseCriteria(exprOrStrings: TemplateStringsArray | string, ...values: any[]): any[] {\n    if (!exprOrStrings?.length)\n        return [];\n\n    if (typeof exprOrStrings === \"string\") {\n        return internalParse(exprOrStrings,\n            values == null || values[0] == null ? null : name => values[0][name]);\n    }\n    else if (!values.length)\n        return internalParse(exprOrStrings.join(''));\n\n    var expression = String.raw({ raw: exprOrStrings }, ...values.map((x, i) => '@__' + i));\n    return internalParse(expression, name => name.startsWith('__') ?\n        values[parseInt(name.substring(2), 10)] : void 0);\n}\n\n/**\n * Enumeration of Criteria operator keys.\n */\nexport enum CriteriaOperator {\n    paren = \"()\",\n    not = \"not\",\n    isNull = \"is null\",\n    isNotNull = \"is not null\",\n    exists = \"exists\",\n    and = \"and\",\n    or = \"or\",\n    xor = \"xor\",\n    eq = \"=\",\n    ne = \"!=\",\n    gt = \">\",\n    ge = \">=\",\n    lt = \"<\",\n    le = \"<=\",\n    in = \"in\",\n    notIn = \"not in\",\n    like = \"like\",\n    notLike = \"not like\"\n}\n\n/**\n * Creates a new criteria builder containg the passed field name.\n * @param field The field name.\n */\nexport function Criteria(field: string) {\n    var builder = CriteriaBuilder.of(field);\n    // workaround for subclassing array until corelib switched to ES6\n    !(builder as any).eq && ((builder as any).__proto__ = CriteriaBuilder.prototype);\n    return builder as CriteriaBuilder\n}\n\n/**\n * Ands two or more criteria together.\n * @param c1 First criteria.\n * @param c2 Second criteria.\n * @param rest Other criteria.\n */\nCriteria.and = function and(c1: any[], c2: any[], ...rest: any[][]) {\n    var result = Criteria.join(c1, 'and', c2);\n    if (rest) {\n        for (let k of rest)\n            result = Criteria.join(result, 'and', k);\n    }\n\n    return result;\n};\n\n/** Provides access to the `CriteriaOperator` enum, e.g list of operator keys */\nCriteria.Operator = CriteriaOperator;\n\n/** \n * Determines if a criteria is empty.\n */\nCriteria.isEmpty = function isEmpty(c: any[]): boolean {\n    return c == null ||\n        c.length === 0 ||\n        (c.length === 1 && typeof c[0] === \"string\" && c[0].length === 0);\n};\n\n/**\n * Joins two criteria together.\n * @param c1 First criteria.\n * @param op Operator to insert between, e.g. 'or', 'and'.\n * @param c2 Second criteria\n */\nCriteria.join = function join(c1: any[], op: string, c2: any[]): any[] {\n    if (Criteria.isEmpty(c1))\n        return c2;\n\n    if (Criteria.isEmpty(c2))\n        return c1;\n\n    return [c1, op, c2];\n};\n\n/**\n * Negates a criteria.\n * @param c Criteria to negate.\n */\nCriteria.not = function not(c: any[]) {\n    return ['not', c]\n}\n\n/**\n * Ors two or more criteria together.\n * @param c1 First criteria.\n * @param c2 Second criteria.\n * @param rest Other criteria.\n */\nCriteria.or = function or(c1: any[], c2: any[], ...rest: any[][]) {\n    var result = Criteria.join(c1, 'or', c2);\n\n    if (rest) {\n        for (let k of rest)\n            result = Criteria.join(result, 'or', k);\n    }\n\n    return result;\n}\n\n/**\n * Puts a criteria in parens. Exists only for compatibility reasons.\n */\nCriteria.paren = function parent(c: any[]): any[] {\n    return Criteria.isEmpty(c) ? c : ['()', c];\n}\n\n/** \n * Parses a criteria expression to Serenity Criteria array format.\n * The expression string may be a string literal, optionally containining \n * parameters like `A >= @p1 and B < @p2`.\n * \n * Or, the expression might be a tagged string literal that \n * contain parameter placeholders like `A >= ${p1}`\n * where p1 is a variable in the scope.\n *\n * @example\n * Criteria.parse(\"A >= @p1 and B < @p2\", { p1: 5, p2: 4 }) // [[[a], '>=' 5], 'and', [[b], '<', 4]]\n * \n * @example\n * var a = 5; b = 4;\n * Criteria.parse`A >= ${a} and B < ${b}` // [[[a], '>=' 5], 'and', [[b], '<', 4]]\n*/\nCriteria.parse = parseCriteria;", "\uFEFFimport { escape, Column, GroupTotals, NonDataRow, convertCompatFormatter } from \"@serenity-is/sleekgrid\";\nimport { formatNumber, htmlEncode, tryGetText } from \"../q\";\n\nexport {}\n\nexport namespace Aggregators\n{\n    export function Avg(field: string): void {\n        this.field_ = field;\n        this.type_ = \"Avg\";\n\n        this.init = function () {\n            this.count_ = 0;\n            this.nonNullCount_ = 0;\n            this.sum_ = 0;\n        };\n\n        this.accumulate = function (item: any) {\n            var val = item[this.field_];\n            this.count_++;\n            if (val != null && val !== \"\" && !isNaN(val)) {\n                this.nonNullCount_++;\n                this.sum_ += parseFloat(val);\n            }\n        };\n\n        this.storeResult = function (groupTotals: any) {\n            if (!groupTotals.avg) {\n                groupTotals.avg = {};\n            }\n            if (this.nonNullCount_ != 0) {\n                groupTotals.avg[this.field_] = this.sum_ / this.nonNullCount_;\n            }\n        };\n    }\n\n    export function WeightedAvg(field: string, weightedField: string) {\n        this.field_ = field;\n        this.type_ = \"WeightedAvg\";\n        this.weightedField_ = weightedField;\n\n        this.init = function () {\n            this.sum_ = 0;\n            this.weightedSum_ = 0;\n        };\n\n        this.accumulate = function (item: any) {\n            var val = item[this.field_];\n            var valWeighted = item[this.weightedField_];\n            if (this.isValid(val) && this.isValid(valWeighted)) {\n                this.weightedSum_ += parseFloat(valWeighted);\n                this.sum_ += parseFloat(val) * parseFloat(valWeighted);\n            }\n        };\n\n        this.storeResult = function (groupTotals: any) {\n            if (!groupTotals.avg) {\n                groupTotals.avg = {};\n            }\n\n            if (this.sum_ && this.weightedSum_) {\n                groupTotals.avg[this.field_] = this.sum_ / this.weightedSum_;\n            }\n        };\n\n        this.isValid = function (val: any) {\n            return val !== null && val !== \"\" && !isNaN(val);\n        };\n    }\n\n    export function Min(field: string): void {\n        this.field_ = field;\n        this.type_ = \"Min\";\n\n        this.init = function () {\n            this.min_ = null;\n        };\n\n        this.accumulate = function (item: any) {\n            var val = item[this.field_];\n            if (val != null && val !== \"\" && !isNaN(val)) {\n                if (this.min_ == null || val < this.min_) {\n                    this.min_ = val;\n                }\n            }\n        };\n\n        this.storeResult = function (groupTotals: any) {\n            if (!groupTotals.min) {\n                groupTotals.min = {};\n            }\n            groupTotals.min[this.field_] = this.min_;\n        }\n    }\n\n    export function Max(field: string): void {\n        this.field_ = field;\n        this.type_ = \"Max\";\n\n        this.init = function () {\n            this.max_ = null;\n        };\n\n        this.accumulate = function (item: any) {\n            var val = item[this.field_];\n            if (val != null && val !== \"\" && !isNaN(val)) {\n                if (this.max_ == null || val > this.max_) {\n                    this.max_ = val;\n                }\n            }\n        };\n\n        this.storeResult = function (groupTotals: any) {\n            if (!groupTotals.max) {\n                groupTotals.max = {};\n            }\n            groupTotals.max[this.field_] = this.max_;\n        }\n    }\n\n    export function Sum(field: string): void {\n        this.field_ = field;\n        this.type_ = \"Sum\";\n\n        this.init = function () {\n            this.sum_ = null;\n        };\n\n        this.accumulate = function (item: any) {\n            var val = item[this.field_];\n            if (val != null && val !== \"\" && !isNaN(val)) {\n                this.sum_ += parseFloat(val);\n            }\n        };\n\n        this.storeResult = function (groupTotals: any) {\n            if (!groupTotals.sum) {\n                groupTotals.sum = {};\n            }\n            groupTotals.sum[this.field_] = this.sum_;\n        }\n    }\n}\n\nexport namespace AggregateFormatting {\n    export function formatMarkup<TItem = any>(totals: GroupTotals, column: Column<TItem>, aggType: string): string {\n        var textKey = (aggType.substring(0, 1).toUpperCase() + aggType.substring(1));\n        var text = tryGetText(\"Enums.Serenity.SummaryType.\" + textKey) ?? textKey;\n    \n        var value = (totals as any)[aggType][column.field];\n        var formattedValue = formatValue(column, value);\n    \n        return \"<span class='aggregate agg-\" + aggType + \"'  title='\" + htmlEncode(text) + \"'>\" +\n            formattedValue +\n            \"</span>\";\n    }\n\n    export function formatValue(column: Column, value: number): string {\n\n        var formatter = column.format ?? (column.formatter ? convertCompatFormatter(column.formatter) : null);\n\n        if (formatter != null) {\n            var item = new NonDataRow();\n            (item as any)[column.field] = value;\n            try {\n                return formatter({ column, escape, item, value });\n            }\n            catch (e) {\n            }\n        }\n\n        if (typeof value === \"number\") {\n            var displayFormat = column.sourceItem?.displayFormat ?? \"#,##0.##\";\n            return htmlEncode(formatNumber(value, displayFormat));\n        }\n        else\n            return htmlEncode(value);\n    }\n\n    export function groupTotalsFormatter<TItem = any>(totals: GroupTotals, column: Column<TItem>): string {\n        if (!totals || !column)\n            return \"\";\n    \n        var text: string = null;\n    \n        [\"sum\", \"avg\", \"min\", \"max\", \"cnt\"].forEach(function (aggType) {\n            if (text == null && (totals as any)[aggType] && (totals as any)[aggType][column.field] != null) {\n                text = formatMarkup(totals, column, aggType);\n                return false;\n            }\n        });\n    \n        return text || \"\";\n    }       \n}", "\uFEFFimport { deepClone, extend, htmlEncode, ListRequest, ListResponse, notifyError, ServiceResponse, localText } from \"../q\";\nimport { EventEmitter, EventData, Grid, gridDefaults, Group, GroupItemMetadataProvider, GroupTotals } from \"@serenity-is/sleekgrid\";\nimport { AggregateFormatting } from \"./aggregators\";\nimport { GroupInfo, PagingOptions, SummaryOptions } from \"./slicktypes\";\n\nexport interface RemoteViewOptions {\n    autoLoad?: boolean;\n    idField?: string;\n    contentType?: string;\n    dataType?: string;\n    filter?: any;\n    params?: any;\n    onSubmit?: CancellableViewCallback<any>;\n    url?: string;\n    localSort?: boolean;\n    sortBy?: any;\n    rowsPerPage?: number;\n    seekToPage?: number;\n    onProcessData?: RemoteViewProcessCallback<any>;\n    method?: string;\n    inlineFilters?: boolean;\n    groupItemMetadataProvider?: GroupItemMetadataProvider;\n    onAjaxCall?: RemoteViewAjaxCallback<any>;\n    getItemMetadata?: (p1?: any, p2?: number) => any;\n    errorMsg?: string;\n}\n    \nexport interface PagingInfo {\n    rowsPerPage: number;\n    page: number,\n    totalCount: number;\n    loading: boolean,\n    error: string;\n    dataView: RemoteView<any>\n}\n\nexport type CancellableViewCallback<TEntity> = (view: RemoteView<TEntity>) => boolean | void;\nexport type RemoteViewAjaxCallback<TEntity> = (view: RemoteView<TEntity>, options: JQueryAjaxSettings) => boolean | void;\nexport type RemoteViewFilter<TEntity> = (item: TEntity, view: RemoteView<TEntity>) => boolean;\nexport type RemoteViewProcessCallback<TEntity> = (data: ListResponse<TEntity>, view: RemoteView<TEntity>) => ListResponse<TEntity>;\n\nexport interface RemoteView<TEntity> {\n    onSubmit: CancellableViewCallback<TEntity>;\n    onDataChanged: EventEmitter;\n    onDataLoading: EventEmitter;\n    onDataLoaded: EventEmitter;\n    onPagingInfoChanged: EventEmitter;\n    onRowCountChanged: EventEmitter;\n    onRowsChanged: EventEmitter;\n    onRowsOrCountChanged: EventEmitter;\n    getPagingInfo(): PagingInfo;\n    onGroupExpanded: EventEmitter,\n    onGroupCollapsed: EventEmitter,\n    onAjaxCall: RemoteViewAjaxCallback<TEntity>;\n    onProcessData: RemoteViewProcessCallback<TEntity>;\n    addData(data: ListResponse<TEntity>): void;\n    beginUpdate(): void;\n    endUpdate(): void;\n    deleteItem(id: any): void;\n    getItems(): TEntity[];\n    setFilter(filter: RemoteViewFilter<TEntity>): void;\n    getFilter(): RemoteViewFilter<TEntity>;\n    getFilteredItems(): any;\n    getGroupItemMetadataProvider(): GroupItemMetadataProvider;\n    setGroupItemMetadataProvider(value: GroupItemMetadataProvider): void;\n    fastSort: any;\n    setItems(items: any[], newIdProperty?: boolean | string): void;\n    getIdPropertyName(): string;\n    getItemById(id: any): TEntity;\n    getGrandTotals(): any;\n    getGrouping(): GroupInfo<TEntity>[];\n    getGroups(): any[];\n    getRowById(id: any): number;\n    getRowByItem(item: any): number;\n    getRows(): any[];\n    mapItemsToRows(itemArray: any[]): any[];\n    mapRowsToIds(rowArray: number[]): any[];\n    mapIdsToRows(idAray: any[]): number[];\n    setFilterArgs(args: any): void;\n    setRefreshHints(hints: any[]): void;\n    insertItem(insertBefore: number, item: any): void;\n    sortedAddItem(item: any): void;\n    sortedUpdateItem(id: any, item: any): void;\n    syncGridSelection(grid: any, preserveHidden?: boolean, preserveHiddenOnSelectionChange?: boolean): void;\n    syncGridCellCssStyles(grid: any, key: string): void;\n    getItemMetadata(i: number): any;\n    updateItem(id: any, item: TEntity): void;\n    addItem(item: TEntity): void;\n    getIdxById(id: any): any;\n    getItemByIdx(index: number): any;\n    setGrouping(groupInfo: GroupInfo<TEntity>[]): void;\n    collapseAllGroups(level: number): void;\n    expandAllGroups(level: number): void;\n    expandGroup(keys: any[]): void;\n    collapseGroup(keys: any[]): void;\n    setSummaryOptions(options: SummaryOptions): void;\n    setPagingOptions(options: PagingOptions): void;\n    refresh(): void;\n    populate(): void;\n    populateLock(): void;\n    populateUnlock(): void;\n    getItem(row: number): any;\n    getLength(): number;\n    rowsPerPage: number;\n    errormsg: string;\n    params: any;\n    getLocalSort(): boolean;\n    setLocalSort(value: boolean): void;\n    sort(comparer?: (a: any, b: any) => number, ascending?: boolean): void;\n    reSort(): void;\n    sortBy: string[];\n    url: string;\n    method: string;\n    idField: string;\n    seekToPage?: number;\n}\n\nexport class RemoteView<TEntity> {\n    constructor(options: RemoteViewOptions) {\n        var self = this;\n\n        if (gridDefaults != null && gridDefaults.groupTotalsFormatter === void 0)\n            gridDefaults.groupTotalsFormatter = AggregateFormatting.groupTotalsFormatter;\n        \n        var idProperty: string;\n        var items: any[] = [];\n        var rows: any[] = [];\n        var idxById: Record<any, number> = {};\n        var rowsById: any = null;\n        var filter: any = null;\n        var updated: any = null;\n        var suspend = 0;\n\n        var sortAsc = true;\n        var fastSortField: string;\n        var sortComparer: any;\n        var refreshHints: any = {};\n        var prevRefreshHints: any = {};\n        var filterArgs: any;\n        var filteredItems: any = [];\n        var compiledFilter: any;\n        var compiledFilterWithCaching: any;\n        var filterCache: any[] = [];\n\n        var groupingInfoDefaults = {\n            getter: <any>null,\n            formatter: <any>null,\n            comparer: function (a: any, b: any) {\n                return (a.value === b.value ? 0 :\n                    (a.value > b.value ? 1 : -1)\n                );\n            },\n            predefinedValues: <any[]>[],\n            aggregateEmpty: false,\n            aggregateCollapsed: false,\n            aggregateChildGroups: false,\n            collapsed: false,\n            displayTotalsRow: true,\n            lazyTotalsCalculation: false\n        };\n        var summaryOptions: any = {};\n        var groupingInfos: any[] = [];\n        var groups: any[] = [];\n        var toggledGroupsByLevel: any[] = [];\n        var groupingDelimiter = ':|:';\n\n        var page = 1;\n        var totalRows = 0;\n\n        var onDataChanged: EventEmitter = new EventEmitter();\n        var onDataLoading: EventEmitter = new EventEmitter();\n        var onDataLoaded: EventEmitter = new EventEmitter();\n        var onGroupExpanded: EventEmitter = new EventEmitter();\n        var onGroupCollapsed: EventEmitter = new EventEmitter();\n        var onPagingInfoChanged: EventEmitter = new EventEmitter();\n        var onRowCountChanged: EventEmitter = new EventEmitter();\n        var onRowsChanged: EventEmitter = new EventEmitter();\n        var onRowsOrCountChanged: EventEmitter = new EventEmitter();\n\n        var loading: any = false;\n        var errorMessage: string = null;\n        var populateLocks = 0;\n        var populateCalls = 0;\n        var contentType: string;\n        var dataType: string;\n        var totalCount: number = null;\n        var groupItemMetadataProvider = options.groupItemMetadataProvider;\n        var localSort: boolean = options.localSort ?? false;\n\n        var intf: RemoteView<TEntity>;\n\n        function beginUpdate() {\n            suspend++;\n        }\n\n        function endUpdate() {\n            suspend--;\n            if (suspend <= 0)\n                refresh();\n        }\n\n        function setRefreshHints(hints: any) {\n            refreshHints = hints;\n        }\n\n        function setFilterArgs(args: any) {\n            filterArgs = args;\n        }\n\n        function updateIdxById(startingIndex?: number) {\n            startingIndex = startingIndex || 0;\n            var id: any;\n            for (var i = startingIndex, l = items.length; i < l; i++) {\n                id = items[i][idProperty];\n                if (id === undefined) {\n                    var msg = \"Each data element must implement a unique '\" +\n                        idProperty + \"' property. Object at index '\" + i + \"' \" +\n                        \"has no identity value: \";\n\n                    msg += (<any>$).toJSON(items[i]);\n                    throw msg;\n                }\n                idxById[id] = i;\n            }\n        }\n\n        function ensureIdUniqueness() {\n            var id: any;\n            for (var i = 0, l = items.length; i < l; i++) {\n                id = items[i][idProperty];\n                if (id === undefined || idxById[id] !== i) {\n                    var msg = \"Each data element must implement a unique '\" +\n                        idProperty + \"' property. Object at index '\" + i + \"' \";\n\n                    if (id == undefined)\n                        msg += \"has no identity value: \";\n                    else\n                        msg += \"has repeated identity value '\" + id + \"': \";\n\n                    msg += (<any>$).toJSON(items[i]);\n                    throw msg;\n                }\n            }\n        }\n\n        function getItems() {\n            return items;\n        }\n\n        function getIdPropertyName() {\n            return idProperty;\n        }\n\n        function setItems(data: any[], newIdProperty?: string | boolean) {\n            if (newIdProperty != null && typeof newIdProperty == \"string\")\n                idProperty = newIdProperty;\n\n            items = filteredItems = data;\n            if (localSort) {\n                items.sort(getSortComparer());\n            }\n\n            idxById = {};\n            rowsById = null;\n            summaryOptions.totals = {};\n            updateIdxById();\n            ensureIdUniqueness();\n\n            if (suspend) {\n                recalc(items);\n            }\n            else {\n                refresh();\n            }\n\n            onDataChanged.notify({ dataView: self }, null, self);\n        }\n\n        function setPagingOptions(args: any) {\n            var anyChange = false;\n\n            if (args.rowsPerPage != undefined &&\n                intf.rowsPerPage != args.rowsPerPage) {\n                intf.rowsPerPage = args.rowsPerPage;\n                anyChange = true;\n            }\n\n            if (args.page != undefined) {\n                var newPage: number;\n                if (!intf.rowsPerPage)\n                    newPage = 1;\n                else if (totalCount == null)\n                    newPage = args.page;\n                else\n                    newPage = Math.min(args.page, Math.ceil(totalCount / intf.rowsPerPage) + 1);\n\n                if (newPage < 1)\n                    newPage = 1;\n\n                if (newPage != page) {\n                    intf.seekToPage = newPage;\n                    anyChange = true;\n                }\n            }\n\n            if (anyChange)\n                populate();\n        }\n\n        function getPagingInfo(): PagingInfo {\n            return {\n                rowsPerPage: intf.rowsPerPage,\n                page: page,\n                totalCount: totalCount,\n                loading: loading,\n                error: errorMessage,\n                dataView: intf\n            };\n        }\n\n        function getSortComparer() {\n            if (sortComparer != null)\n                return sortComparer;\n\n            var cols: string[] = [];\n            var asc: boolean[] = [];\n            var sorts = intf.sortBy || [];\n            for (var s of sorts) {\n                if (s == null)\n                    continue;\n                if (s.length > 5 && s.toLowerCase().substr(s.length - 5).toLowerCase() == ' desc') {\n                    asc.push(false);\n                    cols.push(s.substr(0, s.length - 5));\n                }\n                else {\n                    asc.push(true);\n                    cols.push(s);\n                }\n            }\n            return function (a: any, b: any) {\n                for (var i = 0, l = cols.length; i < l; i++) {\n                    var field = cols[i];\n                    var sign = asc[i] ? 1 : -1;\n                    var value1 = a[field], value2 = b[field];\n                    var result = (value1 == value2 ? 0 : (value1 > value2 ? 1 : -1)) * sign;\n                    if (result != 0) {\n                        return result;\n                    }\n                }\n                return 0;\n            }\n        }\n\n        function sort(comparer?: (a: any, b: any) => number, ascending?: boolean) {\n            sortAsc = ascending;\n            fastSortField = null;\n            if (ascending === false) {\n                items.reverse();\n            }\n\n            sortComparer = comparer;\n            items.sort(getSortComparer());\n\n            if (ascending === false) {\n                items.reverse();\n            }\n            idxById = {};\n            updateIdxById();\n            refresh();\n        }\n\n        function getLocalSort(): boolean {\n            return localSort;\n        }\n\n        function setLocalSort(value: boolean) {\n            if (localSort != value) {\n                localSort = value;\n                sort();\n            }\n        }\n\n        /***\n         * Provides a workaround for the extremely slow sorting in IE.\n         * Does a [lexicographic] sort on a give column by temporarily overriding Object.prototype.toString\n         * to return the value of that field and then doing a native Array.sort().\n         */\n        function fastSort(field: any, ascending: boolean) {\n            sortAsc = ascending;\n            fastSortField = field;\n            sortComparer = null;\n            var oldToString = Object.prototype.toString;\n            Object.prototype.toString = (typeof field === \"function\") ? field : function () {\n                return this[field]\n            };\n            // an extra reversal for descending sort keeps the sort stable\n            // (assuming a stable native sort implementation, which isn't true in some cases)\n            if (ascending === false) {\n                items.reverse();\n            }\n            items.sort();\n            Object.prototype.toString = oldToString;\n            if (ascending === false) {\n                items.reverse();\n            }\n            idxById = {};\n            updateIdxById();\n            refresh();\n        }\n\n        function reSort() {\n            if (fastSortField)\n                fastSort(fastSortField, sortAsc);\n            else\n                sort(sortComparer, sortAsc);\n        }\n\n        function getFilteredItems() {\n            return filteredItems;\n        }\n\n        function getFilter() {\n            return filter;\n        }\n\n        function setFilter(filterFn: any) {\n            filter = filterFn;\n            if (options.inlineFilters) {\n                compiledFilter = compileFilter();\n                compiledFilterWithCaching = compileFilterWithCaching();\n            }\n            refresh();\n        }\n\n        function getGrouping() {\n            return groupingInfos;\n        }\n\n        function setSummaryOptions(summary: any) {\n            summary = summary || {};\n            summaryOptions.aggregators = summary.aggregators || [];\n            summaryOptions.compiledAccumulators = [];\n            summaryOptions.totals = {};\n            var idx = summaryOptions.aggregators.length;\n            while (idx--) {\n                summaryOptions.compiledAccumulators[idx] = compileAccumulatorLoop(summaryOptions.aggregators[idx]);\n            }\n            setGrouping(groupingInfos || []);\n        }\n\n        function getGrandTotals() {\n            summaryOptions.totals = summaryOptions.totals || {};\n\n            if (!summaryOptions.totals.initialized) {\n                summaryOptions.aggregators = summaryOptions.aggregators || [];\n                summaryOptions.compiledAccumulators = summaryOptions.compiledAccumulators || [];\n                var agg: any, idx = summaryOptions.aggregators.length;\n\n                while (idx--) {\n                    agg = summaryOptions.aggregators[idx];\n                    agg.init();\n                    summaryOptions.compiledAccumulators[idx].call(agg, items);\n                    agg.storeResult(summaryOptions.totals);\n                }\n                summaryOptions.totals.initialized = true;\n            }\n\n            return summaryOptions.totals;\n        }\n\n        function setGrouping(groupingInfo: any) {\n            if (!groupItemMetadataProvider) {\n                groupItemMetadataProvider = new GroupItemMetadataProvider();\n            }\n\n            groups = [];\n            toggledGroupsByLevel = [];\n            groupingInfo = groupingInfo || [];\n            groupingInfos = (groupingInfo instanceof Array) ? groupingInfo : [groupingInfo];\n\n            for (var i = 0; i < groupingInfos.length; i++) {\n                var gi = groupingInfos[i] = extend(extend<any>({}, groupingInfoDefaults), deepClone(groupingInfos[i]));\n                gi.aggregators = gi.aggregators || summaryOptions.aggregators || [];\n                gi.getterIsAFn = typeof gi.getter === \"function\";\n\n                // pre-compile accumulator loops\n                gi.compiledAccumulators = [];\n                var idx = gi.aggregators.length;\n                while (idx--) {\n                    gi.compiledAccumulators[idx] = compileAccumulatorLoop(gi.aggregators[idx]);\n                }\n\n                toggledGroupsByLevel[i] = {};\n            }\n\n            refresh();\n        }\n\n        function getItemByIdx(i: number) {\n            return items[i];\n        }\n\n        function getIdxById(id: any) {\n            return idxById[id];\n        }\n\n        function ensureRowsByIdCache() {\n            if (!rowsById) {\n                rowsById = {};\n                for (var i = 0, l = rows.length; i < l; i++) {\n                    rowsById[rows[i][idProperty]] = i;\n                }\n            }\n        }\n\n        function getRowByItem(item: any) {\n            ensureRowsByIdCache();\n            return rowsById[item[idProperty]];\n        }\n\n        function getRowById(id: any) {\n            ensureRowsByIdCache();\n            return rowsById[id];\n        }\n\n        function getItemById(id: any) {\n            return items[idxById[id]];\n        }\n\n        function mapItemsToRows(itemArray: any[]) {\n            var rows = [];\n            ensureRowsByIdCache();\n            for (var i = 0, l = itemArray.length; i < l; i++) {\n                var row = rowsById[itemArray[i][idProperty]];\n                if (row != null) {\n                    rows[rows.length] = row;\n                }\n            }\n            return rows;\n        }\n\n        function mapIdsToRows(idArray: any[]) {\n            var rows: any[] = [];\n            ensureRowsByIdCache();\n            for (var i = 0, l = idArray.length; i < l; i++) {\n                var row = rowsById[idArray[i]];\n                if (row != null) {\n                    rows[rows.length] = row;\n                }\n            }\n            return rows;\n        }\n\n        function mapRowsToIds(rowArray: any[]) {\n            var ids: any[] = [];\n            for (var i = 0, l = rowArray.length; i < l; i++) {\n                if (rowArray[i] < rows.length) {\n                    ids[ids.length] = rows[rowArray[i]][idProperty];\n                }\n            }\n            return ids;\n        }\n\n        function updateItem(id: any, item: any) {\n            if (idxById[id] === undefined) {\n                throw new Error(\"Invalid id\");\n            }\n\n            if (id !== item[idProperty]) {\n                // make sure the new id is unique:\n                var newId = item[idProperty];\n                if (newId == null) {\n                    throw new Error(\"Cannot update item to associate with a null id\");\n                }\n                if (idxById[newId] !== undefined) {\n                    throw new Error(\"Cannot update item to associate with a non-unique id\");\n                }\n                idxById[newId] = idxById[id];\n                delete idxById[id];\n\n                if (updated && updated[id]) {\n                    delete updated[id];\n                }\n\n                id = newId;\n            }\n            items[idxById[id]] = item;\n\n            if (!updated) {\n                updated = {};\n            }\n            updated[id] = true;\n            refresh();\n        }\n\n        function insertItem(insertBefore: number, item: any) {\n            items.splice(insertBefore, 0, item);\n            updateIdxById(insertBefore);\n            refresh();\n        }\n\n        function addItem(item: any) {\n            items.push(item);\n            updateIdxById(items.length - 1);\n            refresh();\n        }\n\n        function deleteItem(id: any) {\n            var idx = idxById[id];\n            if (idx === undefined) {\n                throw \"Invalid id\";\n            }\n            delete idxById[id];\n            items.splice(idx, 1);\n            updateIdxById(idx);\n            refresh();\n        }\n\n        function sortedAddItem(item: any) {\n            insertItem(sortedIndex(item), item);\n        }\n\n        function sortedUpdateItem(id: any, item: any) {\n            if (idxById[id] === undefined || id !== item[idProperty]) {\n                throw new Error(\"Invalid or non-matching id \" + idxById[id]);\n            }\n            var comparer = getSortComparer();\n            var oldItem = getItemById(id);\n            if (comparer(oldItem, item) !== 0) {\n                // item affects sorting -> must use sorted add\n                deleteItem(id);\n                sortedAddItem(item);\n            }\n            else { // update does not affect sorting -> regular update works fine\n                updateItem(id, item);\n            }\n        }\n\n        function sortedIndex(searchItem: any) {\n            var low = 0, high = items.length;\n            var comparer = getSortComparer();\n            while (low < high) {\n                var mid = low + high >>> 1;\n                if (comparer(items[mid], searchItem) === -1) {\n                    low = mid + 1;\n                }\n                else {\n                    high = mid;\n                }\n            }\n            return low;\n        }\n\n        function getRows() {\n            return rows;\n        }\n\n        function getLength() {\n            return rows.length;\n        }\n\n        function getItem(i: number) {\n            var item = rows[i];\n\n            // if this is a group row, make sure totals are calculated and update the title\n            if (item && item.__group && item.totals && !item.totals.initialized) {\n                var gi = groupingInfos[item.level];\n                if (!gi.displayTotalsRow) {\n                    calculateTotals(item.totals);\n                    item.title = gi.formatter ? gi.formatter(item) : htmlEncode(item.value);\n                }\n            }\n            // if this is a totals row, make sure it's calculated\n            else if (item && item.__groupTotals && !item.initialized) {\n                calculateTotals(item);\n            }\n\n            return item;\n        }\n\n        function getItemMetadata(i: number) {\n            var item = rows[i];\n            if (item === undefined) {\n                return null;\n            }\n\n            // overrides for grouping rows\n            if (item.__group) {\n                return groupItemMetadataProvider.getGroupRowMetadata(item);\n            }\n\n            // overrides for totals rows\n            if (item.__groupTotals) {\n                return groupItemMetadataProvider.getTotalsRowMetadata(item);\n            }\n\n            return (options.getItemMetadata && options.getItemMetadata(item, i)) || null;\n        }\n\n        function expandCollapseAllGroups(level: number, collapse: boolean) {\n            if (level == null) {\n                for (var i = 0; i < groupingInfos.length; i++) {\n                    toggledGroupsByLevel[i] = {};\n                    groupingInfos[i].collapsed = collapse;\n\n                    if (collapse === true) {\n                        onGroupCollapsed.notify({ level: i, groupingKey: null });\n                    } else {\n                        onGroupExpanded.notify({ level: i, groupingKey: null });\n                    }\n                }\n            } else {\n                toggledGroupsByLevel[level] = {};\n                groupingInfos[level].collapsed = collapse;\n\n                if (collapse === true) {\n                    onGroupCollapsed.notify({ level: level, groupingKey: null });\n                } else {\n                    onGroupExpanded.notify({ level: level, groupingKey: null });\n                }\n            }\n            refresh();\n        }\n\n        /**\n         * @param level {Number} Optional level to collapse.  If not specified, applies to all levels.\n         */\n        function collapseAllGroups(level: number) {\n            expandCollapseAllGroups(level, true);\n        }\n\n        /**\n         * @param level {Number} Optional level to expand.  If not specified, applies to all levels.\n         */\n        function expandAllGroups(level: number) {\n            expandCollapseAllGroups(level, false);\n        }\n\n        function resolveLevelAndGroupingKey(args: any) {\n            var arg0 = args[0];\n            if (args.length === 1 && arg0.indexOf(groupingDelimiter) !== -1) {\n                return { level: arg0.split(groupingDelimiter).length - 1, groupingKey: arg0 };\n            } else {\n                return { level: args.length - 1, groupingKey: args.join(groupingDelimiter) };\n            }\n        }\n\n        function expandCollapseGroup(args: any, collapse: any) {\n            var opts = resolveLevelAndGroupingKey(args);\n            toggledGroupsByLevel[opts.level][opts.groupingKey] = groupingInfos[opts.level].collapsed ^ collapse;\n            if (collapse)\n                onGroupCollapsed.notify({ level: opts.level, groupingKey: opts.groupingKey });\n            else\n                onGroupExpanded.notify({ level: opts.level, groupingKey: opts.groupingKey });\n\n            refresh();\n        }\n\n        /**\n         * @param varArgs Either a Slick.Group's \"groupingKey\" property, or a\n         *     variable argument list of grouping values denoting a unique path to the row.  For\n         *     example, calling collapseGroup('high', '10%') will collapse the '10%' subgroup of\n         *     the 'high' group.\n         */\n        function collapseGroup(varArgs: any[]) {\n            var args = Array.prototype.slice.call(arguments);\n            expandCollapseGroup(args, true);\n        }\n\n        /**\n         * @param varArgs Either a Slick.Group's \"groupingKey\" property, or a\n         *     variable argument list of grouping values denoting a unique path to the row.  For\n         *     example, calling expandGroup('high', '10%') will expand the '10%' subgroup of\n         *     the 'high' group.\n         */\n        function expandGroup(varArgs: any[]) {\n            var args = Array.prototype.slice.call(arguments);\n            expandCollapseGroup(args, false);\n        }\n\n        function getGroups() {\n            return groups;\n        }\n\n        function getOrCreateGroup(groupsByVal: any, val: any, level: number, parentGroup: any, groups: any[]) {\n            var group = groupsByVal[val];\n\n            if (!group) {\n                group = new Group<any>();\n                group.value = val;\n                group.level = level;\n                group.groupingKey = (parentGroup ? parentGroup.groupingKey + groupingDelimiter : '') + val;\n                groups[groups.length] = group;\n                groupsByVal[val] = group;\n            }\n\n            return group;\n        }\n\n        function extractGroups(rows: any[], parentGroup?: any) {\n            var group: any;\n            var val: any;\n            var groups: any[] = [];\n            var groupsByVal = {};\n            var r: any;\n            var level = parentGroup ? parentGroup.level + 1 : 0;\n            var gi = groupingInfos[level];\n\n            for (var i = 0, l: number = gi.predefinedValues.length; i < l; i++) {\n                val = gi.predefinedValues[i];\n                group = getOrCreateGroup(groupsByVal, val, level, parentGroup, groups);\n            }\n\n            for (var i = 0, l = rows.length; i < l; i++) {\n                r = rows[i];\n                val = gi.getterIsAFn ? gi.getter(r) : r[gi.getter];\n                group = getOrCreateGroup(groupsByVal, val, level, parentGroup, groups);\n\n                group.rows[group.count++] = r;\n            }\n\n            if (level < groupingInfos.length - 1) {\n                for (var i = 0; i < groups.length; i++) {\n                    group = groups[i];\n                    group.groups = extractGroups(group.rows, group);\n                }\n            }\n\n            if (groups.length) {\n                addTotals(groups, level);\n            }\n\n            groups.sort(groupingInfos[level].comparer);\n\n            return groups;\n        }\n\n        function calculateTotals(totals: any) {\n            var group = totals.group;\n            var gi = groupingInfos[group.level];\n            var isLeafLevel = (group.level == groupingInfos.length);\n            var agg: any, idx = gi.aggregators.length;\n\n            if (!isLeafLevel && gi.aggregateChildGroups) {\n                // make sure all the subgroups are calculated\n                var i = group.groups.length;\n                while (i--) {\n                    if (!group.groups[i].totals.initialized) {\n                        calculateTotals(group.groups[i].totals);\n                    }\n                }\n            }\n\n            while (idx--) {\n                agg = gi.aggregators[idx];\n                agg.init();\n                if (!isLeafLevel && gi.aggregateChildGroups) {\n                    gi.compiledAccumulators[idx].call(agg, group.groups);\n                } else {\n                    gi.compiledAccumulators[idx].call(agg, group.rows);\n                }\n                agg.storeResult(totals);\n            }\n            totals.initialized = true;\n        }\n\n        function addGroupTotals(group: any) {\n            var gi = groupingInfos[group.level];\n            var totals = new GroupTotals<TEntity>();\n            totals.group = group;\n            group.totals = totals;\n            if (!gi.lazyTotalsCalculation) {\n                calculateTotals(totals);\n            }\n        }\n\n        function addTotals(groups: any[], level?: number) {\n            level = level || 0;\n            var gi = groupingInfos[level];\n            var groupCollapsed = gi.collapsed;\n            var toggledGroups = toggledGroupsByLevel[level];\n            var idx = groups.length, g: any;\n            while (idx--) {\n                g = groups[idx];\n\n                if (g.collapsed && !gi.aggregateCollapsed) {\n                    continue;\n                }\n\n                // Do a depth-first aggregation so that parent group aggregators can access subgroup totals.\n                if (g.groups) {\n                    addTotals(g.groups, level + 1);\n                }\n\n                if (gi.aggregators.length && (\n                    gi.aggregateEmpty || g.rows.length || (g.groups && g.groups.length))) {\n                    addGroupTotals(g);\n                }\n\n                g.collapsed = groupCollapsed ^ toggledGroups[g.groupingKey];\n                g.title = gi.formatter ? gi.formatter(g) : htmlEncode(g.value);\n            }\n        }\n\n        function flattenGroupedRows(groups: any[], level?: number) {\n            level = level || 0;\n            var gi = groupingInfos[level];\n            var groupedRows: any[] = [], rows: any[], gl = 0, g: any;\n            for (var i = 0, l = groups.length; i < l; i++) {\n                g = groups[i];\n                groupedRows[gl++] = g;\n\n                if (!g.collapsed) {\n                    rows = g.groups ? flattenGroupedRows(g.groups, level + 1) : g.rows;\n                    for (var j = 0, jj = rows.length; j < jj; j++) {\n                        groupedRows[gl++] = rows[j];\n                    }\n                }\n\n                if (g.totals && gi.displayTotalsRow && (!g.collapsed || gi.aggregateCollapsed)) {\n                    groupedRows[gl++] = g.totals;\n                }\n            }\n            return groupedRows;\n        }\n\n        function getFunctionInfo(fn: any) {\n            var fnRegex = /^function[^(]*\\(([^)]*)\\)\\s*{([\\s\\S]*)}$/;\n            var matches = fn.toString().match(fnRegex);\n            return {\n                params: matches[1].split(\",\"),\n                body: matches[2]\n            };\n        }\n\n        function compileAccumulatorLoop(aggregator: any) {\n            var accumulatorInfo = getFunctionInfo(aggregator.accumulate);\n            var fn: any = new Function(\n                \"_items\",\n                \"for (var \" + accumulatorInfo.params[0] + \", _i=0, _il=_items.length; _i<_il; _i++) {\" +\n                accumulatorInfo.params[0] + \" = _items[_i]; \" +\n                accumulatorInfo.body +\n                \"}\"\n            );\n            return fn;\n        }\n\n        function compileFilter() {\n            var filterInfo = getFunctionInfo(filter);\n\n            var filterBody = filterInfo.body\n                .replace(/return false\\s*([;}]|$)/gi, \"{ continue _coreloop; }$1\")\n                .replace(/return true\\s*([;}]|$)/gi, \"{ _retval[_idx++] = $item$; continue _coreloop; }$1\")\n                .replace(/return ([^;}]+?)\\s*([;}]|$)/gi,\n                \"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2\");\n\n            // This preserves the function template code after JS compression,\n            // so that replace() commands still work as expected.\n            var tpl = [\n                //\"function(_items, _args) { \",\n                \"var _retval = [], _idx = 0; \",\n                \"var $item$, $args$ = _args; \",\n                \"_coreloop: \",\n                \"for (var _i = 0, _il = _items.length; _i < _il; _i++) { \",\n                \"$item$ = _items[_i]; \",\n                \"$filter$; \",\n                \"} \",\n                \"return _retval; \"\n                //\"}\"\n            ].join(\"\");\n            tpl = tpl.replace(/\\$filter\\$/gi, filterBody);\n            tpl = tpl.replace(/\\$item\\$/gi, filterInfo.params[0]);\n            tpl = tpl.replace(/\\$args\\$/gi, filterInfo.params[1]);\n\n            var fn: any = new Function(\"_items,_args\", tpl);\n            fn.displayName = fn.name = \"compiledFilter\";\n            return fn;\n        }\n\n        function compileFilterWithCaching() {\n            var filterInfo = getFunctionInfo(filter);\n\n            var filterBody = filterInfo.body\n                .replace(/return false\\s*([;}]|$)/gi, \"{ continue _coreloop; }$1\")\n                .replace(/return true\\s*([;}]|$)/gi, \"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1\")\n                .replace(/return ([^;}]+?)\\s*([;}]|$)/gi,\n                \"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2\");\n\n            // This preserves the function template code after JS compression,\n            // so that replace() commands still work as expected.\n            var tpl = [\n                //\"function(_items, _args, _cache) { \",\n                \"var _retval = [], _idx = 0; \",\n                \"var $item$, $args$ = _args; \",\n                \"_coreloop: \",\n                \"for (var _i = 0, _il = _items.length; _i < _il; _i++) { \",\n                \"$item$ = _items[_i]; \",\n                \"if (_cache[_i]) { \",\n                \"_retval[_idx++] = $item$; \",\n                \"continue _coreloop; \",\n                \"} \",\n                \"$filter$; \",\n                \"} \",\n                \"return _retval; \"\n                //\"}\"\n            ].join(\"\");\n            tpl = tpl.replace(/\\$filter\\$/gi, filterBody);\n            tpl = tpl.replace(/\\$item\\$/gi, filterInfo.params[0]);\n            tpl = tpl.replace(/\\$args\\$/gi, filterInfo.params[1]);\n\n            var fn: any = new Function(\"_items,_args,_cache\", tpl);\n            var fnName = \"compiledFilterWithCaching\";\n            fn.displayName = fnName;\n            fn.name = setFunctionName(fn, fnName);\n            return fn;\n        }\n\n        /**\n         * In ES5 we could set the function name on the fly but in ES6 this is forbidden and we need to set it through differently\n         * We can use Object.defineProperty and set it the property to writable, see MDN for reference\n         * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\n         * @param {string} fn\n         * @param {string} fnName\n         */\n        function setFunctionName(fn: Function, fnName: string) {\n            try {\n                Object.defineProperty(fn, 'name', {\n                    writable: true,\n                    value: fnName\n                });\n            } catch (err) {\n                (fn as any).name = fnName;\n            }\n        }\n\n        function uncompiledFilter(items: any[], args: any) {\n            var retval: any[] = [], idx = 0;\n\n            for (var i = 0, ii = items.length; i < ii; i++) {\n                if (filter(items[i], args)) {\n                    retval[idx++] = items[i];\n                }\n            }\n\n            return retval;\n        }\n\n        function uncompiledFilterWithCaching(items: any[], args: any, cache: any) {\n            var retval: any[] = [], idx = 0, item: any;\n\n            for (var i = 0, ii = items.length; i < ii; i++) {\n                item = items[i];\n                if (cache[i]) {\n                    retval[idx++] = item;\n                } else if (filter(item, args)) {\n                    retval[idx++] = item;\n                    cache[i] = true;\n                }\n            }\n\n            return retval;\n        }\n\n        function getFilteredAndPagedItems(items: any[]) {\n            if (filter) {\n                var batchFilter = options.inlineFilters ? compiledFilter : uncompiledFilter;\n                var batchFilterWithCaching = options.inlineFilters ? compiledFilterWithCaching : uncompiledFilterWithCaching;\n\n                if (refreshHints.isFilterNarrowing) {\n                    filteredItems = batchFilter(filteredItems, filterArgs);\n                } else if (refreshHints.isFilterExpanding) {\n                    filteredItems = batchFilterWithCaching(items, filterArgs, filterCache);\n                } else if (!refreshHints.isFilterUnchanged) {\n                    filteredItems = batchFilter(items, filterArgs);\n                }\n            } else {\n                // special case:  if not filtering and not paging, the resulting\n                // rows collection needs to be a copy so that changes due to sort\n                // can be caught\n                filteredItems = items.concat();\n            }\n\n            // get the current page\n            return { totalRows: filteredItems.length, rows: filteredItems };\n        }\n\n        function getRowDiffs(rows: any[], newRows: any[]) {\n            var item: any, r: any, eitherIsNonData: boolean, diff: any[] = [];\n            var from = 0, to = newRows.length;\n\n            if (refreshHints && refreshHints.ignoreDiffsBefore) {\n                from = Math.max(0,\n                    Math.min(newRows.length, refreshHints.ignoreDiffsBefore));\n            }\n\n            if (refreshHints && refreshHints.ignoreDiffsAfter) {\n                to = Math.min(newRows.length,\n                    Math.max(0, refreshHints.ignoreDiffsAfter));\n            }\n\n            for (var i = from, rl = rows.length; i < to; i++) {\n                if (i >= rl) {\n                    diff[diff.length] = i;\n                } else {\n                    item = newRows[i];\n                    r = rows[i];\n\n                    if ((groupingInfos.length && (eitherIsNonData = (item.__nonDataRow) || (r.__nonDataRow)) &&\n                        item.__group !== r.__group ||\n                        item.__group && !item.equals(r))\n                        || (eitherIsNonData &&\n                            // no good way to compare totals since they are arbitrary DTOs\n                            // deep object comparison is pretty expensive\n                            // always considering them 'dirty' seems easier for the time being\n                            (item.__groupTotals || r.__groupTotals))\n                        || item[idProperty] != r[idProperty]\n                        || (updated && updated[item[idProperty]])\n                    ) {\n                        diff[diff.length] = i;\n                    }\n                }\n            }\n            return diff;\n        }\n\n        function recalc(_items: any[]) {\n            rowsById = null;\n\n            if (refreshHints.isFilterNarrowing != prevRefreshHints.isFilterNarrowing ||\n                refreshHints.isFilterExpanding != prevRefreshHints.isFilterExpanding) {\n                filterCache = [];\n            }\n\n            var filteredItems = getFilteredAndPagedItems(_items);\n            totalRows = filteredItems.totalRows;\n            var newRows = filteredItems.rows;\n\n            summaryOptions.totals = {};\n\n            groups = [];\n            if (groupingInfos.length) {\n                groups = extractGroups(newRows);\n                if (groups.length) {\n                    newRows = flattenGroupedRows(groups);\n                }\n            }\n\n            var diff = getRowDiffs(rows, newRows);\n\n            rows = newRows;\n\n            return diff;\n        }\n\n        function refresh() {\n            if (suspend) {\n                return;\n            }\n\n            var countBefore = rows.length;\n            var totalRowsBefore = totalRows;\n\n            var diff = recalc(items); // pass as direct refs to avoid closure perf hit\n\n            updated = null;\n            prevRefreshHints = refreshHints;\n            refreshHints = {};\n\n            if (totalRowsBefore !== totalRows) {\n                onPagingInfoChanged.notify(getPagingInfo(), null, self);\n            }\n            if (countBefore !== rows.length) {\n                onRowCountChanged.notify({ previous: countBefore, current: rows.length, dataView: self }, null, self);\n            }\n            if (diff.length > 0) {\n                onRowsChanged.notify({ rows: diff, dataView: self }, null, self);\n            }\n            if (countBefore !== rows.length || diff.length > 0) {\n                onRowsOrCountChanged.notify({\n                    rowsDiff: diff, previousRowCount: countBefore, currentRowCount: rows.length,\n                    rowCountChanged: countBefore !== rows.length, rowsChanged: diff.length > 0, dataView: self\n                }, null, self);\n            }\n        }\n\n        /***\n         * Wires the grid and the DataView together to keep row selection tied to item ids.\n         * This is useful since, without it, the grid only knows about rows, so if the items\n         * move around, the same rows stay selected instead of the selection moving along\n         * with the items.\n         *\n         * NOTE:  This doesn't work with cell selection model.\n         *\n         * @param grid {Slick.Grid} The grid to sync selection with.\n         * @param preserveHidden {Boolean} Whether to keep selected items that go out of the\n         *     view due to them getting filtered out.\n         * @param preserveHiddenOnSelectionChange {Boolean} Whether to keep selected items\n         *     that are currently out of the view (see preserveHidden) as selected when selection\n         *     changes.\n         * @return {EventEmitter} An event that notifies when an internal list of selected row ids\n         *     changes.  This is useful since, in combination with the above two options, it allows\n         *     access to the full list selected row ids, and not just the ones visible to the grid.\n         * @method syncGridSelection\n         */\n        function syncGridSelection(grid: any, preserveHidden: boolean, preserveHiddenOnSelectionChange: boolean) {\n            var self = this;\n            var inHandler: any;\n            var selectedRowIds = self.mapRowsToIds(grid.getSelectedRows());\n            var onSelectedRowIdsChanged = new EventEmitter();\n\n            function setSelectedRowIds(rowIds: any[]) {\n                if (selectedRowIds.join(\",\") == rowIds.join(\",\")) {\n                    return;\n                }\n\n                selectedRowIds = rowIds;\n\n                onSelectedRowIdsChanged.notify({\n                    \"grid\": grid,\n                    \"ids\": selectedRowIds,\n                    \"dataView\": self\n                }, new EventData(), self);\n            }\n\n            function update() {\n                if (selectedRowIds.length > 0) {\n                    inHandler = true;\n                    var selectedRows = self.mapIdsToRows(selectedRowIds);\n                    if (!preserveHidden) {\n                        setSelectedRowIds(self.mapRowsToIds(selectedRows));\n                    }\n                    grid.setSelectedRows(selectedRows);\n                    inHandler = false;\n                }\n            }\n\n            grid.onSelectedRowsChanged.subscribe(function (e: any, args: any) {\n                if (inHandler) { return; }\n                var newSelectedRowIds = self.mapRowsToIds(grid.getSelectedRows());\n                if (!preserveHiddenOnSelectionChange || !grid.getOptions().multiSelect) {\n                    setSelectedRowIds(newSelectedRowIds);\n                } else {\n                    // keep the ones that are hidden\n                    var existing = $.grep(selectedRowIds, function (id) { return self.getRowById(id) === undefined; });\n                    // add the newly selected ones\n                    setSelectedRowIds(existing.concat(newSelectedRowIds));\n                }\n            });\n\n            this.onRowsChanged.subscribe(update);\n            this.onRowCountChanged.subscribe(update);\n\n            return onSelectedRowIdsChanged;\n        }\n\n        function syncGridCellCssStyles(grid: Grid, key: string) {\n            var hashById: any;\n            var inHandler: any;\n\n            // since this method can be called after the cell styles have been set,\n            // get the existing ones right away\n            storeCellCssStyles(grid.getCellCssStyles(key));\n\n            function storeCellCssStyles(hash: any) {\n                hashById = {};\n                for (var row in hash) {\n                    var id: any = (rows as any)[row][idProperty];\n                    hashById[id] = hash[row];\n                }   \n            }\n\n            function update() {\n                if (hashById) {\n                    inHandler = true;\n                    ensureRowsByIdCache();\n                    var newHash: Record<number, any> = {};\n                    for (var id in hashById) {\n                        var row = rowsById[id];\n                        if (row != undefined) {\n                            newHash[row] = hashById[id];\n                        }\n                    }\n                    grid.setCellCssStyles(key, newHash);\n                    inHandler = false;\n                }\n            }\n\n            var subFunc = function (e: any, args: any) {\n                if (inHandler) { return; }\n                if (key != args.key) { return; }\n                if (args.hash) {\n                    storeCellCssStyles(args.hash);\n                }\n                else {\n                    grid.onCellCssStylesChanged.unsubscribe(subFunc);\n                    onRowsOrCountChanged.unsubscribe(update);\n                }\n            };\n\n            grid.onCellCssStylesChanged.subscribe(subFunc);\n            onRowsOrCountChanged.subscribe(update);\n        }\n\n        function addData(data: any) {\n\n            if (intf.onProcessData && data)\n                data = intf.onProcessData(data, intf) || data;\n\n            errorMessage = null;\n            loading && loading.abort();\n            loading = false;\n\n            if (!data) {\n                errorMessage = intf.errormsg;\n                onPagingInfoChanged.notify(getPagingInfo());\n                return false;\n            }\n\n            data.TotalCount = data.TotalCount || 0;\n            data.Entities = data.Entities || [];\n\n            if (!data.Skip || (!intf.rowsPerPage && !data.Take))\n                data.Page = 1;\n            else\n                data.Page = Math.ceil(data.Skip / (data.Take || intf.rowsPerPage)) + 1;\n\n            page = data.Page;\n            totalCount = data.TotalCount;\n\n            setItems(data.Entities);\n\n            onPagingInfoChanged.notify(getPagingInfo());\n        }\n\n        function populate() {\n            if (populateLocks > 0) {\n                populateCalls++;\n                return;\n            }\n\n            populateCalls = 0;\n\n            loading && loading.abort();\n\n            if (intf.onSubmit) {\n                var gh = intf.onSubmit(intf);\n                if (gh === false)\n                    return false;\n            }\n\n            onDataLoading.notify(this);\n\n            if (!intf.url)\n                return false;\n\n            // set loading event\n        \n            if (!intf.seekToPage)\n                intf.seekToPage = 1;\n\n            var request: ListRequest = {};\n\n            var skip = (intf.seekToPage - 1) * intf.rowsPerPage;\n            if (skip)\n                request.Skip = skip;\n            if (intf.rowsPerPage)\n                request.Take = intf.rowsPerPage;\n\n            if (intf.sortBy && intf.sortBy.length) {\n                if (typeof intf.sortBy !== \"string\")\n                    request.Sort = intf.sortBy;\n                else {\n                    request.Sort = [intf.sortBy];\n                }\n            }\n\n            if (intf.params) {\n                request = extend(request, intf.params);\n            }\n\n            var dt = dataType;\n\n            var ajaxOptions = {\n                cache: false,\n                type: intf.method,\n                contentType: contentType,\n                url: intf.url,\n                data: request,\n                dataType: dt,\n                success: function (response: ServiceResponse) {\n                    loading = false;\n                    if (response.Error)\n                        notifyError(response.Error.Message || response.Error.Code);\n                    else\n                        addData(response);\n                    onDataLoaded.notify(this);\n                },\n                error: function (xhr: any, status: any, ev: any) {\n                    loading = false;\n\n                    if ((xhr.getResponseHeader(\"content-type\") || '').toLowerCase().indexOf(\"application/json\") >= 0) {\n                        var json = $.parseJSON(xhr.responseText);\n                        if (json != null && json.Error != null) {\n                            notifyError(json.Error.Message || json.Error.Code);\n                            onPagingInfoChanged.notify(getPagingInfo());\n                            onDataLoaded.notify(this);\n                            return;\n                        }\n                    }\n\n                    errorMessage = xhr.errormsg;\n                    onPagingInfoChanged.notify(getPagingInfo());\n                    onDataLoaded.notify(this);\n                },\n                complete: function () {\n                    loading = false;\n                }\n            }\n\n            if (intf.onAjaxCall) {\n                var ah = intf.onAjaxCall(this, ajaxOptions);\n                if (ah === false) {\n                    loading = false;\n                    onPagingInfoChanged.notify(getPagingInfo());\n                    return false;\n                }\n            }\n\n            ajaxOptions.data = (<any>$).toJSON(ajaxOptions.data);\n\n            onPagingInfoChanged.notify(getPagingInfo());\n            loading = $.ajax(ajaxOptions);\n        }\n\n        function populateLock() {\n            if (populateLocks == 0)\n                populateCalls = 0;\n            populateLocks++;\n        }\n\n        function populateUnlock() {\n            if (populateLocks > 0) {\n                populateLocks--;\n                if (populateLocks == 0 && populateCalls > 0)\n                    populate();\n            }\n        }\n\n        function getGroupItemMetadataProvider() {\n            return groupItemMetadataProvider;\n        }\n\n        function setGroupItemMetadataProvider(value: GroupItemMetadataProvider) {\n            groupItemMetadataProvider = value;\n        }\n\n        idProperty = options.idField || 'id';\n        contentType = options.contentType || \"application/json\";\n        dataType = options.dataType || 'json';\n        filter = options.filter || null;\n\n        intf = {\n            // methods\n            beginUpdate: beginUpdate,\n            endUpdate: endUpdate,\n            setPagingOptions: setPagingOptions,\n            getPagingInfo: getPagingInfo,\n            getIdPropertyName: getIdPropertyName,\n            getRows: getRows,\n            getItems: getItems,\n            setItems: setItems,\n            getFilter: getFilter,\n            getFilteredItems: getFilteredItems,\n            setFilter: setFilter,\n            sort: sort,\n            fastSort: fastSort,\n            reSort: reSort,\n            getLocalSort: getLocalSort,\n            setLocalSort: setLocalSort,\n            setSummaryOptions: setSummaryOptions,\n            getGrandTotals: getGrandTotals,\n            setGrouping: setGrouping,\n            getGrouping: getGrouping,\n            collapseAllGroups: collapseAllGroups,\n            expandAllGroups: expandAllGroups,\n            collapseGroup: collapseGroup,\n            expandGroup: expandGroup,\n            getGroups: getGroups,\n            getIdxById: getIdxById,\n            getRowByItem: getRowByItem,\n            getRowById: getRowById,\n            getItemById: getItemById,\n            getItemByIdx: getItemByIdx,\n            mapItemsToRows: mapItemsToRows,\n            mapRowsToIds: mapRowsToIds,\n            mapIdsToRows: mapIdsToRows,\n            setRefreshHints: setRefreshHints,\n            setFilterArgs: setFilterArgs,\n            refresh: refresh,\n            updateItem: updateItem,\n            insertItem: insertItem,\n            addItem: addItem,\n            deleteItem: deleteItem,\n            sortedAddItem: sortedAddItem,\n            sortedUpdateItem: sortedUpdateItem,\n            syncGridSelection: syncGridSelection,\n            syncGridCellCssStyles: syncGridCellCssStyles,\n\n            getLength: getLength,\n            getItem: getItem,\n            getItemMetadata: getItemMetadata,\n            getGroupItemMetadataProvider: getGroupItemMetadataProvider,\n            setGroupItemMetadataProvider: setGroupItemMetadataProvider,\n\n            onRowCountChanged: onRowCountChanged,\n            onRowsChanged: onRowsChanged,\n            onRowsOrCountChanged: onRowsOrCountChanged,\n            onPagingInfoChanged: onPagingInfoChanged,\n            onGroupExpanded: onGroupExpanded,\n            onGroupCollapsed: onGroupCollapsed,\n\n            addData: addData,\n            populate: populate,\n            populateLock: populateLock,\n            populateUnlock: populateUnlock,\n            onDataChanged: onDataChanged,\n            onDataLoaded: onDataLoaded,\n            onDataLoading: onDataLoading,\n            params: options.params || {},\n            onSubmit: options.onSubmit || null,\n            url: options.url || null,\n            rowsPerPage: options.rowsPerPage || 0,\n            seekToPage: options.seekToPage || 1,\n            onAjaxCall: options.onAjaxCall || null,\n            onProcessData: options.onProcessData || null,\n            method: options.method || \"POST\",\n            errormsg: localText(\"Controls.Pager.DefaultLoadError\"),\n            sortBy: typeof options.sortBy == \"string\" ? [options.sortBy] : (options.sortBy || []),\n            idField: idProperty\n        };\n\n        if (options.url && options.autoLoad) {\n            populate();\n        }\n\n        return intf;\n    }\n}\n", "import {\n    addAttribute, addTypeMember, MemberType, ISlickFormatter,\n    registerClass as regClass, registerEditor as regEditor, registerInterface as regIntf, registerEnum as regEnum,\n    startsWith,\n    EditorAttribute\n} from \"../q\";\n\nfunction Attr(name: string) {\n    return function (target: Function) {\n        return regClass(target, 'Serenity.' + name + 'Attribute');\n    }\n}\n\n@Attr('EnumKey')\nexport class EnumKeyAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('DisplayName')\nexport class DisplayNameAttribute {\n    constructor(public displayName: string) {\n    }\n}\n\n@Attr('Category')\nexport class CategoryAttribute {\n    constructor(public category: string) {\n    }\n}\n\n@Attr('ColumnsKey')\nexport class ColumnsKeyAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('CssClass')\nexport class CssClassAttribute {\n    constructor(public cssClass: string) {\n    }\n}\n\n@Attr('DefaultValue')\nexport class DefaultValueAttribute {\n    constructor(public value: any) {\n    }\n}\n\n@Attr('DialogType')\nexport class DialogTypeAttribute {\n    constructor(public value: any) {\n    }\n}\n\n@Attr('EditorOption')\nexport class EditorOptionAttribute {\n    constructor(public key: string, public value: any) {\n    }\n}\n\nexport class EditorTypeAttributeBase {\n    constructor(public editorType: string) {\n    }\n\n    public setParams(editorParams: any): void {\n    }\n}\n\nregClass(EditorTypeAttributeBase, 'Serenity.EditorTypeAttributeBase');\n\n@Attr('EditorType')\nexport class EditorTypeAttribute extends EditorTypeAttributeBase {\n    constructor(editorType: string) {\n        super(editorType);\n    }\n}\n\n@Attr('Element')\nexport class ElementAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('EntityType')\nexport class EntityTypeAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('Filterable')\nexport class FilterableAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('Flexify')\nexport class FlexifyAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('FormKey')\nexport class FormKeyAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('GeneratedCode')\nexport class GeneratedCodeAttribute {\n    constructor(public origin?: string) {\n    }\n}\n\n@Attr('Hidden')\nexport class HiddenAttribute {\n    constructor() {\n    }\n}\n\n@Attr('Hint')\nexport class HintAttribute {\n    constructor(public hint: string) {\n    }\n}\n\n@Attr('IdProperty')\nexport class IdPropertyAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('Insertable')\nexport class InsertableAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('IsActiveProperty')\nexport class IsActivePropertyAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('ItemName')\nexport class ItemNameAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('LocalTextPrefix')\nexport class LocalTextPrefixAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('Maximizable')\nexport class MaximizableAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('MaxLength')\nexport class MaxLengthAttribute {\n    constructor(public maxLength: number) {\n    }\n}\n\n@Attr('NameProperty')\nexport class NamePropertyAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('OneWay')\nexport class OneWayAttribute {\n}\n\n@Attr('Option')\nexport class OptionAttribute {\n}\n\n@Attr('OptionsType')\nexport class OptionsTypeAttribute {\n    constructor(public value: Function) {\n    }\n}\n\n@Attr('Panel')\nexport class PanelAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('Placeholder')\nexport class PlaceholderAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('ReadOnly')\nexport class ReadOnlyAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('Required')\nexport class RequiredAttribute {\n    constructor(public isRequired = true) {\n    }\n}\n\n@Attr('Resizable')\nexport class ResizableAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('Responsive')\nexport class ResponsiveAttribute {\n    constructor(public value = true) {\n    }\n}\n\n@Attr('Service')\nexport class ServiceAttribute {\n    constructor(public value: string) {\n    }\n}\n\n@Attr('Updatable')\nexport class UpdatableAttribute {\n    constructor(public value = true) {\n    }\n}\n\nexport namespace Decorators {\n\n    export function registerClass(nameOrIntf?: string | any[], intf2?: any[]) {\n        return function (target: Function) {\n            if (typeof nameOrIntf == \"string\")\n                regClass(target, nameOrIntf, intf2);\n            else\n                regClass(target, null, nameOrIntf);\n        }\n    }\n\n    export function registerInterface(nameOrIntf?: string | any[], intf2?: any[]) {\n        return function (target: Function) {\n\n            if (typeof nameOrIntf == \"string\")\n                regIntf(target, nameOrIntf, intf2);\n            else\n                regIntf(target, null, nameOrIntf);\n        }\n    }\n\n    export function registerEditor(nameOrIntf?: string | any[], intf2?: any[]) {\n        return function (target: Function) {\n            if (typeof nameOrIntf == \"string\")\n                regEditor(target, nameOrIntf, intf2);\n            else\n                regEditor(target, null, nameOrIntf);\n        }\n    }\n\n    export function registerEnum(target: any, enumKey?: string, name?: string) {\n        regEnum(target, name, enumKey);\n        if (enumKey)\n            addAttribute(target, new EnumKeyAttribute(enumKey));\n    }\n\n    export function registerEnumType(target: any, name?: string, enumKey?: string) {\n        registerEnum(target, enumKey ?? name, name);\n    }\n\n    export function registerFormatter(nameOrIntf: string | any[] = [ISlickFormatter],\n        intf2: any[] = [ISlickFormatter]) {\n        return registerClass(nameOrIntf, intf2);\n    }\n\n    export function enumKey(value: string) {\n        return function (target: Function) {\n            addAttribute(target, new EnumKeyAttribute(value));\n        }\n    }\n\n    export function option() {\n        return function (target: Object, propertyKey: string): void {\n\n            var isGetSet = startsWith(propertyKey, 'get_') || startsWith(propertyKey, 'set_');\n            var memberName = isGetSet ? propertyKey.substr(4) : propertyKey;\n\n            addTypeMember(target.constructor, {\n                name: memberName,\n                attr: [new OptionAttribute()],\n                type: isGetSet ? MemberType.property : MemberType.field,\n                getter: isGetSet ? ('get_' + memberName) : null,\n                setter: isGetSet ? ('set_' + memberName) : null\n            });\n        }\n    }\n\n    export function dialogType(value: any) {\n        return function (target: Function) {\n            addAttribute(target, new DialogTypeAttribute(value));\n        }\n    }\n\n    export function editor() {\n        return function (target: Function) {\n            var attr = new EditorAttribute();\n            addAttribute(target, attr);\n        }\n    }\n\n    export function element(value: string) {\n        return function (target: Function) {\n            addAttribute(target, new ElementAttribute(value));\n        }\n    }\n\n    export function filterable(value = true) {\n        return function (target: Function) {\n            addAttribute(target, new FilterableAttribute(value));\n        }\n    }\n\n    export function flexify(value = true) {\n        return function (target: Function) {\n            addAttribute(target, new FlexifyAttribute(value));\n        }\n    }\n\n    export function itemName(value: string) {\n        return function (target: Function) {\n            addAttribute(target, new ItemNameAttribute(value));\n        }\n    }\n\n    export function maximizable(value = true) {\n        return function (target: Function) {\n            addAttribute(target, new MaximizableAttribute(value));\n        }\n    }\n\n    export function optionsType(value: Function) {\n        return function (target: Function) {\n            addAttribute(target, new OptionsTypeAttribute(value));\n        }\n    }\n\n    export function panel(value = true) {\n        return function (target: Function) {\n            addAttribute(target, new PanelAttribute(value));\n        }\n    }\n\n    export function resizable(value = true) {\n        return function (target: Function) {\n            addAttribute(target, new ResizableAttribute(value));\n        }\n    }\n\n    export function responsive(value = true) {\n        return function (target: Function) {\n            addAttribute(target, new ResponsiveAttribute(value));\n        }\n    }\n\n    export function service(value: string) {\n        return function (target: Function) {\n            addAttribute(target, new ServiceAttribute(value));\n        }\n    }\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\n@Decorators.registerInterface(\"Serenity.IBooleanValue\")\nexport class IBooleanValue {\n}\n\nexport interface IBooleanValue {\n    get_value(): boolean;\n    set_value(value: boolean): void;\n}\n", "\uFEFFimport { Decorators } from \"../decorators\";\n\n@Decorators.registerInterface(\"Serenity.IDoubleValue\")\nexport class IDoubleValue {\n}\n\nexport interface IDoubleValue {\n    get_value(): any;\n    set_value(value: any): void;\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\n@Decorators.registerInterface('Serenity.IDialog')\nexport class IDialog {\n}\n\nexport interface IDialog {\n    dialogOpen(asPanel?: boolean): void;\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\n@Decorators.registerInterface('Serenity.IEditDialog')\nexport class IEditDialog {\n}\n\nexport interface IEditDialog {\n    load(entityOrId: any, done: () => void, fail?: (p1: any) => void): void;\n}\n", "\uFEFFimport { Decorators } from \"../decorators\";\nimport { PropertyItem } from \"../q\";\n\n@Decorators.registerInterface(\"Serenity.IGetEditValue\")\nexport class IGetEditValue {\n}\n\nexport interface IGetEditValue {\n    getEditValue(property: PropertyItem, target: any): void;\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\nexport interface IReadOnly {\n    get_readOnly(): boolean;\n    set_readOnly(value: boolean): void;\n}\n\n@Decorators.registerInterface('Serenity.IReadOnly')\nexport class IReadOnly {\n}\n", "\uFEFFimport { Decorators } from \"../decorators\";\nimport { PropertyItem } from \"../q\";\n\n@Decorators.registerInterface(\"Serenity.ISetEditValue\")\nexport class ISetEditValue {\n}\n\nexport interface ISetEditValue {\n    setEditValue(source: any, property: PropertyItem): void;\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\n@Decorators.registerInterface(\"Serenity.IStringValue\")\nexport class IStringValue {\n}\n\nexport interface IStringValue {\n    get_value(): string;\n    set_value(value: string): void;\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\nexport interface IValidateRequired {\n    get_required(): boolean;\n    set_required(value: boolean): void;\n}\n\n@Decorators.registerInterface('Serenity.IValidateRequired')\nexport class IValidateRequired {\n}", "\uFEFFimport { registerEnum } from \"../q\";\n\nexport {}\n\nexport enum CaptureOperationType {\n    Before = 0,\n    Delete = 1,\n    Insert = 2,\n    Update = 3\n}\n\nregisterEnum(CaptureOperationType, 'Serenity.CaptureOperationType');", "\uFEFFimport { isEmptyOrNull } from \"../q\";\n\nexport namespace ReflectionUtils {\n\n    export function getPropertyValue(o: any, property: string): any {\n        var d = o;\n        var getter = d['get_' + property];\n        if (!!!(typeof (getter) === 'undefined')) {\n            return getter.apply(o);\n        }\n        var camelCase = makeCamelCase(property);\n        getter = d['get_' + camelCase];\n        if (!!!(typeof (getter) === 'undefined')) {\n            return getter.apply(o);\n        }\n        return d[camelCase];\n    }\n\n    export function setPropertyValue(o: any, property: string, value: any): void {\n        var d = o;\n        var setter = d['set_' + property];\n        if (!!!(typeof (setter) === 'undefined')) {\n            setter.apply(o, [value]);\n            return;\n        }\n        var camelCase = makeCamelCase(property);\n        setter = d['set_' + camelCase];\n        if (!!!(typeof (setter) === 'undefined')) {\n            setter.apply(o, [value]);\n            return;\n        }\n        d[camelCase] = value;\n    }\n\n    export function makeCamelCase(s: string): string {\n        if (isEmptyOrNull(s)) {\n            return s;\n        }\n\n        if (s === 'ID') {\n            return 'id';\n        }\n\n        var hasNonUppercase = false;\n        var numUppercaseChars = 0;\n        for (var index = 0; index < s.length; index++) {\n            if (s.charCodeAt(index) >= 65 && s.charCodeAt(index) <= 90) {\n                numUppercaseChars++;\n            }\n            else {\n                hasNonUppercase = true;\n                break;\n            }\n        }\n\n        if (!hasNonUppercase && s.length !== 1 || numUppercaseChars === 0) {\n            return s;\n        }\n        else if (numUppercaseChars > 1) {\n            return s.substr(0, numUppercaseChars - 1).toLowerCase() + s.substr(numUppercaseChars - 1);\n        }\n        else if (s.length === 1) {\n            return s.toLowerCase();\n        }\n        else {\n            return s.substr(0, 1).toLowerCase() + s.substr(1);\n        }\n    }\n}", "\uFEFFimport { Config, endsWith, getType, getTypeNameProp, getTypes } from \"../q\";\n\nexport function commonTypeRegistry(isMatch: (type: any) => boolean, attrKey: (type: any) => string, suffix: string) {\n\n    let knownTypes: { [key: string]: any };\n\n    function reset() {\n        knownTypes = null;\n    }\n    \n    function search(key: string) {\n        var type = getType(key);\n        if (type != null && isMatch(type))\n            return type;\n\n        for (var ns of Config.rootNamespaces) {\n            var k = ns + \".\" + key;\n            type = knownTypes[k];\n            if (type)\n                return type;\n\n            type = getType(ns + '.' + key);\n            if (type != null && isMatch(type))\n                return type;\n        }\n    }\n\n    function init() {\n        knownTypes = {};\n        for (var type of getTypes()) {\n            if (!isMatch(type))\n                continue;\n\n            var fullName = getTypeNameProp(type);\n            knownTypes[fullName] = type;\n\n            var akey = attrKey && attrKey(type);\n            if (akey && akey !== fullName)\n                knownTypes[akey] = type;\n        }\n\n        if (suffix) {\n            for (var key of Object.keys(knownTypes)) {\n                if (key.endsWith(suffix)) {\n                    var p = key.substring(0, key.length - suffix.length);\n                    if (p && !knownTypes[p])\n                        knownTypes[p] = knownTypes[key];\n                }\n            }\n        }\n    }\n    \n    function tryGet(key: string): any {\n        if (!key)\n            return null;\n\n        var type;\n        if (knownTypes == null)\n            init();\n\n        var type = knownTypes[key];\n        if (type)\n            return type;\n\n        type = search(key);\n\n        if (type == null && suffix && !endsWith(key, suffix))\n            type = knownTypes[key + suffix] ?? search(key + suffix);\n\n        if (type) {\n            knownTypes[key] = type;\n\n            var akey = attrKey && attrKey(type);\n            if (akey && key != akey)\n                knownTypes[akey] = type;\n\n            if (suffix && key.endsWith(suffix)) {\n                var p = key.substring(0, key.length - suffix.length);\n                if (p && !knownTypes[p])\n                    knownTypes[p] = knownTypes[key];\n            }\n\n            return type;\n        }\n\n        return type;\n    }\n\n    return {\n        reset,\n        tryGet\n    }\n}", "\uFEFFimport { ArgumentNullException, Exception, htmlEncode, isAssignableFrom, isEmptyOrNull, notifyError } from \"../q\";\nimport { IDialog } from \"../interfaces\";\nimport { commonTypeRegistry } from \"./commontyperegistry\";\n\nexport namespace DialogTypeRegistry {\n\n    let registry = commonTypeRegistry(\n        type => isAssignableFrom(IDialog, type),\n        null, \"Dialog\");\n\n    export function get(key: string): any {\n\n        if (isEmptyOrNull(key))\n            throw new ArgumentNullException('key');\n\n        var type = registry.tryGet(key);\n\n        if (type)\n            return type;\n\n        var message = `\"${htmlEncode(key)}\" dialog class not found! \nMake sure there is such a dialog type under the project root namespace, \nand its namespace parts start with capital letters like MyProject.MyModule.MyDialog.\n\nIf using ES modules, make sure the dialog type has a decorator like \n@Decorators.registerClass('MyProject.MyModule.MyDialog') with the full name\nand \"side-effect-import\" this dialog class from the current \n\"page.ts/grid.ts/dialog.ts file (import \"./path/to/MyDialog.ts\").\n\nIf you had this error from an editor with the InplaceAdd option, verify that the lookup key\nand dialog type name match case-sensitively, excluding the Dialog suffix.\nSpecify the DialogType property in the LookupEditor attribute if it is not.\n\nAfter applying fixes, build and run \"node ./tsbuild.js\" (or \"tsc\" if using namespaces) \nfrom the project folder.`;\n\n        notifyError(message.replace(/\\r?\\n\\r?\\n/g, '<br/><br/>'), '', { escapeHtml: false, timeOut: 5000 });\n        throw new Exception(message);\n    }\n\n    export function reset() {\n        registry.reset();\n    }\n\n    export function tryGet(key: string) {\n        return registry.tryGet(key);\n    }\n}", "\uFEFFimport { isMobileView } from \"../q\";\n\nexport function jQueryPatch($: any) {\n    \n    function applyJQueryUIFixes(): boolean {\n        if (typeof $ == \"undefined\" || !$.ui || !$.ui.dialog || !$.ui.dialog.prototype)\n            return false;\n            \n        $.ui.dialog.prototype._allowInteraction = function (event: any) {\n            if ($(event.target).closest(\".ui-dialog\").length) {\n                return true;\n            }\n            return !!$(event.target).closest(\".ui-datepicker, .select2-drop, .cke, .cke_dialog, .modal, #support-modal\").length;\n        };\n\n        (function (orig) {\n            $.ui.dialog.prototype._focusTabbable = function () {\n                if (isMobileView) {\n                    this.uiDialog && this.uiDialog.focus();\n                    return;\n                }\n                orig.call(this);\n            }\n        })($.ui.dialog.prototype._focusTabbable);\n\n        (function (orig) {\n            $.ui.dialog.prototype._createTitlebar = function () {\n                orig.call(this);\n                this.uiDialogTitlebar.find('.ui-dialog-titlebar-close').html('<i class=\"fa fa-times\" />');\n            }\n        })($.ui.dialog.prototype._createTitlebar);\n    }\n\n    !applyJQueryUIFixes() && typeof $ !== \"undefined\" && $.fn && $(applyJQueryUIFixes);\n\n    if (typeof $ !== \"undefined\" && $.fn) {\n\n        // for backward compatibility\n        if (!$.toJSON)\n            $.toJSON = JSON.stringify;\n        if (!$.parseJSON)\n            $.parseJSON = JSON.parse;\n\n        ($ as any).cleanData = (function (orig) {\n            return function (elems: any[]) {\n                var events, elem, i, e;\n                var cloned = elems;\n                for (i = 0; (elem = cloned[i]) != null; i++) {\n                    try {\n                        events = ($ as any)._data(elem, \"events\");\n                        if (events && events.remove) {\n                            // html collection might change during remove event, so clone it!\n                            if (cloned === elems)\n                                cloned = Array.prototype.slice.call(elems);\n                            $(elem).triggerHandler(\"remove\");\n                            delete events.remove;\n                        }\n                    } catch (e) { }\n                }\n                orig(elems);\n            };\n        })(($ as any).cleanData);\n    }\n}", "\uFEFFimport $ from \"@optionaldeps/jquery\";\nimport { jQueryPatch } from \"../../patch/jquerypatch\";\nimport { Decorators, ElementAttribute } from \"../../decorators\";\nimport { IDialog } from \"../../interfaces\";\nimport { addValidationRule as addValRule, ArgumentNullException, Config, Exception, format, getAttributes, getInstanceType, getTypeFullName, getTypeShortName, isAssignableFrom, notifyError, replaceAll, startsWith } from \"../../q\";\n\nexport interface WidgetClass<TOptions = object> {\n    new(element: JQuery, options?: TOptions): Widget<TOptions>;\n    element: JQuery;\n}\n\nexport interface WidgetDialogClass<TOptions = object> {\n    new(options?: TOptions): Widget<TOptions> & IDialog;\n    element: JQuery;\n}\n\nexport type AnyWidgetClass<TOptions = object> = WidgetClass<TOptions> | WidgetDialogClass<TOptions>;\n\nexport function reactPatch() {\n    // @ts-ignore check for global\n    let globalObj: any = typeof (global) !== \"undefined\" ? global : (typeof (window) !== \"undefined\" ? window : (typeof (self) !== \"undefined\" ? self : null));\n\n    // @ts-ignore\n    if (typeof React === \"undefined\" && typeof globalObj !== \"undefined\") {\n        if (globalObj['preact'] != null) {\n            globalObj['React'] = globalObj['ReactDOM'] = globalObj['preact'];\n            // @ts-ignore\n            (React as any).Fragment = (React as any).Fragment ?? \"x-fragment\";\n        }\n        else if (globalObj['Nerv'] != null) {\n            globalObj['React'] = globalObj['ReactDOM'] = globalObj['Nerv'];\n            // @ts-ignore\n            (React as any).Fragment = (React as any).Fragment ?? \"x-fragment\";\n        }\n        else {\n            globalObj['React'] = {\n                Component: function () { } as any,\n                Fragment: \"x-fragment\" as any,\n                createElement: function () { return { _reactNotLoaded: true }; } as any\n            } as any\n            globalObj['ReactDOM'] = {\n                render: function () { throw Error(\"To use React, it should be included before Serenity.CoreLib.js\"); }\n            }\n        }\n    }\n}\n\nreactPatch();\n\nexport interface CreateWidgetParams<TWidget extends Widget<TOptions>, TOptions> {\n    type?: new (element: JQuery, options?: TOptions) => TWidget;\n    options?: TOptions;\n    container?: JQuery;\n    element?: (e: JQuery) => void;\n    init?: (w: TWidget) => void;\n}\n\n@Decorators.registerClass('Serenity.Widget')\nexport class Widget<TOptions = any> {\n    private static nextWidgetNumber = 0;\n    public element: JQuery;\n    protected options: TOptions;\n    protected widgetName: string;\n    protected uniqueName: string;\n    declare public readonly idPrefix: string;\n\n    constructor(element: JQuery, options?: TOptions) {\n\n        this.element = element;\n        this.options = options || ({} as TOptions);\n\n        this.widgetName = Widget.getWidgetName(getInstanceType(this));\n        this.uniqueName = this.widgetName + (Widget.nextWidgetNumber++).toString();\n\n        if (element.data(this.widgetName)) {\n            throw new Exception(format(\"The element already has widget '{0}'!\", this.widgetName));\n        }\n\n        element.on('remove.' + this.widgetName, e => {\n            if (e.bubbles || e.cancelable) {\n                return;\n            }\n            this.destroy();\n        }).data(this.widgetName, this);\n\n        this.addCssClass();\n\n        this.idPrefix = this.uniqueName + '_';\n        this.renderContents();\n    }\n\n    public destroy(): void {\n        if (this.element) {\n            this.element.removeClass(this.getCssClass());\n            this.element.off('.' + this.widgetName).off('.' + this.uniqueName).removeData(this.widgetName);\n            this.element = null;\n        }\n    }\n\n    protected addCssClass(): void {\n        this.element.addClass(this.getCssClass());\n    }\n\n    protected getCssClass(): string {\n        var type = getInstanceType(this);\n        var classList: string[] = [];\n        var fullClass = replaceAll(getTypeFullName(type), '.', '-');\n        classList.push(fullClass);\n\n        for (let k of Config.rootNamespaces) {\n            if (startsWith(fullClass, k + '-')) {\n                classList.push(fullClass.substr(k.length + 1));\n                break;\n            }\n        }\n\n        classList.push(getTypeShortName(type));\n        return classList\n            .filter((v, i, a) => a.indexOf(v) === i)\n            .map(s => 's-' + s)\n            .join(\" \");\n    }\n\n    public static getWidgetName(type: Function): string {\n        return replaceAll(getTypeFullName(type), '.', '_');\n    }\n\n    public static elementFor<TWidget>(editorType: { new (...args: any[]): TWidget }): JQuery {\n        var elementAttr = getAttributes(editorType, ElementAttribute, true);\n        var elementHtml = ((elementAttr.length > 0) ? elementAttr[0].value : '<input/>');\n        return $(elementHtml);\n    };\n\n    public addValidationRule(eventClass: string, rule: (p1: JQuery) => string): JQuery {\n        return addValRule(this.element, eventClass, rule);\n    }\n\n    public getGridField(): JQuery {\n        return this.element.closest('.field');\n    } \n\n    public change(handler: (e: JQueryEventObject) => void) {\n        this.element.on('change.' + this.uniqueName, handler);\n    };\n\n    public changeSelect2(handler: (e: JQueryEventObject) => void) {\n        this.element.on('change.' + this.uniqueName, function (e, valueSet) {\n            if (valueSet !== true)\n                handler(e);\n        });\n    };\n\n    public static create<TWidget extends Widget<TOpt>, TOpt>(params: CreateWidgetParams<TWidget, TOpt>) {\n        let widget: TWidget;\n\n        if (isAssignableFrom(IDialog, params.type)) {\n            widget = new (params.type as any)(params.options);\n            if (params.container)\n                widget.element.appendTo(params.container);\n            params.element && params.element(widget.element);\n        }\n        else {\n            var e = Widget.elementFor(params.type);\n            if (params.container)\n                e.appendTo(params.container);\n            params.element && params.element(e);\n            widget = new params.type(e, params.options);\n        }\n\n        widget.init(null);\n        params.init && params.init(widget);\n\n        return widget;\n    }\n\n    public initialize(): void {\n    }\n\n    public init(action?: (widget: any) => void): this {\n        action && action(this);\n        return this;\n    }\n\n    protected renderContents(): void {\n    }\n\n    private static __isWidgetType = true;\n}\n\nif (typeof $ !== \"undefined\" && $.fn) {\n    ($.fn as any).tryGetWidget = function (this: JQuery, type: any) {\n        var element = this;\n        var w;\n        if (isAssignableFrom(Widget, type)) {\n            var widgetName = Widget.getWidgetName(type);\n            w = element.data(widgetName);\n            if (w != null && !isAssignableFrom(type, getInstanceType(w))) {\n                w = null;\n            }\n            if (w != null) {\n                return w;\n            }\n        }\n\n        var data = element.data();\n        if (data == null) {\n            return null;\n        }\n\n        for (var key of Object.keys(data)) {\n            w = data[key];\n            if (w != null && isAssignableFrom(type, getInstanceType(w))) {\n                return w;\n            }\n        }\n\n        return null;\n    };\n\n    $.fn.getWidget = function<TWidget>(this: JQuery, type: { new (...args: any[]): TWidget }) {\n        if (this == null) {\n            throw new ArgumentNullException('element');\n        }\n        if (this.length === 0) {\n            throw new Exception(format(\"Searching for widget of type '{0}' on a non-existent element! ({1})\",\n                getTypeFullName(type), this.selector));\n        }\n\n        var w = (this as any).tryGetWidget(type);\n        if (w == null) {\n            var message = format(\"Element has no widget of type '{0}'! If you have recently changed \" +\n                \"editor type of a property in a form class, or changed data type in row (which also changes \" +\n                \"editor type) your script side Form definition might be out of date. Make sure your project \" +\n                \"builds successfully and transform T4 templates\", getTypeFullName(type));\n            notifyError(message, '', null);\n            throw new Exception(message);\n        }\n        return w;\n    };\n}\n\nexport interface WidgetComponentProps<W extends Widget<any>> {\n    id?: string;\n    name?: string;\n    className?: string;\n    maxLength?: number;\n    placeholder?: string;\n    setOptions?: any;\n    required?: boolean;\n    readOnly?: boolean;\n    oneWay?: boolean;\n    onChange?: (e: JQueryEventObject) => void;\n    onChangeSelect2?: (e: JQueryEventObject) => void;\n    value?: any;\n    defaultValue?: any;\n}\n\nexport declare interface Widget<TOptions> {\n    change(handler: (e: JQueryEventObject) => void): void;\n    changeSelect2(handler: (e: JQueryEventObject) => void): void;\n}\n\nif (typeof $ === \"function\") {\n    jQueryPatch($);\n}\n", "\uFEFFimport { ArgumentNullException, EditorAttribute, Exception, getAttributes, htmlEncode, isAssignableFrom, isEmptyOrNull, notifyError } from \"../q\";\nimport { Widget } from \"../ui/widgets/widget\";\nimport { commonTypeRegistry } from \"./commontyperegistry\";\n\nlet knownTypes: { [key: string] : any };\n\nexport namespace EditorTypeRegistry {\n    \n    let registry = commonTypeRegistry(\n        type => !!getAttributes(type, EditorAttribute).length || isAssignableFrom(Widget, type), \n        null, \"Editor\");\n\n    export function get(key: string): any {\n        if (isEmptyOrNull(key)) \n            throw new ArgumentNullException('key');\n        \n        var type = registry.tryGet(key);\n        if (type)\n            return type;\n\n        var message = `\"${htmlEncode(key)}\" editor class not found! \nMake sure there is such a editor type under the project root namespace,\nand its namespace parts start with capital letters like MyProject.MyModule.MyEditor.\n\nIf using ES modules, make sure the editor type has a decorator like \n@Decorators.registerEditor('MyProject.MyModule.MyFormatter') with the full name \nand \"side-effect-import\" this editor class from the current \n\"page.ts/grid.ts/dialog.ts file (import \"./path/to/MyEditor.ts\").\n\nAfter applying fixes, build and run \"node ./tsbuild.js\" (or \"tsc\" if using namespaces) \nfrom the project folder.`;\n\n        notifyError(message.replace(/\\r?\\n\\r?\\n/g, '<br/><br/>'), '', { escapeHtml: false, timeOut: 5000 });\n        throw new Exception(message);\n    }\n\n    export function reset() {\n        registry.reset();\n    }\n\n    export function tryGet(key: string) {\n        return registry.tryGet(key);\n    }\n}", "\uFEFFimport { Exception, getAttributes, htmlEncode, isEnum, notifyError } from \"../q\";\nimport { EnumKeyAttribute } from \"../decorators\";\nimport { commonTypeRegistry } from \"./commontyperegistry\";\n\nexport namespace EnumTypeRegistry {\n\n    let registry = commonTypeRegistry(\n        isEnum, \n        type => getAttributes(type, EnumKeyAttribute)[0]?.value,\n        null);\n\n    export function get(key: string): Function {\n        var type = registry.tryGet(key);\n        if (type)\n            return type;\n\n        var message = `Can't find \"${htmlEncode(key)}\" enum type! \nIf you have recently defined this enum type in server side code, make sure \nyour project builds successfully and run \"dotnet sergen t\". \n\nAlso verify there is such an enum type under the project root namespace, \nand its namespace parts start with capital letters like MyProject.MyModule.MyEnum.\n\nIf using ES modules, make sure the enum type is registered with \nQ.registerEnum('MyProject.MyModule.MyDialog') with the full name of \nyour enum type and \"side-effect-import\" this enum from the current \n\"page.ts/grid.ts/dialog.ts file (import \"./path/to/MyEnum.ts\").\n\nAfter applying fixes, build and run \"node ./tsbuild.js\" (or \"tsc\" if using namespaces) \nfrom the project folder.`;\n\n    notifyError(message.replace(/\\r?\\n\\r?\\n/g, '<br/><br/>'), '', { escapeHtml: false, timeOut: 5000 });\n    throw new Exception(message);\n    }\n\n    export function reset() {\n        registry.reset();\n    }\n\n    export function tryGet(key: string) {\n        return registry.tryGet(key);\n    }\n}", "\uFEFFimport { executeOnceWhenVisible, executeEverytimeWhenVisible } from \"../../q\";\n\nexport namespace LazyLoadHelper {\n    export const executeOnceWhenShown = executeOnceWhenVisible \n    export const executeEverytimeWhenShown = executeEverytimeWhenVisible;\n}", "\uFEFFexport {}\n\nexport class PrefixedContext {\n    constructor(public readonly idPrefix: string) {\n    }\n\n    byId(id: string): JQuery {\n        return $('#' + this.idPrefix + id);\n    }\n\n    w<TWidget>(id: string, type: { new (...args: any[]): TWidget }): TWidget {\n        return $('#' + this.idPrefix + id).getWidget<TWidget>(type);\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { htmlEncode, isEmptyOrNull, startsWith } from \"../../q\";\nimport { Widget } from \"./widget\";\n\nexport interface ToolButton {\n    action?: string;\n    title?: string;\n    hint?: string;\n    cssClass?: string;\n    icon?: string;\n    onClick?: any;\n    htmlEncode?: any;\n    hotkey?: string;\n    hotkeyAllowDefault?: boolean;\n    hotkeyContext?: any;\n    separator?: (false | true | 'left' | 'right' | 'both');\n    visible?: boolean | (() => boolean);\n    disabled?: boolean | (() => boolean);\n}\n\nexport interface PopupMenuButtonOptions {\n    menu?: JQuery;\n    onPopup?: () => void;\n    positionMy?: string;\n    positionAt?: string;\n}\n\n@Decorators.registerEditor('Serenity.PopupMenuButton')\nexport class PopupMenuButton extends Widget<PopupMenuButtonOptions> {\n    constructor(div: JQuery, opt: PopupMenuButtonOptions) {\n        super(div, opt);\n\n        div.addClass('s-PopupMenuButton');\n        div.click(e => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (this.options.onPopup != null) {\n                this.options.onPopup();\n            }\n\n            var menu = this.options.menu;\n            (menu.show() as any).position?.({\n                my: this.options.positionMy ?? 'left top',\n                at: this.options.positionAt ?? 'left bottom',\n                of: this.element\n            });\n\n            var uq = this.uniqueName;\n            $(document).one('click.' + uq, function (x) {\n                menu.hide();\n            });\n        });\n\n        (this.options.menu.hide().appendTo(document.body)\n            .addClass('s-PopupMenu') as any).menu?.();\n    }\n\n    destroy() {\n        if (this.options.menu != null) { \n            this.options.menu.remove();\n            this.options.menu = null;\n        }\n\n        super.destroy();\n    }\n}\n\n\nexport interface PopupToolButtonOptions extends PopupMenuButtonOptions {\n}\n\n@Decorators.registerEditor('Serenity.PopupToolButton')\nexport class PopupToolButton extends PopupMenuButton {\n    constructor(div: JQuery, opt: PopupToolButtonOptions) {\n        super(div, opt);\n\n        div.addClass('s-PopupToolButton');\n        $('<b/>').appendTo(div.children('.button-outer').children('span'));\n    }\n}\n\nexport interface ToolbarOptions {\n    buttons?: ToolButton[];\n    hotkeyContext?: any;\n}\n\n@Decorators.registerClass('Serenity.Toolbar')\nexport class Toolbar extends Widget<ToolbarOptions> {\n    constructor(div: JQuery, options: ToolbarOptions) {\n        super(div, options);\n\n        this.element.addClass('s-Toolbar clearfix')\n            .html('<div class=\"tool-buttons\"><div class=\"buttons-outer\">' +\n                '<div class=\"buttons-inner\"></div></div></div>');\n\n        this.createButtons();\n    }\n\n    destroy() {\n        this.element.find('div.tool-button').unbind('click');\n        if (this.mouseTrap) {\n            if (!!this.mouseTrap.destroy) {\n                this.mouseTrap.destroy();\n            }\n            else {\n                this.mouseTrap.reset();\n            }\n            this.mouseTrap = null;\n        }\n\n        super.destroy();\n    }\n\n    protected mouseTrap: any;\n\n    protected createButtons() {\n        var container: JQuery = $('div.buttons-inner', this.element).last();\n        var buttons = this.options.buttons;\n        var currentCount = 0;\n        for (var i = 0; i < buttons.length; i++) {\n            var button = buttons[i];\n            if (button.separator && currentCount > 0) {\n                container = $('<div class=\"buttons-inner\"></div>').appendTo(container.parent());\n                currentCount = 0;\n            }\n            this.createButton(container, button);\n            currentCount++;\n        }\n    }\n\n    protected createButton(container: JQuery, b: ToolButton) {\n        var cssClass = b.cssClass ?? '';\n\n        var btn = $('<div class=\"tool-button\"><div class=\"button-outer\">' +\n            '<span class=\"button-inner\"></span></div></div>')\n            .appendTo(container);\n\n        if (b.action != null)\n            btn.attr('data-action', b.action);\n\n        if (b.separator === 'right' || b.separator === 'both') {\n            $('<div class=\"separator\"></div>').appendTo(container);\n        }\n\n        if (cssClass.length > 0) {\n            btn.addClass(cssClass);\n        }\n\n        if (!isEmptyOrNull(b.hint)) {\n            btn.attr('title', b.hint);\n        }\n\n        btn.click(function (e) {\n            if (btn.hasClass('disabled')) {\n                return;\n            }\n            b.onClick(e);\n        });\n\n        var text = b.title;\n        if (b.htmlEncode !== false) {\n            text = htmlEncode(b.title);\n        }\n\n        if (!isEmptyOrNull(b.icon)) {\n            btn.addClass('icon-tool-button');\n            var klass = b.icon;\n            if (startsWith(klass, 'fa-')) {\n                klass = 'fa ' + klass;\n            }\n            else if (startsWith(klass, 'glyphicon-')) {\n                klass = 'glyphicon ' + klass;\n            }\n            text = \"<i class='\" + htmlEncode(klass) + \"'></i> \" + text;\n        }\n        if (text == null || text.length === 0) {\n            btn.addClass('no-text');\n        }\n        else {\n            btn.find('span').html(text);\n        }\n\n        if (b.visible === false)\n            btn.hide();\n\n        if (b.disabled != null && typeof b.disabled !== \"function\")\n            btn.toggleClass('disabled', !!b.disabled);\n\n        if (typeof b.visible === \"function\" || typeof b.disabled == \"function\") {\n            btn.on('updateInterface', () => {\n                if (typeof b.visible === \"function\")\n                    btn.toggle(!!b.visible());\n\n                if (typeof b.disabled === \"function\")\n                    btn.toggleClass(\"disabled\", !!b.disabled());\n            });\n        }\n\n        if (!!(!isEmptyOrNull(b.hotkey) && window['Mousetrap' as any] != null)) {\n            this.mouseTrap = this.mouseTrap || (window['Mousetrap' as any] as any)(\n                b.hotkeyContext || this.options.hotkeyContext || window.document.documentElement);\n\n            this.mouseTrap.bind(b.hotkey, function (e1: BaseJQueryEventObject, action: any) {\n                if (btn.is(':visible')) {\n                    btn.triggerHandler('click');\n                }\n                return b.hotkeyAllowDefault;\n            });\n        }\n    }\n\n    findButton(className: string): JQuery {\n        if (className != null && startsWith(className, '.')) {\n            className = className.substr(1);\n        }\n        return $('div.tool-button.' + className, this.element);\n    }\n\n    updateInterface() {\n        this.element.find('.tool-button').each(function (i: number, el: Element) {\n            $(el).triggerHandler('updateInterface')\n        });\n    }\n}\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { canLoadScriptData, Config, format, getBaseType, getInstanceType, getTemplate, getTypeFullName, getTypeShortName, replaceAll, startsWith, localText } from \"../../q\";\nimport { Widget } from \"./widget\";\n\n@Decorators.registerClass(\"Serenity.TemplatedWidget\")\nexport class TemplatedWidget<TOptions> extends Widget<TOptions> {\n\n    private static templateNames: { [key: string]: string } = {};\n\n    protected byId(id: string): JQuery {\n        return $('#' + this.idPrefix + id, this.element);\n    }\n\n    private byID<TWidget>(id: string, type: { new(...args: any[]): TWidget }) {\n        return this.byId(id).getWidget(type);\n    }\n\n    private static noGeneric(s: string): string {\n        var dollar = s.indexOf('$');\n        if (dollar >= 0) {\n            return s.substr(0, dollar);\n        }\n        return s;\n    }\n\n    private getDefaultTemplateName(): string {\n        return TemplatedWidget.noGeneric(getTypeShortName(\n            getInstanceType(this)));\n    }\n\n    protected getTemplateName(): string {\n\n        var type = getInstanceType(this);\n        var fullName = getTypeFullName(type);\n\n        var templateNames = TemplatedWidget.templateNames;\n\n        var cachedName = TemplatedWidget.templateNames[fullName];\n        if (cachedName != null) {\n            return cachedName;\n        }\n\n        while (type && type !== Widget) {\n            var name = TemplatedWidget.noGeneric(getTypeFullName(type));\n\n            for (let k of Config.rootNamespaces) {\n                if (startsWith(name, k + '.')) {\n                    name = name.substr(k.length + 1);\n                    break;\n                }\n            }\n\n            if (canLoadScriptData('Template.' + name)) {\n                templateNames[fullName] = name;\n                return name;\n            }\n\n            name = replaceAll(name, '.', '_');\n            if (canLoadScriptData('Template.' + name) ||\n                $('script#Template_' + name).length > 0) {\n                templateNames[fullName] = name;\n                return name;\n            }\n\n            name = TemplatedWidget.noGeneric(getTypeShortName(type));\n            if (canLoadScriptData('Template.' + name) ||\n                $('script#Template_' + name).length > 0) {\n                TemplatedWidget.templateNames[fullName] = name;\n                return name;\n            }\n\n            type = getBaseType(type);\n        }\n\n        templateNames[fullName] = cachedName = this.getDefaultTemplateName();\n        return cachedName;\n    }\n\n    protected getFallbackTemplate(): string {\n        return null;\n    }\n\n    protected getTemplate(): string {\n        var templateName = this.getTemplateName();\n\n        var script = $('script#Template_' + templateName);\n        if (script.length > 0) {\n            return script.html();\n        }\n\n        let template: string;\n        if (!canLoadScriptData('Template.' + templateName) &&\n            this.getDefaultTemplateName() == templateName) {\n            template = this.getFallbackTemplate();\n            if (template != null)\n                return template;\n        }\n\n        template = getTemplate(templateName);\n\n        if (template == null) {\n            throw new Error(format(\n                \"Can't locate template for widget '{0}' with name '{1}'!\",\n                getTypeFullName(getInstanceType(this)), templateName));\n        }\n\n        return template;\n    }\n\n    protected renderContents(): void {\n        var widgetMarkup = this.getTemplate().replace(new RegExp('~_', 'g'), this.idPrefix);\n\n        // for compatibility with older templates based on JsRender\n        var end = 0;\n        while (true) {\n            var idx = widgetMarkup.indexOf('{{text:\"', end);\n            if (idx < 0)\n                break;\n            var end = widgetMarkup.indexOf('\"}}', idx);\n            if (end < 0)\n                break;\n            var key = widgetMarkup.substr(idx + 8, end - idx - 8);\n            var txt = localText(key);\n            widgetMarkup = widgetMarkup.substr(0, idx) + txt + widgetMarkup.substr(end + 3);\n            end = idx + txt.length;\n        }\n\n        this.element.html(widgetMarkup);\n    }\n\n    protected useIdPrefix(): IdPrefixType {\n        return useIdPrefix(this.idPrefix);\n    }\n}\n\ntype IdPrefixType = { [key: string]: string, Form: string, Tabs: string, Toolbar: string, PropertyGrid: string };\n\nexport function useIdPrefix(prefix: string): IdPrefixType {\n    return new Proxy({ _: prefix ?? '' }, idPrefixHandler);\n}\n\nconst idPrefixHandler = {\n    get(target: any, p: string) {\n        if (p.startsWith('#'))\n            return '#' + target._ + p.substring(1);\n\n        return target._ + p;\n    }\n};", "\uFEFFimport { Widget } from \"./widget\";\nimport { LazyLoadHelper } from \"../helpers/lazyloadhelper\";\n\nif (typeof $ !== \"undefined\" && $.fn) {\n    $.fn.flexHeightOnly = function (flexY: number = 1) {\n        return this.flexWidthHeight(0, flexY);\n    }\n\n    $.fn.flexWidthOnly = function (flexX: number = 1) {\n        return this.flexWidthHeight(flexX, 0);\n    }\n\n    $.fn.flexWidthHeight = function (flexX: number = 1, flexY: number = 1) {\n        return this.addClass('flexify').data('flex-x', flexX).data('flex-y', flexY);\n    }\n\n    $.fn.flexX = function (flexX: number): JQuery {\n        return this.data('flex-x', flexX);\n    }\n\n    $.fn.flexY = function (flexY: number): JQuery {\n        return this.data('flex-y', flexY);\n    }\n}\n\nexport class Flexify extends Widget<FlexifyOptions> {\n    private xDifference = 0;\n    private yDifference = 0;\n    constructor(container: JQuery, options: FlexifyOptions) {\n        super(container, options);\n\n        LazyLoadHelper.executeOnceWhenShown(container, () => {\n            this.storeInitialSize();\n        });\n    }\n\n    storeInitialSize() {\n        if (!!this.element.data('flexify-init')) {\n            return;\n        }\n\n        var designWidth = this.options.designWidth;\n        if (designWidth == null)\n            designWidth = this.element.width();\n        this.element.data('flexify-width', designWidth);\n\n        var designHeight = this.options.designHeight;\n        if (designHeight == null)\n            designHeight = this.element.height();\n        this.element.data('flexify-height', designHeight);\n\n        this.element.data('flexify-init', true);\n\n        this.element.on('resize.' + this.uniqueName, () =>\n            this.resizeElements());\n\n        this.element.on('resizestop.' + this.uniqueName, () =>\n            this.resizeElements());\n        \n        var tabs = this.element.find('.ui-tabs');\n        if (tabs.length > 0) {\n            tabs.on('tabsactivate.' + this.uniqueName, () =>\n                this.resizeElements());\n        }\n\n        if (this.options.designWidth != null || this.options.designHeight != null) \n            this.resizeElements();\n    }\n\n    private getXFactor(element: JQuery): number {\n        var xFactor = null;\n        if (this.options.getXFactor != null)\n            xFactor = this.options.getXFactor(element);\n\n        if (xFactor == null)\n            xFactor = element.data('flex-x');\n\n        return xFactor ?? 1;\n    }\n\n    private getYFactor(element: JQuery): number {\n        var yFactor = null;\n\n        if (this.options.getYFactor != null) \n            yFactor = this.options.getYFactor(element);\n\n        if (yFactor == null) \n            yFactor = element.data('flex-y');\n\n        return yFactor ?? 0;\n    }\n\n    private resizeElements(): void {\n        var width = this.element.width();\n        var initialWidth = this.element.data('flexify-width');\n        if (initialWidth == null) {\n            this.element.data('flexify-width', width);\n            initialWidth = width;\n        }\n\n        var height = this.element.height();\n        var initialHeight = this.element.data('flexify-height');\n        if (initialHeight == null) {\n            this.element.data('flexify-height', height);\n            initialHeight = height;\n        }\n\n        this.xDifference = width - initialWidth;\n        this.yDifference = height - initialHeight;\n\n        var containers = this.element;\n        var tabPanels = this.element.find('.ui-tabs-panel');\n\n        if (tabPanels.length > 0) {\n            containers = tabPanels.filter(':visible');\n        }\n\n        containers.find('.flexify')\n            .add(tabPanels.filter('.flexify:visible'))\n            .each((i, e) => {\n                this.resizeElement($(e as any));\n            });\n    }\n\n    private resizeElement(element: JQuery): void {\n        var xFactor = this.getXFactor(element);\n        if(xFactor !== 0) {\n            var initialWidth = element.data('flexify-width');\n            if (initialWidth == null) {\n                var width = element.width();\n                element.data('flexify-width', width);\n                initialWidth = width;\n            }\n\n            element.width(initialWidth + xFactor * this.xDifference | 0);\n        }\n\n        var yFactor = this.getYFactor(element);\n        if (yFactor !== 0) {\n            var initialHeight = element.data('flexify-height');\n            if (initialHeight == null) {\n                var height = element.height();\n                element.data('flexify-height', height);\n                initialHeight = height;\n            }\n            element.height(initialHeight + yFactor * this.yDifference | 0);\n        }\n\n        if (element.hasClass('require-layout')) {\n            element.triggerHandler('layout');\n        }\n    }\n}\n\nexport interface FlexifyOptions {\n    getXFactor?: (p1: JQuery) => any;\n    getYFactor?: (p1: JQuery) => any;\n    designWidth?: any;\n    designHeight?: any;\n}", "\uFEFFimport { Flexify } from \"../widgets/flexify\";\n\nexport namespace DialogExtensions {\n\n    export function dialogResizable(dialog: JQuery, w?: any, h?: any, mw?: any, mh?: any): JQuery {\n        var dlg = (dialog as any)?.dialog?.();\n        dlg.dialog('option', 'resizable', true);\n        if (mw != null) {\n            dlg.dialog('option', 'minWidth', mw);\n        }\n        if (w != null) {\n            dlg.dialog('option', 'width', w);\n        }\n        if (mh != null) {\n            dlg.dialog('option', 'minHeight', mh);\n        }\n        if (h != null) {\n            dlg.dialog('option', 'height', h);\n        }\n        return dialog;\n    }\n\n    export function dialogMaximizable(dialog: JQuery): JQuery {\n        (dialog as any).dialogExtend({\n            closable: true,\n            maximizable: true,\n            dblclick: 'maximize',\n            icons: { maximize: 'ui-icon-maximize-window' }\n        });\n\n        return dialog;\n    }\n\n    export function dialogFlexify(dialog: JQuery): JQuery {\n        new Flexify(dialog.closest('.ui-dialog'), {});\n        return dialog;\n    }\n}", "\uFEFFimport { Decorators, FlexifyAttribute, MaximizableAttribute, PanelAttribute, ResizableAttribute, ResponsiveAttribute } from \"../../decorators\";\nimport { IDialog } from \"../../interfaces\";\nimport { bsModalMarkup, closePanel, Config, DialogButton, dialogButtonToBS, dialogButtonToUI, endsWith, getAttributes, getInstanceType, isEmptyOrNull, isMobileView, layoutFillHeight, newBodyDiv, openPanel, parseInteger, positionToastContainer, validateOptions } from \"../../q\";\nimport { TemplatedWidget } from \"../widgets/templatedwidget\";\nimport { Toolbar, ToolButton } from \"../widgets/toolbar\";\nimport { DialogExtensions } from \"./dialogextensions\";\nimport validator from \"@optionaldeps/jquery.validation\";\n\n@Decorators.registerClass('Serenity.TemplatedDialog', [IDialog])\nexport class TemplatedDialog<TOptions> extends TemplatedWidget<TOptions> {\n\n    protected tabs: JQuery;\n    protected toolbar: Toolbar;\n    protected validator: JQueryValidation.Validator;\n\n    constructor(options?: TOptions) {\n        super(newBodyDiv().addClass('s-TemplatedDialog hidden'), options);\n\n        this.element.attr(\"id\", this.uniqueName);\n\n        this.initValidator();\n        this.initTabs();\n        this.initToolbar();\n    }\n\n    private get isMarkedAsPanel() {\n        var panelAttr = getAttributes(getInstanceType(this),\n            PanelAttribute, true) as PanelAttribute[];\n        return panelAttr.length > 0 && panelAttr[panelAttr.length - 1].value !== false;\n    }\n\n    private get isResponsive() {\n        return Config.responsiveDialogs ||\n            getAttributes(getInstanceType(this), ResponsiveAttribute, true).length > 0;\n    }\n\n    private static getCssSize(element: JQuery, name: string): number {\n        var cssSize = element.css(name);\n        if (cssSize == null) {\n            return null;\n        }\n\n        if (!endsWith(cssSize, 'px')) {\n            return null;\n        }\n\n        cssSize = cssSize.substr(0, cssSize.length - 2);\n        let i = parseInteger(cssSize);\n        if (i == null || isNaN(i) || i == 0)\n            return null;\n\n        return i;\n    }\n\n    private static applyCssSizes(opt: any, dialogClass: string) {\n        let size: number;\n        let dialog = $('<div/>').hide().addClass(dialogClass).appendTo(document.body);\n        try {\n            var sizeHelper = $('<div/>').addClass('size').appendTo(dialog);\n            size = TemplatedDialog.getCssSize(sizeHelper, 'minWidth'); \n            if (size != null)\n                opt.minWidth = size;\n\n            size = TemplatedDialog.getCssSize(sizeHelper, 'width');\n            if (size != null)\n                opt.width = size;\n\n            size = TemplatedDialog.getCssSize(sizeHelper, 'height');\n            if (size != null)\n                opt.height = size;\n\n            size = TemplatedDialog.getCssSize(sizeHelper, 'minHeight');\n            if (size != null)\n                opt.minHeight = size;\n        }\n        finally {\n            dialog.remove();\n        }\n    };\n\n    public destroy(): void {\n        (this.tabs as any)?.tabs?.('destroy');\n        this.tabs = null;\n        (this.toolbar as any)?.toolbar?.destroy?.();\n        this.toolbar = null;\n        this.validator && this.byId('Form').remove();\n        this.validator = null;\n        if (this.element != null &&\n            this.element.hasClass('ui-dialog-content')) {\n            (this.element as any)?.dialog?.('destroy');\n            this.element.removeClass('ui-dialog-content');\n        }\n        else if (this.element != null &&\n            this.element.hasClass('modal-body')) {\n            var modal = this.element.closest('.modal').data('bs.modal', null);\n            this.element && this.element.removeClass('modal-body');\n            window.setTimeout(() => modal.remove(), 0);\n        }\n        \n        $(window).unbind('.' + this.uniqueName);\n        super.destroy();\n    }\n\n    protected initDialog(): void {\n        if (this.element.hasClass('ui-dialog-content'))\n            return;\n\n        this.element.removeClass('hidden');\n\n        (this.element as any)?.dialog?.(this.getDialogOptions());\n        this.element.closest('.ui-dialog').on('resize', e => this.arrange());\n\n        let type = getInstanceType(this);\n\n        if (this.isResponsive) {\n            DialogExtensions.dialogResizable(this.element);\n\n            $(window).bind('resize.' + this.uniqueName, e => {\n                if (this.element && this.element.is(':visible')) {\n                    this.handleResponsive();\n                }\n            });\n\n            this.element.closest('.ui-dialog').addClass('flex-layout');\n        }\n        else if (DialogExtensions[\"dialogFlexify\"] &&\n            getAttributes(type, FlexifyAttribute, true).length > 0) {\n            DialogExtensions[\"dialogFlexify\"](this.element);\n            DialogExtensions.dialogResizable(this.element);\n        }\n        \n        if (getAttributes(type, MaximizableAttribute, true).length > 0) {\n            DialogExtensions.dialogMaximizable(this.element);\n        }\n\n        var self = this;\n        this.element.bind('dialogopen.' + this.uniqueName, () => {\n            $(document.body).addClass('modal-dialog-open');\n\n            if (this.isResponsive) {\n                this.handleResponsive();\n            }\n\n            self.onDialogOpen();\n        });\n\n        this.element.bind('dialogclose.' + this.uniqueName, () => {\n            $(document.body).toggleClass('modal-dialog-open', $('.ui-dialog:visible').length > 0);\n            self.onDialogClose();\n        });\n    }\n\n    protected getModalOptions(): ModalOptions {\n        return {\n            backdrop: false,\n            keyboard: false,\n            size: 'lg',\n            modalClass: this.getCssClass()\n        }\n    }\n\n    protected initModal(): void {\n        if (this.element.hasClass('modal-body'))\n            return;\n        \n        var title = this.element.data('dialogtitle') ?? this.getDialogTitle() ?? '';\n        var opt = this.getModalOptions();\n        (opt as any)[\"show\"] = false;\n        var modalClass = \"s-Modal\";\n        \n        if (opt.modalClass)\n            modalClass += ' ' + opt.modalClass;\n\n        var div = bsModalMarkup(title, '', modalClass);\n        var modal = $(div).appendTo(document.body).addClass('flex-layout');\n        modal.one('shown.bs.modal.' + this.uniqueName, () => {\n            this.element.triggerHandler('shown.bs.modal');\n            this.onDialogOpen();\n        });\n\n        modal.one('hidden.bs.modal.' + this.uniqueName, () => {\n            $(document.body).toggleClass('modal-open', $('.modal.show').length + $('.modal.in').length > 0);\n            this.onDialogClose();\n        });\n        if (opt.size)\n            modal.find('.modal-dialog').addClass('modal-' + opt.size);\n\n        var footer = modal.find('.modal-footer');\n        var buttons = this.getDialogButtons();\n        if (buttons != null) {\n            for (var x of buttons) {\n                $(dialogButtonToBS(x)).appendTo(footer).click(x.click);\n            }\n        }\n        else\n            footer.hide();\n\n        (modal as any).modal(opt);\n        modal.find('.modal-body').replaceWith(this.element.removeClass('hidden').addClass('modal-body'));\n        $(window).on('resize.' + this.uniqueName, this.arrange.bind(this));\n    }\n\n    protected initToolbar(): void {\n        var toolbarDiv = this.byId('Toolbar');\n        if (toolbarDiv.length === 0) {\n            return;\n        }\n\n        var hotkeyContext = this.element.closest('.ui-dialog');\n        if (hotkeyContext.length === 0) {\n            hotkeyContext = this.element.closest('.modal');\n            if (hotkeyContext.length == 0)\n                hotkeyContext = this.element;\n        }\n\n        var opt = { buttons: this.getToolbarButtons(), hotkeyContext: hotkeyContext[0] };\n        this.toolbar = new Toolbar(toolbarDiv, opt);\n    }\n\n    protected getToolbarButtons(): ToolButton[] {\n        return [];\n    }\n\n    protected getValidatorOptions(): JQueryValidation.ValidationOptions {\n        return {};\n    }\n\n    protected initValidator(): void {\n        var form = this.byId('Form');\n        if (form.length > 0) {\n            var valOptions = this.getValidatorOptions();\n            this.validator = (validator || form.validate) && form.validate(validateOptions(valOptions));\n        }\n    }\n\n    protected resetValidation() {\n        this.validator && (this.validator as any).resetAll();\n    }\n\n    protected validateForm() {\n        return this.validator == null || !!this.validator.form();\n    }\n\n    public dialogOpen(asPanel?: boolean): void {\n        asPanel = asPanel ?? this.isMarkedAsPanel;\n        if (asPanel) {\n            if (!this.element.hasClass('s-Panel')) {\n                // so that panel title is created if needed\n                this.element.on('panelopen.' + this.uniqueName, () => {\n                    this.onDialogOpen();\n                });\n                this.element.on('panelclose.' + this.uniqueName, () => {\n                    this.onDialogClose();\n                });\n            }\n\n            TemplatedDialog.openPanel(this.element, this.uniqueName);\n            this.setupPanelTitle();\n        }\n        else if (this.useBSModal()) {\n            this.initModal();\n            (this.element.closest('.modal') as any).modal('show');\n        }\n        else {\n            this.initDialog();\n            (this.element as any).dialog?.('open');\n        }\n    }\n\n    private useBSModal() {\n        return !!((!($ as any).ui || !($ as any).ui?.dialog) || TemplatedDialog.bootstrapModal);\n    }\n\n    public static bootstrapModal: boolean;\n\n    public static openPanel(element: JQuery, uniqueName: string) {\n        return openPanel(element, uniqueName);\n    }\n\n    public static closePanel(element: JQuery, e?: JQueryEventObject) {\n        return closePanel(element, e);\n    }\n\n    protected onDialogOpen(): void {\n        if (!isMobileView())\n            $(':input', this.element).not('button').eq(0).focus();\n        this.arrange();\n        this.tabs && (this.tabs as any).tabs?.('option', 'active', 0);\n    }\n\n    public arrange(): void {\n        this.element.find('.require-layout').filter(':visible').each(function (i, e) {\n            $(e).triggerHandler('layout');\n        });\n    }\n\n    protected onDialogClose() {\n        $(document).trigger('click');\n\n        // for tooltips etc.\n        if (($ as any).qtip) {\n            $(document.body).children('.qtip').each(function (index, el) {\n                ($(el) as any).qtip('hide');\n            });\n        }\n\n        window.setTimeout(() => {\n            var element = this.element;\n            this.destroy();\n            element.remove();\n            positionToastContainer(false, null);\n        }, 0);\n    }\n\n    protected addCssClass(): void {\n        if (this.isMarkedAsPanel) {\n            super.addCssClass();\n\n            if (this.isResponsive)\n                this.element.addClass(\"flex-layout\");\n        }\n    }\n\n    protected getDialogButtons(): DialogButton[] {\n        return undefined;\n    }\n\n    protected getDialogOptions(): any {\n        var opt: any = {};\n        var dialogClass = 's-Dialog ' + this.getCssClass();\n        opt.dialogClass = dialogClass;\n        var buttons = this.getDialogButtons();\n        if (buttons != null)\n            opt.buttons = buttons.map(dialogButtonToUI);\n        opt.width = 920;\n        TemplatedDialog.applyCssSizes(opt, dialogClass);\n        opt.autoOpen = false;\n        let type = getInstanceType(this);\n        opt.resizable = getAttributes(type, ResizableAttribute, true).length > 0;\n        opt.modal = true;\n        opt.position = { my: 'center', at: 'center', of: $(window.window) };\n        opt.title = this.element.data('dialogtitle') ?? this.getDialogTitle() ?? '';\n        return opt;\n    }\n\n    protected getDialogTitle() {\n        return \"\";\n    }\n\n    public dialogClose(): void {\n        if (this.element.hasClass('ui-dialog-content'))\n            (this.element as any).dialog?.().dialog?.('close');\n        else if (this.element.hasClass('modal-body'))\n            (this.element.closest('.modal') as any).modal('hide');\n        else if (this.element.hasClass('s-Panel') && !this.element.hasClass('hidden')) {\n            TemplatedDialog.closePanel(this.element);\n        }\n    }\n\n    public get dialogTitle(): string {\n        if (this.element.hasClass('ui-dialog-content'))\n            return (this.element as any).dialog?.('option', 'title');\n        else if (this.element.hasClass('modal-body'))\n            return this.element.closest('.modal').find('.modal-header').children('h5').text();\n\n        return this.element.data('dialogtitle');\n    }\n\n    private setupPanelTitle() {\n        var value = this.dialogTitle ?? this.getDialogTitle();\n        var pt = this.element.children('.panel-titlebar');\n\n        if (isEmptyOrNull(value)) {\n            pt.remove();\n        }\n        else {\n            if (!this.element.children('.panel-titlebar').length) {\n                pt = $(\"<div class='panel-titlebar'><div class='panel-titlebar-text'></div></div>\")\n                    .prependTo(this.element);\n            }\n            pt.children('.panel-titlebar-text').text(value);\n\n            if (this.element.hasClass('s-Panel')) {\n                if (!pt.children('.panel-titlebar-close').length) {\n                    $('<button class=\"panel-titlebar-close\">&nbsp;</button>')\n                        .prependTo(pt)\n                        .click(e => {\n                            TemplatedDialog.closePanel(this.element, e);\n                        });\n                }\n            }\n        }\n    }\n\n    public set dialogTitle(value: string) {\n        var oldTitle = this.dialogTitle;\n        this.element.data('dialogtitle', value);\n\n        if (this.element.hasClass('ui-dialog-content'))\n            (this.element as any).dialog?.('option', 'title', value);\n        else if (this.element.hasClass('modal-body')) {\n            this.element.closest('.modal').find('.modal-header').children('h5').text(value ?? '');\n        }\n        else if (this.element.hasClass('s-Panel')) {\n            if (oldTitle != this.dialogTitle) {\n                this.setupPanelTitle();\n                this.arrange();\n            }\n\n        }\n    }\n\n    public set_dialogTitle(value: string) {\n        this.dialogTitle = value;\n    }\n\n    protected initTabs(): void {\n        var tabsDiv = this.byId('Tabs');\n        if (tabsDiv.length === 0) {\n            return;\n        }\n        this.tabs = (tabsDiv as any).tabs?.({});\n        this.tabs.bind('tabsactivate', () => this.arrange());\n    }\n\n    protected handleResponsive(): void {\n        var dlg = (this.element as any)?.dialog();\n        var uiDialog = this.element.closest('.ui-dialog');\n        if (isMobileView()) {\n            var data = this.element.data('responsiveData');\n            if (!data) {\n                data = {};\n                data.draggable = dlg.dialog('option', 'draggable');\n                data.resizable = dlg.dialog('option', 'resizable');\n                data.position = dlg.css('position');\n                var pos = uiDialog.position();\n                data.left = pos.left;\n                data.top = pos.top;\n                data.width = uiDialog.width();\n                data.height = uiDialog.height();\n                data.contentHeight = this.element.height();\n                this.element.data('responsiveData', data);\n                dlg.dialog('option', 'draggable', false);\n                dlg.dialog('option', 'resizable', false);\n            }\n            uiDialog.addClass('mobile-layout');\n            uiDialog.css({ left: '0px', top: '0px', width: $(window).width() + 'px', height: $(window).height() + 'px', position: 'fixed' });\n            $(document.body).scrollTop(0);\n            layoutFillHeight(this.element);\n        }\n        else {\n            var d = this.element.data('responsiveData');\n            if (d) {\n                dlg.dialog('option', 'draggable', d.draggable);\n                dlg.dialog('option', 'resizable', d.resizable);\n                this.element.closest('.ui-dialog').css({ left: '0px', top: '0px', width: d.width + 'px', height: d.height + 'px', position: d.position });\n                this.element.height(d.contentHeight);\n                uiDialog.removeClass('mobile-layout');\n                this.element.removeData('responsiveData');\n            }\n        }\n    }\n}\n\nexport interface ModalOptions {\n    backdrop?: boolean | 'static',\n    keyboard?: boolean,\n    size?: 'lg' | 'sm',\n    modalClass?: string;\n}", "\uFEFFimport { validateOptions } from \"../../q\";\nimport { Decorators } from \"../../decorators\";\nimport { TemplatedWidget } from \"./templatedwidget\";\nimport { Toolbar, ToolButton } from \"./toolbar\";\n\n@Decorators.registerClass(\"Serenity.TemplatedPanel\")\nexport class TemplatedPanel<TOptions> extends TemplatedWidget<TOptions> {\n    constructor(container: JQuery, options?: TOptions) {\n        super(container, options);\n\n        this.initValidator();\n        this.initTabs();\n        this.initToolbar();\n    }\n\n    destroy() {\n        if (this.tabs) {\n            (this.tabs as any).tabs?.('destroy');\n            this.tabs = null;\n        }\n\n        if (this.toolbar) {\n            this.toolbar.destroy();\n            this.toolbar = null;\n        }\n\n        if (this.validator) {\n            this.byId('Form').remove();\n            this.validator = null;\n        }\n\n        super.destroy();\n    }\n\n    protected tabs: JQuery;\n    protected toolbar: Toolbar;\n    protected validator: JQueryValidation.Validator;\n    protected isPanel: boolean;\n    protected responsive: boolean;\n\n    public arrange(): void {\n        this.element.find('.require-layout').filter(':visible').each(function (i, e) {\n            $(e).triggerHandler('layout');\n        });\n    }\n\n    protected getToolbarButtons(): ToolButton[] {\n        return [];\n    }\n\n    protected getValidatorOptions(): JQueryValidation.ValidationOptions {\n        return {};\n    }\n\n    protected initTabs(): void {\n        var tabsDiv = this.byId('Tabs');\n        if (tabsDiv.length === 0) {\n            return;\n        }\n        this.tabs = (tabsDiv as any).tabs?.({});\n    }\n\n    protected initToolbar(): void {\n        var toolbarDiv = this.byId('Toolbar');\n        if (toolbarDiv.length === 0) {\n            return;\n        }\n        var opt = { buttons: this.getToolbarButtons() };\n        this.toolbar = new Toolbar(toolbarDiv, opt);\n    }\n\n    protected initValidator(): void {\n        var form = this.byId('Form');\n        if (form.length > 0) {\n            var valOptions = this.getValidatorOptions();\n            this.validator = form.validate(validateOptions(valOptions));\n        }\n    }\n\n    protected resetValidation(): void {\n        if (this.validator) {\n            (this.validator as any).resetAll();\n        }\n    }\n\n    protected validateForm(): boolean {\n        return this.validator == null || !!this.validator.form();\n    }\n}", "\uFEFFimport { Exception, validatorAbortHandler } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\nexport namespace ValidationHelper {\n    export function asyncSubmit(form: JQuery, validateBeforeSave: () => boolean, submitHandler: () => void): boolean {\n        var validator = form.validate();\n        var valSettings = validator.settings;\n        if ((valSettings as any).abortHandler) {\n            return false;\n        }\n        if (validateBeforeSave != null && validateBeforeSave() === false) {\n            return false;\n        }\n        (valSettings as any)['abortHandler'] = validatorAbortHandler;\n        valSettings['submitHandler'] = function () {\n            if (submitHandler != null) {\n                submitHandler();\n            }\n            return false;\n        };\n        form.trigger('submit');\n        return true;\n    }\n\n    export function submit(form: JQuery, validateBeforeSave: () => boolean, submitHandler: () => void): boolean {\n        var validator = form.validate();\n        var valSettings = validator.settings;\n        if ((valSettings as any).abortHandler != null) {\n            return false;\n        }\n        if (validateBeforeSave != null && validateBeforeSave() === false) {\n            return false;\n        }\n        if (!validator.form()) {\n            return false;\n        }\n        if (submitHandler != null) {\n            submitHandler();\n        }\n        return true;\n    }\n\n    export function getValidator(element: JQuery): JQueryValidation.Validator {\n        var form = element.closest('form');\n        if (form.length === 0) {\n            return null;\n        }\n        return form.data('validator');\n    }\n}\n\nexport namespace VX {\n    export function addValidationRule(element: JQuery, eventClass: string, rule: (p1: JQuery) => string): JQuery {\n        if (!element.length)\n        return element;\n        if (rule == null)\n            throw new Exception('rule is null!');\n        element.addClass('customValidate').bind('customValidate.' + eventClass, rule as any);\n        return element;        \n    }\n\n    export function removeValidationRule(element: JQuery, eventClass: string): JQuery {\n        element.unbind('customValidate.' + eventClass);\n        return element;\n    }    \n\n    export function validateElement(validator: JQueryValidation.Validator, widget: Widget<any>): boolean {\n        return validator.element(widget.element[0] as any);\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { findElementWithRelativeId, isEmptyOrNull, notifyError } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\n@Decorators.registerClass('Serenity.CascadedWidgetLink')\nexport class CascadedWidgetLink<TParent extends Widget<any>> {\n\n    constructor(private parentType: { new(...args: any[]): TParent },\n        private widget: Widget<any>,\n        private parentChange: (p1: TParent) => void) {\n        this.bind();\n        this.widget.element.bind('remove.' + (widget as any).uniqueName + 'cwh', e => {\n            this.unbind();\n            this.widget = null;\n            this.parentChange = null;\n        });\n    }\n\n    private _parentID: string;\n\n    bind() {\n\n        if (isEmptyOrNull(this._parentID)) {\n            return null;\n        }\n\n        var parent = findElementWithRelativeId(this.widget.element, this._parentID)\n            .tryGetWidget(this.parentType);\n\n        if (parent != null) {\n            parent.element.bind('change.' + (this.widget as any).uniqueName, () => {\n                this.parentChange(parent);\n            });\n            return parent;\n        }\n        else {\n            notifyError(\"Can't find cascaded parent element with ID: \" + this._parentID + '!', '', null);\n            return null;\n        }\n    }\n\n    unbind() {\n\n        if (isEmptyOrNull(this._parentID)) {\n            return null;\n        }\n\n        var parent = findElementWithRelativeId(this.widget.element, this._parentID).tryGetWidget(this.parentType);\n\n        if (parent != null) {\n            parent.element.unbind('.' + (this.widget as any).uniqueName);\n        }\n\n        return parent;\n    }\n\n    get_parentID() {\n        return this._parentID;\n    }\n\n    set_parentID(value: string) {\n\n        if (this._parentID !== value) {\n            this.unbind();\n            this._parentID = value;\n            this.bind();\n        }\n    }\n}\n", "\uFEFFexport {}\n\nexport namespace TabsExtensions {\n    export function setDisabled(tabs: JQuery, tabKey: string, isDisabled: boolean) {\n        if (!tabs)\n            return;\n\n        var ibk = indexByKey(tabs);\n        if (!ibk)\n            return;\n\n        var index = ibk[tabKey];\n        if (index == null) {\n            return;\n        }\n\n        if (isDisabled && index === (tabs as any).tabs('option', 'active')) {\n            (tabs as any).tabs?.('option', 'active', 0);\n        }\n\n        (tabs as any).tabs?.(isDisabled ? 'disable' : 'enable', index);\n    }\n\n    export function toggle(tabs: JQuery, tabKey: string, visible: boolean) {\n        if (!tabs)\n            return;\n\n        var ibk = indexByKey(tabs);\n        if (!ibk)\n            return;\n\n        var index = ibk[tabKey];\n        if (index == null) {\n            return;\n        }\n\n        if (!visible && index === (tabs as any).tabs?.('option', 'active')) {\n            (tabs as any).tabs?.('option', 'active', 0);\n        }\n\n        tabs.children('ul').children('li').eq(index).toggle(visible);\n    }\n\n    export function activeTabKey(tabs: JQuery) {\n        var href = tabs.children('ul')\n            .children('li')\n            .eq((tabs as any).tabs?.('option', 'active'))\n            .children('a')\n            .attr('href')\n            .toString();\n\n        var prefix = '_Tab';\n        var lastIndex = href.lastIndexOf(prefix);\n        if (lastIndex >= 0) {\n            href = href.substr(lastIndex + prefix.length);\n        }\n        return href;\n    }\n\n    export function indexByKey(tabs: JQuery): any {\n        var indexByKey = tabs.data('indexByKey');\n        if (!indexByKey) {\n            indexByKey = {};\n            tabs.children('ul').children('li').children('a').each(function (index, el) {\n                var href = el.getAttribute('href').toString();\n                var prefix = '_Tab';\n                var lastIndex = href.lastIndexOf(prefix);\n                if (lastIndex >= 0) {\n                    href = href.substr(lastIndex + prefix.length);\n                }\n                indexByKey[href] = index;\n            });\n            tabs.data('indexByKey', indexByKey);\n        }\n\n        return indexByKey;\n    }\n    \n    export function selectTab(tabs: JQuery, tabKey: string) {\n        var ibk = indexByKey(tabs);\n        if (!ibk)\n            return;\n        var index = ibk[tabKey];\n        if (index == null) {\n            return;\n        }\n        if (index !== (tabs as any).tabs?.('option', 'active')) {\n            (tabs as any).tabs?.('option', 'active', index);\n        }\n    }\n}\n", "\uFEFFimport { DisplayNameAttribute, OptionAttribute } from \"../../decorators\";\nimport { getInstanceType, getMembers, isInstanceOfType, MemberType } from \"../../q\";\nimport { ReflectionUtils } from \"../../types/reflectionutils\";\n\nexport namespace ReflectionOptionsSetter {\n    export function set(target: any, options: any): void {\n        if (options == null) {\n            return;\n        }\n\n        var type = getInstanceType(target);\n\n        if (type === Object) {\n            return;\n        }\n\n        var propByName = type.__propByName;\n        var fieldByName = type.__fieldByName;\n        if (propByName == null) {\n            var props = getMembers(type, MemberType.property);\n            var propList = props.filter(function (x: any) {\n                return !!x.setter && ((x.attr || []).filter(function (a: any) {\n                    return isInstanceOfType(a, OptionAttribute);\n                }).length > 0 || (x.attr || []).filter(function (a: any) {\n                    return isInstanceOfType(a, DisplayNameAttribute);\n                }).length > 0);\n            });\n\n            propByName = {};\n            for (var k of propList) {\n                propByName[ReflectionUtils.makeCamelCase(k.name)] = k;\n            }\n\n            type.__propByName = propByName;\n        }\n\n        if (fieldByName == null) {\n            var fields = getMembers(type, MemberType.field);\n            var fieldList = fields.filter(function (x1: any) {\n                return (x1.attr || []).filter(function (a: any) {\n                    return isInstanceOfType(a, OptionAttribute);\n                }).length > 0 || (x1.attr || []).filter(function (a: any) {\n                    return isInstanceOfType(a, DisplayNameAttribute);\n                }).length > 0;\n            });\n\n            fieldByName = {};\n            for (var $t2 = 0; $t2 < fieldList.length; $t2++) {\n                var k1 = fieldList[$t2];\n                fieldByName[ReflectionUtils.makeCamelCase(k1.name)] = k1;\n            }\n            type.__fieldByName = fieldByName;\n        }\n\n        var keys = Object.keys(options);\n        for (var k2 of keys) {\n            var v = options[k2];\n            var cc = ReflectionUtils.makeCamelCase(k2);\n            var p = propByName[cc] || propByName[k2];\n            if (p != null) {\n                var func = (target[p.setter] as Function);\n                func && func.call(target, v);\n            }\n            else {\n                var f = fieldByName[cc] || fieldByName[k2];\n                f && (target[f.name] = v);\n            }\n        }\n    }\n}", "\uFEFFimport { IBooleanValue, IDoubleValue, IGetEditValue, IReadOnly, ISetEditValue, IStringValue, IValidateRequired } from \"../../interfaces\";\nimport { cast, isInstanceOfType, isTrimmedEmpty, parseDecimal, PropertyItem, safeCast, localText, tryGetText } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\nexport namespace EditorUtils {\n    export function getDisplayText(editor: Widget<any>): string {\n\n        var select2 = editor.element.data('select2');\n\n        if (select2 != null) {\n            var data = editor.element.select2('data');\n            if (data == null)\n                return '';\n\n            return data.text ?? '';\n        }\n\n        var value = getValue(editor);\n        if (value == null) {\n            return '';\n        }\n\n        if (typeof value === \"string\")\n            return value;\n\n        if (value instanceof Boolean)\n            return (!!value ? (tryGetText('Controls.FilterPanel.OperatorNames.true') ?? 'True') :\n                (tryGetText('Controls.FilterPanel.OperatorNames.true') ?? 'False'));\n\n        return value.toString();\n    }\n\n    var dummy: PropertyItem = { name: '_' };\n\n    export function getValue(editor: Widget<any>): any {\n        var target: Record<string, any> = {};\n        saveValue(editor, dummy, target);\n        return target['_'];\n    }\n\n    export function saveValue(editor: Widget<any>, item: PropertyItem, target: any): void {\n\n        var getEditValue = safeCast(editor, IGetEditValue);\n\n        if (getEditValue != null) {\n            getEditValue.getEditValue(item, target);\n            return;\n        }\n\n        var stringValue = safeCast(editor, IStringValue);\n        if (stringValue != null) {\n            target[item.name] = stringValue.get_value();\n            return;\n        }\n\n        var booleanValue = safeCast(editor, IBooleanValue);\n        if (booleanValue != null) {\n            target[item.name] = booleanValue.get_value();\n            return;\n        }\n\n        var doubleValue = safeCast(editor, IDoubleValue);\n        if (doubleValue != null) {\n            var value = doubleValue.get_value();\n            target[item.name] = (isNaN(value) ? null : value);\n            return;\n        }\n\n        if ((editor as any).getEditValue != null) {\n            (editor as any).getEditValue(item, target);\n            return;\n        }\n\n        if (editor.element.is(':input')) {\n            target[item.name] = editor.element.val();\n            return;\n        }\n    }\n\n    export function setValue(editor: Widget<any>, value: any): void {\n        var source = { _: value };\n        loadValue(editor, dummy, source);\n    }\n\n    export function loadValue(editor: Widget<any>, item: PropertyItem, source: any): void {\n\n        var setEditValue = safeCast(editor, ISetEditValue);\n        if (setEditValue != null) {\n            setEditValue.setEditValue(source, item);\n            return;\n        }\n\n        var stringValue = safeCast(editor, IStringValue);\n        if (stringValue != null) {\n            var value = source[item.name];\n            if (value != null) {\n                value = value.toString();\n            }\n            stringValue.set_value(cast(value, String));\n            return;\n        }\n\n        var booleanValue = safeCast(editor, IBooleanValue);\n        if (booleanValue != null) {\n            var value1 = source[item.name];\n            if (typeof (value1) === 'number') {\n                booleanValue.set_value(value1 > 0);\n            }\n            else {\n                booleanValue.set_value(!!value1);\n            }\n            return;\n        }\n\n        var doubleValue = safeCast(editor, IDoubleValue);\n        if (doubleValue != null) {\n            var d = source[item.name];\n            if (!!(d == null || isInstanceOfType(d, String) && isTrimmedEmpty(cast(d, String)))) {\n                doubleValue.set_value(null);\n            }\n            else if (isInstanceOfType(d, String)) {\n                doubleValue.set_value(cast(parseDecimal(cast(d, String)), Number));\n            }\n            else if (isInstanceOfType(d, Boolean)) {\n                doubleValue.set_value((!!d ? 1 : 0));\n            }\n            else {\n                doubleValue.set_value(cast(d, Number));\n            }\n            return;\n        }\n\n        if ((editor as any).setEditValue != null) {\n            (editor as any).setEditValue(source, item);\n            return;\n        }\n\n        if (editor.element.is(':input')) {\n            var v = source[item.name];\n            if (v == null) {\n                editor.element.val('');\n            }\n            else {\n                editor.element.val(v);\n            }\n            return;\n        }\n    }\n\n    export function setReadonly(elements: JQuery, isReadOnly: boolean): JQuery {\n        elements.each(function (index, el) {\n            var elx = $(el);\n            var type = elx.attr('type');\n            if (elx.is('select') || type === 'radio' || type === 'checkbox') {\n                if (isReadOnly) {\n                    elx.addClass('readonly').attr('disabled', 'disabled');\n                }\n                else {\n                    elx.removeClass('readonly').removeAttr('disabled');\n                }\n            }\n            else if (isReadOnly) {\n                elx.addClass('readonly').attr('readonly', 'readonly');\n            }\n            else {\n                elx.removeClass('readonly').removeAttr('readonly');\n            }\n            return true;\n        });\n        return elements;\n    }\n\n    export function setReadOnly(widget: Widget<any>, isReadOnly: boolean): void {\n\n        var readOnly = safeCast(widget, IReadOnly);\n\n        if (readOnly != null) {\n            readOnly.set_readOnly(isReadOnly);\n        }\n        else if (widget.element.is(':input')) {\n            setReadonly(widget.element, isReadOnly);\n        }\n    }\n\n    export function setRequired(widget: Widget<any>, isRequired: boolean): void {\n        var req = safeCast(widget, IValidateRequired);\n        if (req != null) {\n            req.set_required(isRequired);\n        }\n        else if (widget.element.is(':input')) {\n            widget.element.toggleClass('required', !!isRequired);\n        }\n        var gridField = widget.element.closest('.field');\n        var hasSupItem = gridField.find('sup').get().length > 0;\n        if (isRequired && !hasSupItem) {\n            $('<sup>*</sup>').attr('title', localText('Controls.PropertyGrid.RequiredHint'))\n                .prependTo(gridField.find('.caption')[0]);\n        }\n        else if (!isRequired && hasSupItem) {\n            $(gridField.find('sup')[0]).remove();\n        }\n    }\n\n    export function setContainerReadOnly(container: JQuery, readOnly: boolean) {\n\n        if (!readOnly) {\n\n            if (!container.hasClass('readonly-container'))\n                return;\n\n            container.removeClass('readonly-container').find(\".editor.container-readonly\")\n                .removeClass('container-readonly').each((i, e) => {\n                    var w = $(e).tryGetWidget(Widget);\n                    if (w != null)\n                        EditorUtils.setReadOnly(w, false);\n                    else\n                        EditorUtils.setReadonly($(e), false);\n                });\n\n            return;\n        }\n\n        container.addClass('readonly-container').find(\".editor\")\n            .not('.container-readonly')\n            .each((i, e) => {\n                var w = $(e).tryGetWidget(Widget) as any;\n                if (w != null) {\n\n                    if (w['get_readOnly']) {\n                        if (w['get_readOnly']())\n                            return;\n                    }\n                    else if ($(e).is('[readonly]') || $(e).is('[disabled]') || $(e).is('.readonly') || $(e).is('.disabled'))\n                        return;\n\n                    $(e).addClass('container-readonly');\n                    EditorUtils.setReadOnly(w, true);\n\n                }\n                else {\n                    if ($(e).is('[readonly]') || $(e).is('[disabled]') || $(e).is('.readonly') || $(e).is('.disabled'))\n                        return;\n\n                    EditorUtils.setReadonly($(e).addClass('container-readonly'), true);\n                }\n            });\n    }\n}", "\uFEFFimport { Decorators, ElementAttribute, OptionsTypeAttribute } from \"../../decorators\";\nimport { any, Authorization, Culture, extend, getAttributes, getTypeShortName, isBS3, isBS5Plus, isEmptyOrNull, PropertyItem, startsWith, localText, trimToEmpty, trimToNull, tryGetText } from \"../../q\";\nimport { EditorTypeRegistry } from \"../../types/editortyperegistry\";\nimport { EditorUtils } from \"../editors/editorutils\";\nimport { ReflectionOptionsSetter } from \"./reflectionoptionssetter\";\nimport { Widget } from \"./widget\";\n\n@Decorators.registerClass('Serenity.PropertyGrid')\nexport class PropertyGrid extends Widget<PropertyGridOptions> {\n\n    private editors: Widget<any>[];\n    private items: PropertyItem[];\n    declare public readonly idPrefix: string;\n\n    constructor(div: JQuery, opt: PropertyGridOptions) {\n        super(div, opt);\n\n        this.idPrefix = this.options.idPrefix = this.options.idPrefix ?? this.idPrefix;\n\n        if (this.options.mode == null)\n            this.options.mode = 1;\n\n        div.addClass('s-PropertyGrid');\n        this.editors = [];\n        var items = this.options.items || [];\n        this.items = [];\n\n        var useTabs = any(items, function (x) {\n            return !isEmptyOrNull(x.tab);\n        });\n\n        if (useTabs) {\n            var itemsWithoutTab = items.filter(f => isEmptyOrNull(f.tab));\n            if (itemsWithoutTab.length > 0) {\n                this.createItems(this.element, itemsWithoutTab);\n\n                $(\"<div class='pad'></div>\").appendTo(this.element);\n            }\n\n            var itemsWithTab = items.filter(f => !isEmptyOrNull(f.tab));\n\n            var ul = $(\"<ul class='nav nav-tabs property-tabs' role='tablist'></ul>\")\n                .appendTo(this.element);\n\n            var tc = $(\"<div class='tab-content property-panes'></div>\")\n                .appendTo(this.element);\n\n            var tabIndex = 0;\n            var i = 0;\n            while (i < itemsWithTab.length) {\n                var tab = { $: trimToEmpty(itemsWithTab[i].tab) };\n                var tabItems = [];\n\n                var j = i;\n                do {\n                    tabItems.push(itemsWithTab[j]);\n                } while (++j < itemsWithTab.length &&\n                    trimToEmpty(itemsWithTab[j].tab) === tab.$);\n                i = j;\n\n                var li = $(isBS3() ? '<li><a data-toggle=\"tab\" role=\"tab\"></a></li>' :\n                        `<li class=\"nav-item\"><a class=\"nav-link\" data-${isBS5Plus() ? \"bs-\" :  \"\"}toggle=\"tab\" role=\"tab\"></a></li>`)\n                    .appendTo(ul);\n\n                if (tabIndex === 0) {\n                    if (isBS3())\n                        li.addClass('active');\n                    else\n                        li.children('a').addClass('active');\n                }\n\n                var tabID = this.uniqueName + '_Tab' + tabIndex;\n\n                li.children('a').attr('href', '#' + tabID)\n                    .text(this.determineText(tab.$, function (prefix: string) {\n                        return prefix + 'Tabs.' + this.tab.$;\n                    }.bind({\n                        tab: tab\n                    })));\n\n                var pane = $(\"<div class='tab-pane fade' role='tabpanel'>\")\n                    .appendTo(tc);\n\n                if (tabIndex === 0) {\n                    pane.addClass(isBS3() ? 'in active' : 'show active');\n                }\n\n                pane.attr('id', tabID);\n                this.createItems(pane, tabItems);\n                tabIndex++;\n            }\n        }\n        else {\n            this.createItems(this.element, items);\n        }\n\n        this.updateInterface();\n    }\n\n    destroy() {\n        if (this.editors != null) {\n            for (var i = 0; i < this.editors.length; i++) {\n                this.editors[i].destroy();\n            }\n            this.editors = null;\n        }\n        this.element.find('a.category-link').unbind('click',\n            this.categoryLinkClick).remove();\n\n        Widget.prototype.destroy.call(this);\n    }\n\n    private createItems(container: JQuery, items: PropertyItem[]) {\n        var categoryIndexes = {};\n        var categoriesDiv = container;\n\n        var useCategories = this.options.useCategories !== false && any(items, function (x) {\n            return !isEmptyOrNull(x.category);\n        });\n\n        if (useCategories) {\n            var linkContainer = $('<div/>').addClass('category-links');\n            categoryIndexes = this.createCategoryLinks(linkContainer, items);\n            if (Object.keys(categoryIndexes).length > 1) {\n                linkContainer.appendTo(container);\n            }\n            else {\n                linkContainer.find('a.category-link').unbind('click',\n                    this.categoryLinkClick).remove();\n            }\n        }\n\n        categoriesDiv = $('<div/>').addClass('categories').appendTo(container);\n        var fieldContainer;\n        if (useCategories) {\n            fieldContainer = categoriesDiv;\n        }\n        else {\n            fieldContainer = $('<div/>').addClass('category').appendTo(categoriesDiv);\n        }\n        var priorCategory = null;\n        for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            var category = item.category;\n            if (category == null) {\n                category = this.options.defaultCategory ?? '';\n            }\n\n            if (useCategories && priorCategory !== category) {\n                var categoryDiv = this.createCategoryDiv(categoriesDiv,\n                    categoryIndexes, category,\n                    ((item.collapsible !== true) ? null :\n                        item.collapsed ?? false));\n\n                if (priorCategory == null) {\n                    categoryDiv.addClass('first-category');\n                }\n                priorCategory = category;\n                fieldContainer = categoryDiv;\n            }\n            var editor = this.createField(fieldContainer, item);\n            this.items.push(item);\n            this.editors.push(editor);\n        }\n    }\n\n    private createCategoryDiv(categoriesDiv: JQuery,\n        categoryIndexes: { [key: string]: number }, category: string, collapsed: boolean) {\n\n        var categoryDiv = $('<div/>').addClass('category')\n            .appendTo(categoriesDiv);\n\n        var title = $('<div/>').addClass('category-title')\n            .append($('<a/>').addClass('category-anchor')\n            .text(this.determineText(category, function (prefix) {\n                return prefix + 'Categories.' + category;\n            }))\n            .attr('name', this.idPrefix + \n                'Category' + categoryIndexes[category].toString()))\n            .appendTo(categoryDiv);\n\n        if (collapsed != null) {\n            categoryDiv.addClass(((collapsed === true) ?\n                'collapsible collapsed' : 'collapsible'));\n\n            var img = $('<i/>').addClass(((collapsed === true) ?\n                'fa fa-plus' : 'fa fa-minus')).appendTo(title);\n\n            title.click(function (e) {\n                categoryDiv.toggleClass('collapsed');\n                img.toggleClass('fa-plus').toggleClass('fa-minus');\n            });\n        }\n\n        return categoryDiv;\n    }\n\n    private categoryLinkClick = (e: JQueryEventObject) => {\n        e.preventDefault();\n\n        var title = $('a[name=' + e.target.getAttribute('href')\n            .toString().substr(1) + ']');\n\n        if (title.closest('.category').hasClass('collapsed'))\n            title.closest('.category').children('.category-title').click();\n\n        var animate = function () {\n            if (($.fn as any).fadeTo) {\n                title.fadeTo(100, 0.5, function () {\n                    title.fadeTo(100, 1, function () {\n                    });\n                });\n            }\n        };\n\n        var intoView = title.closest('.category');\n        if (($.fn as any).scrollintoview) {\n            if (intoView.closest(':scrollable(both)').length === 0)\n                animate();\n            else\n                (intoView as any).scrollintoview({\n                    duration: 'fast',\n                    direction: 'y',\n                    complete: animate\n                });\n        }\n        else if (intoView && intoView[0] && intoView[0].scrollIntoView) {\n            intoView[0].scrollIntoView();\n            animate();\n        }\n    }\n\n    private determineText(text: string, getKey: (s: string) => string) {\n        if (text != null && !startsWith(text, '`')) {\n            var local = tryGetText(text);\n            if (local != null) {\n                return local;\n            }\n        }\n\n        if (text != null && startsWith(text, '`')) {\n            text = text.substring(1);\n        }\n\n        if (!isEmptyOrNull(this.options.localTextPrefix)) {\n            var local1 = tryGetText(getKey(this.options.localTextPrefix));\n            if (local1 != null) {\n                return local1;\n            }\n        }\n\n        return text;\n    }\n\n    private createField(container: JQuery, item: PropertyItem) {\n        var fieldDiv = $('<div/>').addClass('field')\n            .addClass(item.name).data('PropertyItem', item).appendTo(container);\n\n        if (!isEmptyOrNull(item.cssClass)) {\n            fieldDiv.addClass(item.cssClass);\n        }\n\n        if (!isEmptyOrNull(item.formCssClass)) {\n            fieldDiv.addClass(item.formCssClass);\n            if (item.formCssClass.indexOf('line-break-') >= 0) {\n                var splitted = item.formCssClass.split(String.fromCharCode(32));\n                if (splitted.indexOf('line-break-xs') >= 0) {\n                    $(\"<div class='line-break' style='width: 100%' />\")\n                        .insertBefore(fieldDiv);\n                }\n                else if (splitted.indexOf('line-break-sm') >= 0) {\n                    $(\"<div class='line-break hidden-xs' style='width: 100%' />\")\n                        .insertBefore(fieldDiv);\n                }\n                else if (splitted.indexOf('line-break-md') >= 0) {\n                    $(\"<div class='line-break hidden-sm' style='width: 100%' />\")\n                        .insertBefore(fieldDiv);\n                }\n                else if (splitted.indexOf('line-break-lg') >= 0) {\n                    $(\"<div class='line-break hidden-md' style='width: 100%' />\")\n                        .insertBefore(fieldDiv);\n                }\n            }\n        }\n        var editorId = this.idPrefix + item.name;\n        var title = this.determineText(item.title, function (prefix) {\n            return prefix + item.name;\n        });\n\n        var hint = this.determineText(item.hint, function (prefix1) {\n            return prefix1 + item.name + '_Hint';\n        });\n\n        var placeHolder = this.determineText(item.placeholder, function (prefix2) {\n            return prefix2 + item.name + '_Placeholder';\n        });\n\n        if (hint == null) {\n            hint = title ?? '';\n        }\n\n        var label = $('<label/>')\n            .addClass('caption')\n            .attr('for', editorId)\n            .attr('title', hint)\n            .text(title ?? '')\n            .appendTo(fieldDiv);\n\n        if (!isEmptyOrNull(item.labelWidth)) {\n            if (item.labelWidth === '0') {\n                label.hide();\n            }\n            else {\n                label.css('width', item.labelWidth);\n            }\n        }\n\n        if (item.required === true) {\n            $('<sup>*</sup>').attr('title',\n                localText('Controls.PropertyGrid.RequiredHint'))\n                .prependTo(label);\n        }\n\n        var editorType = EditorTypeRegistry\n            .get(item.editorType ?? 'String');\n\n        var element = Widget.elementFor(editorType as any)\n            .addClass('editor')\n            .attr('id', editorId).appendTo(fieldDiv);\n\n        if (element.is(':input')) {\n            element.attr('name', item.name ?? '');\n        }\n\n        if (!isEmptyOrNull(placeHolder)) {\n            element.attr('placeholder', placeHolder);\n        }\n        var editorParams = item.editorParams;\n        var optionsType = null;\n        var optionsAttr = getAttributes(editorType,\n            OptionsTypeAttribute, true);\n\n        if (optionsAttr != null && optionsAttr.length > 0) {\n            optionsType = optionsAttr[0].optionsType;\n        }\n        var editor;\n        if (optionsType != null) {\n            editorParams = extend(new optionsType(), item.editorParams);\n            editor = new (editorType as any)(element, editorParams);\n        }\n        else {\n            editorParams = extend(new Object(), item.editorParams);\n            editor = new (editorType as any)(element, editorParams);\n        }\n\n        editor.initialize();\n\n        if (getTypeShortName(editor) == \"BooleanEditor\" &&\n            (item.editorParams == null || !!!item.editorParams['labelFor'])) {\n            label.removeAttr('for');\n        }\n\n        if (getTypeShortName(editor) == \"RadioButtonEditor\" &&\n            (item.editorParams == null || !!!item.editorParams['labelFor'])) {\n            label.removeAttr('for');\n        }\n\n        if (item.maxLength != null) {\n            PropertyGrid.setMaxLength(editor, item.maxLength);\n        }\n\n        if (item.editorParams != null) {\n            ReflectionOptionsSetter.set(editor, item.editorParams);\n        }\n\n        $('<div/>').addClass('vx').appendTo(fieldDiv);\n        $('<div/>').addClass('clear').appendTo(fieldDiv);\n\n        return editor;\n    }\n\n    private getCategoryOrder(items: PropertyItem[]) {\n        var order = 0;\n        var result = {} as any;\n        var categoryOrder = trimToNull(this.options.categoryOrder);\n        if (categoryOrder != null) {\n            var split = categoryOrder.split(';');\n            for (var s of split) {\n                var x = trimToNull(s);\n                if (x == null) {\n                    continue;\n                }\n                if (result[x] as any != null) {\n                    continue;\n                }\n                result[x] = order++;\n            }\n        }\n\n        for (var x1 of items) {\n            var category = x1.category;\n            if (category == null) {\n                category = this.options.defaultCategory ?? '';\n            }\n            if (result[category] == null) {\n                result[category] = order++;\n            }\n        }\n\n        return result;\n    }\n\n    private createCategoryLinks(container: JQuery, items: PropertyItem[]) {\n        var idx = 0;\n        var itemIndex: Record<string, number> = {};\n        var itemCategory: Record<string, string> = {};\n        for (var x of items) {\n            var name1 = x.name;\n            var cat1 = x.category;\n            if (cat1 == null) {\n                cat1 = this.options.defaultCategory ?? '';\n            }\n            itemCategory[name1] = cat1;\n            itemIndex[x.name] = idx++;\n        }\n\n        var self = this;\n        var categoryOrder = this.getCategoryOrder(items);\n\n        items.sort(function (x1, y) {\n            var c = 0;\n            var xcategory = itemCategory[x1.name];\n            var ycategory = itemCategory[y.name];\n            if (xcategory != ycategory) {\n                var c1 = categoryOrder[xcategory];\n                var c2 = categoryOrder[ycategory];\n                if (c1 != null && c2 != null) {\n                    c = c1 - c2;\n                }\n                else if (c1 != null) {\n                    c = -1;\n                }\n                else if (c2 != null) {\n                    c = 1;\n                }\n            }\n            if (c === 0) {\n                c = Culture.stringCompare(xcategory, ycategory);\n            }\n            if (c === 0) {\n                c = itemIndex[x1.name] < itemIndex[y.name] ? -1 : (itemIndex[x1.name] > itemIndex[y.name] ? 1 : 0)\n            }\n            return c;\n        });\n\n        var categoryIndexes: Record<string, number> = {};\n        for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            var category = { $: itemCategory[item.name] };\n            if (categoryIndexes[category.$] == null) {\n                var index = Object.keys(categoryIndexes).length + 1;\n                categoryIndexes[category.$] = index;\n                if (index > 1) {\n                    $('<span/>').addClass('separator').text('|').prependTo(container);\n                }\n                $('<a/>').addClass('category-link').text(\n                    this.determineText(category.$,\n                        function (prefix: string) {\n                            return prefix + 'Categories.' + this.category.$;\n                        }.bind({ category: category })))\n                    .attr('tabindex', '-1')\n                    .attr('href', '#' + this.idPrefix +\n                        'Category' + index.toString())\n                    .click(this.categoryLinkClick)\n                    .prependTo(container);\n            }\n        }\n\n        $('<div/>').addClass('clear').appendTo(container);\n        return categoryIndexes;\n    }\n\n    get_editors(): Widget<any>[] {\n        return this.editors;\n    }\n\n    get_items(): PropertyItem[] {\n        return this.items;\n    }\n\n    get_idPrefix(): string {\n        return this.idPrefix;\n    }\n\n    get_mode(): PropertyGridMode {\n        return this.options.mode;\n    }\n\n    set_mode(value: PropertyGridMode) {\n        if(this.options.mode !== value) {\n            this.options.mode = value;\n            this.updateInterface();\n        }\n    }\n\n    // Obsolete\n    static loadEditorValue(editor: Widget<any>,\n        item: PropertyItem, source: any): void {\n    }\n\n    // Obsolete\n    static saveEditorValue(editor: Widget<any>,\n        item: PropertyItem, target: any): void {\n\n        EditorUtils.saveValue(editor, item, target);\n    }\n\n    // Obsolete\n    private static setReadOnly(widget: Widget<any>, isReadOnly: boolean): void {\n        EditorUtils.setReadOnly(widget, isReadOnly);\n    }\n\n    // Obsolete\n    private static setReadonly(elements: JQuery, isReadOnly: boolean): JQuery {\n        return EditorUtils.setReadonly(elements, isReadOnly);\n    }\n\n    // Obsolete\n    private static setRequired(widget: Widget<any>, isRequired: boolean): void {\n        EditorUtils.setRequired(widget, isRequired);\n    }\n\n    private static setMaxLength(widget: Widget<any>, maxLength: number) {\n        if (widget.element.is(':input')) {\n            if (maxLength > 0) {\n                widget.element.attr('maxlength', maxLength);\n            }\n            else {\n                widget.element.removeAttr('maxlength');\n            }\n        }\n    }\n\n    load(source: any): void {\n        for (var i = 0; i < this.editors.length; i++) {\n            var item = this.items[i];\n            var editor = this.editors[i];\n            if (!!(this.get_mode() === 1 && item.defaultValue != null) &&\n                typeof (source[item.name]) === 'undefined') {\n                source[item.name] = item.defaultValue;\n            }\n\n            EditorUtils.loadValue(editor, item, source);\n        }\n    }\n\n    save(target?: any): any {\n        if (target == null)\n            target = Object.create(null);\n        for (var i = 0; i < this.editors.length; i++) {\n            var item = this.items[i];\n            if (item.oneWay !== true && this.canModifyItem(item)) {\n                var editor = this.editors[i];\n                EditorUtils.saveValue(editor, item, target);\n            }\n        }\n        return target;\n    }\n\n    public get value(): any {\n        return this.save();\n    }\n\n    public set value(val: any) {\n        if (val == null)\n            val = Object.create(null);\n        this.load(val);\n    }\n\n    private canModifyItem(item: PropertyItem) {\n        if (this.get_mode() === PropertyGridMode.insert) {\n            if (item.insertable === false) {\n                return false;\n            }\n\n            if (item.insertPermission == null) {\n                return true;\n            }\n\n            return Authorization.hasPermission(item.insertPermission);\n        }\n        else if (this.get_mode() === PropertyGridMode.update) {\n            if (item.updatable === false) {\n                return false;\n            }\n\n            if (item.updatePermission == null) {\n                return true;\n            }\n\n            return Authorization.hasPermission(item.updatePermission);\n        }\n        return true;\n    }\n\n    updateInterface() {\n        for (var i = 0; i < this.editors.length; i++) {\n            var item = this.items[i];\n            var editor = this.editors[i];\n            var readOnly = item.readOnly === true || !this.canModifyItem(item);\n            EditorUtils.setReadOnly(editor, readOnly);\n            EditorUtils.setRequired(editor, !readOnly &&\n                !!item.required && item.editorType !== 'Boolean');\n            if (item.visible === false || item.readPermission != null ||\n                item.insertPermission != null || item.updatePermission != null ||\n                item.hideOnInsert === true || item.hideOnUpdate === true) {\n                var hidden = (item.readPermission != null &&\n                    !Authorization.hasPermission(item.readPermission)) ||\n                    item.visible === false ||\n                    (this.get_mode() === PropertyGridMode.insert && item.hideOnInsert === true) ||\n                    (this.get_mode() === 2 && item.hideOnUpdate === true);\n\n                editor.getGridField().toggle(!hidden);\n            }\n        }\n    }\n\n    enumerateItems(callback: (p1: PropertyItem, p2: Widget<any>) => void): void {\n        for (var i = 0; i < this.editors.length; i++) {\n            var item = this.items[i];\n            var editor = this.editors[i];\n            callback(item, editor);\n        }\n    }\n}\n\nexport enum PropertyGridMode {\n    insert = 1,\n    update = 2\n}\n\nexport interface PropertyGridOptions {\n    idPrefix?: string;\n    items?: PropertyItem[];\n    useCategories?: boolean;\n    categoryOrder?: string;\n    defaultCategory?: string;\n    localTextPrefix?: string;\n    mode?: PropertyGridMode;\n}", "\uFEFFimport { Decorators, FormKeyAttribute } from \"../../decorators\";\nimport { endsWith, getAttributes, getForm, getInstanceType, getTypeFullName, PropertyItem } from \"../../q\";\nimport { PropertyGrid, PropertyGridOptions } from \"./propertygrid\";\nimport { TemplatedPanel } from \"./templatedpanel\";\n\n@Decorators.registerClass('Serenity.PropertyPanel')\nexport class PropertyPanel<TItem, TOptions> extends TemplatedPanel<TOptions> {\n\n    private _entity: TItem;\n    private _entityId: any;\n\n    constructor(container: JQuery, options?: TOptions) {\n        super(container, options);\n\n        this.initPropertyGrid();\n        this.loadInitialEntity();\n    }\n\n    destroy() {\n        if (this.propertyGrid) {\n            this.propertyGrid.destroy();\n            this.propertyGrid = null;\n        }\n        if (this.validator) {\n            this.byId('Form').remove();\n            this.validator = null;\n        }\n        super.destroy();\n    }\n\n    protected initPropertyGrid() {\n        var pgDiv = this.byId('PropertyGrid');\n        if (pgDiv.length <= 0) {\n            return;\n        }\n        var pgOptions = this.getPropertyGridOptions();\n        this.propertyGrid = (new PropertyGrid(pgDiv, pgOptions)).init(null);\n        if (this.element.closest('.ui-Panel').hasClass('s-Flexify')) {\n            this.propertyGrid.element.children('.categories').flexHeightOnly(1);\n        }\n    }\n\n    protected loadInitialEntity(): void {\n        if (this.propertyGrid) {\n            this.propertyGrid.load(new Object());\n        }\n    }\n\n    protected getFormKey(): string {\n        var attributes = getAttributes(\n            getInstanceType(this), FormKeyAttribute, true);\n\n        if (attributes.length >= 1) {\n            return attributes[0].value;\n        }\n        var name = getTypeFullName(getInstanceType(this));\n        var px = name.indexOf('.');\n        if (px >= 0) {\n            name = name.substring(px + 1);\n        }\n        if (endsWith(name, 'Panel')) {\n            name = name.substr(0, name.length - 6);\n        }\n        else if (endsWith(name, 'Panel')) {\n            name = name.substr(0, name.length - 5);\n        }\n        return name;\n    }\n\n    protected getPropertyGridOptions(): PropertyGridOptions {\n        return {\n            idPrefix: this.idPrefix,\n            items: this.getPropertyItems(),\n            mode: 1,\n            useCategories: false,\n            localTextPrefix: 'Forms.' + this.getFormKey() + '.'\n        };\n    }\n\n    protected getPropertyItems(): PropertyItem[] {\n        var formKey = this.getFormKey();\n        return getForm(formKey);\n    }\n\n    protected getSaveEntity(): TItem {\n        var entity = new Object();\n        if (this.propertyGrid) {\n            this.propertyGrid.save(entity);\n        }\n        return entity as TItem;\n    }\n\n    protected get_entity(): TItem {\n        return this._entity;\n    }\n\n    protected get_entityId(): any {\n        return this._entityId;\n    }\n    \n    protected set_entity(value: TItem): void {\n        this._entity = value ?? new Object() as any;\n    }\n\n    protected set_entityId(value: any): void {\n        this._entityId = value;\n    }\n\n    protected validateBeforeSave(): boolean {\n        return this.validator.form();\n    }\n\n    protected propertyGrid: PropertyGrid;\n}", "\uFEFFimport { DataChangeInfo } from \"../../types/datachangeinfo\";\nimport { Widget } from \"../widgets/widget\";\n\nexport namespace SubDialogHelper {\n    export function bindToDataChange(dialog: any, owner: Widget<any>,\n        dataChange: (p1: any, p2: DataChangeInfo) => void, useTimeout?: boolean): any {\n        var widgetName = (owner as any).widgetName;\n        dialog.element.bind('ondatachange.' + widgetName, function (e: JQueryEventObject, dci: any) {\n            if (useTimeout) {\n                window.setTimeout(function () {\n                    dataChange(e, dci);\n                }, 0);\n            }\n            else {\n                dataChange(e, dci);\n            }\n        }).bind('remove.' + widgetName, function () {\n            dialog.element.unbind('ondatachange.' + widgetName);\n        });\n        return dialog;\n    }\n\n    export function triggerDataChange(dialog: Widget<any>): any {\n        dialog.element.triggerHandler('ondatachange');\n        return dialog;\n    }\n\n    export function triggerDataChanged(element: JQuery): JQuery {\n        element.triggerHandler('ondatachange');\n        return element;\n    }\n\n    export function bubbleDataChange(dialog: any, owner: Widget<any>, useTimeout?: boolean): any {\n        return bindToDataChange(dialog, owner, function (e, dci) {\n            owner.element.triggerHandler('ondatachange');\n        }, useTimeout);\n    }\n\n    export function cascade(cascadedDialog: any, ofElement: JQuery): any {\n        cascadedDialog.element.one('dialogopen', function (e: JQueryEventObject) {\n            cascadedDialog.element.dialog().dialog('option', 'position', cascadedDialogOffset(ofElement));\n        });\n        return cascadedDialog;\n    }\n\n    export function cascadedDialogOffset(element: JQuery): any {\n        return { my: 'left top', at: 'left+20 top+20', of: element[0] };\n    }\n}", "\uFEFFimport { Decorators, FormKeyAttribute } from \"../../decorators\";\nimport { DialogButton, endsWith, getAttributes, getForm, getFormData, getFormDataAsync, getInstanceType, getTypeFullName, isEmptyOrNull, PropertyItem, PropertyItemsData, ScriptData, localText } from \"../../q\";\nimport { PropertyGrid, PropertyGridOptions } from \"../widgets/propertygrid\";\nimport { TemplatedDialog } from \"./templateddialog\";\n\n@Decorators.registerClass('Serenity.PropertyDialog')\nexport class PropertyDialog<TItem, TOptions> extends TemplatedDialog<TOptions> {\n    protected entity: TItem;\n    protected entityId: any;\n    protected propertyItemsData: PropertyItemsData;\n\n    constructor(opt?: TOptions) {\n        super(opt);\n\n        if (this.useAsync())\n            this.initAsync();\n        else \n            this.initSync();        \n    }\n\n    internalInit() {\n        this.initPropertyGrid();\n        this.loadInitialEntity();\n    }\n\n    protected initSync() {\n        this.propertyItemsData = this.getPropertyItemsData();\n        this.internalInit();\n        this.afterInit();\n    }\n\n    protected async initAsync() {\n        this.propertyItemsData = await this.getPropertyItemsDataAsync();\n        this.internalInit();\n        this.afterInit();\n    }\n\n    protected afterInit() {\n    }    \n\n    protected useAsync() {\n        return false;\n    }\n\n    destroy() {\n        if (this.propertyGrid) {\n            this.propertyGrid.destroy();\n            this.propertyGrid = null;\n        }\n\n        if (this.validator) {\n            this.byId('Form').remove();\n            this.validator = null;\n        }\n\n        super.destroy();\n    }\n\n    protected getDialogOptions() {\n        var opt = super.getDialogOptions();\n        opt.width = 400;\n        return opt;\n    }\n\n    protected getDialogButtons() {\n        super.getDialogButtons();\n        return <DialogButton[]>[{\n            text: localText('Dialogs.OkButton'),\n            cssClass: \"btn btn-primary\",\n            click: () => this.okClick()\n        }, {\n            text: localText('Dialogs.CancelButton'),\n            click: () => this.cancelClick()\n        }];\n    }\n\n    protected okClick() {\n        if (!this.validateBeforeSave()) {\n            return;\n        }\n\n        this.okClickValidated();\n    }\n\n    protected okClickValidated() {\n        this.dialogClose();\n    }\n\n    protected cancelClick() {\n        this.dialogClose();\n    }\n\n    protected initPropertyGrid() {\n        var pgDiv = this.byId('PropertyGrid');\n        if (pgDiv.length <= 0) {\n            return;\n        }\n        var pgOptions = this.getPropertyGridOptions();\n        this.propertyGrid = (new PropertyGrid(pgDiv, pgOptions)).init(null);\n        if (this.element.closest('.ui-dialog').hasClass('s-Flexify')) {\n            this.propertyGrid.element.children('.categories').flexHeightOnly(1);\n        }\n    }\n\n    protected getFormKey(): string {\n        var attributes = getAttributes(\n            getInstanceType(this), FormKeyAttribute, true);\n        if (attributes.length >= 1) {\n            return attributes[0].value;\n        }\n        else {\n            var name = getTypeFullName(getInstanceType(this));\n            var px = name.indexOf('.');\n            if (px >= 0) {\n                name = name.substring(px + 1);\n            }\n            if (endsWith(name, 'Dialog')) {\n                name = name.substr(0, name.length - 6);\n            }\n            else if (endsWith(name, 'Panel')) {\n                name = name.substr(0, name.length - 5);\n            }\n            return name;\n        }\n    }\n\n    protected getPropertyGridOptions(): PropertyGridOptions {\n        return {\n            idPrefix: this.idPrefix,\n            items: this.getPropertyItems(),\n            mode: 1,\n            useCategories: false,\n            localTextPrefix: 'Forms.' + this.getFormKey() + '.'\n        };\n    }\n\n    protected getPropertyItems() {\n        return this.propertyItemsData?.items || [];\n    }\n\n    protected getPropertyItemsData(): PropertyItemsData {\n        var formKey = this.getFormKey();\n\n        if (this.getFormKey === PropertyDialog.prototype.getFormKey &&\n            this.getPropertyItems !== PropertyDialog.prototype.getPropertyItems &&\n            !ScriptData.canLoad('Form.' + formKey)) {\n            return {\n                items: this.getPropertyItems(),\n                additionalItems: []\n            }\n        }\n\n        if (!isEmptyOrNull(formKey)) {\n            return getFormData(formKey);\n        }\n\n        return { items: [], additionalItems: [] };\n    }\n\n    protected async getPropertyItemsDataAsync(): Promise<PropertyItemsData> {\n        var formKey = this.getFormKey();\n        if (!isEmptyOrNull(formKey)) {\n            return await getFormDataAsync(formKey);\n        }\n\n        return { items: [], additionalItems: [] };\n    }\n\n    protected getSaveEntity(): TItem {\n        var entity = new Object();\n        if (this.propertyGrid) {\n            this.propertyGrid.save(entity);\n        }\n        return entity as TItem;\n    }\n\n    protected loadInitialEntity(): void {\n        this.propertyGrid && this.propertyGrid.load(new Object());\n    }\n\n    protected get_entity() {\n        return this.entity;\n    }\n\n    protected set_entity(value: TItem) {\n        this.entity = (value ?? new Object()) as any;\n    }\n\n    protected get_entityId() {\n        return this.entityId;\n    }\n\n    protected set_entityId(value: any): void {\n        this.entityId = value;\n    }\n\n    protected validateBeforeSave(): boolean {\n        return this.validator.form();\n    }\n\n    protected updateTitle() {\n    }\n\n    protected propertyGrid: PropertyGrid;\n\n    protected getFallbackTemplate() {\n        return `<div>\n    <div class=\"s-Form\">\n        <form id=\"~_Form\" action=\"\">\n            <div class=\"fieldset\">\n                <div id=\"~_PropertyGrid\"></div>\n                <div class=\"clear\"></div>\n            </div>\n        </form> \n    </div>\n</div>`;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IStringValue } from \"../../interfaces\";\nimport { Widget } from \"../widgets/widget\";\n\n@Decorators.registerEditor('Serenity.StringEditor', [IStringValue])\n@Decorators.element(\"<input type=\\\"text\\\"/>\")\nexport class StringEditor extends Widget<any> {\n\n    constructor(input: JQuery) {\n        super(input);\n    }\n\n    public get value(): string {\n        return this.element.val();\n    }\n\n    protected get_value(): string {\n        return this.value;\n    }\n\n    public set value(value: string) {\n        this.element.val(value);\n    }\n\n    protected set_value(value: string): void {\n        this.value = value;\n    }\n}\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { StringEditor } from \"./stringeditor\";\n\n@Decorators.registerEditor('Serenity.PasswordEditor')\nexport class PasswordEditor extends StringEditor {\n    constructor(input: JQuery) {\n        super(input);\n\n        input.attr('type', 'password');\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IStringValue } from \"../../interfaces\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface TextAreaEditorOptions {\n    cols?: number;\n    rows?: number;\n}\n\n@Decorators.registerEditor('Serenity.TextAreaEditor', [IStringValue])\n@Decorators.element(\"<textarea />\")\nexport class TextAreaEditor extends Widget<TextAreaEditorOptions> {\n\n    constructor(input: JQuery, opt?: TextAreaEditorOptions) {\n        super(input, opt);\n\n        if (this.options.cols !== 0) {\n            input.attr('cols', (this.options.cols ?? 80));\n        }\n        if (this.options.rows !== 0) {\n            input.attr('rows', (this.options.rows ?? 6));\n        }\n    }\n\n    public get value(): string {\n        return this.element.val();\n    }\n\n    protected get_value(): string {\n        return this.value;\n    }\n\n    public set value(value: string) {\n        this.element.val(value);\n    }\n\n    protected set_value(value: string): void {\n        this.value = value;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IBooleanValue } from \"../../interfaces\";\nimport { Widget } from \"../widgets/widget\";\n\n@Decorators.registerEditor('Serenity.BooleanEditor', [IBooleanValue])\n@Decorators.element('<input type=\"checkbox\"/>')\nexport class BooleanEditor extends Widget<any> {\n\n    public get value(): boolean {\n        return this.element.is(\":checked\");\n    }\n\n    protected get_value(): boolean {\n        return this.value;\n    }\n\n    public set value(value: boolean) {\n        this.element.prop(\"checked\", !!value);\n    }\n\n    protected set_value(value: boolean): void {\n        this.value = value;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IDoubleValue } from \"../../interfaces\";\nimport { Culture, extend, formatNumber, parseDecimal } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface DecimalEditorOptions {\n    minValue?: string;\n    maxValue?: string;\n    decimals?: any;\n    padDecimals?: any;\n    allowNegatives?: boolean;\n}\n\n@Decorators.registerEditor('Serenity.DecimalEditor', [IDoubleValue])\n@Decorators.element('<input type=\"text\"/>')\nexport class DecimalEditor extends Widget<DecimalEditorOptions> implements IDoubleValue {\n\n    constructor(input: JQuery, opt?: DecimalEditorOptions) {\n        super(input, opt);\n\n        input.addClass('decimalQ');\n        var numericOptions = extend(DecimalEditor.defaultAutoNumericOptions(), {\n            vMin: (this.options.minValue ?? (this.options.allowNegatives ? (this.options.maxValue != null ? (\"-\" + this.options.maxValue) : '-999999999999.99') : '0.00')),\n            vMax: (this.options.maxValue ?? '999999999999.99')\n        });\n\n        if (this.options.decimals != null) {\n            numericOptions.mDec = this.options.decimals;\n        }\n\n        if (this.options.padDecimals != null) {\n            numericOptions.aPad = this.options.padDecimals;\n        }\n\n        if (($.fn as any).autoNumeric)\n            (input as any).autoNumeric(numericOptions);\n    }\n\n    get_value(): number {\n        if (($.fn as any).autoNumeric) {\n            var val = (this.element as any).autoNumeric('get');\n\n            if (!!(val == null || val === ''))\n                return null;\n\n            return parseFloat(val);\n        }\n\n        var val = this.element.val();\n        return parseDecimal(val);\n    }\n\n    get value(): number {\n        return this.get_value();\n    }\n\n    set_value(value: number) {\n        if (value == null || (value as any) === '') {\n            this.element.val('');\n        }\n        else if (($.fn as any).autoNumeric) {\n            (this.element as any).autoNumeric('set', value);\n        }\n        else\n            this.element.val(formatNumber(value));\n    }\n\n    set value(v: number) {\n        this.set_value(v);\n    }\n\n    get_isValid(): boolean {\n        return !isNaN(this.get_value());\n    }\n\n    static defaultAutoNumericOptions(): any {\n        return {\n            aDec: Culture.decimalSeparator,\n            altDec: ((Culture.decimalSeparator === '.') ? ',' : '.'),\n            aSep: ((Culture.decimalSeparator === '.') ? ',' : '.'),\n            aPad: true\n        };\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IDoubleValue } from \"../../interfaces\";\nimport { extend, formatNumber, isTrimmedEmpty, parseInteger, trimToNull } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\nimport { DecimalEditor } from \"./decimaleditor\";\n\nexport interface IntegerEditorOptions {\n    minValue?: number;\n    maxValue?: number;\n    allowNegatives?: boolean;\n}\n\n@Decorators.registerEditor('Serenity.IntegerEditor', [IDoubleValue])\n@Decorators.element('<input type=\"text\"/>')\nexport class IntegerEditor extends Widget<IntegerEditorOptions> implements IDoubleValue {\n\n    constructor(input: JQuery, opt?: IntegerEditorOptions) {\n        super(input, opt);\n\n        input.addClass('integerQ');\n        var numericOptions = extend(DecimalEditor.defaultAutoNumericOptions(),\n            {\n                vMin: (this.options.minValue ?? this.options.allowNegatives ? (this.options.maxValue != null ? (\"-\" + this.options.maxValue) : '-2147483647') : '0'),\n                vMax: (this.options.maxValue ?? 2147483647),\n                aSep: null\n            });\n\n        if (($.fn as any).autoNumeric)\n            (input as any).autoNumeric(numericOptions);\n    }\n\n    get_value(): number {\n        if (($.fn as any).autoNumeric) {\n            var val = (this.element as any).autoNumeric('get') as string;\n            if (!!isTrimmedEmpty(val))\n                return null;\n            else \n                return parseInt(val, 10);\n        } \n        else {\n            var val = trimToNull(this.element.val());\n            if (val == null)\n                return null;\n            return parseInteger(val)\n        }\n\n    }\n\n    get value(): number {\n        return this.get_value();\n    }\n\n    set_value(value: number) {\n        if (value == null || (value as any) === '')\n            this.element.val('');\n        else if (($.fn as any).autoNumeric)\n            (this.element as any).autoNumeric('set', value);\n        else\n            this.element.val(formatNumber(value));\n    }\n\n    set value(v: number) {\n        this.set_value(v);\n    }\n\n    get_isValid(): boolean {\n        return !isNaN(this.get_value());\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IReadOnly, IStringValue } from \"../../interfaces\";\nimport { addValidationRule, Culture, format, formatDate, Invariant, isEmptyOrNull, parseDate, parseISODateTime, replaceAll, localText, today } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\nexport let datePickerIconSvg = '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 17 17\"><g></g><path d=\"M14 2v-1h-3v1h-5v-1h-3v1h-3v15h17v-15h-3zM12 2h1v2h-1v-2zM4 2h1v2h-1v-2zM16 16h-15v-8.921h15v8.921zM1 6.079v-3.079h2v2h3v-2h5v2h3v-2h2v3.079h-15z\" fill=\"currentColor\"></path></svg>';\n\n@Decorators.registerEditor('Serenity.DateEditor', [IStringValue, IReadOnly])\n@Decorators.element('<input type=\"text\"/>')\nexport class DateEditor extends Widget<any> implements IStringValue, IReadOnly {\n\n    private minValue: string;\n    private maxValue: string;\n\n    constructor(input: JQuery) {\n        super(input);\n\n        // @ts-ignore\n        if (typeof flatpickr !== \"undefined\" && (DateEditor.useFlatpickr || !$.fn.datepicker)) {\n            // @ts-ignore\n            flatpickr(input[0], DateEditor.flatPickrOptions(input));\n        }\n        else if (($.fn as any)?.datepicker) {\n            (input as any).datepicker({\n                showOn: 'button',\n                beforeShow: (inp: any, inst: any) => {\n                    if (input.hasClass('readonly') as any)\n                        return false as any;\n                    DateEditor.uiPickerZIndexWorkaround(this.element);\n                    return true;\n                },\n                yearRange: (this.yearRange ?? '-100:+50')\n            });\n\n        }\n        else {\n            input.attr('type', 'date');\n        }\n\n        input.on('keyup.' + this.uniqueName, e => {\n            if (e.which === 32 && !this.get_readOnly()) {\n                if (this.get_valueAsDate() != today()) {\n                    this.set_valueAsDate(today());\n                    this.element.trigger('change');\n                }\n            }\n            else {\n                DateEditor.dateInputKeyup(e);\n            }\n        });\n\n        input.on('change.' + this.uniqueName, DateEditor.dateInputChange);\n\n        addValidationRule(input, this.uniqueName, e1 => {\n            var value = this.get_value();\n            if (isEmptyOrNull(value)) {\n                return null;\n            }\n\n            if (!isEmptyOrNull(this.get_minValue()) && Invariant.stringCompare(formatDate(value, 'yyyy-MM-dd'), formatDate(this.get_minValue(), 'yyyy-MM-dd')) < 0) {\n                return format(localText('Validation.MinDate'), formatDate(this.get_minValue(), null));\n            }\n\n            if (!isEmptyOrNull(this.get_maxValue()) && Invariant.stringCompare(formatDate(value, 'yyyy-MM-dd'), formatDate(this.get_maxValue(), 'yyyy-MM-dd')) > 0) {\n                return format(localText('Validation.MaxDate'), formatDate(this.get_maxValue(), null));\n            }\n\n            return null;\n        });\n\n        this.set_sqlMinMax(true)\n    }\n\n    public static useFlatpickr: boolean;\n\n    public static flatPickrOptions(input: JQuery) {\n        return {\n            clickOpens: true,\n            allowInput: true,\n            dateFormat: Culture.dateOrder.split('').join(Culture.dateSeparator).replace('y', 'Y'),\n            onChange: function() {\n                input.triggerHandler('change');\n            }\n        }\n    }\n\n    get_value(): string {\n        var value = this.element.val()?.trim();\n        if (!value?.length) {\n            return null;\n        }\n\n        return formatDate(value, 'yyyy-MM-dd');\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string) {\n        if (value == null) {\n            this.element.val('');\n        }\n        else if (value.toLowerCase() === 'today' || value.toLowerCase() === 'now') {\n            this.element.val(formatDate(today(), this.element.attr('type') === 'date' ? 'yyyy-MM-dd' : null));\n        }\n        else {\n            this.element.val(formatDate(value, this.element.attr('type') === 'date' ? 'yyyy-MM-dd' : null));\n        }\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n\n    private get_valueAsDate(): Date {\n        if (isEmptyOrNull(this.get_value())) {\n            return null;\n        }\n\n        return parseISODateTime(this.get_value());\n    }\n\n    get valueAsDate(): Date {\n        return this.get_valueAsDate();\n    }\n\n    private set_valueAsDate(value: Date): void {\n        if (value == null) {\n            this.set_value(null);\n        }\n\n        this.set_value(formatDate(value, 'yyyy-MM-dd'));\n    }\n\n    set valueAsDate(v: Date) {\n        this.set_valueAsDate(v);\n    }\n\n    get_readOnly(): boolean {\n        return this.element.hasClass('readonly');\n    }\n\n    set_readOnly(value: boolean): void {\n\n        if (value !== this.get_readOnly()) {\n            if (value) {\n                this.element.addClass('readonly').attr('readonly', 'readonly');\n                this.element.nextAll('.ui-datepicker-trigger').css('opacity', '0.1');\n            }\n            else {\n                this.element.removeClass('readonly').removeAttr('readonly');\n                this.element.nextAll('.ui-datepicker-trigger').css('opacity', '1');\n            }\n        }\n    }\n\n    @Decorators.option()\n    public yearRange: string;\n\n    @Decorators.option()\n    get_minValue(): string {\n        return this.minValue;\n    }\n\n    set_minValue(value: string) {\n        this.minValue = value;\n    }\n\n    @Decorators.option()\n    get_maxValue(): string {\n        return this.maxValue;\n    }\n\n    set_maxValue(value: string): void {\n        this.maxValue = value;\n    }\n\n    get_minDate(): Date {\n        return parseISODateTime(this.get_minValue());\n    }\n\n    set_minDate(value: Date): void {\n        this.set_minValue(formatDate(value, 'yyyy-MM-dd'));\n    }\n\n    @Decorators.option()\n    get_maxDate(): Date {\n        return parseISODateTime(this.get_maxValue());\n    }\n\n    set_maxDate(value: Date) {\n        this.set_maxValue(formatDate(value, 'yyyy-MM-dd'));\n    }\n\n    @Decorators.option()\n    get_sqlMinMax(): boolean {\n        return this.get_minValue() === '1753-01-01' && this.get_maxValue() === '9999-12-31';\n    }\n\n    set_sqlMinMax(value: boolean) {\n        if (value) {\n            this.set_minValue('1753-01-01');\n            this.set_maxValue('9999-12-31');\n        }\n        else {\n            this.set_minValue(null);\n            this.set_maxValue(null);\n        }\n    }\n\n    static dateInputChange = function (e: JQueryEventObject) {\n        if (Culture.dateOrder !== 'dmy') {\n            return;\n        }\n        var input = $(e.target);\n        if (!input.is(':input') || input.attr(\"type\") == \"date\") {\n            return;\n        }\n        var val = input.val() ?? '';\n        var x = {};\n        if (val.length >= 6 && /^[0-9]*$/g.test(val)) {\n            input.val(val.substr(0, 2) + Culture.dateSeparator + val.substr(2, 2) + Culture.dateSeparator + val.substr(4));\n        }\n        val = input.val() ?? '';\n        if (val.length >= 5) {\n            var d = parseDate(val);\n            if (d && !isNaN(d.valueOf())) {\n                input.val(formatDate(d, null));\n            }\n        }\n    };\n\n    static flatPickrTrigger(input: JQuery): JQuery {\n        return $('<i class=\"ui-datepicker-trigger\" href=\"javascript:;\">' + datePickerIconSvg + '</i>')\n            .insertAfter(input)\n            .click(() => {\n                if (!input.hasClass('readonly'))\n                    (input[0] as any)._flatpickr.open();\n            });\n    }\n\n    static dateInputKeyup(e: JQueryEventObject) {\n\n        if (Culture.dateOrder !== 'dmy') {\n            return;\n        }\n\n        var input = $(e.target);\n        if (!input.is(':input') || input.attr(\"type\") == \"date\") {\n            // for browser date editors, format might not match culture setting\n            return;\n        }\n\n        if (input.is('[readonly]') || input.is(':disabled')) {\n            return;\n        }\n\n        var val: string = input.val() ?? '';\n        if (!!(val.length === 0 || (input[0] as any).selectionEnd !== val.length)) {\n            return;\n        }\n\n        if (val.indexOf(Culture.dateSeparator + Culture.dateSeparator) !== -1) {\n            input.val(replaceAll(val, Culture.dateSeparator + Culture.dateSeparator,\n                Culture.dateSeparator));\n            return;\n        }\n\n        function isNumeric(c: number): boolean {\n            return c >= 48 && c <= 57;\n        }\n\n        if (e.which === 47 || e.which === 111) {\n\n            if (val.length >= 2 && val.charAt(val.length - 1) === Culture.dateSeparator &&\n                val.charAt(val.length - 2) === Culture.dateSeparator) {\n                input.val(val.substr(0, val.length - 1));\n                return;\n            }\n\n            if (val.charAt(val.length - 1) !== Culture.dateSeparator) {\n                return;\n            }\n\n            switch (val.length) {\n                case 2: {\n                    if (isNumeric(val.charCodeAt(0))) {\n                        val = '0' + val;\n                        break;\n                    }\n                    else {\n                        return;\n                    }\n                }\n\n                case 4: {\n                    if (isNumeric(val.charCodeAt(0)) &&\n                        isNumeric(val.charCodeAt(2)) &&\n                        val.charAt(1) == Culture.dateSeparator) {\n                        val = '0' + val.charAt(0) + Culture.dateSeparator + '0' +\n                            val.charAt(2) + Culture.dateSeparator;\n                        break;\n                    }\n                    else {\n                        return;\n                    }\n                }\n\n                case 5: {\n                    if (isNumeric(val.charCodeAt(0)) &&\n                        isNumeric(val.charCodeAt(2)) &&\n                        isNumeric(val.charCodeAt(3)) &&\n                        val.charAt(1) === Culture.dateSeparator) {\n                        val = '0' + val;\n                        break;\n                    }\n                    else if (isNumeric(val.charCodeAt(0)) &&\n                        isNumeric(val.charCodeAt(1)) &&\n                        isNumeric(val.charCodeAt(3)) &&\n                        val.charAt(2) === Culture.dateSeparator) {\n                        val = val.charAt(0) + val.charAt(1) +\n                            Culture.dateSeparator + '0' + val.charAt(3) + Culture.dateSeparator;\n                        break;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                default: {\n                    return;\n                }\n            }\n            input.val(val);\n        }\n\n        if (val.length < 6 && (e.which >= 48 && e.which <= 57 || e.which >= 96 && e.which <= 105) &&\n            isNumeric(val.charCodeAt(val.length - 1))) {\n            switch (val.length) {\n                case 1: {\n                    if (val.charCodeAt(0) <= 51) {\n                        return;\n                    }\n                    val = '0' + val;\n                    break;\n                }\n\n                case 2: {\n                    if (!isNumeric(val.charCodeAt(0))) {\n                        return;\n                    }\n                    break;\n                }\n\n                case 3: {\n                    if (!isNumeric(val.charCodeAt(0)) ||\n                        val.charAt(1) !== Culture.dateSeparator ||\n                        val.charCodeAt(2) <= 49) {\n                        return;\n                    }\n\n                    val = '0' + val.charAt(0) + Culture.dateSeparator + '0' + val.charAt(2);\n                    break;\n                }\n\n                case 4: {\n                    if (val.charAt(1) == Culture.dateSeparator) {\n                        if (!isNumeric(val.charCodeAt(0)) ||\n                            !isNumeric(val.charCodeAt(2))) {\n                            return;\n                        }\n\n                        val = '0' + val;\n                        break;\n                    }\n                    else if (val.charAt(2) == Culture.dateSeparator) {\n                        if (!isNumeric(val.charCodeAt(0)) ||\n                            !isNumeric(val.charCodeAt(1)) ||\n                            val.charCodeAt(3) <= 49) {\n                            return;\n                        }\n\n                        val = val.charAt(0) + val.charAt(1) + Culture.dateSeparator +\n                            '0' + val.charAt(3);\n                        break;\n                    }\n                    else {\n                        return;\n                    }\n                }\n                case 5: {\n                    if (val.charAt(2) !== Culture.dateSeparator ||\n                        !isNumeric(val.charCodeAt(0)) ||\n                        !isNumeric(val.charCodeAt(1)) ||\n                        !isNumeric(val.charCodeAt(3))) {\n                        return;\n                    }\n\n                    break;\n                }\n\n                default: {\n                    return;\n                }\n            }\n\n            input.val(val + Culture.dateSeparator);\n        }\n    };\n\n    public static uiPickerZIndexWorkaround(input: JQuery) {\n        if (!input?.closest('.ui-dialog').length) \n            return; \n        var dialogIndex = parseInt(input.closest('.ui-dialog').css('z-index'), 10);\n        if (dialogIndex == null || isNaN(dialogIndex))\n            return;\n        setTimeout(() => {\n            var widget = (input as any).datepicker('widget');\n            if (!widget?.length)\n                return\n            var zIndex = parseInt(widget.css('z-index'));\n            if (!isNaN(zIndex) && zIndex <= dialogIndex)\n                widget.css('z-index', dialogIndex + 1);\n        }, 0);\n    }    \n}\n\nfunction jQueryDatepickerInitialization(): boolean {\n    if (!($ as any).datepicker?.regional?.en)\n        return false;\n    let order = Culture.dateOrder;\n    let s = Culture.dateSeparator;\n    let culture = ($('html').attr('lang') || 'en').toLowerCase();\n    if (!($ as any).datepicker.regional[culture]) {\n        culture = culture.split('-')[0];\n        if (!($ as any).datepicker.regional[culture]) {\n            culture = 'en';\n        }\n    }\n    ($ as any).datepicker.setDefaults(($ as any).datepicker.regional['en']);\n    ($ as any).datepicker.setDefaults(($ as any).datepicker.regional[culture]);\n    ($ as any).datepicker.setDefaults({\n        dateFormat: (order == 'mdy' ? 'mm' + s + 'dd' + s + 'yy' :\n            (order == 'ymd' ? 'yy' + s + 'mm' + s + 'dd' :\n                'dd' + s + 'mm' + s + 'yy')),\n        buttonImage: 'data:image/svg+xml,' + encodeURIComponent(datePickerIconSvg),\n        buttonImageOnly: true,\n        showOn: 'both',\n        showButtonPanel: true,\n        changeMonth: true,\n        changeYear: true\n    });\n\n    if (($ as any).ui && ($ as any).ui.version <= '1.12.1') {\n        ($ as any).datepicker.setDefaults({\n            buttonImage: null,\n            buttonImageOnly: false,\n            buttonText: '<i class=\"fa fa-calendar\"></i>'\n        });\n    }\n\n    return true;\n};\n\ntypeof $ !== \"undefined\" && $.fn && !jQueryDatepickerInitialization() && $(jQueryDatepickerInitialization);\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IReadOnly, IStringValue } from \"../../interfaces\";\nimport { addOption, addValidationRule, Culture, format, formatDate, formatISODateTimeUTC, Invariant, isEmptyOrNull, parseDate, parseISODateTime, round, localText, today, trunc, tryGetText } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\nimport { DateEditor } from \"./dateeditor\";\nimport { EditorUtils } from \"./editorutils\";\n\n@Decorators.registerEditor('Serenity.DateTimeEditor', [IStringValue, IReadOnly])\n@Decorators.element('<input type=\"text\"/>')\nexport class DateTimeEditor extends Widget<DateTimeEditorOptions> implements IStringValue, IReadOnly {\n\n    private minValue: string;\n    private maxValue: string;\n    private time: JQuery;\n    private lastSetValue: string;\n    private lastSetValueGet: string;\n\n    constructor(input: JQuery, opt?: DateTimeEditorOptions) {\n        super(input, opt);\n        \n        input.addClass('s-DateTimeEditor');\n\n        if (this.options.inputOnly) {\n            input.addClass('dateTimeQ');\n            // just a basic input, usually read only display\n        }\n        // @ts-ignore\n        else if (typeof flatpickr !== \"undefined\" && (DateEditor.useFlatpickr || !$.fn.datepicker || this.options.seconds)) {\n            input.addClass('dateTimeQ');\n            // @ts-ignore\n            flatpickr(input[0], this.getFlatpickrOptions());\n        }\n        else if (($.fn as any)?.datepicker) {\n            input.addClass('dateQ');\n\n            (input as any).datepicker({\n                showOn: 'button',\n                beforeShow: function () {\n                    if (input.hasClass('readonly') as any)\n                        return false as any;\n                    DateEditor.uiPickerZIndexWorkaround(this.element);\n                    return true;                    \n                } as any,\n                yearRange: (this.options.yearRange ?? '-100:+50')\n            });\n\n            input.bind('change.' + this.uniqueName, (e) => {\n                this.lastSetValue = null;\n                DateEditor.dateInputChange(e);\n            });\n\n            this.time = $('<select/>').addClass('editor s-DateTimeEditor time');\n            var after = input.next('.ui-datepicker-trigger');\n            if (after.length > 0) {\n                this.time.insertAfter(after);\n            }\n            else {\n                after = input.prev('.ui-datepicker-trigger');\n                if (after.length > 0) {\n                    this.time.insertBefore(after);\n                }\n                else {\n                    this.time.insertAfter(input);\n                }\n            }\n\n            this.time.on('change', function (e3) {\n                this.lastSetValue = null;\n                input.triggerHandler('change');\n            });\n\n            var timeOpt = DateTimeEditor.getTimeOptions(\n                (this.options.startHour ?? 0), 0,\n                (this.options.endHour ?? 23), 59,\n                (this.options.intervalMinutes ?? 5));\n\n            for (var t of timeOpt) {\n                addOption(this.time, t, t);\n            }\n\n            addValidationRule(input, this.uniqueName, e1 => {\n                var value = this.get_value();\n                if (isEmptyOrNull(value)) {\n                    return null;\n                }\n\n                if (!isEmptyOrNull(this.get_minValue()) && Invariant.stringCompare(value, this.get_minValue()) < 0) {\n                    return format(localText('Validation.MinDate'), formatDate(this.get_minValue(), null));\n                }\n    \n                if (!isEmptyOrNull(this.get_maxValue()) && Invariant.stringCompare(value, this.get_maxValue()) > 0) {\n                    return format(localText('Validation.MaxDate'), formatDate(this.get_maxValue(), null));\n                }\n\n                return null;\n            });   \n        }\n        else \n            input.attr('type', 'datetime').addClass('dateTimeQ');\n\n        input.bind('keyup.' + this.uniqueName, e => {\n            if (this.get_readOnly())\n                return;\n            \n            if (this.time) {\n                if (e.which === 32) {\n                    if (this.get_valueAsDate() !== new Date()) {\n                        this.set_valueAsDate(new Date());\n                        this.element.trigger('change');\n                    }\n                }\n                else {\n                    var before = this.element.val();\n                    DateEditor.dateInputKeyup(e);\n                    if (before != this.element.val())\n                        this.lastSetValue = null;\n                }\n            }\n        });\n\n        this.set_sqlMinMax(true);\n\n        if (!this.options.inputOnly) {\n            $(\"<i class='inplace-button inplace-now'><b></b></div>\")\n                .attr('title', this.getInplaceNowText())\n                .insertAfter(this.time).click(e2 => {\n                    if (this.element.hasClass('readonly')) {\n                        return;\n                    }\n                    this.lastSetValue = null;\n                    this.set_valueAsDate(new Date());\n                    input.triggerHandler('change');\n                });\n        }\n    }\n\n    getFlatpickrOptions(): any {\n        return {\n            clickOpens: true,\n            allowInput: true,\n            enableTime: true,\n            time_24hr: true,\n            enableSeconds: !!this.options.seconds,\n            minuteIncrement: this.options.intervalMinutes ?? 5,\n            dateFormat: Culture.dateOrder.split('').join(Culture.dateSeparator).replace('y', 'Y') + \" H:i\" + (this.options.seconds ? \":S\" : \"\"),\n            onChange: () => {\n                this.lastSetValue = null;\n                this.element && this.element.triggerHandler('change');\n            }\n        }\n    }\n\n    get_value(): string {           \n        var value = this.element.val().trim();\n        if (value != null && value.length === 0) {\n            return null;\n        }\n\n        var result: string;\n        if (this.time) {\n            var datePart = formatDate(value, 'yyyy-MM-dd');\n            var timePart = this.time.val();\n                result = datePart + 'T' + timePart + ':00.000';\n        }\n        else\n            result = formatDate(parseDate(this.element.val()), \"yyyy-MM-ddTHH:mm:ss.fff\");\n\n        if (this.options.useUtc)\n            result = formatISODateTimeUTC(parseISODateTime(result));\n\n        if (this.lastSetValue != null &&\n            this.lastSetValueGet == result)\n            return this.lastSetValue;\n\n        return result;\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string) {\n        if (isEmptyOrNull(value)) {\n            this.element.val('');\n            this.time && this.time.val('00:00');\n        }\n        else if (value.toLowerCase() === 'today') {\n            if (this.time) {\n                this.element.val(formatDate(today(), null));\n                this.time.val('00:00');\n            }\n            else {\n                this.element.val(this.getDisplayFormat())\n            }\n        }\n        else {\n            var val = ((value.toLowerCase() === 'now') ? new Date() : parseISODateTime(value));\n            if (this.time) {\n                val = DateTimeEditor.roundToMinutes(val, (this.options.intervalMinutes ?? 5));\n                this.element.val(formatDate(val, null));\n                this.time.val(formatDate(val, 'HH:mm'));\n            }\n            else\n                this.element.val(formatDate(val, this.getDisplayFormat()));\n        }\n\n        this.lastSetValue = null;\n        if (!isEmptyOrNull(value) && value.toLowerCase() != 'today' && value.toLowerCase() != 'now') {\n            this.lastSetValueGet = this.get_value();\n            this.lastSetValue = value;\n        }\n    }\n\n    private getInplaceNowText(): string {\n        return tryGetText('Controls.DateTimeEditor.SetToNow') ?? 'set to now';\n    }\n\n    private getDisplayFormat(): string {\n        return (this.options.seconds ? Culture.dateTimeFormat : Culture.dateTimeFormat.replace(':ss', ''));\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n\n    private get_valueAsDate(): Date {\n        if (isEmptyOrNull(this.get_value())) {\n            return null;\n        }\n\n        return parseISODateTime(this.get_value());\n    }\n\n    get valueAsDate() {\n        return this.get_valueAsDate();\n    }\n\n    private set_valueAsDate(value: Date) {\n        if (value == null) {\n            this.set_value(null);\n        }\n\n        this.set_value(formatDate(value, 'yyyy-MM-ddTHH:mm' + (this.options.seconds ? ':ss' : '')));\n    }\n\n    set valueAsDate(value: Date) {\n        this.set_valueAsDate(value);\n    }\n\n    @Decorators.option()\n    get_minValue(): string {\n        return this.minValue;\n    }\n\n    set_minValue(value: string) {\n        this.minValue = value;\n    }\n\n    @Decorators.option()\n    get_maxValue(): string {\n        return this.maxValue;\n    }\n\n    set_maxValue(value: string): void {\n        this.maxValue = value;\n    }\n\n    get_minDate(): Date {\n        return parseISODateTime(this.get_minValue());\n    }\n\n    set_minDate(value: Date): void {\n        this.set_minValue(formatDate(value, 'yyyy-MM-ddTHH:mm:ss'));\n    }\n\n    @Decorators.option()\n    get_maxDate(): Date {\n        return parseISODateTime(this.get_maxValue());\n    }\n\n    set_maxDate(value: Date) {\n        this.set_maxValue(formatDate(value, 'yyyy-MM-ddTHH:mm:ss'));\n    }\n\n    @Decorators.option()\n    get_sqlMinMax(): boolean {\n        return this.get_minValue() === '1753-01-01' && this.get_maxValue() === '9999-12-31';\n    }\n\n    set_sqlMinMax(value: boolean) {\n        if (value) {\n            this.set_minValue('1753-01-01');\n            this.set_maxValue('9999-12-31');\n        }\n        else {\n            this.set_minValue(null);\n            this.set_maxValue(null);\n        }\n    }\n\n    get_readOnly(): boolean {\n        return this.element.hasClass('readonly');\n    }\n\n    set_readOnly(value: boolean): void {\n\n        if (value !== this.get_readOnly()) {\n            if (value) {\n                this.element.addClass('readonly').attr('readonly', 'readonly');\n                this.element.nextAll('.ui-datepicker-trigger').css('opacity', '0.1');\n                this.element.nextAll('.inplace-now').css('opacity', '0.1');\n            }\n            else {\n                this.element.removeClass('readonly').removeAttr('readonly');\n                this.element.nextAll('.ui-datepicker-trigger').css('opacity', '1');\n                this.element.nextAll('.inplace-now').css('opacity', '1');\n            }\n\n            this.time && EditorUtils.setReadonly(this.time, value);\n        }\n    }\n\n    static roundToMinutes(date: Date, minutesStep: number) {\n        date = new Date(date.getTime());\n        var m = trunc(round(date.getMinutes() / minutesStep) * minutesStep);\n        date.setMinutes(m);\n        date.setSeconds(0);\n        date.setMilliseconds(0);\n        return date;\n    }\n\n    static getTimeOptions = function (fromHour: number, fromMin: number,\n        toHour: number, toMin: number, stepMins: number) {\n        var list = [];\n        if (toHour >= 23) {\n            toHour = 23;\n        }\n        if (toMin >= 60) {\n            toMin = 59;\n        }\n        var hour = fromHour;\n        var min = fromMin;\n        while (true) {\n            if (hour > toHour || hour === toHour && min > toMin) {\n                break;\n            }\n            var t = ((hour >= 10) ? '' : '0') + hour + ':' + ((min >= 10) ? '' : '0') + min;\n            list.push(t);\n            min += stepMins;\n            if (min >= 60) {\n                min -= 60;\n                hour++;\n            }\n        }\n        return list;\n    };\n}\n\nexport interface DateTimeEditorOptions {\n    startHour?: any;\n    endHour?: any;\n    intervalMinutes?: any;\n    yearRange?: string;\n    useUtc?: boolean;\n    seconds?: boolean;\n    inputOnly?: boolean;\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IDoubleValue, IReadOnly } from \"../../interfaces\";\nimport { addOption, toId } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\nimport { EditorUtils } from \"./editorutils\";\n\nexport interface TimeEditorOptions {\n    noEmptyOption?: boolean;\n    startHour?: any;\n    endHour?: any;\n    intervalMinutes?: any;\n}\n\n@Decorators.registerEditor('Serenity.TimeEditor', [IDoubleValue, IReadOnly])\n@Decorators.element(\"<select />\")\nexport class TimeEditor extends Widget<TimeEditorOptions> {\n\n    private minutes: JQuery;\n\n    constructor(input: JQuery, opt?: TimeEditorOptions) {\n        super(input, opt);\n\n        input.addClass('editor s-TimeEditor hour');\n\n        if (!this.options.noEmptyOption) {\n            addOption(input, '', '--');\n        }\n\n        for (var h = (this.options.startHour || 0); h <= (this.options.endHour || 23); h++) {\n            addOption(input, h.toString(), ((h < 10) ? ('0' + h) : h.toString()));\n        }\n\n        this.minutes = $('<select/>').addClass('editor s-TimeEditor minute').insertAfter(input);\n        this.minutes.change(() => this.element.trigger(\"change\"));\n\n        for (var m = 0; m <= 59; m += (this.options.intervalMinutes || 5)) {\n            addOption(this.minutes, m.toString(), ((m < 10) ? ('0' + m) : m.toString()));\n        }\n    }\n\n    public get value(): number {\n        var hour = toId(this.element.val());\n        var minute = toId(this.minutes.val());\n        if (hour == null || minute == null) {\n            return null;\n        }\n        return hour * 60 + minute;\n    }\n\n    protected get_value(): number {\n        return this.value;\n    }\n\n    public set value(value: number) {\n        if (!value) {\n            if (this.options.noEmptyOption) {\n                this.element.val(this.options.startHour);\n                this.minutes.val('0');\n            }\n            else {\n                this.element.val('');\n                this.minutes.val('0');\n            }\n        }\n        else {\n            this.element.val(Math.floor(value / 60).toString());\n            this.minutes.val(value % 60);\n        }\n    }\n\n    protected set_value(value: number): void {\n        this.value = value;\n    }\n\n    get_readOnly(): boolean {\n        return this.element.hasClass('readonly');\n    }\n\n    set_readOnly(value: boolean): void {\n\n        if (value !== this.get_readOnly()) {\n            if (value) {\n                this.element.addClass('readonly').attr('readonly', 'readonly');\n            }\n            else {\n                this.element.removeClass('readonly').removeAttr('readonly');\n            }\n            EditorUtils.setReadonly(this.minutes, value);\n        }\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IReadOnly, IStringValue } from \"../../interfaces\";\nimport { isEmptyOrNull, trimToNull, tryGetText } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface EmailEditorOptions {\n    domain?: string;\n    readOnlyDomain?: boolean;\n}\n\n@Decorators.registerEditor('Serenity.EmailEditor', [IStringValue, IReadOnly])\n@Decorators.element('<input type=\"text\"/>')\nexport class EmailEditor extends Widget<EmailEditorOptions> {\n\n    constructor(input: JQuery, opt: EmailEditorOptions) {\n        super(input, opt);\n\n        EmailEditor.registerValidationMethods();\n\n        input.addClass('emailuser');\n\n        var spanAt = $('<span/>').text('@').addClass('emailat').insertAfter(input);\n\n        var domain = $('<input type=\"text\"/>').addClass('emaildomain').insertAfter(spanAt);\n        domain.bind('blur.' + this.uniqueName, function () {\n            var validator = domain.closest('form').data('validator');\n            if (validator != null) {\n                validator.element(input[0]);\n            }\n        });\n\n        if (!isEmptyOrNull(this.options.domain)) {\n            domain.val(this.options.domain);\n        }\n\n        if (this.options.readOnlyDomain) {\n            domain.attr('readonly', 'readonly').addClass('disabled').attr('tabindex', '-1');\n        }\n\n        input.bind('keypress.' + this.uniqueName, e => {\n            if (e.which === 64) {\n                e.preventDefault();\n                if (!this.options.readOnlyDomain) {\n                    domain.focus();\n                    domain.select();\n                }\n            }\n        });\n\n        domain.bind('keypress.' + this.uniqueName, function (e1) {\n            if (e1.which === 64) {\n                e1.preventDefault();\n            }\n        });\n\n        if (!this.options.readOnlyDomain) {\n            input.change(e2 => this.set_value(input.val()));\n        }\n    }\n\n    static registerValidationMethods(): void {\n        if (!$.validator || !$.validator.methods || $.validator.methods['emailuser'] != null)\n            return;\n\n        $.validator.addMethod('emailuser', function (value, element) {\n\n            var domain = $(element).nextAll('.emaildomain');\n            if (domain.length > 0 && domain.attr('readonly') == null) {\n\n                if (this.optional(element) && this.optional(domain[0])) {\n                    return true;\n                }\n\n                return $.validator.methods.email.call(this, value + '@' + domain.val(), element);\n            }\n            else {\n                return $.validator.methods.email.call(this, value + '@dummy.com', element);\n            }\n        }, tryGetText(\"Validation.Email\") ?? $.validator.messages.email);\n    }\n\n    get_value(): string {\n        var domain = this.element.nextAll('.emaildomain');\n        var value = this.element.val();\n        var domainValue = domain.val();\n        if (isEmptyOrNull(value)) {\n            if (this.options.readOnlyDomain || isEmptyOrNull(domainValue)) {\n                return '';\n            }\n            return '@' + domainValue;\n        }\n        return value + '@' + domainValue;\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string): void {\n        var domain = this.element.nextAll('.emaildomain');\n        value = trimToNull(value);\n        if (value == null) {\n            if (!this.options.readOnlyDomain)\n                domain.val('');\n            this.element.val('');\n        }\n        else {\n            var parts = value.split('@');\n            if (parts.length > 1) {\n                if (!this.options.readOnlyDomain) {\n                    domain.val(parts[1]);\n                    this.element.val(parts[0]);\n                }\n                else if (!isEmptyOrNull(this.options.domain)) {\n                    if (parts[1] !== this.options.domain)\n                        this.element.val(value);\n                    else \n                        this.element.val(parts[0]);\n                }\n                else \n                    this.element.val(parts[0]);\n            }\n            else\n                this.element.val(parts[0]);\n        }\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n\n    get_readOnly(): boolean {\n        var domain = this.element.nextAll('.emaildomain');\n        return !(this.element.attr('readonly') == null &&\n            (!this.options.readOnlyDomain || domain.attr('readonly') == null));\n    }\n\n    set_readOnly(value: boolean): void {\n        var domain = this.element.nextAll('.emaildomain');\n        if (value) {\n            this.element.attr('readonly', 'readonly').addClass('readonly');\n            if (!this.options.readOnlyDomain) {\n                domain.attr('readonly', 'readonly').addClass('readonly');\n            }\n        }\n        else {\n            this.element.removeAttr('readonly').removeClass('readonly');\n            if (!this.options.readOnlyDomain) {\n                domain.removeAttr('readonly').removeClass('readonly');\n            }\n        }\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { StringEditor } from \"./stringeditor\";\n\n@Decorators.registerEditor('Serenity.EmailAddressEditor')\nexport class EmailAddressEditor extends StringEditor {\n    constructor(input: JQuery) {\n        super(input);\n\n        input.attr('type', 'email')\n            .addClass('email');\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IStringValue } from \"../../interfaces\";\nimport { trimToNull } from \"../../q\";\nimport { StringEditor } from \"./stringeditor\";\n\n@Decorators.registerEditor('Serenity.URLEditor', [IStringValue])\nexport class URLEditor extends StringEditor {\n\n    constructor(input: JQuery) {\n        super(input);\n\n        input.addClass(\"url\").attr(\"title\", \"URL should be entered in format: 'http://www.site.com/page'.\");\n\n        input.on(\"blur.\" + this.uniqueName, e => {\n            var validator = input.closest(\"form\").data(\"validator\") as JQueryValidation.Validator;\n            if (validator == null)\n                return;\n\n            if (!input.hasClass(\"error\"))\n                return;\n\n            var value = trimToNull(input.val());\n            if (!value)\n                return;\n\n            value = \"http://\" + value;\n\n            if ($.validator.methods['url'].call(validator, value, input[0]) == true) {\n                input.val(value);\n                validator.element(input);\n            }\n        });\n    }\n}", "\uFEFFimport { Decorators, EnumKeyAttribute } from \"../../decorators\";\nimport { IReadOnly, IStringValue } from \"../../interfaces\";\nimport { Enum, getAttributes, getLookup, isEmptyOrNull, tryGetText } from \"../../q\";\nimport { EnumTypeRegistry } from \"../../types/enumtyperegistry\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface RadioButtonEditorOptions {\n    enumKey?: string;\n    enumType?: any;\n    lookupKey?: string;\n}\n\n@Decorators.registerEditor('Serenity.RadioButtonEditor', [IStringValue, IReadOnly])\n@Decorators.element('<div/>')\nexport class RadioButtonEditor extends Widget<RadioButtonEditorOptions>\n    implements IReadOnly {\n\n    constructor(input: JQuery, opt: RadioButtonEditorOptions) {\n        super(input, opt);\n\n        if (isEmptyOrNull(this.options.enumKey) &&\n            this.options.enumType == null &&\n            isEmptyOrNull(this.options.lookupKey)) {\n            return;\n        }\n\n        if (!isEmptyOrNull(this.options.lookupKey)) {\n            var lookup = getLookup(this.options.lookupKey);\n            for (var item of lookup.items) {\n                var textValue = (item as any)[lookup.textField];\n                var text = (textValue == null ? '' : textValue.toString());\n                var idValue = (item as any)[lookup.idField];\n                var id = (idValue == null ? '' : idValue.toString());\n                this.addRadio(id, text);\n            }\n        }\n        else {\n            var enumType = this.options.enumType || EnumTypeRegistry.get(this.options.enumKey);\n            var enumKey = this.options.enumKey;\n            if (enumKey == null && enumType != null) {\n                var enumKeyAttr = getAttributes(enumType, EnumKeyAttribute, false);\n                if (enumKeyAttr.length > 0) {\n                    enumKey = enumKeyAttr[0].value;\n                }\n            }\n\n            var values = Enum.getValues(enumType);\n            for (var x of values) {\n                var name = Enum.toString(enumType, x);\n                this.addRadio(x.toString(), tryGetText(\n                    'Enums.' + enumKey + '.' + name) ?? name);\n            }\n        }\n    }\n\n    protected addRadio(value: string, text: string) {\n        var label = $('<label/>').text(text);\n        $('<input type=\"radio\"/>').attr('name', this.uniqueName)\n            .attr('id', this.uniqueName + '_' + value)\n            .attr('value', value).prependTo(label);\n        label.appendTo(this.element);\n    }\n\n    get_value(): string {\n        return this.element.find('input:checked').first().val();\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string): void {\n        if (value !== this.get_value()) {\n            var inputs = this.element.find('input');\n            var checks = inputs.filter(':checked');\n            if (checks.length > 0) {\n                (checks[0] as HTMLInputElement).checked = false;\n            }\n            if (!isEmptyOrNull(value)) {\n                checks = inputs.filter('[value=' + value + ']');\n                if (checks.length > 0) {\n                    (checks[0] as HTMLInputElement).checked = true;\n                }\n            }\n        }\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n\n    get_readOnly(): boolean {\n        return this.element.attr('disabled') != null;\n    }\n\n    set_readOnly(value: boolean): void {\n        if (this.get_readOnly() !== value) {\n            if (value) {\n                this.element.attr('disabled', 'disabled')\n                    .find('input').attr('disabled', 'disabled');\n            }\n            else {\n                this.element.removeAttr('disabled')\n                    .find('input').removeAttr('disabled');\n            }\n        }\n    }\n\n}", "\uFEFFimport \"@optionaldeps/jquery\";\n\nconst _Select2 = typeof Select2 !== \"undefined\" ? Select2 : undefined;\n\nexport default _Select2;", "\uFEFFimport Select2 from \"@optionaldeps/select2\";\nimport { Authorization, PropertyItem, any, isEmptyOrNull, isTrimmedEmpty, localText, startsWith, trimToEmpty, trimToNull } from \"../../q\";\nimport { Decorators } from \"../../decorators\";\nimport { IEditDialog, IGetEditValue, IReadOnly, ISetEditValue, IStringValue } from \"../../interfaces\";\nimport { DialogTypeRegistry } from \"../../types/dialogtyperegistry\";\nimport { ReflectionUtils } from \"../../types/reflectionutils\";\nimport { SubDialogHelper } from \"../helpers/subdialoghelper\";\nimport { Widget } from \"../widgets/widget\";\nimport { CascadedWidgetLink } from \"./cascadedwidgetlink\";\nimport { EditorUtils } from \"./editorutils\";\n\nexport interface Select2CommonOptions {\n    allowClear?: boolean;\n    delimited?: boolean;\n    minimumResultsForSearch?: any;\n    multiple?: boolean;\n}\n\nexport interface Select2FilterOptions {\n    cascadeFrom?: string;\n    cascadeField?: string;\n    cascadeValue?: any;\n    filterField?: string;\n    filterValue?: any;\n}\n\nexport interface Select2InplaceAddOptions {\n    inplaceAdd?: boolean;\n    inplaceAddPermission?: string;\n    dialogType?: string;\n    autoComplete?: boolean;\n}\n\nexport interface Select2EditorOptions extends Select2FilterOptions, Select2InplaceAddOptions, Select2CommonOptions {\n}\n\nexport interface Select2SearchPromise {\n    abort?(): void;\n    catch?(callback: () => void): void;\n    fail?(callback: () => void): void;\n}\n\nexport interface Select2SearchQuery {\n    searchTerm?: string;\n    idList?: string[];\n    skip?: number;\n    take?: number;\n    checkMore?: boolean;\n}\n\nexport interface Select2SearchResult<TItem> {\n    items: TItem[];\n    more: boolean;\n}\n\n@Decorators.registerClass('Serenity.Select2Editor',\n    [ISetEditValue, IGetEditValue, IStringValue, IReadOnly])\n@Decorators.element(\"<input type=\\\"hidden\\\"/>\")\nexport class Select2Editor<TOptions, TItem> extends Widget<TOptions> implements\n    ISetEditValue, IGetEditValue, IStringValue, IReadOnly {\n\n    private _items: Select2Item[];\n    private _itemById: { [key: string]: Select2Item };\n    protected lastCreateTerm: string;\n\n    constructor(hidden: JQuery, opt?: any) {\n        super(hidden, opt);\n\n        this._items = [];\n        this._itemById = {};\n        var emptyItemText = this.emptyItemText();\n        if (emptyItemText != null) {\n            hidden.attr('placeholder', emptyItemText);\n        }\n        var select2Options = this.getSelect2Options();\n        hidden.select2(select2Options);\n        hidden.attr('type', 'text');\n\n        // for jquery validate to work\n        hidden.on('change.' + this.uniqueName, (e: any, valueSet) => {\n            if (valueSet !== true && hidden.closest('form').data('validator'))\n                    hidden.valid();\n        });\n\n        this.setCascadeFrom((this.options as Select2EditorOptions).cascadeFrom);\n\n        if (this.useInplaceAdd())\n            this.addInplaceCreate(localText('Controls.SelectEditor.InplaceAdd'), null);\n    }\n\n    destroy() {\n        this.initSelectionPromise?.abort?.();\n        this.abortPendingQuery();\n        this.element?.select2?.('destroy');\n        super.destroy();\n    }\n\n    protected hasAsyncSource(): boolean {\n        return false;\n    }\n\n    protected asyncSearch(query: Select2SearchQuery, results: (result: Select2SearchResult<TItem>) => void): Select2SearchPromise {\n        results({\n            items: [],\n            more: false\n        });\n        return null;\n    }\n\n    protected getTypeDelay() {\n        return ((this.options as any)['typeDelay'] ?? 200);\n    }\n\n    protected emptyItemText() {\n        return this.element.attr('placeholder') ??\n            localText('Controls.SelectEditor.EmptyItemText');\n    }\n\n    protected getPageSize(): number {\n        return (this.options as any)['pageSize'] ?? 100;\n    }\n\n    protected getIdField() {\n        return (this.options as any)['idField'];\n    }\n\n    protected itemId(item: TItem): string {\n        var value = (item as any)[this.getIdField()];\n        if (value == null)\n            return '';\n        return value.toString();\n    }\n\n    protected getTextField() {\n        return (this.options as any)['textField'] ?? this.getIdField();\n    }\n\n    protected itemText(item: TItem): string {\n        var value = (item as any)[this.getTextField()];\n        if (value == null)\n            return '';\n        return value.toString();\n    }\n\n    protected itemDisabled(item: TItem): boolean {\n        return false;\n    }\n\n    protected mapItem(item: TItem): Select2Item {\n        return {\n            id: this.itemId(item),\n            text: this.itemText(item),\n            disabled: this.itemDisabled(item),\n            source: item\n        };\n    }\n\n    protected mapItems(items: TItem[]): Select2Item[] {\n        return items.map(this.mapItem.bind(this));\n    }\n\n    protected allowClear() {\n        return (this.options as Select2EditorOptions).allowClear != null ?\n            !!(this.options as Select2EditorOptions).allowClear : this.emptyItemText() != null;\n    }\n\n    protected isMultiple() {\n        return !!(this.options as Select2EditorOptions).multiple;\n    }\n\n    private initSelectionPromise: Select2SearchPromise;\n    private queryPromise: Select2SearchPromise;\n    private typeTimeout: number;\n\n    protected abortPendingQuery() {\n        this.queryPromise?.abort?.();\n        this.queryPromise = null;\n        if (this.typeTimeout) {\n            clearTimeout(this.typeTimeout);\n            this.typeTimeout = null;\n        }\n    }\n\n    protected getSelect2Options(): Select2Options {\n        var emptyItemText = this.emptyItemText();\n        var opt: Select2Options = {\n            multiple: this.isMultiple(),\n            placeHolder: (!isEmptyOrNull(emptyItemText) ? emptyItemText : null),\n            allowClear: this.allowClear(),\n            createSearchChoicePosition: 'bottom'\n        }\n\n        if (this.hasAsyncSource()) {\n            opt.query = query => {\n                var pageSize = this.getPageSize();\n                var searchQuery: Select2SearchQuery = {\n                    searchTerm: trimToNull(query.term),\n                    skip: (query.page - 1) * pageSize,\n                    take: pageSize,\n                    checkMore: true\n                }\n\n                this.abortPendingQuery();\n\n                var select2 = $(this.element).data('select2');\n                select2?.search?.removeClass?.('select2-active').parent().removeClass('select2-active');\n\n                this.typeTimeout = setTimeout(() => {\n                    this.abortPendingQuery();\n                    select2?.search?.addClass?.('select2-active').parent().addClass('select2-active');\n                    this.queryPromise = this.asyncSearch(searchQuery, result => {\n                        select2?.search?.removeClass?.('select2-active').parent().removeClass('select2-active');\n                        this.queryPromise = null;\n                        query.callback({\n                            results: this.mapItems(result.items),\n                            more: result.more\n                        });\n                    });\n                    (this.queryPromise?.catch || this.queryPromise?.fail)?.call(this.queryPromise, () => {\n                        this.queryPromise = null;\n                        select2?.search?.removeClass?.('select2-active').parent().removeClass('select2-active');\n                    });\n                }, !query.term ? 0 : this.getTypeDelay());\n            }\n\n            opt.initSelection = (element, callback) => {\n                var val = element.val();\n                if (val == null || val == '') {\n                    callback(null);\n                    return;\n                }\n\n                var isMultiple = this.isMultiple();\n                var idList = isMultiple ? val.split(',') : [val]; \n                var searchQuery = {\n                    idList: idList\n                }\n\n                this.initSelectionPromise?.abort?.();\n                this.initSelectionPromise = this.asyncSearch(searchQuery, result => {\n                    this.initSelectionPromise = null;\n                    if (isMultiple) {\n                        var items = (result.items || []).map(x => this.mapItem(x));\n                        this._itemById = this._itemById || {};\n                        for (var item of items)\n                            this._itemById[item.id] = item;\n                        if (this.isAutoComplete &&\n                            items.length != idList.length) {\n                            for (var v of idList) {\n                                if (!any(items, z => z.id == v)) {\n                                    items.push({\n                                        id: v,\n                                        text: v\n                                    });\n                                }\n                            }\n                        }\n                        callback(items);\n                    }\n                    else if (!result.items || !result.items.length) {\n                        if (this.isAutoComplete) {\n                            callback({\n                                id: val,\n                                text: val\n                            });\n                        }\n                        else\n                            callback(null);\n                    }\n                    else {\n                        var item = this.mapItem(result.items[0]);\n                        this._itemById = this._itemById || {};\n                        this._itemById[item.id] = item;\n                        callback(item);\n                    }\n                });\n                (this.initSelectionPromise.catch || this.initSelectionPromise.fail)?.call(this.initSelectionPromise, () => {\n                    this.initSelectionPromise = null;\n                });\n            }\n        }\n        else {\n            opt.data = this._items;\n            opt.query = (query) => {\n                var items = Select2Editor.filterByText(this._items, x => x.text, query.term);\n                var pageSize = this.getPageSize();\n                query.callback({\n                    results: items.slice((query.page - 1) * pageSize, query.page * pageSize),\n                    more: items.length >= query.page * pageSize\n                });\n            }\n            opt.initSelection = (element, callback) => {\n                var val = element.val();\n                var isAutoComplete = this.isAutoComplete();\n                if (this.isMultiple()) {\n                    var list = [];\n                    for (var z of val.split(',')) {\n                        var item2 = this._itemById[z];\n                        if (item2 == null && isAutoComplete) {\n                            item2 = { id: z, text: z };\n                            this.addItem(item2);\n                        }\n                        if (item2 != null) {\n                            list.push(item2);\n                        }\n                    }\n                    callback(list);\n                    return;\n                }\n                var it = this._itemById[val];\n                if (it == null && isAutoComplete) {\n                    it = { id: val, text: val };\n                    this.addItem(it);\n                }\n                callback(it);\n            }\n        }\n\n        if ((this.options as Select2EditorOptions).minimumResultsForSearch != null)\n            opt.minimumResultsForSearch = (this.options as Select2EditorOptions).minimumResultsForSearch;\n\n        if (this.isAutoComplete() || this.useInplaceAdd())\n            opt.createSearchChoice = this.getCreateSearchChoice(null);\n\n        return opt;\n    }\n\n    get_delimited() {\n        return !!(this.options as Select2EditorOptions).delimited;\n    }\n\n    public get items(): Select2Item[] {\n        if (this.hasAsyncSource())\n            throw new Error(\"Can't read items property of an async select editor!\");\n\n        return this._items || [];\n    }\n\n    public set items(value: Select2Item[]) {\n        if (this.hasAsyncSource())\n            throw new Error(\"Can't set items of an async select editor!\");\n\n        this._items = value || [];\n        this._itemById = {};\n        for (var item of this._items)\n            this._itemById[item.id] = item;\n    }\n\n    protected get itemById(): { [key: string]: Select2Item } {\n        if (this.hasAsyncSource())\n            throw new Error(\"Can't read items property of an async select editor!\");\n\n        return this._itemById;\n    }\n\n    protected set itemById(value: { [key: string]: Select2Item }) {\n        if (this.hasAsyncSource())\n            throw new Error(\"Can't set itemById of an async select editor!\");\n\n        this._itemById = value || {};\n    }\n\n    public clearItems() {\n        if (this.hasAsyncSource())\n            throw new Error(\"Can't clear items of an async select editor!\");\n\n        this._items.length = 0;\n        this._itemById = {};\n    }\n\n    public addItem(item: Select2Item) {\n        if (this.hasAsyncSource())\n            throw new Error(\"Can't add item to an async select editor!\");\n\n        this._items.push(item);\n        this._itemById[item.id] = item;\n    }\n\n    public addOption(key: string, text: string, source?: any, disabled?: boolean) {\n        this.addItem({\n            id: key,\n            text: text,\n            source: source,\n            disabled: disabled\n        });\n    }\n\n    protected addInplaceCreate(addTitle: string, editTitle: string) {\n        var self = this;\n        addTitle = (addTitle ?? localText('Controls.SelectEditor.InplaceAdd'));\n        editTitle = (editTitle ?? localText('Controls.SelectEditor.InplaceEdit'));\n        var inplaceButton = $('<a><b/></a>')\n            .addClass('inplace-button inplace-create')\n            .attr('title', addTitle)\n            .insertAfter(this.element).click(function (e) {\n                self.inplaceCreateClick(e);\n            });\n\n        this.get_select2Container().add(this.element).addClass('has-inplace-button');\n\n        this.element.change(() => {\n            var isNew = this.isMultiple() || isEmptyOrNull(this.get_value());\n            inplaceButton.attr('title', (isNew ? addTitle : editTitle)).toggleClass('edit', !isNew);\n        });\n\n        this.element.change((e: any, valueSet: boolean) => {\n            if (valueSet === true)\n                return;\n            if (this.isMultiple()) {\n                var values = this.get_values();\n                if (values.length > 0 && values[values.length - 1] == (-2147483648).toString()) {\n                    this.set_values(values.slice(0, values.length - 1));\n                    this.inplaceCreateClick(e);\n                }\n            }\n            else if (this.get_value() == (-2147483648).toString()) {\n                this.set_value(null);\n                this.inplaceCreateClick(e);\n            }\n        });\n\n        if (this.isMultiple()) {\n            this.get_select2Container().on('dblclick.' + this.uniqueName, '.select2-search-choice', (e3: JQueryEventObject) => {\n                var q = $(e3.target);\n                if (!q.hasClass('select2-search-choice')) {\n                    q = q.closest('.select2-search-choice');\n                }\n                var index = q.index();\n                var values1 = this.get_values();\n                if (index < 0 || index >= this.get_values().length) {\n                    return;\n                }\n                (e3 as any)['editItem'] = values1[index];\n                this.inplaceCreateClick(e3);\n            });\n        }\n    }\n\n    protected useInplaceAdd(): boolean {\n        return !this.isAutoComplete() &&\n            (this.options as Select2EditorOptions).inplaceAdd &&\n            ((this.options as Select2EditorOptions).inplaceAddPermission == null ||\n                Authorization.hasPermission((this.options as Select2EditorOptions).inplaceAddPermission));\n    }\n\n    protected isAutoComplete(): boolean {\n        return !!(this.options as Select2EditorOptions).autoComplete;\n    }\n\n    public getCreateSearchChoice(getName: (z: any) => string) {\n        return (s: string) => {\n\n            this.lastCreateTerm = s;\n            s = (Select2.util.stripDiacritics(s) ?? '').toLowerCase();\n\n            if (isTrimmedEmpty(s)) {\n                return null;\n            }\n\n            var isAsyncSource = false;\n\n            if (any(this._items || [], (x: Select2Item) => {\n                    var text = getName ? getName(x.source) : x.text;\n                    return Select2.util.stripDiacritics((text ?? '')).toLowerCase() == s;\n            }))\n                return null;\n\n            if (!any(this._items || [], x1 => {\n                return (Select2.util.stripDiacritics(x1.text) ?? '').toLowerCase().indexOf(s) !== -1;\n            })) {\n                if (this.isAutoComplete()) {\n                    return {\n                        id: this.lastCreateTerm,\n                        text: this.lastCreateTerm\n                    };\n                }\n\n                return {\n                    id: (-2147483648).toString(),\n                    text: localText('Controls.SelectEditor.NoResultsClickToDefine')\n                };\n            }\n\n            if (this.isAutoComplete()) {\n                return {\n                    id: this.lastCreateTerm,\n                    text: this.lastCreateTerm\n                };\n            }\n\n            return {\n                id: (-2147483648).toString(),\n                text: localText('Controls.SelectEditor.ClickToDefine')\n            };\n        }\n    }\n\n    setEditValue(source: any, property: PropertyItem) {\n        var val = source[property.name];\n        if(Array.isArray(val)) {\n            this.set_values(val);\n        }\n        else {\n            this.set_value((val == null ? null : val.toString()));\n        }\n    }\n\n    getEditValue(property: PropertyItem, target: any) {\n        if (!this.isMultiple() || this.get_delimited()) {\n            target[property.name] = this.get_value();\n        }\n        else {\n            target[property.name] = this.get_values();\n        }\n    }\n\n    protected get_select2Container(): JQuery {\n        return this.element.prevAll('.select2-container');\n    }\n\n    protected get_items() {\n        return this.items;\n    }\n\n    protected get_itemByKey() {\n        return this.itemById;\n    }\n\n    public static filterByText<TItem>(items: TItem[], getText: (item: TItem) => string, term: string): TItem[] {\n        if (term == null || term.length == 0)\n            return items;\n\n        term = Select2.util.stripDiacritics(term).toUpperCase();\n\n        var contains: TItem[] = [];\n        function filter(item: TItem): boolean {\n            var text = getText(item);\n            if (text == null || !text.length)\n                return false;\n            text = Select2.util.stripDiacritics(text).toUpperCase();\n            if (startsWith(text, term))\n                return true;\n            if (text.indexOf(term) >= 0)\n                contains.push(item);\n            return false;\n        }\n\n        return items.filter(filter).concat(contains);\n    }\n\n    get_value() {\n        var val;\n        if (this.element.data('select2')) {\n            val = this.element.select2('val');\n            if (val != null && Array.isArray(val)) {\n                return val.join(',');\n            }\n        }\n        else\n            val = this.element.val();\n\n        return val;\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string) {\n\n        if (value != this.get_value()) {\n            var val: any = value;\n            if (!isEmptyOrNull(value) && this.isMultiple()) {\n                val = value.split(String.fromCharCode(44)).map(function (x) {\n                    return trimToNull(x);\n                }).filter(function (x1) {\n                    return x1 != null;\n                });\n            }\n\n            var el = this.element;\n            el.select2('val', val);\n            el.data('select2-change-triggered', true);\n            try {\n                el.triggerHandler('change', [true]); // valueSet: true\n            } finally {\n                el.data('select2-change-triggered', false);\n            }\n\n            this.updateInplaceReadOnly();\n        }\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n\n    get selectedItem(): TItem {\n        let selectedValue = this.get_value();\n        if (selectedValue && this._itemById) {\n            let item = this._itemById[selectedValue];\n            if (item)\n                return item.source;\n        }\n        return null;\n    }\n\n    get selectedItems(): TItem[] {\n        let selectedValues = this.values;\n        var result = [];\n        for (var value of selectedValues) {\n            if (value && this._itemById) {\n                let item = this._itemById[value];\n                if (item && item.source)\n                    result.push(item.source);\n                else\n                    result.push(null);\n            }\n        }\n        return result;\n    }\n\n    protected get_values(): string[] {\n\n        var val = this.element.select2('val');\n        if (val == null) {\n            return [];\n        }\n\n        if (Array.isArray(val)) {\n            return val;\n        }\n\n        var str = val;\n        if (isEmptyOrNull(str)) {\n            return [];\n        }\n\n        return [str];\n    }\n\n    get values(): string[] {\n        return this.get_values();\n    }\n\n    protected set_values(value: string[]) {\n\n        if (value == null || value.length === 0) {\n            this.set_value(null);\n            return;\n        }\n\n        this.set_value(value.join(','));\n    }\n\n    set values(value: string[]) {\n        this.set_values(value);\n    }\n\n    protected get_text(): string {\n        return (this.element.select2('data') ?? {}).text;\n    }\n\n    get text(): string {\n        return this.get_text();\n    }\n\n    get_readOnly(): boolean {\n        return !isEmptyOrNull(this.element.attr('readonly'));\n    }\n\n    get readOnly(): boolean {\n        return this.get_readOnly();\n    }\n\n    private updateInplaceReadOnly(): void {\n        var readOnly = this.get_readOnly() &&\n            (this.isMultiple() || !this.value);\n\n        this.element.nextAll('.inplace-create')\n            .attr('disabled', (readOnly ? 'disabled' : ''))\n            .css('opacity', (readOnly ? '0.1' : ''))\n            .css('cursor', (readOnly ? 'default' : ''));\n    }\n\n    set_readOnly(value: boolean) {\n        if (value !== this.get_readOnly()) {\n            this.element.attr(\"readonly\", value ? \"readonly\" : null);\n            this.updateInplaceReadOnly();\n        }\n    }\n\n    set readOnly(value: boolean) {\n        this.set_readOnly(value);\n    }\n\n    protected getCascadeFromValue(parent: Widget<any>) {\n        return EditorUtils.getValue(parent);\n    }\n\n    protected cascadeLink: CascadedWidgetLink<Widget<any>>;\n\n    protected setCascadeFrom(value: string) {\n\n        if (isEmptyOrNull(value)) {\n            if (this.cascadeLink != null) {\n                this.cascadeLink.set_parentID(null);\n                this.cascadeLink = null;\n            }\n            (this.options as Select2EditorOptions).cascadeFrom = null;\n            return;\n        }\n\n        this.cascadeLink = new CascadedWidgetLink<Widget<any>>(Widget, this, p => {\n            this.set_cascadeValue(this.getCascadeFromValue(p));\n        });\n\n        this.cascadeLink.set_parentID(value);\n        (this.options as Select2EditorOptions).cascadeFrom = value;\n    }\n\n    protected get_cascadeFrom(): string {\n        return (this.options as Select2EditorOptions).cascadeFrom;\n    }\n\n    get cascadeFrom(): string {\n        return this.get_cascadeFrom();\n    }\n\n    protected set_cascadeFrom(value: string) {\n        if (value !== (this.options as Select2EditorOptions).cascadeFrom) {\n            this.setCascadeFrom(value);\n            this.updateItems();\n        }\n    }\n\n    set cascadeFrom(value: string) {\n        this.set_cascadeFrom(value);\n    }\n\n    protected get_cascadeField() {\n        return ((this.options as Select2EditorOptions).cascadeField ?? (this.options as Select2EditorOptions).cascadeFrom);\n    }\n\n    get cascadeField(): string {\n        return this.get_cascadeField();\n    }\n\n    protected set_cascadeField(value: string) {\n        (this.options as Select2EditorOptions).cascadeField = value;\n    }\n\n    set cascadeField(value: string) {\n        this.set_cascadeField(value);\n    }\n\n    protected get_cascadeValue(): any {\n        return (this.options as Select2EditorOptions).cascadeValue;\n    }\n\n    get cascadeValue(): any {\n        return this.get_cascadeValue();\n    }\n\n    protected set_cascadeValue(value: any) {\n        if ((this.options as Select2EditorOptions).cascadeValue !== value) {\n            (this.options as Select2EditorOptions).cascadeValue = value;\n            this.set_value(null);\n            this.updateItems();\n        }\n    }\n\n    set cascadeValue(value: any) {\n        this.set_cascadeValue(value);\n    }\n\n    protected get_filterField() {\n        return (this.options as Select2EditorOptions).filterField;\n    }\n\n    get filterField(): string {\n        return this.get_filterField();\n    }\n\n    protected set_filterField(value: string) {\n        (this.options as Select2EditorOptions).filterField = value;\n    }\n\n    set filterField(value: string) {\n        this.set_filterField(value);\n    }\n\n    protected get_filterValue(): any {\n        return (this.options as Select2EditorOptions).filterValue;\n    }\n\n    get filterValue(): any {\n        return this.get_filterValue();\n    }\n\n    protected set_filterValue(value: any) {\n        if ((this.options as Select2EditorOptions).filterValue !== value) {\n            (this.options as Select2EditorOptions).filterValue = value;\n            this.set_value(null);\n            this.updateItems();\n        }\n    }\n\n    set filterValue(value: any) {\n        this.set_filterValue(value);\n    }\n\n    protected cascadeItems(items: TItem[]) {\n\n        var val = this.get_cascadeValue();\n\n        if (val == null || val === '') {\n\n            if (!isEmptyOrNull(this.get_cascadeField())) {\n                return [];\n            }\n\n            return items;\n        }\n\n        var key = val.toString();\n        var fld = this.get_cascadeField();\n\n        return items.filter(x => {\n            var itemKey = (x as any)[fld] ?? ReflectionUtils.getPropertyValue(x, fld);\n            return !!(itemKey != null && itemKey.toString() === key);\n        });\n    }\n\n    protected filterItems(items: TItem[]) {\n        var val = this.get_filterValue();\n\n        if (val == null || val === '') {\n            return items;\n        }\n\n        var key = val.toString();\n        var fld = this.get_filterField();\n\n        return items.filter(x => {\n            var itemKey = (x as any)[fld] ?? ReflectionUtils.getPropertyValue(x, fld);\n            return !!(itemKey != null && itemKey.toString() === key);\n        });\n    }\n\n    protected updateItems() {\n    }\n\n    protected getDialogTypeKey() {\n        if ((this.options as Select2EditorOptions).dialogType != null) {\n            return (this.options as Select2EditorOptions).dialogType;\n        }\n\n        return null;\n    }\n\n    protected createEditDialog(callback: (dlg: IEditDialog) => void) {\n        var dialogTypeKey = this.getDialogTypeKey();\n        var dialogType = DialogTypeRegistry.get(dialogTypeKey);\n        Widget.create({\n            type: dialogType,\n            init: x => callback(x as any)\n        });\n    }\n\n    public onInitNewEntity: (entity: TItem) => void;\n\n    protected initNewEntity(entity: TItem) {\n        if (!isEmptyOrNull(this.get_cascadeField())) {\n            (entity as any)[this.get_cascadeField()] = this.get_cascadeValue();\n        }\n\n        if (!isEmptyOrNull(this.get_filterField())) {\n            (entity as any)[this.get_filterField()] = this.get_filterValue();\n        }\n\n        if (this.onInitNewEntity != null) {\n            this.onInitNewEntity(entity);\n        }\n    }\n\n    protected setEditDialogReadOnly(dialog: any): void {\n        // an ugly workaround\n        dialog.element && dialog.element\n            .find('.tool-button.delete-button')\n            .addClass('disabled')\n            .unbind('click');\n    }\n\n    protected editDialogDataChange() {\n    }\n\n    protected setTermOnNewEntity(entity: TItem, term: string) {\n    }\n\n    protected inplaceCreateClick(e: JQueryEventObject) {\n\n        if (this.get_readOnly() &&\n            ((this.isMultiple() && !(e as any)['editItem']) || !this.value))\n            return;\n\n        this.createEditDialog(dialog => {\n\n            if (this.get_readOnly())\n                this.setEditDialogReadOnly(dialog);\n\n            SubDialogHelper.bindToDataChange(dialog, this, (x, dci) => {\n                this.editDialogDataChange();\n                this.updateItems();\n                this.lastCreateTerm = null;\n\n                if ((dci.type === 'create' || dci.type === 'update') &&\n                    dci.entityId != null) {\n                    var id = dci.entityId.toString();\n\n                    if (this.isMultiple()) {\n                        var values = this.get_values().slice();\n                        if (values.indexOf(id) < 0) {\n                            values.push(id);\n                        }\n                        this.set_values(null);\n                        this.set_values(values.slice());\n                    }\n                    else {\n                        this.set_value(null);\n                        this.set_value(id);\n                    }\n                }\n                else if (this.isMultiple() && dci.type === 'delete' &&\n                    dci.entityId != null) {\n                    var id1 = dci.entityId.toString();\n                    var values1 = this.get_values().slice();\n\n                    var idx1 = values1.indexOf(id1);\n                    if (idx1 >= 0)\n                        values1.splice(idx1, 1);\n\n                    this.set_values(values1.slice());\n                }\n                else if (!this.isMultiple()) {\n                    this.set_value(null);\n                }\n            }, true);\n\n            var editItem = (e as any)['editItem'];\n            if (editItem != null) {\n                dialog.load(editItem, () => {\n                    (dialog as any).dialogOpen(this.openDialogAsPanel);\n                }, null);\n            }\n            else if (this.isMultiple() || isEmptyOrNull(this.get_value())) {\n                var entity: TItem = {} as any;\n                this.setTermOnNewEntity(entity, trimToEmpty(this.lastCreateTerm));\n                this.initNewEntity(entity);\n                dialog.load(entity, () => {\n                    (dialog as any).dialogOpen(this.openDialogAsPanel);\n                }, null);\n            }\n            else {\n                dialog.load(this.get_value(), () => {\n                    (dialog as any).dialogOpen(this.openDialogAsPanel);\n                }, null);\n            }\n        });\n    }\n\n    public openDialogAsPanel: boolean;\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { isEmptyOrNull } from \"../../q\";\nimport { Select2CommonOptions, Select2Editor } from \"./select2editor\";\n\n@Decorators.registerClass('Serenity.SelectEditor')\nexport class SelectEditor extends Select2Editor<SelectEditorOptions, Select2Item> {\n    constructor(hidden: JQuery, opt?: SelectEditorOptions) {\n        super(hidden, opt);\n        this.updateItems();\n    }\n\n    getItems() {\n        return this.options.items || [];\n    }\n\n    protected emptyItemText() {\n        if (!isEmptyOrNull(this.options.emptyOptionText)) {\n            return this.options.emptyOptionText;\n        }\n        return super.emptyItemText();\n    }\n\n    updateItems() {\n        var items = this.getItems();\n        this.clearItems();\n\n        if (items.length > 0) {\n            var isStrings = typeof (items[0]) === 'string';\n            for (var item of items) {\n                var key = isStrings ? item : item[0];\n                var text = isStrings ? item : (item[1] ?? item[0]);\n                this.addOption(key, text, item, false);\n            }\n        }\n    }\n}\n\nexport interface SelectEditorOptions extends Select2CommonOptions {\n    items?: any[];\n    emptyOptionText?: string;\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { startsWith } from \"../../q\";\nimport { SelectEditor, SelectEditorOptions } from \"./selecteditor\";\n\n@Decorators.registerEditor('Serenity.DateYearEditor')\nexport class DateYearEditor extends SelectEditor {\n\n    constructor(hidden: JQuery, opt: DateYearEditorOptions) {\n        super(hidden, opt);\n\n        this.updateItems();\n    }\n\n    getItems() {\n        var opt = this.options as DateYearEditorOptions;\n\n        if (opt.items != null && opt.items.length >= 1) {\n            return opt.items;\n        }\n\n        var years = [];\n        var minYear = (new Date()).getFullYear();\n        var maxYear = (new Date()).getFullYear();\n\n        opt.minYear = (opt.minYear ?? '-10').toString();\n        if (startsWith(opt.minYear, '-')) {\n            minYear -= parseInt(opt.minYear.substr(1), 10);\n        }\n        else if (startsWith(opt.minYear, '+')) {\n            minYear += parseInt(opt.minYear.substr(1), 10);\n        }\n        else {\n            minYear = parseInt(opt.minYear, 10);\n        }\n\n        opt.maxYear = (opt.maxYear ?? '+10').toString();\n        if (startsWith(opt.maxYear, '-')) {\n            maxYear -= parseInt(opt.maxYear.substr(1), 10);\n        }\n        else if (startsWith(opt.maxYear, '+')) {\n            maxYear += parseInt(opt.maxYear.substr(1), 10);\n        }\n        else {\n            maxYear = parseInt(opt.maxYear, 10);\n        }\n\n        if (opt.descending) {\n            for (var i = maxYear; i >= minYear; i--) {\n                years.push(i.toString());\n            }\n        }\n        else {\n            for (var i1 = minYear; i1 <= maxYear; i1++) {\n                years.push(i1.toString());\n            }\n        }\n\n        return years;\n    }\n}\n\nexport interface DateYearEditorOptions extends SelectEditorOptions {\n    minYear?: string;\n    maxYear?: string;\n    descending?: boolean;\n}", "\uFEFFimport { Decorators, EnumKeyAttribute } from \"../../decorators\";\nimport { Enum, getAttributes, tryGetText } from \"../../q\";\nimport { EnumTypeRegistry } from \"../../types/enumtyperegistry\";\nimport { Select2CommonOptions, Select2Editor } from \"./select2editor\";\n\nexport interface EnumEditorOptions extends Select2CommonOptions {\n    enumKey?: string;\n    enumType?: any;\n}\n\n@Decorators.registerEditor('Serenity.EnumEditor')\nexport class EnumEditor extends Select2Editor<EnumEditorOptions, Select2Item> {\n    constructor(hidden: JQuery, opt: EnumEditorOptions) {\n        super(hidden, opt);\n        this.updateItems();\n    }\n\n    protected updateItems(): void {\n        this.clearItems();\n\n        var enumType = this.options.enumType || EnumTypeRegistry.get(this.options.enumKey);\n        var enumKey = this.options.enumKey;\n\n        if (enumKey == null && enumType != null) {\n            var enumKeyAttr = getAttributes(enumType, EnumKeyAttribute, false);\n            if (enumKeyAttr.length > 0) {\n                enumKey = enumKeyAttr[0].value;\n            }\n        }\n\n        var values = Enum.getValues(enumType);\n        for (var x of values) {\n            var name = Enum.toString(enumType, x);\n            this.addOption(parseInt(x, 10).toString(),\n                (tryGetText('Enums.' + enumKey + '.' + name) ?? name), null, false);\n        }\n    }\n\n    protected allowClear() {\n        return (this.options.allowClear ?? true);\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { endsWith, getInstanceType, getLookup, getLookupAsync, getTypeFullName, Lookup, reloadLookup, ScriptData } from \"../../q\";\nimport { Select2Editor, Select2EditorOptions, Select2SearchPromise, Select2SearchQuery, Select2SearchResult } from \"./select2editor\";\n\nexport interface LookupEditorOptions extends Select2EditorOptions {\n    lookupKey?: string;\n    async?: boolean;\n}\n\n@Decorators.registerEditor(\"Serenity.LookupEditorBase\")\nexport abstract class LookupEditorBase<TOptions extends LookupEditorOptions, TItem> extends Select2Editor<TOptions, TItem> {\n\n    constructor(input: JQuery, opt?: TOptions) {\n        super(input, opt);\n\n        if (!this.hasAsyncSource()) {\n            this.updateItems();\n            var self = this;\n            ScriptData.bindToChange('Lookup.' + this.getLookupKey(), this.uniqueName, function () {\n                if (!self.hasAsyncSource())\n                    self.updateItems();\n            });\n        }\n    }\n\n    hasAsyncSource(): boolean {\n        return !!this.options.async;\n    }\n\n    destroy(): void {\n        if (!this.hasAsyncSource())\n            ScriptData.unbindFromChange(this.uniqueName);\n\n        super.destroy();\n    }\n\n    protected getLookupKey(): string {\n        if (this.options.lookupKey != null) {\n            return this.options.lookupKey;\n        }\n\n        var key = getTypeFullName(getInstanceType(this));\n\n        var idx = key.indexOf('.');\n        if (idx >= 0) {\n            key = key.substring(idx + 1);\n        }\n\n        if (endsWith(key, 'Editor')) {\n            key = key.substr(0, key.length - 6);\n        }\n\n        return key;\n    }\n\n    protected lookup: Lookup<TItem>;\n\n    protected getLookupAsync(): PromiseLike<Lookup<TItem>> {\n        return getLookupAsync<TItem>(this.getLookupKey());\n    }\n\n    protected getLookup(): Lookup<TItem> {\n        return getLookup<TItem>(this.getLookupKey());\n    }\n\n    protected getItems(lookup: Lookup<TItem>) {\n        return this.filterItems(this.cascadeItems(lookup.items));\n    }\n\n    protected getIdField() {\n        return this.lookup != null ? this.lookup.idField : super.getIdField();\n    }\n\n    protected getItemText(item: TItem, lookup: Lookup<TItem>) {\n        if (lookup == null)\n            return super.itemText(item);\n\n        var textValue = lookup.textFormatter ? lookup.textFormatter(item) : (item as any)[lookup.textField];\n        return textValue == null ? '' : textValue.toString();\n    }\n\n    protected mapItem(item: TItem): Select2Item {\n        return {\n            id: this.itemId(item),\n            text: this.getItemText(item, this.lookup),\n            disabled: this.getItemDisabled(item, this.lookup),\n            source: item\n        };\n    }\n\n    protected getItemDisabled(item: TItem, lookup: Lookup<TItem>) {\n        return super.itemDisabled(item);\n    }\n\n    public updateItems() {\n        if (this.hasAsyncSource())\n            return;\n\n        this.clearItems();\n        this.lookup = this.getLookup();\n        var items = this.getItems(this.lookup);\n        for (var item of items)\n            this.addItem(this.mapItem(item));\n    }\n\n    protected asyncSearch(query: Select2SearchQuery, results: (result: Select2SearchResult<TItem>) => void): Select2SearchPromise {\n        return this.getLookupAsync().then(lookup => {\n            this.lookup = lookup;\n\n            var items = this.getItems(this.lookup);\n\n            if (query.idList != null) {\n                items = items.filter(x => query.idList.indexOf(this.itemId(x)) >= 0);\n            }\n\n            function getText(item: TItem) {\n                return this.getItemText(item, this.lookup);\n            }\n\n            items = Select2Editor.filterByText(items, getText.bind(this), query.searchTerm);\n\n            results({\n                items: items.slice(query.skip, query.take),\n                more: items.length >= query.take\n            });\n        }) as any;\n    }\n\n    protected getDialogTypeKey() {\n        var dialogTypeKey = super.getDialogTypeKey();\n        if (dialogTypeKey)\n            return dialogTypeKey;\n\n        return this.getLookupKey();\n    }\n\n    protected setCreateTermOnNewEntity(entity: TItem, term: string) {\n        (entity as any)[this.getLookup().textField] = term;\n    }\n\n    protected editDialogDataChange() {\n        reloadLookup(this.getLookupKey());\n    }\n}\n\n@Decorators.registerEditor(\"Serenity.LookupEditor\")\nexport class LookupEditor extends LookupEditorBase<LookupEditorOptions, any> {\n    constructor(hidden: JQuery, opt?: LookupEditorOptions) {\n        super(hidden, opt);\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { ColumnSelection, Criteria, isEmptyOrNull, ListRequest, ListResponse, resolveUrl, serviceCall, ServiceOptions, startsWith } from \"../../q\";\nimport { Select2Editor, Select2EditorOptions, Select2SearchPromise, Select2SearchQuery, Select2SearchResult } from \"./select2editor\";\n\nexport interface ServiceLookupEditorOptions extends Select2EditorOptions {\n    service?: string;\n    idField: string;\n    textField: string;\n    pageSize?: number;\n    minimumResultsForSearch?: any;\n    sort: string[];\n    columnSelection?: ColumnSelection;\n    includeColumns?: string[];\n    excludeColumns?: string[];\n    includeDeleted?: boolean;\n    containsField?: string;\n    equalityFilter?: any;\n    criteria?: any[];\n}\n\n@Decorators.registerEditor(\"Serenity.ServiceLookupEditorBase\")\nexport abstract class ServiceLookupEditorBase<TOptions extends ServiceLookupEditorOptions, TItem> extends Select2Editor<TOptions, TItem> {\n\n    constructor(input: JQuery, opt?: TOptions) {\n        super(input, opt);\n    }\n\n    protected getDialogTypeKey() {\n        var dialogTypeKey = super.getDialogTypeKey();\n        if (dialogTypeKey)\n            return dialogTypeKey;\n\n        var service = this.getService();\n        if (startsWith(service, \"~/Services/\"))\n            service = service.substr(\"~/Services/\".length);\n\n        if (service.split('/').length == 3)\n            service = service.substr(0, service.lastIndexOf('/'));\n\n        return service.replace(\"/\", \".\");\n    }\n\n    protected getService(): string {\n        return this.options.service;\n    }\n\n    protected getServiceUrl() {\n        var url = this.getService();\n        if (url == null)\n            throw new Error(\"ServiceLookupEditor requires 'service' option to be configured!\");\n\n        if (!startsWith(url, \"~\") && !startsWith(url, \"/\") && url.indexOf('://') < 0)\n            url = \"~/Services/\" + url;\n\n        if (startsWith(url, \"~\"))\n            url = resolveUrl(url);\n\n        return url;\n    }\n\n    protected getIncludeColumns() {\n        var include = this.options.includeColumns || [];\n        var idField = this.getIdField();\n\n        if (idField && include.indexOf(idField) < 0)\n            include.push(idField);\n\n        var textField = this.getTextField();\n        if (textField && include.indexOf(textField) < 0)\n            include.push(textField);\n\n        return include;\n    }\n\n    protected getSort() {\n        return this.options.sort || (this.getTextField() ? [this.getTextField()] : null);\n    }\n\n    protected getCascadeCriteria(): any[] {\n\n        var val = this.get_cascadeValue();\n\n        if (val == null || val === '') {\n\n            if (!isEmptyOrNull(this.get_cascadeField())) {\n                return ['0', '=', '1'];\n            }\n\n            return null;\n        }\n\n        var fld = this.get_cascadeField();\n\n        return Criteria(fld).eq(val);\n    }\n\n    protected getFilterCriteria(): any[] {\n        var val = this.get_filterValue();\n\n        if (val == null || val === '') {\n            return null;\n        }\n\n        var fld = this.get_filterField();\n        return [[fld], '=', val];\n    }\n\n    protected getIdListCriteria(idList: any[]): any[] {\n        if (idList == null)\n            return null;\n\n        if (idList.length == 0)\n            return ['0', '=', '1'];\n\n        var idField = this.getIdField();\n        if (idField == null)\n            throw new Error(\"ServiceLookupEditor requires 'idField' option to be configured!\");\n\n        return Criteria(idField).in(idList);\n    }\n\n    protected getCriteria(query: Select2SearchQuery): any[] {\n        return Criteria.and(\n            Criteria.and(this.getIdListCriteria(query.idList), this.options.criteria),\n            Criteria.and(this.getCascadeCriteria(), this.getFilterCriteria()));\n    }\n\n    protected getListRequest(query: Select2SearchQuery): ListRequest {\n\n        var request: ListRequest = {};\n\n        if (query.searchTerm)\n            request.ContainsText = query.searchTerm;\n\n        request.Sort = this.getSort();\n        request.ColumnSelection = this.options.columnSelection || ColumnSelection.KeyOnly;\n        request.IncludeColumns = this.getIncludeColumns();\n        request.ExcludeColumns = this.options.excludeColumns;\n        request.ContainsField = this.options.containsField;\n        request.EqualityFilter = this.options.equalityFilter;\n        request.Criteria = this.getCriteria(query);\n        request.Skip = query.skip || 0;\n        request.Take = query.take ? (query.checkMore ? query.take + 1 : query.take) : 0;\n        request.IncludeDeleted = this.options.includeDeleted;\n        request.ExcludeTotalCount = true;\n\n        return request;\n    }\n\n    protected getServiceCallOptions(query: Select2SearchQuery, results: (result: Select2SearchResult<TItem>) => void): ServiceOptions<ListResponse<TItem>> {\n        return {\n            blockUI: false,\n            url: this.getServiceUrl(),\n            request: this.getListRequest(query),\n            onSuccess: response => {\n                var items = response.Entities || [];\n\n                if (items && query.take && query.checkMore && response.Entities.length > items.length)\n                    items = items.slice(0, query.take);\n\n                results({\n                    items: items.slice(0, query.take),\n                    more: query.checkMore && query.take && items.length > query.take\n                });\n            }\n        };\n    }\n\n    protected hasAsyncSource() {\n        return true;\n    }\n\n    protected asyncSearch(query: Select2SearchQuery, results: (result: Select2SearchResult<TItem>) => void): Select2SearchPromise {\n        var opt = this.getServiceCallOptions(query, results);\n        return serviceCall(opt);\n    }\n}\n\n@Decorators.registerEditor('Serenity.ServiceLookupEditor')\nexport class ServiceLookupEditor extends ServiceLookupEditorBase<ServiceLookupEditorOptions, any> {\n    constructor(hidden: JQuery, opt?: ServiceLookupEditorOptions) {\n        super(hidden, opt);\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IReadOnly, IStringValue } from \"../../interfaces\";\nimport { endsWith, isEmptyOrNull, isTrimmedEmpty, resolveUrl, localText, trimToNull } from \"../../q\";\nimport { LazyLoadHelper } from \"../helpers/lazyloadhelper\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface HtmlContentEditorOptions {\n    cols?: any;\n    rows?: any;\n}\n\nexport interface CKEditorConfig {\n}    \n\n@Decorators.registerEditor('Serenity.HtmlContentEditor', [IStringValue, IReadOnly])\n@Decorators.element('<textarea/>')\nexport class HtmlContentEditor extends Widget<HtmlContentEditorOptions>\n    implements IStringValue, IReadOnly {\n\n    private _instanceReady: boolean;\n\n    constructor(textArea: JQuery, opt?: HtmlContentEditorOptions) {\n        super(textArea, opt)\n\n        this._instanceReady = false;\n        HtmlContentEditor.includeCKEditor();\n\n        var id = textArea.attr('id');\n        if (isTrimmedEmpty(id)) {\n            textArea.attr('id', this.uniqueName);\n            id = this.uniqueName;\n        }\n\n        if (this.options.cols != null)\n            textArea.attr('cols', this.options.cols);\n\n        if (this.options.rows != null)\n            textArea.attr('rows', this.options.rows);\n\n        this.addValidationRule(this.uniqueName, e => {\n            if (e.hasClass('required')) {\n                var value = trimToNull(this.get_value());\n                if (value == null)\n                    return localText('Validation.Required');\n            }\n\n            return null;\n        });\n\n        LazyLoadHelper.executeOnceWhenShown(this.element, () => {\n            var config = this.getConfig();\n            (window as any)['CKEDITOR'] && (window as any)['CKEDITOR'].replace(id, config);\n        });\n    }\n\n    protected instanceReady(x: any): void {\n        this._instanceReady = true;\n        $(x.editor.container.$).addClass(this.element.attr('class'));\n        this.element.addClass('select2-offscreen').css('display', 'block');\n\n        // for validation to work\n        x.editor.setData(this.element.val());\n        x.editor.setReadOnly(this.get_readOnly());\n    }\n\n    protected getLanguage(): string {\n        if (!(window as any)['CKEDITOR'])\n            return 'en';\n\n        var CKEDITOR = (window as any)['CKEDITOR'];\n\n        var lang = (trimToNull($('html').attr('lang')) ?? 'en');\n        if (!!CKEDITOR.lang.languages[lang]) {\n            return lang;\n        }\n        if (lang.indexOf(String.fromCharCode(45)) >= 0) {\n            lang = lang.split(String.fromCharCode(45))[0];\n        }\n        if (!!CKEDITOR.lang.languages[lang]) {\n            return lang;\n        }\n        return 'en';\n    }\n\n    protected getConfig(): CKEditorConfig {\n        return {\n            customConfig: '',\n            language: this.getLanguage(),\n            bodyClass: 's-HtmlContentBody',\n            on: {\n                instanceReady: (x: any) => this.instanceReady(x),\n                change: (x1: any) => {\n                    x1.editor.updateElement();\n                    this.element.triggerHandler('change');\n                }\n            },\n            toolbarGroups: [\n                {\n                    name: 'clipboard',\n                    groups: ['clipboard', 'undo']\n                }, {\n                    name: 'editing',\n                    groups: ['find', 'selection', 'spellchecker']\n                }, {\n                    name: 'insert',\n                    groups: ['links', 'insert', 'blocks', 'bidi', 'list', 'indent']\n                }, {\n                    name: 'forms',\n                    groups: ['forms', 'mode', 'document', 'doctools', 'others', 'about', 'tools']\n                }, {\n                    name: 'colors'\n                }, {\n                    name: 'basicstyles',\n                    groups: ['basicstyles', 'cleanup']\n                }, {\n                    name: 'align'\n                }, {\n                    name: 'styles'\n                }],\n            removeButtons: 'SpecialChar,Anchor,Subscript,Styles',\n            format_tags: 'p;h1;h2;h3;pre',\n            removeDialogTabs: 'image:advanced;link:advanced',\n            removePlugins: 'uploadimage,image2',\n            contentsCss: resolveUrl('~/Content/site/site.htmlcontent.css'),\n            entities: false,\n            entities_latin: false,\n            entities_greek: false,\n            autoUpdateElement: true,\n            height: (this.options.rows == null || this.options.rows === 0) ? null :\n                ((this.options.rows * 20) + 'px')\n        };\n    }\n\n    protected getEditorInstance() {\n        var id = this.element.attr('id');\n        return (window as any)['CKEDITOR'].instances[id];\n    }\n\n    destroy(): void {\n        var instance = this.getEditorInstance();\n        instance && instance.destroy(true);\n        super.destroy();\n    }\n\n    get_value(): string {\n        var instance = this.getEditorInstance();\n        if (this._instanceReady && instance) {\n            return instance.getData();\n        }\n        else {\n            return this.element.val();\n        }\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string): void {\n        var instance = this.getEditorInstance();\n        this.element.val(value);\n        if (this._instanceReady && instance)\n            instance.setData(value);\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n\n    get_readOnly(): boolean {\n        return !isEmptyOrNull(this.element.attr('disabled'));\n    }\n\n    set_readOnly(value: boolean) {\n\n        if (this.get_readOnly() !== value) {\n            if (value) {\n                this.element.attr('disabled', 'disabled');\n            }\n            else {\n                this.element.removeAttr('disabled');\n            }\n\n            var instance = this.getEditorInstance();\n            if (this._instanceReady && instance)\n                instance.setReadOnly(value);\n        }\n    }\n\n    static CKEditorVer = \"4.7.1\";\n    static CKEditorBasePath: string;\n\n    static getCKEditorBasePath(): string {\n        var path = HtmlContentEditor.CKEditorBasePath;\n        if (path == null) {\n            // @ts-ignore\n            if (typeof CKEDITOR_BASEPATH !== \"undefined\" && CKEDITOR_BASEPATH)\n                // @ts-ignore\n                path = CKEDITOR_BASEPATH;\n            else\n                return \"~/Serenity.Assets/Scripts/ckeditor/\";\n        }\n        if (endsWith(path, '/'))\n            return path;\n        return path + '/';\n    }\n\n    static includeCKEditor(): void {\n        if ((window as any)['CKEDITOR']) {\n            return;\n        }\n\n        var script = $('#CKEditorScript');\n        if (script.length > 0) {\n            return;\n        }\n\n        $('<script/>').attr('type', 'text/javascript')\n            .attr('id', 'CKEditorScript')\n            .attr('src', resolveUrl(HtmlContentEditor.getCKEditorBasePath() + 'ckeditor.js?v=' +\n                HtmlContentEditor.CKEditorVer))\n            .appendTo(window.document.head);\n    };\n}\n\n@Decorators.registerEditor('Serenity.HtmlNoteContentEditor')\nexport class HtmlNoteContentEditor extends HtmlContentEditor {\n    constructor(textArea: JQuery, opt?: HtmlContentEditorOptions) {\n        super(textArea, opt);\n    }\n\n    protected getConfig(): CKEditorConfig {\n        var config = super.getConfig();\n        (config as any).removeButtons += ',Cut,Copy,Paste,BulletedList,NumberedList,' +\n            'Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,PasteText,' +\n            'PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,Image,Table,' +\n            'HorizontalRule,Source,Maximize,Format,Font,FontSize,Anchor,Blockquote,' +\n            'CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,' +\n            'JustifyRight,JustifyBlock,Superscript,RemoveFormat';\n\n        (config as any).removePlugins = 'elementspath,uploadimage,image2';\n        return config;\n    }\n}\n\n@Decorators.registerEditor('Serenity.HtmlReportContentEditor')\nexport class HtmlReportContentEditor extends HtmlContentEditor {\n    constructor(textArea: JQuery, opt?: HtmlContentEditorOptions) {\n        super(textArea, opt);\n    }\n\n    protected getConfig(): CKEditorConfig {\n        var config = super.getConfig();\n        (config as any).removeButtons += ',Cut,Copy,Paste,BulletedList,NumberedList,' +\n            'Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,' +\n            'PasteText,PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,' +\n            'Image,Table,HorizontalRule,Source,Maximize,Format,Font,FontSize,' +\n            'Anchor,Blockquote,CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,' +\n            'JustifyRight,JustifyBlock,Superscript,RemoveFormat';\n\n        (config as any).removePlugins = 'elementspath,uploadimage,image2';\n        return config;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IStringValue } from \"../../interfaces\";\nimport { Widget } from \"../widgets/widget\";\n\n// http://digitalbush.com/projects/masked-input-plugin/\n@Decorators.registerEditor('Serenity.MaskedEditor', [IStringValue])\n@Decorators.element(\"<input type=\\\"text\\\"/>\")\nexport class MaskedEditor extends Widget<MaskedEditorOptions> {\n\n    constructor(input: JQuery, opt?: MaskedEditorOptions) {\n        super(input, opt);\n\n        (input as any).mask(this.options.mask || '', {\n            placeholder: (this.options.placeholder ?? '_')\n        });\n    }\n\n    public get value(): string {\n        this.element.triggerHandler(\"blur.mask\");\n        return this.element.val();\n    }\n\n    protected get_value(): string {\n        return this.value;\n    }\n\n    public set value(value: string) {\n        this.element.val(value);\n    }\n\n    protected set_value(value: string): void {\n        this.value = value;\n    }\n}\n\nexport interface MaskedEditorOptions {\n    mask?: string;\n    placeholder?: string;\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IStringValue } from \"../../interfaces\";\nimport { addValidationRule, isEmptyOrNull, localText } from \"../../q\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface RecaptchaOptions {\n    siteKey?: string;\n    language?: string;\n}\n\n@Decorators.registerEditor('Serenity.Recaptcha', [IStringValue])\n@Decorators.element(\"<div/>\")\nexport class Recaptcha extends Widget<RecaptchaOptions> implements IStringValue {\n    constructor(div: JQuery, opt: RecaptchaOptions) {\n        super(div, opt);\n\n        this.element.addClass('g-recaptcha').attr('data-sitekey', this.options.siteKey);\n        if (!!((window as any)['grecaptcha'] == null && $('script#RecaptchaInclude').length === 0)) {\n            var src = 'https://www.google.com/recaptcha/api.js';\n            var lng = this.options.language;\n            if (lng == null) {\n                lng = $('html').attr('lang') ?? '';\n            }\n            src += '?hl=' + lng;\n            $('<script/>').attr('id', 'RecaptchaInclude').attr('src', src).appendTo(document.body);\n        }\n\n        var valInput = $('<input />').insertBefore(this.element)\n            .attr('id', this.uniqueName + '_validate').val('x');\n\n        var gro: Record<string, string> = {};\n        gro['visibility'] = 'hidden';\n        gro['width'] = '0px';\n        gro['height'] = '0px';\n        gro['padding'] = '0px';\n\n        var input = valInput.css(gro);\n        var self = this;\n\n        addValidationRule(input, this.uniqueName, e => {\n            if (isEmptyOrNull(this.get_value())) {\n                return localText('Validation.Required');\n            }\n            return null;\n        });\n    }\n\n    get_value(): string {\n        return this.element.find('.g-recaptcha-response').val();\n    }\n\n    set_value(value: string): void {\n        // ignore\n    }\n}", "import { alertDialog, htmlEncode, blockUI, blockUndo, endsWith, format, iframeDialog, isEmptyOrNull, notifyError, replaceAll, resolveUrl, round, startsWith, localText, ServiceResponse } from \"../../q\";\n\nexport namespace UploadHelper {\n\n    export function addUploadInput(options: UploadInputOptions): JQuery {\n        options.container.addClass('fileinput-button');\n\n        var uploadUrl = options.uploadUrl || '~/File/TemporaryUpload';\n        if (options.uploadIntent) {\n            if (uploadUrl.indexOf('?') < 0)\n                uploadUrl += \"?\"\n            else\n                uploadUrl += \"&\";\n            uploadUrl += \"uploadIntent=\";\n            uploadUrl += encodeURIComponent(options.uploadIntent);\n        }\n\n        var uploadInput = $('<input/>').attr('type', 'file')\n            .attr('name', options.inputName + '[]')\n            .attr('data-url', resolveUrl(uploadUrl))\n            .appendTo(options.container);\n\n        if (options.allowMultiple) {\n            uploadInput.attr('multiple', 'multiple');\n        }\n\n        (uploadInput as any).fileupload({\n            dataType: 'json',\n            dropZone: options.zone,\n            pasteZone: options.zone,\n            done: function (e: JQueryEventObject, data: any) {\n                var response = data.result;\n                if (response.Error) {\n                    notifyError(response.Error.Message);\n                    return;\n                } \n\n                if (options.fileDone != null) {\n                    options.fileDone(response, data.files[0].name, data);\n                }\n            },\n            fail: function(e: JQueryEventObject, opt: any) {\n                var xhr = opt?._response?.jqXHR;\n                if (!xhr) {\n                    notifyError('An error occurred during file upload.');\n                    return;\n                }\n\n                if ((xhr.getResponseHeader('content-type') || '')\n                    .toLowerCase().indexOf('application/json') >= 0) {\n                    var json = $.parseJSON(xhr.responseText);\n                    if (json && json.Error && json.Error.Message) {\n                        notifyError(json.Error.Message);\n                        return;\n                    }\n                }\n\n                var html = xhr.responseText;\n                if (html) {\n                    iframeDialog({ html: html });\n                    return;\n                }\n\n                if (!xhr.status) {\n                    if (xhr.statusText != \"abort\")\n                        notifyError(\"An unknown connection error occurred! Check browser console for details.\");\n                    return;\n                }\n\n                if (xhr.status == 500) {\n                    notifyError(\"HTTP 500: Connection refused! Check browser console for details.\");\n                    return;\n                }\n\n                notifyError(\"HTTP \" + xhr.status + ' error! Check browser console for details.');\n            },\n            start: function () {\n                blockUI(null);\n                if (options.progress != null) {\n                    options.progress.show();\n                }\n            },\n            stop: function () {\n                blockUndo();\n                if (options.progress != null) {\n                    options.progress.hide();\n                }\n            },\n            progress: function (e1: JQueryEventObject, data1: any) {\n                if (options.progress != null) {\n                    var percent = data1.loaded / data1.total * 100;\n                    options.progress.children().css('width', percent.toString() + '%');\n                }\n            }\n        });\n        return uploadInput;\n    }\n\n    export function checkImageConstraints(file: UploadResponse,\n        opt: FileUploadConstraints): boolean {\n\n        if (!file.IsImage && !opt.allowNonImage) {\n            alertDialog(localText('Controls.ImageUpload.NotAnImageFile'));\n            return false;\n        }\n        if (opt.minSize > 0 && file.Size < opt.minSize) {\n            alertDialog(format(localText('Controls.ImageUpload.UploadFileTooSmall'),\n                fileSizeDisplay(opt.minSize)));\n            return false;\n        }\n        if (opt.maxSize > 0 && file.Size > opt.maxSize) {\n            alertDialog(format(localText('Controls.ImageUpload.UploadFileTooBig'),\n                fileSizeDisplay(opt.maxSize)));\n            return false;\n        }\n        if (!file.IsImage) {\n            return true;\n        }\n        if (opt.minWidth > 0 && file.Width < opt.minWidth) {\n            alertDialog(format(localText('Controls.ImageUpload.MinWidth'), opt.minWidth));\n            return false;\n        }\n        if (opt.maxWidth > 0 && file.Width > opt.maxWidth) {\n            alertDialog(format(localText('Controls.ImageUpload.MaxWidth'), opt.maxWidth));\n            return false;\n        }\n        if (opt.minHeight > 0 && file.Height < opt.minHeight) {\n            alertDialog(format(localText('Controls.ImageUpload.MinHeight'), opt.minHeight));\n            return false;\n        }\n        if (opt.maxHeight > 0 && file.Height > opt.maxHeight) {\n            alertDialog(format(localText('Controls.ImageUpload.MaxHeight'), opt.maxHeight));\n            return false;\n        }\n        return true;\n    }\n\n    export function fileNameSizeDisplay(name: string, bytes: number): string {\n        return name + ' (' + fileSizeDisplay(bytes) + ')';\n    }\n\n    export function fileSizeDisplay(bytes: number): string {\n        var byteSize = round(bytes * 100 / 1024) * 0.01;\n        var suffix = 'KB';\n        if (byteSize >= 1024) {\n            byteSize = round(byteSize * 100 / 1024) * 0.01;\n            suffix = 'MB';\n        }\n        var sizeParts = byteSize.toString().split(String.fromCharCode(46));\n        var value;\n        if (sizeParts.length > 1) {\n            value = sizeParts[0] + '.' + sizeParts[1].substr(0, 2);\n        }\n        else {\n            value = sizeParts[0];\n        }\n        return value + ' ' + suffix;\n    }\n\n    export function hasImageExtension(filename: string): boolean {\n        if (isEmptyOrNull(filename)) {\n            return false;\n        }\n        filename = filename.toLowerCase();\n        return endsWith(filename, '.jpg') || endsWith(filename, '.jpeg') ||\n            endsWith(filename, '.gif') || endsWith(filename, '.png');\n    }\n\n    export function thumbFileName(filename: string): string {\n        filename = filename ?? '';\n        var idx = filename.lastIndexOf('.');\n        if (idx >= 0) {\n            filename = filename.substr(0, idx);\n        }\n        return filename + '_t.jpg';\n    }\n\n    export function dbFileUrl(filename: string): string {\n        filename = replaceAll(filename ?? '', '\\\\', '/');\n        return resolveUrl('~/upload/') + filename;\n    }\n\n    export function colorBox(link: JQuery, options: any): void {\n        (link as any).colorbox({\n            current: htmlEncode(localText('Controls.ImageUpload.ColorboxCurrent')),\n            previous: htmlEncode(localText('Controls.ImageUpload.ColorboxPrior')),\n            next: htmlEncode(localText('Controls.ImageUpload.ColorboxNext')),\n            close: htmlEncode(localText('Controls.ImageUpload.ColorboxClose'))\n        });\n    }\n\n    export function populateFileSymbols(container: JQuery, items: UploadedFile[],\n        displayOriginalName?: boolean, urlPrefix?: string): void {\n\n        items = items || [];\n        container.html('');\n        for (var index = 0; index < items.length; index++) {\n            var item = items[index];\n            var li = $('<li/>').addClass('file-item').data('index', index);\n            var isImage = hasImageExtension(item.Filename);\n            if (isImage) {\n                li.addClass('file-image');\n            }\n            else {\n                li.addClass('file-binary');\n            }\n            var editLink = '#' + index;\n            var thumb = $('<a/>').addClass('thumb').appendTo(li);\n            var originalName = item.OriginalName ?? '';\n            var fileName = item.Filename;\n            if (urlPrefix != null && fileName != null &&\n                !startsWith(fileName, 'temporary/')) {\n                fileName = urlPrefix + fileName;\n            }\n\n            thumb.attr('href', dbFileUrl(fileName));\n            thumb.attr('target', '_blank');\n            if (!isEmptyOrNull(originalName)) {\n                thumb.attr('title', originalName);\n            }\n\n            if (isImage) {\n                thumb.css('backgroundImage', \"url('\" + dbFileUrl(\n                    thumbFileName(item.Filename)) + \"')\");\n                colorBox(thumb, new Object());\n            }\n\n            if (displayOriginalName) {\n                $('<div/>').addClass('filename').text(originalName)\n                    .attr('title', originalName).appendTo(li);\n            }\n\n            li.appendTo(container);\n        }\n    }\n}\n\nexport interface UploadedFile {\n    Filename?: string;\n    OriginalName?: string;\n}\n\nexport interface UploadInputOptions {\n    container?: JQuery;\n    zone?: JQuery;\n    progress?: JQuery;\n    inputName?: string;\n    allowMultiple?: boolean;\n    uploadIntent?: string;\n    uploadUrl?: string;\n    fileDone?: (p1: UploadResponse, p2: string, p3: any) => void;\n}\n\nexport interface UploadResponse extends ServiceResponse {\n    TemporaryFile: string;\n    Size: number;\n    IsImage: boolean;\n    Width: number;\n    Height: number;\n}\n\nexport interface FileUploadConstraints {\n    minWidth?: number;\n    maxWidth?: number;\n    minHeight?: number;\n    maxHeight?: number;\n    minSize?: number;\n    maxSize?: number;\n    allowNonImage?: boolean;\n    originalNameProperty?: string;\n}\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IGetEditValue, IReadOnly, ISetEditValue, IValidateRequired } from \"../../interfaces\";\nimport { endsWith, extend, isEmptyOrNull, isInstanceOfType, isTrimmedEmpty, PropertyItem, replaceAll, startsWith, localText, trimToNull } from \"../../q\";\nimport { FileUploadConstraints, UploadedFile, UploadHelper, UploadInputOptions } from \"../helpers/uploadhelper\";\nimport { Toolbar, ToolButton } from \"../widgets/toolbar\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface FileUploadEditorOptions extends FileUploadConstraints {\n    displayFileName?: boolean;\n    uploadIntent?: string;\n    uploadUrl?: string;\n    urlPrefix?: string;\n}\n\nexport interface ImageUploadEditorOptions extends FileUploadEditorOptions {\n}\n\n@Decorators.registerEditor('Serenity.FileUploadEditor', [IReadOnly, IGetEditValue, ISetEditValue, IValidateRequired])\n@Decorators.element('<div/>')\nexport class FileUploadEditor extends Widget<FileUploadEditorOptions>\n    implements IReadOnly, IGetEditValue, ISetEditValue, IValidateRequired {\n\n    constructor(div: JQuery, opt: FileUploadEditorOptions) {\n        super(div, opt);\n\n        if (!opt || opt.allowNonImage == null)\n            this.options.allowNonImage = true;\n\n        div.addClass('s-FileUploadEditor');\n        \n        if (isEmptyOrNull(this.options.originalNameProperty))\n            div.addClass('hide-original-name');\n\n        this.toolbar = new Toolbar($('<div/>').appendTo(this.element), {\n            buttons: this.getToolButtons()\n        });\n\n        this.progress = $('<div><div></div></div>')\n            .addClass('upload-progress')\n            .prependTo(this.toolbar.element);\n\n        var uio = this.getUploadInputOptions();\n        this.uploadInput = UploadHelper.addUploadInput(uio);\n\n        this.fileSymbols = $('<ul/>').appendTo(this.element);\n\n        if (!this.element.attr('id'))\n            this.element.attr('id', this.uniqueName);\n\n        this.hiddenInput = $('<input type=\"text\" class=\"s-offscreen\" name=\"' + this.uniqueName +\n            '_Validator\" data-vx-highlight=\"' + this.element.attr('id') + '\"/>')\n            .appendTo(this.element);\n\n        this.updateInterface();\n    }\n\n    protected getUploadInputOptions(): UploadInputOptions {\n        return {\n            container: this.toolbar.findButton('add-file-button'),\n            zone: this.element,\n            inputName: this.uniqueName,\n            progress: this.progress,\n            uploadIntent: this.options.uploadIntent,\n            uploadUrl: this.options.uploadUrl,\n            fileDone: (response, name, data) => {\n                if (!UploadHelper.checkImageConstraints(response, this.options)) {\n                    return;\n                }\n\n                var newEntity: UploadedFile = {\n                    OriginalName: name,\n                    Filename: response.TemporaryFile\n                };\n\n                this.entity = newEntity;\n                this.populate();\n                this.updateInterface();\n\n                var validator = this.hiddenInput.closest('form').data('validator');\n                if (validator != null) {\n                    validator.element(this.hiddenInput);\n                }\n            }\n        }\n    }\n\n    protected addFileButtonText(): string {\n        return localText('Controls.ImageUpload.AddFileButton');\n    }\n\n    protected getToolButtons(): ToolButton[] {\n        return [\n            {\n                title: this.addFileButtonText(),\n                action: 'add-file',\n                cssClass: 'add-file-button',\n                onClick: function () {\n                }\n            },\n            {\n                title: '',\n                hint: localText('Controls.ImageUpload.DeleteButtonHint'),\n                action: 'delete',\n                cssClass: 'delete-button',\n                onClick: () => {\n                    this.entity = null;\n                    this.populate();\n                    this.updateInterface();\n\n                    var validator = this.hiddenInput.closest('form').data('validator');\n                    if (validator != null) {\n                        validator.element(this.hiddenInput);\n                    }\n                }\n            }\n        ];\n    }\n\n    protected populate(): void {\n        var displayOriginalName = this.options.displayFileName ||\n            !isTrimmedEmpty(this.options.originalNameProperty);\n\n        if (this.entity == null) {\n            UploadHelper.populateFileSymbols(this.fileSymbols,\n                null, displayOriginalName, this.options.urlPrefix);\n        }\n        else {\n            UploadHelper.populateFileSymbols(\n                this.fileSymbols, [this.entity], displayOriginalName,\n                this.options.urlPrefix);\n        }\n\n        this.hiddenInput.val(trimToNull((this.get_value() || {}).Filename));\n    }\n\n    protected updateInterface(): void {\n        var addButton = this.toolbar.findButton('add-file-button');\n        var delButton = this.toolbar.findButton('delete-button');\n        addButton.toggleClass('disabled', this.get_readOnly());\n        delButton.toggleClass('disabled', this.get_readOnly() ||\n            this.entity == null);\n    }\n\n    get_readOnly(): boolean {\n        return this.uploadInput.attr('disabled') != null;\n    }\n\n    set_readOnly(value: boolean): void {\n        if (this.get_readOnly() !== value) {\n            if (value) {\n                this.uploadInput.attr('disabled', 'disabled');\n                try {\n                    (this.uploadInput as any).fileupload('disable');\n                }\n                catch {\n                }\n            }\n            else {\n                this.uploadInput.removeAttr('disabled');\n                try {\n                    (this.uploadInput as any).fileupload('enable');\n                } catch {\n                }\n            }\n            this.updateInterface();\n        }\n    }\n\n    get_required(): boolean {\n        return this.hiddenInput.hasClass('required');\n    }\n\n    set_required(value: boolean): void {\n        this.hiddenInput.toggleClass('required', !!value);\n    }\n\n    get_value(): UploadedFile {\n        if (this.entity == null) {\n            return null;\n        }\n        var copy = extend({}, this.entity);\n        return copy;\n    }\n\n    get value(): UploadedFile {\n        return this.get_value();\n    }\n\n    set_value(value: UploadedFile): void {\n        var stringValue = value as string;\n        if (typeof stringValue === \"string\") {\n            var stringValue = trimToNull(stringValue);\n            if (value != null) {\n                var idx = stringValue.indexOf('/');\n                if (idx < 0)\n                    idx = stringValue.indexOf('\\\\');\n                value = <UploadedFile>{\n                    Filename: value,\n                    OriginalName: stringValue.substring(idx + 1)\n                }\n            }\n        }\n        else if (value != null && isTrimmedEmpty(value.Filename))\n            value = null;\n\n        if (value != null) {\n            if (value.Filename == null) {\n                this.entity = null;\n            }\n            else {\n                this.entity = extend({}, value);\n            }\n        }\n        else {\n            this.entity = null;\n        }\n        this.populate();\n\n        var validator = this.hiddenInput.closest('form').data('validator');\n        if (validator != null) {\n            validator.element(this.hiddenInput);\n        }\n\n        this.updateInterface();\n    }\n\n    set value(v: UploadedFile) {\n        this.set_value(v);\n    }\n\n    getEditValue(property: PropertyItem, target: any) {\n        target[property.name] = this.entity == null ? null :\n            trimToNull(this.entity.Filename);\n    }\n\n    setEditValue(source: any, property: PropertyItem) {\n        var value: UploadedFile = {};\n        value.Filename = source[property.name];\n        if (isEmptyOrNull(this.options.originalNameProperty)) {\n\n            if (this.options.displayFileName) {\n                var s = (value.Filename ?? '');\n                var idx = replaceAll(s, '\\\\', '/').lastIndexOf('/');\n                if (idx >= 0) {\n                    value.OriginalName = s.substr(idx + 1);\n                }\n                else {\n                    value.OriginalName = s;\n                }\n            }\n        }\n        else {\n            value.OriginalName = source[this.options.originalNameProperty];\n        }\n\n        this.set_value(value);\n    }\n\n    protected entity: UploadedFile;\n    protected toolbar: Toolbar;\n    protected progress: JQuery;\n    protected fileSymbols: JQuery;\n    protected uploadInput: JQuery;\n    protected hiddenInput: JQuery;\n}\n\n@Decorators.registerEditor('Serenity.ImageUploadEditor')\nexport class ImageUploadEditor extends FileUploadEditor {\n    constructor(div: JQuery, opt: ImageUploadEditorOptions) {\n        super(div, opt);\n\n        if (opt && opt.allowNonImage == null)\n            this.options.allowNonImage = false;\n\n        div.addClass('s-ImageUploadEditor');\n    }\n}\n\n@Decorators.registerEditor('Serenity.MultipleFileUploadEditor', [IReadOnly, IGetEditValue, ISetEditValue, IValidateRequired])\n@Decorators.element('<div/>')\nexport class MultipleFileUploadEditor extends Widget<FileUploadEditorOptions>\n    implements IReadOnly, IGetEditValue, ISetEditValue, IValidateRequired {\n\n    private entities: UploadedFile[];\n    private toolbar: Toolbar;\n    private fileSymbols: JQuery;\n    private uploadInput: JQuery;\n    protected progress: JQuery;\n    protected hiddenInput: JQuery;\n\n    constructor(div: JQuery, opt: ImageUploadEditorOptions) {\n        super(div, opt);\n\n        this.entities = [];\n        div.addClass('s-MultipleFileUploadEditor');\n        var self = this;\n        this.toolbar = new Toolbar($('<div/>').appendTo(this.element), {\n            buttons: this.getToolButtons()\n        });\n\n        this.progress = $('<div><div></div></div>')\n            .addClass('upload-progress')\n            .prependTo(this.toolbar.element);\n\n        this.uploadInput = UploadHelper.addUploadInput(this.getUploadInputOptions());\n\n        this.fileSymbols = $('<ul/>').appendTo(this.element);\n        if (!this.element.attr('id')) {\n            this.element.attr('id', this.uniqueName);\n        }\n\n        this.hiddenInput = $('<input type=\"text\" class=\"s-offscreen\" name=\"' + this.uniqueName +\n            '_Validator\" data-vx-highlight=\"' + this.element.attr('id') + '\" multiple=\"multiple\"></input>').appendTo(this.element);\n\n        this.updateInterface();\n    }\n\n    protected getUploadInputOptions(): UploadInputOptions {\n        var addFileButton = this.toolbar.findButton('add-file-button');\n\n        return {\n            container: addFileButton,\n            zone: this.element,\n            inputName: this.uniqueName,\n            progress: this.progress,\n            uploadIntent: this.options.uploadIntent,\n            uploadUrl: this.options.uploadUrl,\n            allowMultiple: true,\n            fileDone: (response, name) => {\n                if (!UploadHelper.checkImageConstraints(response, this.options)) {\n                    return;\n                }\n                var newEntity = { OriginalName: name, Filename: response.TemporaryFile };\n                this.entities.push(newEntity);\n                this.populate();\n\n                var validator = this.hiddenInput.closest('form').data('validator');\n                if (validator != null) {\n                    validator.element(this.hiddenInput);\n                }\n\n                this.updateInterface();\n            }\n        }\n    }\n\n    protected addFileButtonText(): string {\n        return localText('Controls.ImageUpload.AddFileButton');\n    }\n\n    protected getToolButtons(): ToolButton[] {\n        return [{\n            title: this.addFileButtonText(),\n            action: 'add-file',\n            cssClass: 'add-file-button',\n            onClick: function () {\n            }\n        }];\n    }\n\n    protected populate(): void {\n        UploadHelper.populateFileSymbols(this.fileSymbols, this.entities,\n            true, this.options.urlPrefix);\n\n        this.fileSymbols.children().each((i, e) => {\n            var x = i;\n            $(\"<a class='delete'></a>\").appendTo($(e).children('.filename'))\n                .click(ev => {\n                    ev.preventDefault();\n                    this.entities.splice(x, 1);\n                    this.populate();\n\n                    var validator = this.hiddenInput.closest('form').data('validator');\n                    if (validator != null) {\n                        validator.element(this.hiddenInput);\n                    }\n                });\n        });\n\n        this.hiddenInput.val(trimToNull((this.get_value()[0] || {}).Filename));\n    }\n\n    protected updateInterface(): void {\n        var addButton = this.toolbar.findButton('add-file-button');\n        addButton.toggleClass('disabled', this.get_readOnly());\n        this.fileSymbols.find('a.delete').toggle(!this.get_readOnly());\n    }\n\n    get_readOnly(): boolean {\n        return this.uploadInput.attr('disabled') != null;\n    }\n\n    set_readOnly(value: boolean): void {\n        if (this.get_readOnly() !== value) {\n            if (value) {\n                this.uploadInput.attr('disabled', 'disabled');\n                try {\n                    (this.uploadInput as any).fileupload('disable');\n                }\n                catch {\n                }\n            }\n            else {\n                this.uploadInput.removeAttr('disabled');\n                try {\n                    (this.uploadInput as any).fileupload('enable');\n                } catch {\n                }\n            }\n            this.updateInterface();\n        }\n    }\n\n    get_required(): boolean {\n        return this.hiddenInput.hasClass('required');\n    }\n\n    set_required(value: boolean): void {\n        this.hiddenInput && this.hiddenInput.toggleClass('required', !!value);\n    }\n\n    get_value(): UploadedFile[] {\n        return this.entities.map(function (x) {\n            return extend({}, x);\n        });\n    }\n\n    get value(): UploadedFile[] {\n        return this.get_value();\n    }\n\n    set_value(value: UploadedFile[]) {\n        this.entities = (value || []).map(function (x) {\n            return extend({}, x);\n        });\n        this.populate();\n        this.updateInterface();\n    }\n\n    set value(v: UploadedFile[]) {\n        this.set_value(v);\n    }\n\n    getEditValue(property: PropertyItem, target: any) {\n        if (this.jsonEncodeValue) {\n            target[property.name] = JSON.stringify(this.get_value());\n        }\n        else {\n            target[property.name] = this.get_value();\n        }\n    }\n\n    setEditValue(source: any, property: PropertyItem) {\n        var val = source[property.name];\n        if (isInstanceOfType(val, String)) {\n            var json = trimToNull(val) ?? '[]';\n            if (startsWith(json, '[') && endsWith(json, ']')) {\n                this.set_value($.parseJSON(json));\n            }\n            else {\n                this.set_value([{\n                    Filename: json,\n                    OriginalName: 'UnknownFile'\n                }]);\n            }\n        }\n        else {\n            this.set_value(val as any);\n        }\n    }\n\n    @Decorators.option()\n    public jsonEncodeValue: boolean;\n}\n\n@Decorators.registerEditor('Serenity.MultipleImageUploadEditor')\nexport class MultipleImageUploadEditor extends MultipleFileUploadEditor {\n    constructor(div: JQuery, opt: ImageUploadEditorOptions) {\n        super(div, opt);\n\n        div.addClass('s-MultipleImageUploadEditor');\n    }\n}", "\uFEFFimport { ArgumentNullException, Criteria, ListRequest, delegateCombine, delegateRemove, formatDate, isEmptyOrNull, isTrimmedEmpty, localText, notifyWarning, parseDate, toId, tryGetText } from \"../../q\";\nimport { Decorators } from \"../../decorators\";\nimport { DateEditor } from \"../editors/dateeditor\";\nimport { DateTimeEditor, DateTimeEditorOptions } from \"../editors/datetimeeditor\";\nimport { EditorUtils } from \"../editors/editorutils\";\nimport { SelectEditor, SelectEditorOptions } from \"../editors/selecteditor\";\nimport { Widget } from \"../widgets/widget\";\nimport { QuickFilter } from \"./quickfilter\";\n\nexport interface QuickFilterBarOptions {\n    filters: QuickFilter<Widget<any>, any>[];\n    getTitle?: (filter: QuickFilter<Widget<any>, any>) => string;\n    idPrefix?: string;\n}\n\n@Decorators.registerClass('Serenity.QuickFilterBar')\n@Decorators.element(\"<div/>\")\nexport class QuickFilterBar extends Widget<QuickFilterBarOptions> {\n\n    constructor(container: JQuery, options?: QuickFilterBarOptions) {\n        super(container, options);\n\n        container.addClass('quick-filters-bar').addClass('clear');\n\n        var filters = this.options.filters;\n        for (var f = 0; f < filters.length; f++) {\n            var filter = filters[f];\n            this.add(filter);\n        }\n\n        this.options.idPrefix = (this.options.idPrefix ?? this.uniqueName + '_');\n    }\n\n    public addSeparator(): void {\n        this.element.append($('<hr/>'));\n    }\n\n    public add<TWidget extends Widget<any>, TOptions>(opt: QuickFilter<TWidget, TOptions>): TWidget {\n\n        if (opt == null) {\n            throw new ArgumentNullException('opt');\n        }\n\n        if (opt.separator) {\n            this.addSeparator();\n        }\n\n        var item = $(\"<div class='quick-filter-item'><span class='quick-filter-label'></span></div>\")\n            .appendTo(this.element)\n            .data('qffield', opt.field).children();\n\n        var title = tryGetText(opt.title) ?? opt.title;\n        if (title == null) {\n            title = this.options.getTitle ? this.options.getTitle(opt) : null;\n            if (title == null) {\n                title = opt.field;\n            }\n        }\n\n        var quickFilter = item.text(title).parent();\n\n        if (opt.displayText != null) {\n            quickFilter.data('qfdisplaytext', opt.displayText);\n        }\n\n        if (opt.saveState != null) {\n            quickFilter.data('qfsavestate', opt.saveState);\n        }\n\n        if (opt.loadState != null) {\n            quickFilter.data('qfloadstate', opt.loadState);\n        }\n\n        if (!isEmptyOrNull(opt.cssClass)) {\n            quickFilter.addClass(opt.cssClass);\n        }\n\n        var widget = Widget.create({\n            type: opt.type,\n            element: e => {\n                if (!isEmptyOrNull(opt.field)) {\n                    e.attr('id', this.options.idPrefix + opt.field);\n                }\n                e.attr('placeholder', ' ');\n                e.appendTo(quickFilter);\n                if (opt.element != null) {\n                    opt.element(e);\n                }\n            },\n            options: opt.options,\n            init: opt.init\n        });\n\n        var submitHandler = (request: ListRequest) => {\n\n            if (quickFilter.hasClass('ignore')) {\n                return;\n            }\n\n            request.EqualityFilter = request.EqualityFilter || {};\n            var value = EditorUtils.getValue(widget);\n            var active = value != null && !isEmptyOrNull(value.toString());\n            if (opt.handler != null) {\n                var args = {\n                    field: opt.field,\n                    request: request,\n                    equalityFilter: request.EqualityFilter,\n                    value: value,\n                    active: active,\n                    widget: widget,\n                    handled: true\n                };\n                opt.handler(args);\n                quickFilter.toggleClass('quick-filter-active', args.active);\n                if (!args.handled) {\n                    request.EqualityFilter[opt.field] = value;\n                }\n            }\n            else {\n                request.EqualityFilter[opt.field] = value;\n                quickFilter.toggleClass('quick-filter-active', active);\n            }\n        };\n\n        widget.changeSelect2(e1 => {\n            // use timeout give cascaded dropdowns a chance to update / clear themselves\n            window.setTimeout(() => this.onChange && this.onChange(e1), 0);\n        });\n\n        this.add_submitHandlers(submitHandler);\n        widget.element.bind('remove.' + this.uniqueName, x => {\n            this.remove_submitHandlers(submitHandler);\n        });\n\n        return widget;\n    }\n\n    public addDateRange(field: string, title?: string): DateEditor {\n        return this.add(QuickFilterBar.dateRange(field, title)) as DateEditor;\n    }\n\n    public static dateRange(field: string, title?: string): QuickFilter<DateEditor, DateTimeEditorOptions> {\n        var end: DateEditor = null;\n        return <QuickFilter<DateEditor, DateTimeEditorOptions>>{\n            field: field,\n            type: DateEditor,\n            title: title,\n            element: function (e1) {\n                end = Widget.create({\n                    type: DateEditor,\n                    element: function (e2) {\n                        e2.insertAfter(e1);\n                    },\n                    options: null,\n                    init: null\n                });\n\n                end.element.change(function (x) {\n                    e1.triggerHandler('change');\n                });\n\n                $('<span/>').addClass('range-separator').text('-').insertAfter(e1);\n            },\n            handler: function (args) {\n                var date1 = parseDate(args.widget.value);\n                if (date1) {\n                    if (isNaN(date1.valueOf())) {\n                        notifyWarning(localText('Validation.DateInvalid'), '', null);\n                        args.widget.element.val('');\n                        date1 = null;\n                    }\n                    else {\n                        args.request.Criteria = Criteria.and(args.request.Criteria, \n                            Criteria(args.field).ge(args.widget.value));   \n                    }\n                }\n\n                var date2 = parseDate(end.value);\n                if (date2) {\n                    if (isNaN(date2?.valueOf())) {\n                        notifyWarning(localText('Validation.DateInvalid'), '', null);\n                        end.element.val('');\n                        date2 = null;\n                    }\n                    else {\n                        var next = new Date(end.valueAsDate.valueOf());\n                        next.setDate(next.getDate() + 1);\n                        args.request.Criteria = Criteria.and(args.request.Criteria,\n                            Criteria(args.field).lt(formatDate(next, 'yyyy-MM-dd')));\n                    }\n                }\n\n                args.active = !!(date1 || date2);\n            },\n            displayText: function (w, l) {\n                var v1 = EditorUtils.getDisplayText(w);\n                var v2 = EditorUtils.getDisplayText(end);\n                if (isEmptyOrNull(v1) && isEmptyOrNull(v2)) {\n                    return null;\n                }\n                var text1 = l + ' >= ' + v1;\n                var text2 = l + ' <= ' + v2;\n                if (!isEmptyOrNull(v1) && !isEmptyOrNull(v2)) {\n                    return text1 + ' ' + (tryGetText('Controls.FilterPanel.And') ?? 'and') + ' ' + text2;\n                }\n                else if (!isEmptyOrNull(v1)) {\n                    return text1;\n                }\n                else {\n                    return text2;\n                }\n            },\n            saveState: function (w1) {\n                return [EditorUtils.getValue(w1), EditorUtils.getValue(end)];\n            },\n            loadState: function (w2, state) {\n                if (state == null || !Array.isArray(state) || state.length !== 2) {\n                    state = [null, null];\n                }\n\n                EditorUtils.setValue(w2, state[0]);\n                EditorUtils.setValue(end, state[1]);\n            }\n        };\n    }\n\n    public addDateTimeRange(field: string, title?: string) {\n        return this.add(QuickFilterBar.dateTimeRange(field, title)) as DateTimeEditor;\n    }\n\n    public static dateTimeRange(field: string, title?: string, useUtc?: boolean): QuickFilter<DateTimeEditor, DateTimeEditorOptions> {\n        var end: DateTimeEditor = null;\n\n        return <QuickFilter<DateTimeEditor, DateTimeEditorOptions>>{\n            field: field,\n            type: DateTimeEditor,\n            title: title,\n            element: function (e1) {\n                end = Widget.create({\n                    type: DateTimeEditor,\n                    element: function (e2) {\n                        e2.insertAfter(e1);\n                    },\n                    options: useUtc == null ? null : { useUtc },\n                    init: null\n                });\n\n                end.element.change(function (x) {\n                    e1.triggerHandler('change');\n                });\n\n                $('<span/>').addClass('range-separator').text('-').insertAfter(e1);\n            },\n            init: function (i) {\n                i.element.parent().find('.time').change(function (x1) {\n                    i.element.triggerHandler('change');\n                });\n            },\n            handler: function (args) {\n                var date1 = parseDate(args.widget.value);\n                if (date1) {\n                    if (isNaN(date1?.valueOf())) {\n                        notifyWarning(localText('Validation.DateInvalid'), '', null);\n                        args.widget.element.val('');\n                        date1 = null;\n                    } \n                    else {\n                        args.request.Criteria = Criteria.and(args.request.Criteria,\n                            Criteria(args.field).ge(args.widget.value));\n                    }\n                }\n\n                var date2 = parseDate(end.value);\n                if (date2) {\n                    if (isNaN(date2?.valueOf())) {\n                        notifyWarning(localText('Validation.DateInvalid'), '', null);\n                        end.element.val('');\n                        date2 = null;\n                    }\n                    else {\n                        args.request.Criteria = Criteria.and(args.request.Criteria,\n                            Criteria(args.field).le(end.value));\n                    }\n                }\n                \n                args.active = !!(date1 || date2);\n            },\n            displayText: function (w, l) {\n                var v1 = EditorUtils.getDisplayText(w);\n                var v2 = EditorUtils.getDisplayText(end);\n                if (isEmptyOrNull(v1) && isEmptyOrNull(v2)) {\n                    return null;\n                }\n                var text1 = l + ' >= ' + v1;\n                var text2 = l + ' <= ' + v2;\n                if (!isEmptyOrNull(v1) && !isEmptyOrNull(v2)) {\n                    return text1 + ' ' + (tryGetText('Controls.FilterPanel.And') ?? 'and') + ' ' + text2;\n                }\n                else if (!isEmptyOrNull(v1)) {\n                    return text1;\n                }\n                else {\n                    return text2;\n                }\n            },\n            saveState: function (w1) {\n                return [EditorUtils.getValue(w1), EditorUtils.getValue(end)];\n            },\n            loadState: function (w2, state) {\n                if (state == null || !Array.isArray(state) || state.length !== 2) {\n                    state = [null, null];\n                }\n                EditorUtils.setValue(w2, state[0]);\n                EditorUtils.setValue(end, state[1]);\n            },\n            options: useUtc == null ? null : { useUtc }\n        };\n    }\n\n    public addBoolean(field: string, title?: string, yes?: string, no?: string): SelectEditor {\n        return this.add(QuickFilterBar.boolean(field, title, yes, no));\n    }\n\n    public static boolean(field: string, title?: string, yes?: string, no?: string): QuickFilter<SelectEditor, SelectEditorOptions> {\n        var opt: SelectEditorOptions = {};\n        var items = [];\n\n        var trueText = yes;\n        if (trueText == null) {\n            trueText = localText('Controls.FilterPanel.OperatorNames.true');\n        }\n        items.push(['1', trueText]);\n\n        var falseText = no;\n        if (falseText == null) {\n            falseText = localText('Controls.FilterPanel.OperatorNames.false');\n        }\n\n        items.push(['0', falseText]);\n\n        opt.items = items;\n\n        return {\n            field: field,\n            type: SelectEditor,\n            title: title,\n            options: opt,\n            handler: function (args) {\n                args.equalityFilter[args.field] = args.value == null || isEmptyOrNull(args.value.toString()) ?\n                    null : !!toId(args.value);\n            }\n        };\n    }\n\n    public onChange: (e: JQueryEventObject) => void;\n\n    private submitHandlers: any;\n\n    destroy() {\n        this.submitHandlers = null;\n        super.destroy();\n    }\n\n    public onSubmit(request: ListRequest) {\n        this.submitHandlers && this.submitHandlers(request);\n    }\n\n    protected add_submitHandlers(action: (request: ListRequest) => void): void {\n        this.submitHandlers = delegateCombine(this.submitHandlers, action);\n    }\n\n    protected remove_submitHandlers(action: (request: ListRequest) => void): void {\n        this.submitHandlers = delegateRemove(this.submitHandlers, action);\n    }\n\n    protected clear_submitHandlers() {\n    }\n\n    public find<TWidget>(type: { new(...args: any[]): TWidget }, field: string): TWidget {\n        return $('#' + this.options.idPrefix + field).getWidget(type);\n    }\n\n    public tryFind<TWidget>(type: { new(...args: any[]): TWidget }, field: string): TWidget {\n        var el = $('#' + this.options.idPrefix + field);\n        if (!el.length)\n            return null;\n\n        return el.tryGetWidget(type);\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { isEmptyOrNull, isValue, localText, trim } from \"../../q\";\nimport { PopupMenuButton } from \"../widgets/toolbar\";\nimport { Widget } from \"../widgets/widget\";\n\nexport interface QuickSearchField {\n    name: string;\n    title: string;\n}\n\nexport interface QuickSearchInputOptions {\n    typeDelay?: number;\n    loadingParentClass?: string;\n    filteredParentClass?: string;\n    onSearch?: (p1: string, p2: string, p3: (p1: boolean) => void) => void;\n    fields?: QuickSearchField[];\n}\n\n@Decorators.registerClass('Serenity.QuickSearchInput')\nexport class QuickSearchInput extends Widget<QuickSearchInputOptions> {\n    private lastValue: string;\n    private field: QuickSearchField;\n    private fieldChanged: boolean;\n    private timer: number;\n\n    constructor(input: JQuery, opt: QuickSearchInputOptions) {\n        super(input, opt);\n\n        input.attr('title', localText('Controls.QuickSearch.Hint'))\n            .attr('placeholder', localText('Controls.QuickSearch.Placeholder'));\n        this.lastValue = trim(input.val() ?? '');\n\n        var self = this;\n        this.element.bind('keyup.' + this.uniqueName, function () {\n            self.checkIfValueChanged();\n        });\n\n        this.element.bind('change.' + this.uniqueName, function () {\n            self.checkIfValueChanged();\n        });\n\n        $('<span><i></i></span>').addClass('quick-search-icon')\n            .insertBefore(input);\n\n        if (isValue(this.options.fields) && this.options.fields.length > 0) {\n            var a = $('<a/>').addClass('quick-search-field').attr('title',\n                localText('Controls.QuickSearch.FieldSelection')).insertBefore(input);\n\n            var menu = $('<ul></ul>').css('width', '120px');\n\n            for (var item of this.options.fields) {\n                var field = { $: item };\n                $('<li><a/></li>').appendTo(menu).children().attr('href', '#')\n                    .text(item.title ?? '').click(function (e: any) {\n                        e.preventDefault();\n                        this.$this.fieldChanged = self.field !== this.field.$;\n                        self.field = this.field.$;\n                        this.$this.updateInputPlaceHolder();\n                        this.$this.checkIfValueChanged();\n                    }.bind({\n                        field: field,\n                        $this: this\n                    }));\n            }\n\n            new PopupMenuButton(a, {\n                positionMy: 'right top',\n                positionAt: 'right bottom',\n                menu: menu\n            });\n\n            this.field = this.options.fields[0];\n            this.updateInputPlaceHolder();\n        }\n\n        this.element.bind('execute-search.' + this.uniqueName, e1 => {\n            if (!!this.timer) {\n                window.clearTimeout(this.timer);\n            }\n            this.searchNow(trim(this.element.val() ?? ''));\n        });\n    }\n\n    protected checkIfValueChanged(): void {\n        if (this.element.hasClass('ignore-change')) {\n            return;\n        }\n\n        var value = this.get_value();\n        if (value == this.lastValue && (!this.fieldChanged || isEmptyOrNull(value))) {\n            this.fieldChanged = false;\n            return;\n        }\n\n        this.fieldChanged = false;\n\n        if (!!this.timer) {\n            window.clearTimeout(this.timer);\n        }\n\n        var self = this;\n        this.timer = window.setTimeout(function () {\n            self.searchNow(value);\n        }, this.options.typeDelay ?? 500);\n\n        this.lastValue = value;\n    }\n\n    get_value() {\n        return trim(this.element.val() ?? '');\n    }\n\n    get_field(): QuickSearchField {\n        return this.field;\n    }\n\n    set_field(value: QuickSearchField): void {\n        if (this.field !== value) {\n            this.fieldChanged = true;\n            this.field = value;\n            this.updateInputPlaceHolder();\n            this.checkIfValueChanged();\n        }\n    }\n\n    protected updateInputPlaceHolder() {\n        var qsf = this.element.prevAll('.quick-search-field');\n        if (this.field) {\n            qsf.text(this.field.title);\n        }\n        else {\n            qsf.text('');\n        }\n    }\n\n    public restoreState(value: string, field: QuickSearchField) {\n        this.fieldChanged = false;\n        this.field = field;\n        var value = trim(value ?? '');\n        this.element.val(value);\n        this.lastValue = value;\n        if (!!this.timer) {\n            window.clearTimeout(this.timer);\n            this.timer = null;\n        }\n        this.updateInputPlaceHolder();\n    }\n\n    protected searchNow(value: string) {\n        this.element.parent().toggleClass(\n            (this.options.filteredParentClass ?? 's-QuickSearchFiltered'), !!(value.length > 0));\n\n        this.element.parent().addClass(this.options.loadingParentClass ?? 's-QuickSearchLoading')\n                .addClass(this.options.loadingParentClass ?? 's-QuickSearchLoading');\n\n        var done = (results: any) => {\n            this.element.removeClass(this.options.loadingParentClass ?? 's-QuickSearchLoading')\n            .parent().removeClass(this.options.loadingParentClass ?? 's-QuickSearchLoading');\n\n            if (!results) {\n                var el = this.element.closest('.s-QuickSearchBar')\n                    .find('.quick-search-icon i')[0] as HTMLElement;\n                if (el) {\n                    el.classList.add('s-shake-effect');\n                    setTimeout(() => el.classList.remove('s-shake-effect'), 2000);\n                }\n            }\n        };\n\n        if (this.options.onSearch != null) {\n            this.options.onSearch(((this.field != null &&\n                !isEmptyOrNull(this.field.name)) ? this.field.name : null), value, done);\n        }\n        else {\n            done(true);\n        }\n    }\n}", "\uFEFFexport {}\n\nexport interface FilterOperator {\n    key?: string;\n    title?: string;\n    format?: string;\n}\n\nexport namespace FilterOperators {\n\n    export const isTrue = 'true';\n    export const isFalse = 'false';\n    export const contains = 'contains';\n    export const startsWith = 'startswith';\n    export const EQ = 'eq';\n    export const NE = 'ne';\n    export const GT = 'gt';\n    export const GE = 'ge';\n    export const LT = 'lt';\n    export const LE = 'le';\n    export const BW = 'bw';\n    export const IN = 'in';\n    export const isNull = 'isnull';\n    export const isNotNull = 'isnotnull';\n\n    export const toCriteriaOperator: { [key: string]: string } = {\n        eq: '=',\n        ne: '!=',\n        gt: '>',\n        ge: '>=',\n        lt: '<',\n        le: '<='\n    };\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { ArgumentNullException, Criteria, Culture, delegateCombine, delegateRemove, PropertyItem, localText, tryGetText } from \"../../q\";\nimport { FilterLine } from \"./filterline\";\n\n@Decorators.registerClass('Serenity.FilterStore')\nexport class FilterStore {\n\n    constructor(fields: PropertyItem[]) {\n\n        this.items = [];\n\n        if (fields == null) {\n            throw new ArgumentNullException('source');\n        }\n\n        this.fields = fields.slice();\n\n        this.get_fields().sort(function (x, y) {\n            var titleX = tryGetText(x.title);\n            if (titleX == null) {\n                titleX = x.title;\n                if (titleX == null)\n                    titleX = x.name;\n            }\n\n            var titleY = tryGetText(y.title);\n            if (titleY == null) {\n                titleY = y.title;\n                if (titleY == null)\n                    titleY = y.name;\n            }\n\n            return Culture.stringCompare(titleX, titleY);\n        });\n\n        this.fieldByName = {};\n\n        for (var field of fields) {\n            this.get_fieldByName()[field.name] = field;\n        }\n    }\n\n    static getCriteriaFor(items: FilterLine[]): any[] {\n\n        if (items == null)\n            return [''];\n\n        var inParens = false;\n        var currentBlock = [''];\n        var isBlockOr = false;\n        var criteria = [''];\n\n        for (var i = 0; i < items.length; i++) {\n            var line = items[i];\n\n            if (line.leftParen || inParens && line.rightParen) {\n\n                if (!Criteria.isEmpty(currentBlock)) {\n\n                    if (inParens)\n                        currentBlock = Criteria.paren(currentBlock);\n\n                    if (isBlockOr)\n                        criteria = Criteria.or(criteria, currentBlock);\n                    else\n                        criteria = Criteria.and(criteria, currentBlock);\n\n                    currentBlock = [''];\n                }\n\n                inParens = false;\n            }\n\n            if (line.leftParen) {\n                isBlockOr = line.isOr;\n                inParens = true;\n            }\n\n            if (line.isOr)\n                currentBlock = Criteria.or(currentBlock, line.criteria);\n            else\n                currentBlock = Criteria.and(currentBlock, line.criteria);\n        }\n\n        if (!Criteria.isEmpty(currentBlock)) {\n            if (isBlockOr)\n                criteria = Criteria.or(criteria, Criteria.paren(currentBlock));\n            else\n                criteria = Criteria.and(criteria, Criteria.paren(currentBlock));\n        }\n\n        return criteria;\n    }\n\n    static getDisplayTextFor(items: FilterLine[]): string {\n\n        if (items == null)\n            return '';\n\n        var inParens = false;\n        var displayText = '';\n\n        for (var i = 0; i < items.length; i++) {\n            var line = items[i];\n\n            if (inParens && (line.rightParen || line.leftParen)) {\n                displayText += ')';\n                inParens = false;\n            }\n\n            if (displayText.length > 0) {\n                displayText += ' ' + localText('Controls.FilterPanel.' +\n                    (line.isOr ? 'Or' : 'And')) + ' ';\n            }\n\n            if (line.leftParen) {\n                displayText += '(';\n                inParens = true;\n            }\n\n            displayText += line.displayText;\n        }\n\n        if (inParens) {\n            displayText += ')';\n        }\n\n        return displayText;\n    }\n\n    private changed: any;\n    private displayText: string;\n    private fields: PropertyItem[];\n    private fieldByName: { [key: string]: PropertyItem }\n    private items: FilterLine[];\n\n    get_fields(): PropertyItem[] {\n        return this.fields;\n    }\n\n    get_fieldByName(): { [key: string]: PropertyItem } {\n        return this.fieldByName;\n    }\n\n    get_items(): FilterLine[] {\n        return this.items;\n    }\n\n    raiseChanged(): void {\n        this.displayText = null;\n        this.changed && this.changed(this, {});\n    }\n\n    add_changed(value: (e: JQueryEventObject, a: any) => void): void {\n        this.changed = delegateCombine(this.changed, value);\n    }\n\n    remove_changed(value: (e: JQueryEventObject, a: any) => void): void {\n        this.changed = delegateRemove(this.changed, value);\n    }\n\n    get_activeCriteria(): any[] {\n        return FilterStore.getCriteriaFor(this.items);\n    }\n\n    get_displayText(): string {\n        if (this.displayText == null)\n            this.displayText = FilterStore.getDisplayTextFor(this.items);\n        \n        return this.displayText;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { ArgumentNullException, Config, Criteria, deepClone, endsWith, Exception, extend, format, formatDate, getInstanceType, getTypeFullName, getTypeShortName, getTypes, isAssignableFrom, isEmptyOrNull, parseISODateTime, PropertyItem, startsWith, localText, tryGetText } from \"../../q\";\nimport { EditorTypeRegistry } from \"../../types/editortyperegistry\";\nimport { QuickFilter } from \"../datagrid/quickfilter\";\nimport { DateEditor } from \"../editors/dateeditor\";\nimport { DateTimeEditor } from \"../editors/datetimeeditor\";\nimport { DecimalEditor } from \"../editors/decimaleditor\";\nimport { EditorUtils } from \"../editors/editorutils\";\nimport { EnumEditor } from \"../editors/enumeditor\";\nimport { IntegerEditor } from \"../editors/integereditor\";\nimport { LookupEditor } from \"../editors/lookupeditor\";\nimport { ServiceLookupEditor } from \"../editors/servicelookupeditor\";\nimport { StringEditor } from \"../editors/stringeditor\";\nimport { Widget } from \"../widgets/widget\";\nimport { FilterOperator, FilterOperators } from \"./filteroperator\";\n\nexport interface IFiltering {\n    createEditor(): void;\n    getCriteria(): CriteriaWithText;\n    getOperators(): FilterOperator[];\n    loadState(state: any): void;\n    saveState(): any;\n    get_field(): PropertyItem;\n    set_field(value: PropertyItem): void;\n    get_container(): JQuery;\n    set_container(value: JQuery): void;\n    get_operator(): FilterOperator;\n    set_operator(value: FilterOperator): void;\n}\n\n@Decorators.registerInterface('Serenity.IFiltering')\nexport class IFiltering {\n}\n\nexport interface CriteriaWithText {\n    criteria?: any[];\n    displayText?: string;\n}\n\nexport interface IQuickFiltering {\n    initQuickFilter(filter: QuickFilter<Widget<any>, any>): void;\n}\n\n@Decorators.registerInterface('Serenity.IQuickFiltering')\nexport class IQuickFiltering {\n}\n\n@Decorators.registerClass('Serenity.BaseFiltering', [IFiltering, IQuickFiltering])\nexport abstract class BaseFiltering implements IFiltering, IQuickFiltering {\n\n    private field: PropertyItem;\n\n    public get_field() {\n        return this.field;\n    }\n\n    set_field(value: PropertyItem) {\n        this.field = value;\n    }\n\n    private container: JQuery;\n\n    get_container(): JQuery {\n        return this.container;\n    }\n\n    set_container(value: JQuery) {\n        this.container = value;\n    }\n\n    private operator: FilterOperator;\n\n    get_operator() {\n        return this.operator;\n    }\n\n    set_operator(value: FilterOperator) {\n        this.operator = value;\n    }\n\n    abstract getOperators(): FilterOperator[];\n\n    protected appendNullableOperators(list: FilterOperator[]) {\n        if (!this.isNullable()) {\n            return list;\n        }\n        list.push({ key: FilterOperators.isNotNull });\n        list.push({ key: FilterOperators.isNull });\n        return list;\n    }\n\n    protected appendComparisonOperators(list: FilterOperator[]) {\n        list.push({ key: FilterOperators.EQ });\n        list.push({ key: FilterOperators.NE });\n        list.push({ key: FilterOperators.LT });\n        list.push({ key: FilterOperators.LE });\n        list.push({ key: FilterOperators.GT });\n        list.push({ key: FilterOperators.GE });\n        return list;\n    }\n\n    protected isNullable() {\n        return this.get_field().required !== true;\n    }\n\n    public createEditor() {\n        switch (this.get_operator().key) {\n            case 'true':\n            case 'false':\n            case 'isnull':\n            case 'isnotnull': {\n                return;\n            }\n            case 'contains':\n            case 'startswith':\n            case 'eq':\n            case 'ne':\n            case 'lt':\n            case 'le':\n            case 'gt':\n            case 'ge': {\n                this.get_container().html('<input type=\"text\"/>');\n                return;\n            }\n        }\n\n        throw new Exception(format(\"Filtering '{0}' has no editor for '{1}' operator\",\n            getTypeFullName(getInstanceType(this)), this.get_operator().key));\n    }\n\n    protected operatorFormat(op: FilterOperator) {\n        return op.format ?? tryGetText('Controls.FilterPanel.OperatorFormats.' + op.key) ?? op.key;\n    }\n\n    protected getTitle(field: PropertyItem) {\n        return tryGetText(field.title) ??(field.title ?? field.name);\n    }\n\n    protected displayText(op: FilterOperator, values?: any[]) {\n        if (!values || values.length === 0) {\n            return format(this.operatorFormat(op), this.getTitle(this.field));\n        }\n        else if (values.length === 1) {\n            return format(this.operatorFormat(op), this.getTitle(this.field), values[0]);\n        }\n        else {\n            return format(this.operatorFormat(op), this.getTitle(this.field), values[0], values[1]);\n        }\n    }\n\n    protected getCriteriaField() {\n        return this.field.name;\n    }\n\n    public getCriteria(): CriteriaWithText {\n        var result: CriteriaWithText = {};\n        var text: string;\n        var field = Criteria(this.getCriteriaField());\n        var op = this.get_operator().key;\n        switch (op) {\n            case 'true': {\n                result.displayText = this.displayText(this.get_operator(), []);\n                result.criteria = field.eq(true);\n                return result;\n            }\n\n            case 'false': {\n                result.displayText = this.displayText(this.get_operator(), []);\n                result.criteria = field.eq(false);\n                return result;\n            }\n\n            case 'isnull': {\n                result.displayText = this.displayText(this.get_operator(), []);\n                result.criteria = field.isNull();\n                return result;\n            }\n\n            case 'isnotnull': {\n                result.displayText = this.displayText(this.get_operator(), []);\n                result.criteria = field.isNotNull();\n                return result;\n            }\n\n            case 'contains': {\n                text = this.getEditorText();\n                result.displayText = this.displayText(this.get_operator(), [text]);\n                result.criteria = field.contains(text);\n                return result;\n            }\n\n            case 'startswith': {\n                text = this.getEditorText();\n                result.displayText = this.displayText(this.get_operator(), [text]);\n                result.criteria = field.startsWith(text);\n                return result;\n            }\n\n            case 'eq':\n            case 'ne':\n            case 'lt':\n            case 'le':\n            case 'gt':\n            case 'ge': {\n                text = this.getEditorText();\n                result.displayText = this.displayText(this.get_operator(), [text]);\n                result.criteria = field[op](this.getEditorValue());\n                return result;\n            }\n        }\n\n        throw new Exception(format(\"Filtering '{0}' has no handler for '{1}' operator\",\n            getTypeFullName(getInstanceType(this)), this.get_operator().key));\n    }\n\n    loadState(state: any) {\n        var input = this.get_container().find(':input').first();\n        input.val(state);\n    }\n\n    saveState() {\n        switch (this.get_operator().key) {\n            case 'contains':\n            case 'startswith':\n            case 'eq':\n            case 'ne':\n            case 'lt':\n            case 'le':\n            case 'gt':\n            case 'ge': {\n                var input = this.get_container().find(':input').first();\n                return input.val();\n            }\n        }\n        return null;\n    }\n\n    protected argumentNull() {\n        return new Error(localText('Controls.FilterPanel.ValueRequired'));\n    }\n\n    validateEditorValue(value: string) {\n        if (value.length === 0) {\n            throw this.argumentNull();\n        }\n        return value;\n    }\n\n    getEditorValue() {\n        var input = this.get_container().find(':input').not('.select2-focusser').first();\n        if (input.length !== 1) {\n            throw new Exception(format(\"Couldn't find input in filter container for {0}\",\n                (this.field.title ?? this.field.name)));\n        }\n\n        var value;\n        if (input.data('select2') != null) {\n            value = input.select2('val');\n        }\n        else {\n            value = input.val();\n        }\n\n        value = (value ?? '').trim();\n\n        return this.validateEditorValue(value);\n    }\n\n    getEditorText() {\n        var input = this.get_container().find(':input').not('.select2-focusser').not('.select2-input').first();\n        if (input.length === 0) {\n            return this.get_container().text().trim();\n        }\n        var value;\n        if (input.data('select2') != null) {\n            value = (input.select2('data') ?? {}).text;\n        }\n        else {\n            value = input.val();\n        }\n        return value;\n    }\n\n    initQuickFilter(filter: QuickFilter<Widget<any>, any>) {\n        filter.field = this.getCriteriaField();\n        filter.type = StringEditor;\n        filter.title = this.getTitle(this.field);\n        filter.options = deepClone(this.get_field().quickFilterParams);\n    }\n}\n\nfunction Filtering(name: string) {\n    return Decorators.registerClass('Serenity.' + name + 'Filtering')\n}\n\n@Filtering('BaseEditor')\nexport abstract class BaseEditorFiltering<TEditor extends Widget<any>> extends BaseFiltering {\n    constructor(public editorType: any) {\n        super();\n    }\n\n    protected useEditor() {\n        switch (this.get_operator().key) {\n            case 'eq':\n            case 'ne':\n            case 'lt':\n            case 'le':\n            case 'gt':\n            case 'ge':\n                return true;\n        }\n        return false;\n    }\n\n    protected editor: TEditor;\n\n    createEditor() {\n        if (this.useEditor()) {\n            this.editor = Widget.create({\n                type: this.editorType,\n                container: this.get_container(),\n                options: this.getEditorOptions(),\n                init: null\n            }) as any;\n            return;\n        }\n        this.editor = null;\n        super.createEditor();\n    }\n\n    protected useIdField() {\n        return false;\n    }\n\n    getCriteriaField() {\n        if (this.useEditor() &&\n            this.useIdField() &&\n            !isEmptyOrNull(this.get_field().filteringIdField)) {\n            return this.get_field().filteringIdField;\n        }\n\n        return super.getCriteriaField();\n    }\n\n    getEditorOptions() {\n        var opt = deepClone(this.get_field().editorParams || {});\n        delete opt['cascadeFrom'];\n        // currently can't support cascadeFrom in filtering\n        return extend(opt, this.get_field().filteringParams);\n    }\n\n    loadState(state: any) {\n        if (this.useEditor()) {\n            if (state == null) {\n                return;\n            }\n\n            EditorUtils.setValue(this.editor, state);\n            return;\n        }\n\n        super.loadState(state);\n    }\n\n    saveState() {\n        if (this.useEditor()) {\n            return EditorUtils.getValue(this.editor);\n        }\n\n        return super.saveState();\n    }\n\n    getEditorValue() {\n        if (this.useEditor()) {\n            var value = EditorUtils.getValue(this.editor);\n\n            if (value == null || (typeof value == \"string\" && value.trim().length === 0))\n                throw this.argumentNull();\n\n            return value;\n        }\n\n        return super.getEditorValue();\n    }\n\n    initQuickFilter(filter: QuickFilter<Widget<any>, any>) {\n        super.initQuickFilter(filter);\n\n        filter.type = this.editorType;\n        filter.options = extend(extend({}, deepClone(this.getEditorOptions())), deepClone(this.get_field().quickFilterParams));\n    }\n}\n\n@Filtering('Date')\nexport class DateFiltering extends BaseEditorFiltering<DateEditor> {\n\n    constructor() {\n        super(DateEditor)\n    }\n\n    getOperators(): FilterOperator[] {\n        return this.appendNullableOperators(this.appendComparisonOperators([]));\n    }\n}\n\n@Filtering('Boolean')\nexport class BooleanFiltering extends BaseFiltering {\n    getOperators() {\n        return this.appendNullableOperators([\n            { key: FilterOperators.isTrue },\n            { key: FilterOperators.isFalse }\n        ]);\n    }\n}\n\n@Filtering('DateTime')\nexport class DateTimeFiltering extends BaseEditorFiltering<DateEditor> {\n\n    constructor() {\n        super(DateTimeEditor)\n    }\n\n    getOperators(): FilterOperator[] {\n        return this.appendNullableOperators(\n            this.appendComparisonOperators([]));\n    }\n\n    getCriteria() {\n        var result: CriteriaWithText = {};\n\n        switch (this.get_operator().key) {\n            case 'eq':\n            case 'ne':\n            case 'lt':\n            case 'le':\n            case 'gt':\n            case 'ge': {\n                {\n                    var text = this.getEditorText();\n                    result.displayText = this.displayText(this.get_operator(), [text]);\n                    var date = parseISODateTime(this.getEditorValue());\n                    date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n                    var next = new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1);\n                    var criteria = Criteria(this.getCriteriaField());\n                    var dateValue = formatDate(date, 'yyyy-MM-dd');\n                    var nextValue = formatDate(next, 'yyyy-MM-dd');\n                    switch (this.get_operator().key) {\n                        case 'eq': {\n                            result.criteria = Criteria.and(criteria.ge(dateValue), criteria.lt(nextValue));\n                            return result;\n                        }\n                        case 'ne': {\n                            result.criteria = Criteria.paren(Criteria.or(criteria.lt(dateValue), criteria.gt(nextValue)));\n                            return result;\n                        }\n                        case 'lt': {\n                            result.criteria = criteria.lt(dateValue);\n                            return result;\n                        }\n                        case 'le': {\n                            result.criteria = criteria.lt(nextValue);\n                        }\n                        case 'gt': {\n                            result.criteria = criteria.ge(nextValue);\n                            return result;\n                        }\n                        case 'ge': {\n                            result.criteria = criteria.ge(dateValue);\n                            return result;\n                        }\n                    }\n                }\n                break;\n            }\n        }\n\n        return super.getCriteria();\n    }\n}\n\n@Filtering('Decimal')\nexport class DecimalFiltering extends BaseEditorFiltering<DecimalEditor> {\n    constructor() {\n        super(DecimalEditor);\n    }\n\n    getOperators(): FilterOperator[] {\n        return this.appendNullableOperators(\n            this.appendComparisonOperators([]));\n    }\n}\n\n@Filtering('Editor')\nexport class EditorFiltering extends BaseEditorFiltering<Widget<any>> {\n\n    constructor() {\n        super(Widget)\n    }\n\n    @Decorators.option()\n    editorType: string;\n\n    @Decorators.option()\n    useRelative: boolean;\n\n    @Decorators.option()\n    useLike: boolean;\n\n    getOperators(): FilterOperator[] {\n        var list = [];\n\n        list.push({ key: FilterOperators.EQ });\n        list.push({ key: FilterOperators.NE });\n\n        if (this.useRelative) {\n            list.push({ key: FilterOperators.LT });\n            list.push({ key: FilterOperators.LE });\n            list.push({ key: FilterOperators.GT });\n            list.push({ key: FilterOperators.GE });\n        }\n\n        if (this.useLike) {\n            list.push({ key: FilterOperators.contains });\n            list.push({ key: FilterOperators.startsWith });\n        }\n\n        this.appendNullableOperators(list);\n\n        return list;\n    }\n\n    protected useEditor() {\n        var op = this.get_operator().key;\n\n        return op === FilterOperators.EQ ||\n            op === FilterOperators.NE ||\n            (this.useRelative && (\n                op === FilterOperators.LT ||\n                op === FilterOperators.LE ||\n                op === FilterOperators.GT ||\n                op === FilterOperators.GE));\n    }\n\n    getEditorOptions() {\n        var opt = super.getEditorOptions();\n        if (this.useEditor() && this.editorType === (this.get_field().editorType ?? 'String')) {\n            opt = extend(opt, this.get_field().editorParams);\n        }\n\n        return opt;\n    }\n\n    createEditor() {\n        if (this.useEditor()) {\n            var editorType = EditorTypeRegistry.get(this.editorType);\n\n            this.editor = Widget.create({\n                type: editorType ,\n                element: e => e.appendTo(this.get_container()),\n                options: this.getEditorOptions()\n            });\n\n            return;\n        }\n\n        super.createEditor();\n    }\n\n    protected useIdField(): boolean {\n        return this.useEditor();\n    }\n\n    initQuickFilter(filter: QuickFilter<Widget<any>, any>) {\n        super.initQuickFilter(filter);\n\n        filter.type = EditorTypeRegistry.get(this.editorType);\n    }\n}\n\n@Filtering('Enum')\nexport class EnumFiltering extends BaseEditorFiltering<EnumEditor> {\n    constructor() {\n        super(EnumEditor);\n    }\n\n    getOperators() {\n        var op = [{ key: FilterOperators.EQ }, { key: FilterOperators.NE }];\n        return this.appendNullableOperators(op);\n    }\n}\n\n@Filtering('Integer')\nexport class IntegerFiltering extends BaseEditorFiltering<IntegerEditor> {\n    constructor() {\n        super(IntegerEditor);\n    }\n\n    getOperators(): FilterOperator[] {\n        return this.appendNullableOperators(this.appendComparisonOperators([]));\n    }\n}\n\n@Filtering('Lookup')\nexport class LookupFiltering extends BaseEditorFiltering<LookupEditor> {\n\n    constructor() {\n        super(LookupEditor);\n    }\n\n    getOperators(): FilterOperator[] {\n        var ops = [{ key: FilterOperators.EQ }, { key: FilterOperators.NE }, { key: FilterOperators.contains }, { key: FilterOperators.startsWith }]\n        return this.appendNullableOperators(ops);\n    }\n\n    protected useEditor(): boolean {\n        var op = this.get_operator().key;\n        return op == FilterOperators.EQ || op == FilterOperators.NE;\n    }\n\n    protected useIdField(): boolean {\n        return this.useEditor();\n    }\n\n    getEditorText(): string {\n        if (this.useEditor()) {\n            return this.editor.text;\n        }\n\n        return super.getEditorText();\n    }\n}\n\n@Filtering('ServiceLookup')\nexport class ServiceLookupFiltering extends BaseEditorFiltering<ServiceLookupEditor> {\n\n    constructor() {\n        super(ServiceLookupEditor);\n    }\n\n    getOperators(): FilterOperator[] {\n        var ops = [{ key: FilterOperators.EQ }, { key: FilterOperators.NE }, { key: FilterOperators.contains }, { key: FilterOperators.startsWith }]\n        return this.appendNullableOperators(ops);\n    }\n\n    protected useEditor(): boolean {\n        var op = this.get_operator().key;\n        return op == FilterOperators.EQ || op == FilterOperators.NE;\n    }\n\n    protected useIdField(): boolean {\n        return this.useEditor();\n    }\n\n    getEditorText(): string {\n        if (this.useEditor()) {\n            return this.editor.text;\n        }\n\n        return super.getEditorText();\n    }\n}\n\n@Filtering('String')\nexport class StringFiltering extends BaseFiltering {\n\n    getOperators(): FilterOperator[] {\n        var ops = [\n            { key: FilterOperators.contains }, \n            { key: FilterOperators.startsWith }, \n            { key: FilterOperators.EQ },\n            { key: FilterOperators.NE }\n        ];\n        return this.appendNullableOperators(ops);\n    }\n\n    validateEditorValue(value: string) {\n        if (value.length === 0) {\n            return value;\n        }\n\n        return super.validateEditorValue(value);\n    }\n}\n\nexport namespace FilteringTypeRegistry {\n\n    let knownTypes: { [key: string]: Function };\n\n    function initialize(): void {\n\n        if (knownTypes != null)\n            return;\n        \n        knownTypes = {};\n\n        for (var type of getTypes()) {\n            if (!isAssignableFrom(IFiltering, type))\n                continue;\n                \n            var fullName = getTypeFullName(type).toLowerCase();\n\n            knownTypes[fullName] = type;\n\n            for (var k of Config.rootNamespaces) {\n                if (startsWith(fullName, k.toLowerCase() + '.')) {\n                    var kx = fullName.substr(k.length + 1).toLowerCase();\n\n                    if (knownTypes[kx] == null) {\n                        knownTypes[kx] = type;\n                    }\n                }\n            }\n        }\n\n        setTypeKeysWithoutFilterHandlerSuffix();\n    }\n\n    function setTypeKeysWithoutFilterHandlerSuffix() {\n        var suffix = 'filtering';\n        \n        for (var k of Object.keys(knownTypes)) {\n            if (!endsWith(k, suffix))\n                continue;\n            \n            var p = k.substr(0, k.length - suffix.length);\n            if (isEmptyOrNull(p))\n                continue;\n\n            if (knownTypes[p] != null)\n                continue;\n            \n            knownTypes[p] = knownTypes[k];\n        }\n    }\n\n    function reset(): void {\n        knownTypes = null;\n    }\n\n    export function get(key: string): Function {\n\n        if (isEmptyOrNull(key))\n            throw new ArgumentNullException('key');\n\n        initialize();\n        var formatterType = knownTypes[key.toLowerCase()];\n        if (formatterType == null)\n            throw new Exception(format(\n                \"Can't find {0} filter handler type!\", key));\n\n        return formatterType;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { TemplatedWidget } from \"../widgets/templatedwidget\";\nimport { FilterStore } from \"./filterstore\";\n\n@Decorators.registerClass('Serenity.FilterWidgetBase')\nexport class FilterWidgetBase<TOptions> extends TemplatedWidget<TOptions> {\n    private store: FilterStore;\n\n    private onFilterStoreChanged: () => void;\n\n    constructor(div: JQuery, opt?: TOptions) {\n        super(div, opt);\n\n        this.store = new FilterStore([]);\n        this.onFilterStoreChanged = () => this.filterStoreChanged();\n        this.store.add_changed(this.onFilterStoreChanged);\n    }\n\n    destroy() {\n\n        if (this.store) {\n            this.store.remove_changed(this.onFilterStoreChanged);\n            this.onFilterStoreChanged = null;\n            this.store = null;\n        }\n\n        super.destroy();\n    }\n\n    protected filterStoreChanged() {\n    }\n\n    get_store(): FilterStore {\n        return this.store;\n    }\n\n    set_store(value: FilterStore): void {\n        if (this.store !== value) {\n            if (this.store != null) \n                this.store.remove_changed(this.onFilterStoreChanged);\n\n            this.store = value || new FilterStore([]);\n            this.store.add_changed(this.onFilterStoreChanged);\n            this.filterStoreChanged();\n        }\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { cast, isEmptyOrNull, PropertyItem, localText, tryGetText } from \"../../q\";\nimport { Select2Editor } from \"../editors/select2editor\";\nimport { ReflectionOptionsSetter } from \"../widgets/reflectionoptionssetter\";\nimport { FilteringTypeRegistry, IFiltering } from \"./filtering\";\nimport { FilterLine } from \"./filterline\";\nimport { FilterOperator } from \"./filteroperator\";\nimport { FilterWidgetBase } from \"./filterwidgetbase\";\n\n@Decorators.registerClass('Serenity.FilterFieldSelect')\nclass FilterFieldSelect extends Select2Editor<any, PropertyItem> {\n    constructor(hidden: JQuery, fields: PropertyItem[]) {\n        super(hidden);\n\n        for (var field of fields) {\n            this.addOption(field.name, (tryGetText(field.title) ??\n                field.title ?? field.name), field);\n        }\n    }\n\n    emptyItemText() {\n        if (isEmptyOrNull(this.value)) {\n            return localText('Controls.FilterPanel.SelectField');\n        }\n\n        return null;\n    }\n\n    getSelect2Options() {\n        var opt = super.getSelect2Options();\n        opt.allowClear = false;\n        return opt;\n    }\n}\n\n@Decorators.registerClass('Serenity.FilterOperatorSelect')\nclass FilterOperatorSelect extends Select2Editor<any, FilterOperator> {\n    constructor(hidden: JQuery, source: FilterOperator[]) {\n        super(hidden);\n\n        for (var op of source) {\n            var title = (op.title ?? (\n                tryGetText(\"Controls.FilterPanel.OperatorNames.\" + op.key) ?? op.key));\n            this.addOption(op.key, title, op);\n        }\n\n        if (source.length && source[0])\n            this.value = source[0].key;\n    }\n\n    emptyItemText(): string {\n        return null;\n    }\n\n    getSelect2Options() {\n        var opt = super.getSelect2Options();\n        opt.allowClear = false;\n        return opt;\n    }\n}\n\n@Decorators.registerClass(\"Serenity.FilterPanel\")\nexport class FilterPanel extends FilterWidgetBase<any> {\n\n    private rowsDiv: JQuery;\n\n    constructor(div: JQuery) {\n        super(div);\n\n        this.element.addClass('s-FilterPanel');\n        this.rowsDiv = this.byId('Rows');\n        this.initButtons();\n        this.updateButtons();\n    }\n\n    private showInitialLine: boolean;\n\n    get_showInitialLine() {\n        return this.showInitialLine;\n    }\n\n    set_showInitialLine(value: boolean) {\n        if (this.showInitialLine !== value) {\n            this.showInitialLine = value;\n            if (this.showInitialLine && this.rowsDiv.children().length === 0) {\n                this.addEmptyRow(false);\n            }\n        }\n    }\n\n    protected filterStoreChanged() {\n        super.filterStoreChanged();\n        this.updateRowsFromStore();\n    }\n\n    updateRowsFromStore() {\n        this.rowsDiv.empty();\n\n        var items = this.get_store().get_items();\n        for (var item of items) {\n            this.addEmptyRow(false);\n\n            var row = this.rowsDiv.children().last();\n\n            var divl = row.children('div.l');\n            divl.children('.leftparen').toggleClass('active', !!item.leftParen);\n            divl.children('.rightparen').toggleClass('active', !!item.rightParen);\n            divl.children('.andor').toggleClass('or', !!item.isOr)\n                .text(localText((!!item.isOr ? 'Controls.FilterPanel.Or' :\n                    'Controls.FilterPanel.And')));\n\n            var fieldSelect = row.children('div.f')\n                .find('input.field-select').getWidget(FilterFieldSelect);\n\n            fieldSelect.value = item.field;\n            this.rowFieldChange(row);\n            var operatorSelect = row.children('div.o')\n                .find('input.op-select').getWidget(FilterOperatorSelect);\n\n            operatorSelect.set_value(item.operator);\n            this.rowOperatorChange(row);\n\n            var filtering = this.getFilteringFor(row);\n            if (filtering != null) {\n                filtering.set_operator({ key: item.operator });\n                filtering.loadState(item.state);\n            }\n        }\n\n        if (this.get_showInitialLine() && this.rowsDiv.children().length === 0) {\n            this.addEmptyRow(false);\n        }\n\n        this.updateParens();\n    }\n\n    private showSearchButton: boolean;\n\n    get_showSearchButton(): boolean {\n        return this.showSearchButton;\n    }\n\n    set_showSearchButton(value: boolean): void {\n        if (this.showSearchButton !== value) {\n            this.showSearchButton = value;\n            this.updateButtons();\n        }\n    }\n\n    private updateStoreOnReset: boolean;\n\n    get_updateStoreOnReset() {\n        return this.updateStoreOnReset;\n    }\n\n    set_updateStoreOnReset(value: boolean): void {\n        if (this.updateStoreOnReset !== value) {\n            this.updateStoreOnReset = value;\n        }\n    }\n\n    protected getTemplate(): string {\n        return \"<div id='~_Rows' class='filter-lines'>\" +\n            \"</div>\" +\n            \"<div id='~_Buttons' class='buttons'>\" +\n            \"<button id='~_AddButton' class='btn btn-primary add'></button>\" +\n            \"<button id='~_SearchButton' class='btn btn-success search'></button>\" +\n            \"<button id='~_ResetButton' class='btn btn-danger reset'></button>\" +\n            \"</div>\" +\n            \"<div style='clear: both'>\" +\n            \"</div>\"\n    }\n\n    protected initButtons(): void {\n        this.byId('AddButton').text(localText('Controls.FilterPanel.AddFilter'))\n            .click((e) => this.addButtonClick(e));\n\n        this.byId('SearchButton').text(localText('Controls.FilterPanel.SearchButton'))\n            .click((e) => this.searchButtonClick(e));\n\n        this.byId('ResetButton').text(localText('Controls.FilterPanel.ResetButton'))\n            .click((e) => this.resetButtonClick(e));\n    }\n\n    protected searchButtonClick(e: JQueryEventObject) {\n        e.preventDefault();\n        this.search();\n    }\n\n    get_hasErrors(): boolean {\n        return this.rowsDiv.children().children('div.v')\n            .children('span.error').length > 0;\n    }\n\n    search() {\n        this.rowsDiv.children().children('div.v')\n            .children('span.error').remove();\n\n        var filterLines = [];\n        var errorText = null;\n        var row = null;\n        for (var i = 0; i < this.rowsDiv.children().length; i++) {\n            row = this.rowsDiv.children().eq(i);\n            var filtering = this.getFilteringFor(row);\n            if (filtering == null) {\n                continue;\n            }\n\n            var field = this.getFieldFor(row);\n            var op = row.children('div.o').find('input.op-select')\n                .getWidget(FilterOperatorSelect).value;\n\n            if (op == null || op.length === 0) {\n                errorText = localText('Controls.FilterPanel.InvalidOperator');\n                break;\n            }\n\n            var line: FilterLine = {};\n            line.field = field.name;\n            line.operator = op;\n            line.isOr = row.children('div.l')\n                .children('a.andor').hasClass('or');\n            line.leftParen = row.children('div.l')\n                .children('a.leftparen').hasClass('active');\n            line.rightParen = row.children('div.l')\n                .children('a.rightparen').hasClass('active');\n            filtering.set_operator({ key: op });\n            var criteria;\n            try {\n                criteria = filtering.getCriteria();\n            }\n            catch (ex) {\n                errorText = ex.message ?? ex.toString();\n                break;\n            }\n            line.criteria = criteria.criteria;\n            line.state = filtering.saveState();\n            line.displayText = criteria.displayText;\n            filterLines.push(line);\n        }\n\n        // if an error occurred, display it, otherwise set current filters\n        if (errorText != null) {\n            $('<span/>').addClass('error')\n                .attr('title', errorText).appendTo(row.children('div.v'));\n            row.children('div.v').find('input:first').focus();\n            return;\n        }\n\n        var items = this.get_store().get_items();\n        items.length = 0;\n        items.push.apply(items, filterLines);\n        this.get_store().raiseChanged();\n    }\n\n    protected addButtonClick(e: JQueryEventObject) {\n        this.addEmptyRow(true);\n        e.preventDefault();\n    }\n\n    protected resetButtonClick(e: JQueryEventObject) {\n        e.preventDefault();\n\n        if (this.get_updateStoreOnReset()) {\n            if (this.get_store().get_items().length > 0) {\n                this.get_store().get_items().length = 0;\n                this.get_store().raiseChanged();\n            }\n        }\n\n        this.rowsDiv.empty();\n        this.updateButtons();\n        if (this.get_showInitialLine()) {\n            this.addEmptyRow(false);\n        }\n    }\n\n    protected findEmptyRow(): JQuery {\n        var result: JQuery = null;\n\n        this.rowsDiv.children().each(function (index, row) {\n            var fieldInput = $(row).children('div.f')\n                .children('input.field-select').first();\n            if (fieldInput.length === 0) {\n                return true;\n            }\n            var val = fieldInput.val();\n            if (val == null || val.length === 0) {\n                result = $(row);\n                return false;\n            }\n            return true;\n        });\n\n        return result;\n    }\n\n    protected addEmptyRow(popupField: boolean): JQuery {\n        var emptyRow = this.findEmptyRow();\n\n        if (emptyRow != null) {\n            emptyRow.find('input.field-select').select2('focus');\n            if (popupField) {\n                emptyRow.find('input.field-select').select2('open');\n            }\n            return emptyRow;\n        }\n\n        var isLastRowOr = this.rowsDiv.children().last()\n            .children('a.andor').hasClass('or');\n\n        var row = $(\n            \"<div class='filter-line'>\" +\n            \"<a class='delete'><span></span></a>\" +\n            \"<div class='l'>\" +\n            \"<a class='rightparen' href='#'>)</a>\" +\n            \"<a class='andor' href='#'></a>\" +\n            \"<a class='leftparen' href='#'>(</a>\" +\n            \"</div>\" +\n            \"<div class='f'>\" +\n            \"<input type='hidden' class='field-select'>\" +\n            \"</div>\" +\n            \"<div class='o'></div>\" +\n            \"<div class='v'></div>\" +\n            \"<div style='clear: both'></div>\" +\n            \"</div>\").appendTo(this.rowsDiv);\n\n        var parenDiv = row.children('div.l').hide();\n\n        parenDiv.children('a.leftparen, a.rightparen')\n            .click((e) => this.leftRightParenClick(e));\n\n        var andor = parenDiv.children('a.andor').attr('title', localText('Controls.FilterPanel.ChangeAndOr'));\n        if (isLastRowOr) {\n            andor.addClass('or').text(localText('Controls.FilterPanel.Or'));\n        }\n        else {\n            andor.text(localText('Controls.FilterPanel.And'));\n        }\n\n        andor.click((e) => this.andOrClick(e));\n\n        row.children('a.delete')\n            .attr('title', localText('Controls.FilterPanel.RemoveField'))\n            .click((e) => this.deleteRowClick(e));\n\n        var fieldSel = new FilterFieldSelect(row.children('div.f')\n            .children('input'), this.get_store().get_fields())\n            .changeSelect2(e => this.onRowFieldChange(e));\n\n        this.updateParens();\n        this.updateButtons();\n\n        row.find('input.field-select').select2('focus');\n\n        if (popupField) {\n            row.find('input.field-select').select2('open');\n        }\n\n        return row;\n    }\n\n    protected onRowFieldChange(e: JQueryEventObject) {\n        var row = $(e.target).closest('div.filter-line');\n        this.rowFieldChange(row);\n        var opSelect = row.children('div.o').find('input.op-select');\n        opSelect.select2('focus');\n    }\n\n    protected rowFieldChange(row: JQuery) {\n        row.removeData('Filtering');\n        var select = row.children('div.f').find('input.field-select')\n            .getWidget(FilterFieldSelect);\n        var fieldName = select.get_value();\n        var isEmpty = fieldName == null || fieldName === '';\n        this.removeFiltering(row);\n        this.populateOperatorList(row);\n        this.rowOperatorChange(row);\n        this.updateParens();\n        this.updateButtons();\n    }\n\n    protected removeFiltering(row: JQuery): void {\n        row.data('Filtering', null);\n        row.data('FilteringField', null);\n    }\n\n    protected populateOperatorList(row: JQuery): void {\n        row.children('div.o').html('');\n\n        var filtering = this.getFilteringFor(row);\n        if (filtering == null)\n            return;\n\n        var hidden = row.children('div.o').html('<input/>')\n            .children().attr('type', 'hidden').addClass('op-select');\n\n        var operators = filtering.getOperators();\n        var opSelect = new FilterOperatorSelect(hidden, operators);\n        opSelect.changeSelect2(e => this.onRowOperatorChange(e));\n    }\n\n    protected getFieldFor(row: JQuery) {\n        if (row.length === 0) {\n            return null;\n        }\n        var select = row.children('div.f').find('input.field-select')\n            .getWidget(FilterFieldSelect);\n\n        if (isEmptyOrNull(select.value)) {\n            return null;\n        }\n\n        return this.get_store().get_fieldByName()[select.get_value()];\n    }\n\n    protected getFilteringFor(row: JQuery): IFiltering {\n        var field = this.getFieldFor(row);\n\n        if (field == null)\n            return null;\n\n        var filtering = cast(row.data('Filtering'), IFiltering);\n\n        if (filtering != null)\n            return filtering;\n\n        var filteringType = FilteringTypeRegistry.get(\n            (field.filteringType ?? 'String'));\n\n        var editorDiv = row.children('div.v');\n        filtering = new (filteringType as any)() as IFiltering;\n        ReflectionOptionsSetter.set(filtering, field.filteringParams);\n        filtering.set_container(editorDiv);\n        filtering.set_field(field);\n        row.data('Filtering', filtering);\n        return filtering;\n    }\n\n    protected onRowOperatorChange(e: JQueryEventObject) {\n        var row = $(e.target).closest('div.filter-line');\n        this.rowOperatorChange(row);\n        var firstInput = row.children('div.v').find(':input:visible').first();\n        try {\n            firstInput.focus();\n        }\n        catch ($t1) {\n        }\n    }\n\n    protected rowOperatorChange(row: JQuery): void {\n\n        if (row.length === 0) {\n            return;\n        }\n\n        var editorDiv = row.children('div.v');\n        editorDiv.html('');\n        var filtering = this.getFilteringFor(row);\n        if (filtering == null)\n            return;\n        \n        var operatorSelect = row.children('div.o').find('input.op-select')\n            .getWidget(FilterOperatorSelect);\n\n        if (isEmptyOrNull(operatorSelect.get_value()))\n            return;\n        \n        var ops = filtering.getOperators().filter(function (x) {\n            return x.key === operatorSelect.value;\n        });\n\n        var op = ((ops.length > 0) ? ops[0] : null);\n        if (op == null)\n            return;\n\n        filtering.set_operator(op);\n        filtering.createEditor();\n    }\n\n    protected deleteRowClick(e: JQueryEventObject): void {\n        e.preventDefault();\n        var row = $(e.target).closest('div.filter-line');\n        row.remove();\n\n        if (this.rowsDiv.children().length === 0) {\n            this.search();\n        }\n\n        this.updateParens();\n        this.updateButtons();\n    }\n\n    protected updateButtons(): void {\n        this.byId('SearchButton').toggle(\n            this.rowsDiv.children().length >= 1 && this.showSearchButton);\n        this.byId('ResetButton').toggle(\n            this.rowsDiv.children().length >= 1);\n    }\n\n    protected andOrClick(e: JQueryEventObject): void {\n        e.preventDefault();\n        var andor = $(e.target).toggleClass('or');\n        andor.text(localText('Controls.FilterPanel.' +\n            (andor.hasClass('or') ? 'Or' : 'And')));\n    }\n\n    protected leftRightParenClick(e: JQueryEventObject): void {\n        e.preventDefault();\n        $(e.target).toggleClass('active');\n        this.updateParens();\n    }\n\n    protected updateParens() {\n        var rows = this.rowsDiv.children();\n        if (rows.length === 0) {\n            return;\n        }\n        rows.removeClass('paren-start');\n        rows.removeClass('paren-end');\n        rows.children('div.l').css('display', ((rows.length === 1) ? 'none' : 'block'));\n        rows.first().children('div.l').children('a.rightparen, a.andor')\n            .css('visibility', 'hidden');\n\n        for (var i = 1; i < rows.length; i++) {\n            var row = rows.eq(i);\n            row.children('div.l').css('display', 'block')\n                .children('a.lefparen, a.andor').css('visibility', 'visible');\n        }\n\n        var inParen = false;\n        for (var i1 = 0; i1 < rows.length; i1++) {\n            var row1 = rows.eq(i1);\n            var divParen = row1.children('div.l');\n            var lp = divParen.children('a.leftparen');\n            var rp = divParen.children('a.rightparen');\n            if (rp.hasClass('active') && inParen) {\n                inParen = false;\n                if (i1 > 0) {\n                    rows.eq(i1 - 1).addClass('paren-end');\n                }\n            }\n            if (lp.hasClass('active')) {\n                inParen = true;\n                if (i1 > 0) {\n                    row1.addClass('paren-start');\n                }\n            }\n        }\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { notifyError, localText } from \"../../q\";\nimport { TemplatedDialog } from \"../dialogs/templateddialog\";\nimport { FilterPanel } from \"./filterpanel\";\n\n@Decorators.registerClass('Serenity.FilterDialog')\nexport class FilterDialog extends TemplatedDialog<any> {\n\n    private filterPanel: FilterPanel;\n\n    constructor() {\n        super();\n\n        this.filterPanel = new FilterPanel(this.byId('FilterPanel'));\n        this.filterPanel.set_showInitialLine(true);\n        this.filterPanel.set_showSearchButton(false);\n        this.filterPanel.set_updateStoreOnReset(false);\n\n        this.dialogTitle = localText('Controls.FilterPanel.DialogTitle');\n    }\n\n    get_filterPanel(): FilterPanel {\n        return this.filterPanel;\n    }\n\n    protected getTemplate(): string {\n        return '<div id=\"~_FilterPanel\"/>';\n    }\n\n    protected getDialogButtons() {\n        return [\n            {\n                text: localText('Dialogs.OkButton'),\n                click: () => {\n                    this.filterPanel.search();\n                    if (this.filterPanel.get_hasErrors()) {\n                        notifyError(localText('Controls.FilterPanel.FixErrorsMessage'), '', null);\n                        return;\n                    }\n\n                    this.dialogClose();\n                }\n            },\n            {\n                text: localText('Dialogs.CancelButton'),\n                click: () => this.dialogClose()\n            }\n        ];\n    }\n}\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { localText, trimToNull } from \"../../q\";\nimport { FilterDialog } from \"./filterdialog\";\nimport { FilterWidgetBase } from \"./filterwidgetbase\";\n\n@Decorators.registerClass('Serenity.FilterDisplayBar')\nexport class FilterDisplayBar extends FilterWidgetBase<any> {\n\n    constructor(div: JQuery) {\n        super(div);\n\n        this.element.find('.cap').text(\n            localText('Controls.FilterPanel.EffectiveFilter'));\n\n        this.element.find('.edit').text(\n            localText('Controls.FilterPanel.EditFilter'));\n\n        this.element.find('.reset').attr('title',\n            localText('Controls.FilterPanel.ResetFilterHint'));\n\n        var openFilterDialog = (e: JQueryEventObject) => {\n            e.preventDefault();\n            var dialog = new FilterDialog();\n            dialog.get_filterPanel().set_store(this.get_store());\n            dialog.dialogOpen(null);\n        };\n\n        this.element.find('.edit').click(openFilterDialog);\n        this.element.find('.txt').click(openFilterDialog);\n\n        this.element.find('.reset').click(e1 => {\n            e1.preventDefault();\n            this.get_store().get_items().length = 0;\n            this.get_store().raiseChanged();\n        });\n    }\n\n    protected filterStoreChanged() {\n        super.filterStoreChanged();\n\n        var displayText = trimToNull(this.get_store().get_displayText());\n\n        this.element.find('.current').toggle(displayText != null);\n        this.element.find('.reset').toggle(displayText != null);\n\n        if (displayText == null)\n            displayText = localText('Controls.FilterPanel.EffectiveEmpty');\n\n        this.element.find('.txt').text('[' + displayText + ']');\n    }\n\n    protected getTemplate() {\n        return \"<div><a class='reset'></a><a class='edit'></a>\" + \n            \"<div class='current'><span class='cap'></span>\" +\n            \"<a class='txt'></a></div></div>\";\n    }\n}\n", "\uFEFFimport { htmlEncode, extend, localText } from \"../../q\";\nimport { PagerOptions } from \"../../slick\";\nimport { Decorators } from \"../../decorators\";\nimport { Widget } from \"../widgets/widget\";\n\n@Decorators.registerClass(\"Serenity.SlickPager\")\nexport class SlickPager extends Widget<PagerOptions> {\n\n    constructor(div: JQuery, o: PagerOptions) {\n        super(div, extend({\n            showRowsPerPage: true,\n            rowsPerPageOptions: [20, 100, 500, 2000]\n        } as any, o));\n\n        o = this.options;\n        var v = o.view;\n\n        if (!v)\n            throw \"SlickPager requires view option to be set!\";\n\n        this.element.addClass('s-SlickPager slick-pg')\n            .html(`<div class=\"slick-pg-in\">\n    <div class=\"slick-pg-grp slick-pg-grp-firstprev\">\n        <div class=\"slick-pg-first slick-pg-btn\"><span class=\"slick-pg-btn-span\"></span></div>\n        <div class=\"slick-pg-prev slick-pg-btn\"><span class=\"slick-pg-btn-span\"></span></div>\n    </div>\n    <div class=\"slick-pg-grp slick-pg-grp-control\">\n        <span class=\"slick-pg-control\">\n            <span class=\"slick-pg-pagetext\">${htmlEncode(localText(\"Controls.Pager.Page\"))}</span>\n            <input id=\"${this.idPrefix}CurrentPage\" class=\"slick-pg-current\" type=\"text\" size=\"4\" value=\"1\" />\n            <span class=\"slick-pg-pagesep\">/</span>\n            <span class=\"slick-pg-total\">1</span>\n        </span>\n    </div>\n    <div class=\"slick-pg-grp slick-pg-grp-nextlast\">\n        <div class=\"slick-pg-next slick-pg-btn\"><span class=\"slick-pg-btn-span\"></span></div>\n        <div class=\"slick-pg-last slick-pg-btn\"><span class=\"slick-pg-btn-span\"></span></div>\n    </div>\n    <div class=\"slick-pg-grp slick-pg-grp-reload\">\n        <div class=\"slick-pg-reload slick-pg-btn\"><span class=\"slick-pg-btn-span\"></span></div>\n    </div>\n    <div class=\"slick-pg-grp slick-pg-grp-stat\">\n        <span class=\"slick-pg-stat\"></span>\n    </div>\n</div>`);\n\n        var self = this;\n        $('.slick-pg-reload', this.element).click(function () { v.populate() });\n        $('.slick-pg-first', this.element).click(function () { self._changePage('first') });\n        $('.slick-pg-prev', this.element).click(function () { self._changePage('prev') });\n        $('.slick-pg-next', this.element).click(function () { self._changePage('next') });\n        $('.slick-pg-last', this.element).click(function () { self._changePage('last') });\n        $('.slick-pg-current', this.element).keydown(function (e) { if (e.keyCode == 13) self._changePage('input') });\n\n        if (self.options.showRowsPerPage) {\n            var opt: string = \"\", sel = \"\";\n            for (var nx = 0; nx < o.rowsPerPageOptions.length; nx++) {\n                if (v.rowsPerPage == o.rowsPerPageOptions[nx])\n                    sel = 'selected=\"selected\"'; else sel = '';\n                opt += \"<option value='\" + o.rowsPerPageOptions[nx] + \"' \" + sel + \" >\" + o.rowsPerPageOptions[nx] + \"&nbsp;&nbsp;</option>\";\n            };\n            $('.slick-pg-in', this.element).prepend('<div class=\"slick-pg-grp\"><select class=\"slick-pg-size\" name=\"rp\">' + opt + '</select></div>');\n            $('select.slick-pg-size', this.element).change(\n                function (this: HTMLSelectElement) {\n                    if (o.onRowsPerPageChange)\n                        o.onRowsPerPageChange(+this.value);\n                    else {\n                        v[\"newp\"] = 1;\n                        v.setPagingOptions({\n                            page: 1,\n                            rowsPerPage: +this.value\n                        });\n                    }\n                }\n            );\n        }\n\n        v.onPagingInfoChanged.subscribe(function () {\n            self._updatePager();\n        });\n    }\n\n    _changePage(ctype: string) { //change page\n\n        var view = this.options.view;\n\n        if (!view || view.loading)\n            return true;\n\n        var info = view.getPagingInfo();\n        var pages = (!info.rowsPerPage || !info.totalCount) ? 1 : Math.ceil(info.totalCount / info.rowsPerPage);\n\n        var newp: number;\n\n        switch (ctype) {\n            case 'first': newp = 1; break;\n            case 'prev': if (info.page > 1) newp = parseInt(info.page as any) - 1; break;\n            case 'next': if (info.page < pages) newp = parseInt(info.page as any) + 1; break;\n            case 'last': newp = pages; break;\n            case 'input':\n                var nv = parseInt($('input.slick-pg-current', this.element).val());\n                if (isNaN(nv))\n                    nv = 1;\n                else if (nv < 1)\n                    nv = 1;\n                else if (nv > pages)\n                    nv = pages;\n\n                $('.slick-pg-current', this.element).val(nv);\n\n                newp = nv;\n                break;\n        }\n\n        if (newp == info.page)\n            return false;\n\n        if (this.options.onChangePage)\n            this.options.onChangePage(newp);\n        else {\n            view.setPagingOptions({ page: newp });\n        }\n    }\n\n    _updatePager() {\n\n        var view = this.options.view;\n        var info = view.getPagingInfo();\n        var pages = (!info.rowsPerPage || !info.totalCount) ? 1 : Math.ceil(info.totalCount / info.rowsPerPage);\n\n        $('.slick-pg-current', this.element).val(info.page);\n        $('.slick-pg-total', this.element).html(pages as any);\n\n        var r1 = (info.page - 1) * info.rowsPerPage + 1;\n        var r2 = r1 + info.rowsPerPage - 1;\n\n        if (info.totalCount < r2)\n            r2 = info.totalCount;\n\n        var stat: string;\n\n        if (info.loading) {\n            stat = htmlEncode(localText(\"Controls.Pager.LoadingStatus\"));\n        }\n        else if (info.error) {\n            stat = info.error;\n        }\n        else if (info.totalCount > 0) {\n            stat = htmlEncode(localText(\"Controls.Pager.PageStatus\"));\n            stat = stat.replace(/{from}/, <any>r1);\n            stat = stat.replace(/{to}/, <any>r2);\n            stat = stat.replace(/{total}/, <any>info.totalCount);\n        }\n        else\n            stat = htmlEncode(localText(\"Controls.Pager.NoRowStatus\"));\n\n        $('.slick-pg-stat', this.element).html(stat);\n        $('.slick-pg-size', this.element).val((info.rowsPerPage || 0).toString());\n    }\n}", "\uFEFFimport { Culture, Enum, format, formatDate, formatNumber, getAttributes, getTypeFullName, htmlEncode, isEmptyOrNull, ISlickFormatter, parseDecimal, parseISODateTime, replaceAll, resolveUrl, safeCast, startsWith, tryGetText } from \"../../q\";\nimport { Formatter } from \"../../slick\";\nimport { Column, FormatterContext } from \"@serenity-is/sleekgrid\";\nimport { Decorators, EnumKeyAttribute } from \"../../decorators\";\nimport { EnumTypeRegistry } from \"../../types/enumtyperegistry\";\n\nexport interface IInitializeColumn {\n    initializeColumn(column: Column): void;\n}\n\n@Decorators.registerInterface('Serenity.IInitializeColumn')\nexport class IInitializeColumn {\n}\n\n@Decorators.registerFormatter('Serenity.BooleanFormatter')\nexport class BooleanFormatter implements Formatter {\n    format(ctx: FormatterContext) {\n\n        if (ctx.value == null) {\n            return '';\n        }\n\n        var text;\n        if (!!ctx.value) {\n            text = tryGetText(this.trueText);\n            if (text == null) {\n                text = this.trueText;\n                if (text == null) {\n                    text = tryGetText('Dialogs.YesButton') ?? 'Yes';\n                }\n            }\n        }\n        else {\n            text = tryGetText(this.falseText);\n            if (text == null) {\n                text = this.falseText;\n                if (text == null) {\n                    text = tryGetText('Dialogs.NoButton') ?? 'No';\n                }\n            }\n        }\n\n        return htmlEncode(text);\n    }\n\n    @Decorators.option()\n    public falseText: string;\n\n    @Decorators.option()\n    public trueText: string;\n}\n\n@Decorators.registerFormatter('Serenity.CheckboxFormatter')\nexport class CheckboxFormatter implements Formatter {\n    format(ctx: FormatterContext) {\n        return '<span class=\"check-box no-float readonly slick-edit-preclick ' + (!!ctx.value ? ' checked' : '') + '\"></span>';\n    }\n}\n\n@Decorators.registerFormatter('Serenity.DateFormatter')\nexport class DateFormatter implements Formatter {\n    constructor() {\n        this.displayFormat = Culture.dateFormat;\n    }\n\n    static format(value: any, format?: string) {\n        if (value == null) {\n            return '';\n        }\n\n        var date: Date;\n\n        if (value instanceof Date) {\n            date = value;\n        }\n        else if (typeof value === 'string') {\n            date = parseISODateTime(value);\n\n            if (date == null || isNaN(date.valueOf())) {\n                return htmlEncode(value);\n            }\n        }\n        else {\n            return value.toString();\n        }\n\n        return htmlEncode(formatDate(date, format));\n    }\n\n    @Decorators.option()\n    public displayFormat: string;\n\n    format(ctx: FormatterContext): string {\n        return DateFormatter.format(ctx.value, this.displayFormat);\n    }\n}\n\n@Decorators.registerFormatter('Serenity.DateTimeFormatter')\nexport class DateTimeFormatter extends DateFormatter {\n    constructor() {\n        super();\n        this.displayFormat = Culture.dateTimeFormat;\n    }\n}\n\n@Decorators.registerFormatter('Serenity.EnumFormatter')\nexport class EnumFormatter implements Formatter {\n\n    format(ctx: FormatterContext): string {\n        return EnumFormatter.format(EnumTypeRegistry.get(this.enumKey), ctx.value);\n    }\n\n    @Decorators.option()\n    enumKey: string;\n\n    static format(enumType: any, value: any) {\n\n        if (value == null) {\n            return '';\n        }\n\n        var name = Enum.toString(enumType, value);\n        var enumKeyAttr = getAttributes(enumType, EnumKeyAttribute, false);\n        var enumKey = ((enumKeyAttr.length > 0) ? enumKeyAttr[0].value : getTypeFullName(enumType));\n        return EnumFormatter.getText(enumKey, name);\n    }\n\n    static getText(enumKey: string, name: string) {\n        if (isEmptyOrNull(name)) {\n            return '';\n        }\n\n        return htmlEncode(tryGetText('Enums.' + enumKey + '.' + name) ?? name);\n    }\n\n    static getName(enumType: any, value: any) {\n        if (value == null) {\n            return '';\n        }\n        return Enum.toString(enumType, value);\n    }\n}\n\n@Decorators.registerFormatter('Serenity.FileDownloadFormatter', [ISlickFormatter, IInitializeColumn])\nexport class FileDownloadFormatter implements Formatter, IInitializeColumn {\n\n    format(ctx: FormatterContext): string {\n        var dbFile = safeCast(ctx.value, String);\n        if (isEmptyOrNull(dbFile)) {\n            return '';\n        }\n\n        var downloadUrl = FileDownloadFormatter.dbFileUrl(dbFile);\n        var originalName = (!isEmptyOrNull(this.originalNameProperty) ?\n            safeCast(ctx.item[this.originalNameProperty], String) : null);\n\n        originalName = (originalName ?? '');\n        var text = format((this.displayFormat ?? '{0}'),\n            originalName, dbFile, downloadUrl);\n\n        var iconClass = this.iconClass ?? \"fa fa-download\";\n\n        if (iconClass.startsWith(\"fa-\"))\n            iconClass = \"fa \" + iconClass;\n\n        return \"<a class='file-download-link' target='_blank' href='\" +\n            htmlEncode(downloadUrl) + \"'><i class='\" + iconClass + \"'></i> \" + htmlEncode(text) + '</a>';\n    }\n\n    static dbFileUrl(filename: string): string {\n        filename = replaceAll((filename ?? ''), '\\\\', '/');\n        return resolveUrl('~/upload/') + filename;\n    }\n\n    initializeColumn(column: Column): void {\n        column.referencedFields = column.referencedFields || [];\n        if (!isEmptyOrNull(this.originalNameProperty)) {\n            column.referencedFields.push(this.originalNameProperty);\n            return;\n        }\n    }\n\n    @Decorators.option()\n    displayFormat: string;\n\n    @Decorators.option()\n    originalNameProperty: string;\n\n    @Decorators.option()\n    iconClass: string;\n}\n\n@Decorators.registerFormatter('Serenity.MinuteFormatter')\nexport class MinuteFormatter implements Formatter {\n\n    format(ctx: FormatterContext) {\n        return MinuteFormatter.format(ctx.value);\n    }\n\n    static format(value: number): string {\n        var hour = Math.floor(value / 60);\n        var minute = value - hour * 60;\n        var hourStr, minuteStr;\n\n        if (value == null || isNaN(value))\n            return '';\n\n        if (hour < 10)\n            hourStr = '0' + hour;\n        else\n            hourStr = hour.toString();\n\n        if (minute < 10)\n            minuteStr = '0' + minute;\n        else\n            minuteStr = minute.toString();\n\n        return format('{0}:{1}', hourStr, minuteStr);\n    }\n}\n\n@Decorators.registerFormatter('Serenity.NumberFormatter')\nexport class NumberFormatter {\n    format(ctx: FormatterContext): string {\n        return NumberFormatter.format(ctx.value, this.displayFormat);\n    }\n\n    static format(value: any, format?: string): string {\n        format = (format ?? '0.##');\n        if (value == null)\n            return '';\n\n        if (typeof (value) === 'number') {\n            if (isNaN(value))\n                return '';\n\n            return htmlEncode(formatNumber(value, format));\n        }\n\n        var dbl = parseDecimal(value.toString());\n        if (dbl == null || isNaN(dbl))\n            return value?.toString() ?? '';\n\n        return htmlEncode(formatNumber(dbl, format));\n    }\n\n    @Decorators.option()\n    displayFormat: string;\n}\n\n@Decorators.registerFormatter('Serenity.UrlFormatter', [ISlickFormatter, IInitializeColumn])\nexport class UrlFormatter implements Formatter, IInitializeColumn {\n\n    format(ctx: FormatterContext): string {\n        var url = (!isEmptyOrNull(this.urlProperty) ?\n            (ctx.item[this.urlProperty] ?? '').toString() :\n            (ctx.value ?? '').toString());\n\n        if (isEmptyOrNull(url))\n            return '';\n\n        if (!isEmptyOrNull(this.urlFormat))\n            url = format(this.urlFormat, url);\n\n        if (url != null && startsWith(url, '~/'))\n            url = resolveUrl(url);\n\n        var display = (!isEmptyOrNull(this.displayProperty) ?\n            (ctx.item[this.displayProperty] ?? '').toString() :\n            (ctx.value ?? '').toString());\n\n        if (!isEmptyOrNull(this.displayFormat))\n            display = format(this.displayFormat, display);\n\n        var s = \"<a href='\" + htmlEncode(url) + \"'\";\n        if (!isEmptyOrNull(this.target))\n            s += \" target='\" + this.target + \"'\";\n\n        s += '>' + htmlEncode(display) + '</a>';\n\n        return s;\n    }\n\n    initializeColumn(column: Column): void {\n        column.referencedFields = column.referencedFields || [];\n\n        if (!isEmptyOrNull(this.displayProperty)) {\n            column.referencedFields.push(this.displayProperty);\n        }\n\n        if (!isEmptyOrNull(this.urlProperty)) {\n            column.referencedFields.push(this.urlProperty);\n        }\n    }\n\n    @Decorators.option()\n    displayProperty: string;\n\n    @Decorators.option()\n    displayFormat: string;\n\n    @Decorators.option()\n    urlProperty: string;\n\n    @Decorators.option()\n    urlFormat: string;\n\n    @Decorators.option()\n    target: string;\n}", "\uFEFFimport { ArgumentNullException, Exception, htmlEncode, isAssignableFrom, isEmptyOrNull, ISlickFormatter, notifyError } from \"../q\";\nimport { commonTypeRegistry } from \"./commontyperegistry\";\n\nexport namespace FormatterTypeRegistry {\n\n    let registry = commonTypeRegistry(\n        type => isAssignableFrom(ISlickFormatter, type), \n        null, \"Formatter\");\n\n    export function get(key: string): any {\n        if (isEmptyOrNull(key)) \n            throw new ArgumentNullException('key');\n        \n        var type = registry.tryGet(key);\n        if (type)\n            return type;\n\n        var message = `\"${htmlEncode(key)}\" formatter class not found! \nMake sure there is such a formatter type under the project root namespace,\nand its namespace parts start with capital letters like MyProject.MyModule.MyFormatter.\n\nIf using ES modules, make sure the formatter type has a decorator like \n@Decorators.registerFormatter('MyProject.MyModule.MyFormatter') with the full name \nof your formatter type and \"side-effect-import\" this formatter class from the current \n\"page.ts/grid.ts/dialog.ts file (import \"./path/to/MyFormatter.ts\").\n\nAfter applying fixes, build and run \"node ./tsbuild.js\" (or \"tsc\" if using namespaces) \nfrom the project folder.`;\n\n        notifyError(message.replace(/\\r?\\n\\r?\\n/g, '<br/><br/>'), '', { escapeHtml: false, timeOut: 5000 });\n        throw new Exception(message);\n    }\n\n    export function reset() {\n        registry.reset();\n    }\n\n    export function tryGet(key: string) {\n        return registry.tryGet(key);\n    }\n}", "\uFEFFimport { Column, FormatterContext, Grid, IPlugin } from \"@serenity-is/sleekgrid\";\nimport { Decorators } from \"../../decorators\";\nimport { Authorization, clearKeys, Culture, htmlEncode, isEmptyOrNull, PropertyItem, replaceAll, safeCast, SaveRequest, serviceCall, startsWith, localText, tryGetText, tryFirst } from \"../../q\";\nimport { Format, Formatter, RemoteView } from \"../../slick\";\nimport { IDataGrid } from \"../datagrid/idatagrid\";\nimport { QuickSearchField, QuickSearchInput } from \"../datagrid/quicksearchinput\";\nimport { DateFormatter, EnumFormatter, IInitializeColumn, NumberFormatter } from \"../formatters/formatters\";\nimport { ReflectionOptionsSetter } from \"../widgets/reflectionoptionssetter\";\nimport { Toolbar, ToolButton } from \"../widgets/toolbar\";\nimport { FormatterTypeRegistry } from \"../../types/formattertyperegistry\";\n\nexport interface GridRowSelectionMixinOptions {\n    selectable?: (item: any) => boolean;\n}\n\n@Decorators.registerClass('Serenity.GridRowSelectionMixin')\nexport class GridRowSelectionMixin {\n\n    private idField: string;\n    private include: { [key: string]: boolean}\n    private grid: IDataGrid;\n    private options: GridRowSelectionMixinOptions;\n\n    constructor(grid: IDataGrid, options?: GridRowSelectionMixinOptions) {\n\n        this.include = {};\n        this.grid = grid;\n        this.idField = (grid.getView() as any).idField;\n        this.options = options || {};\n\n        grid.getGrid().onClick.subscribe((e, p) => {\n            if ($(e.target).hasClass('select-item')) {\n                e.preventDefault();\n                var item = grid.getView().getItem(p.row);\n                var id = item[this.idField].toString();\n\n                if (this.include[id]) {\n                    delete this.include[id];\n                }\n                else {\n                    this.include[id] = true;\n                }\n\n                for (var i = 0; i < (grid.getView() as any).getLength(); i++) {\n                    grid.getGrid().updateRow(i);\n                }\n\n                this.updateSelectAll();\n            }\n        });\n\n        grid.getGrid().onHeaderClick.subscribe((e1, u) => {\n            if (e1.isDefaultPrevented())\n                return;\n            if ($(e1.target).hasClass('select-all-items')) {\n                e1.preventDefault();\n                if (Object.keys(this.include).length > 0) {\n                    clearKeys(this.include);\n                }\n                else {\n                    var items = grid.getView().getItems();\n                    for (var x of items.filter(this.isSelectable.bind(this))) {\n                        var id1 = x[this.idField];\n                        this.include[id1] = true;\n                    }\n                }\n                this.updateSelectAll();\n                grid.getView().setItems(grid.getView().getItems(), true);\n                setTimeout(this.updateSelectAll.bind(this), 0);\n            }\n        });\n\n        (grid.getView() as any).onRowsChanged.subscribe(() => {\n            return this.updateSelectAll();\n        });\n    }\n\n    updateSelectAll(): void {\n        var selectAllButton = this.grid.getElement()\n            .find('.select-all-header .slick-column-name .select-all-items');\n\n        if (selectAllButton) {\n            var keys = Object.keys(this.include);\n            selectAllButton.toggleClass('checked',\n                keys.length > 0 &&\n                this.grid.getView().getItems().filter(\n                    this.isSelectable.bind(this)).length <= keys.length);\n        }\n    }\n\n    clear(): void {\n        clearKeys(this.include);\n        this.updateSelectAll();\n    }\n\n    resetCheckedAndRefresh(): void {\n        this.include = {};\n        this.updateSelectAll();\n        this.grid.getView().populate();\n    }\n\n    selectKeys(keys: string[]): void {\n        for (var k of keys) {\n            this.include[k] = true;\n        }\n\n        this.updateSelectAll();\n    }\n\n    getSelectedKeys(): string[] {\n        return Object.keys(this.include);\n    }\n\n    getSelectedAsInt32(): number[] {\n        return Object.keys(this.include).map(function (x) {\n            return parseInt(x, 10);\n        });\n    }\n\n    getSelectedAsInt64(): number[] {\n        return Object.keys(this.include).map(function (x) {\n            return parseInt(x, 10);\n        });\n    }\n\n    setSelectedKeys(keys: string[]): void {\n        this.clear();\n        for (var k of keys) {\n            this.include[k] = true;\n        }\n\n        this.updateSelectAll();\n    }\n\n    private isSelectable(item: any) {\n        return item && (\n            this.options.selectable == null ||\n            this.options.selectable(item));\n    }\n\n    static createSelectColumn(getMixin: () => GridRowSelectionMixin): Column {\n        return {\n            name: '<span class=\"select-all-items check-box no-float \"></span>',\n            nameIsHtml: true,\n            toolTip: ' ',\n            field: '__select__',\n            width: 27,\n            minWidth: 27,\n            headerCssClass: 'select-all-header',\n            sortable: false,\n            format: function (ctx) {\n                var item = ctx.item;\n                var mixin = getMixin();\n                if (!mixin || !mixin.isSelectable(item)) {\n                    return '';\n                }\n                var isChecked = mixin.include[ctx.item[mixin.idField]];\n                return '<span class=\"select-item check-box no-float ' + (isChecked ? ' checked' : '') + '\"></span>';\n            }\n        };\n    }\n}\n\nexport interface GridRadioSelectionMixinOptions {\n    selectable?: (item: any) => boolean;\n}\n\n@Decorators.registerClass('GridRadioSelectionMixin')\nexport class GridRadioSelectionMixin {\n\n    private idField: string;\n    private include: { [key: string]: boolean };\n    private grid: IDataGrid;\n    private options: GridRadioSelectionMixinOptions;\n\n    constructor(grid: IDataGrid, options?: GridRadioSelectionMixinOptions) {\n\n        this.include = {};\n        this.grid = grid;\n        this.idField = (grid.getView() as any).idField;\n        this.options = options || {};\n\n        grid.getGrid().onClick.subscribe((e, p) => {\n            if ($(e.target).hasClass('rad-select-item')) {\n                e.preventDefault();\n                var item = grid.getView().getItem(p.row);\n\n                if (!this.isSelectable(item)) {\n                    return;\n                }\n\n                var id = item[this.idField].toString();\n\n                if (this.include[id] == true) {\n                    clearKeys(this.include);\n                }\n                else {\n                    clearKeys(this.include);\n                    this.include[id] = true;\n                }\n\n                for (var i = 0; i < (grid.getView() as any).getLength(); i++) {\n                    grid.getGrid().updateRow(i);\n                }\n            }\n        });\n    }\n\n    private isSelectable(item: any) {\n        return item && (\n            this.options.selectable == null ||\n            this.options.selectable(item));\n    }\n\n    clear(): void {\n        clearKeys(this.include);\n    }\n\n    resetCheckedAndRefresh(): void {\n        this.include = {};\n        this.grid.getView().populate();\n    }\n\n    getSelectedKey(): string {\n        var items = Object.keys(this.include);\n        if (items != null && items.length > 0) {\n            return items[0];\n        }\n\n        return null;\n    }\n\n    getSelectedAsInt32(): number {\n        var items = Object.keys(this.include).map(function (x) {\n            return parseInt(x, 10);\n        });\n\n        if (items != null && items.length > 0) {\n            return items[0];\n        }\n\n        return null;\n    }\n\n    getSelectedAsInt64(): number {\n        var items = Object.keys(this.include).map(function (x) {\n            return parseInt(x, 10);\n        });\n\n        if (items != null && items.length > 0) {\n            return items[0];\n        }\n\n        return null;\n    }\n\n    setSelectedKey(key: string): void {\n        this.clear();\n        this.include[key] = true;\n    }\n\n    static createSelectColumn(getMixin: () => GridRadioSelectionMixin): Column {\n        return {\n            name: '',\n            toolTip: ' ',\n            field: '__select__',\n            width: 27,\n            minWidth: 27,\n            headerCssClass: '',\n            sortable: false,\n            formatter: function (row, cell, value, column, item) {\n                var mixin = getMixin();\n                if (!mixin || !mixin.isSelectable(item)) {\n                    return '';\n                }\n\n                var isChecked = mixin.include[item[mixin.idField]];\n                return '<input type=\"radio\" name=\"radio-selection-group\" class=\"rad-select-item no-float\" style=\"cursor: pointer;width: 13px; height:13px;\" ' + (isChecked ? ' checked' : '') + ' /> ';\n            }\n        };\n    }\n}\n\nexport namespace GridSelectAllButtonHelper {\n    export function update(grid: IDataGrid, getSelected: (p1: any) => boolean): void {\n        var toolbar = (grid as any).element.children('.s-Toolbar') as JQuery;\n        if (toolbar.length === 0) {\n            return;\n        }\n        var btn = toolbar.getWidget(Toolbar).findButton('select-all-button');\n        var items = grid.getView().getItems();\n        btn.toggleClass('checked', items.length > 0 && !items.some(function (x) {\n            return !getSelected(x);\n        }));\n    }\n\n    export function define(getGrid: () => IDataGrid, getId: (p1: any) => any,\n        getSelected: (p1: any) => boolean,\n        setSelected: (p1: any, p2: boolean) => void,\n        text?: string, onClick?: () => void): ToolButton {\n\n        if (text == null) {\n            text = tryGetText('Controls.CheckTreeEditor.SelectAll') ??\n                'Select All';\n        }\n        return {\n            title: text,\n            action: \"select-all\",\n            cssClass: 'select-all-button',\n            onClick: function () {\n                var grid = getGrid();\n                var view = grid.getView();\n                var btn = (grid as any).element.children('.s-Toolbar')\n                    .getWidget(Toolbar).findButton('select-all-button');\n                var makeSelected = !btn.hasClass('checked');\n                view.beginUpdate();\n                try {\n                    for (var item of view.getItems()) {\n                        setSelected(item, makeSelected);\n                        view.updateItem(getId(item), item);\n                    }\n                    onClick && onClick();\n                }\n                finally {\n                    view.endUpdate();\n                }\n\n                btn.toggleClass('checked', makeSelected);\n            }\n        };\n    }\n}\n\nexport namespace GridUtils {\n    export function addToggleButton(toolDiv: JQuery, cssClass: string,\n        callback: (p1: boolean) => void, hint: string, initial?: boolean): void {\n\n        var div = $('<div><a href=\"#\"></a></div>')\n            .addClass('s-ToggleButton').addClass(cssClass)\n            .prependTo(toolDiv);\n        div.children('a').click(function (e) {\n            e.preventDefault();\n            div.toggleClass('pressed');\n            var pressed = div.hasClass('pressed');\n            callback && callback(pressed);\n        }).attr('title', hint ?? '');\n        if (initial) {\n            div.addClass('pressed');\n        }\n    }\n\n    export function addIncludeDeletedToggle(toolDiv: JQuery,\n        view: RemoteView<any>, hint?: string, initial?: boolean): void {\n\n        var includeDeleted = false;\n        var oldSubmit = view.onSubmit;\n        view.onSubmit = function (v) {\n            v.params.IncludeDeleted = includeDeleted;\n            if (oldSubmit != null) {\n                return oldSubmit(v);\n            }\n            return true;\n        };\n\n        if (hint == null) \n            hint = localText('Controls.EntityGrid.IncludeDeletedToggle');\n        \n        addToggleButton(toolDiv, 's-IncludeDeletedToggle',\n            function (pressed) {\n                includeDeleted = pressed;\n                view.seekToPage = 1;\n                view.populate();\n            }, hint, initial);\n        toolDiv.bind('remove', function () {\n            view.onSubmit = null;\n            oldSubmit = null;\n        });\n    }\n\n    export function addQuickSearchInput(toolDiv: JQuery,\n        view: RemoteView<any>, fields?: QuickSearchField[], onChange?: () => void): QuickSearchInput {\n\n        var oldSubmit = view.onSubmit;\n        var input: QuickSearchInput;\n        view.onSubmit = function (v) {\n            if (input) {\n                var searchText = input.get_value();\n                if (searchText && searchText.length > 0) {\n                    v.params.ContainsText = searchText;\n                }\n                else {\n                    delete v.params['ContainsText'];\n                }\n                var searchField = input.get_field()?.name;\n                if (searchField != null && searchField.length > 0) {\n                    v.params.ContainsField = searchField;\n                }\n                else {\n                    delete v.params['ContainsField'];\n                }\n            }\n\n            if (oldSubmit != null) \n                return oldSubmit(v);\n            \n            return true;\n        };\n\n        var lastDoneEvent: any = null;\n        input = addQuickSearchInputCustom(toolDiv, (field, query, done) => {\n            onChange && onChange();\n            view.seekToPage = 1;\n            lastDoneEvent = done;\n            view.populate();\n        }, fields);\n\n        view.onDataLoaded.subscribe(function (e, ui) {\n            if (lastDoneEvent != null) {\n                lastDoneEvent(view.getLength() > 0);\n                lastDoneEvent = null;\n            }\n        });\n\n        return input;\n    }\n\n    export function addQuickSearchInputCustom(container: JQuery,\n        onSearch: (p1: string, p2: string, done: (p3: boolean) => void) => void,\n        fields?: QuickSearchField[]): QuickSearchInput {\n\n        var div = $('<div><input type=\"text\"/></div>')\n            .addClass('s-QuickSearchBar').prependTo(container);\n\n        if (fields != null && fields.length > 0) {\n            div.addClass('has-quick-search-fields');\n        }\n\n        return new QuickSearchInput(div.children(), {\n            fields: fields,\n            onSearch: onSearch as any\n        });\n    }\n\n    export function makeOrderable(grid: Grid,\n        handleMove: (p1: any, p2: number) => void): void {\n\n        var moveRowsPlugin = new Slick.RowMoveManager({ cancelEditOnDrag: true });\n        moveRowsPlugin.onBeforeMoveRows.subscribe(function (e, data) {\n            for (var i = 0; !!(i < data.rows.length); i++) {\n                if (!!(data.rows[i] === data.insertBefore ||\n                    data.rows[i] === data.insertBefore - 1)) {\n                    e.stopPropagation();\n                    return false;\n                }\n            }\n\n            return true;\n        });\n\n        moveRowsPlugin.onMoveRows.subscribe(function (e1, data1) {\n            handleMove(data1.rows, data1.insertBefore);\n            try {\n                grid.setSelectedRows([]);\n            }\n            catch ($t1) {\n            }\n        });\n        grid.registerPlugin(moveRowsPlugin);\n    }\n\n    export function makeOrderableWithUpdateRequest(grid: IDataGrid,\n        getId: (p1: any) => number, getDisplayOrder: (p1: any) => any, service: string,\n        getUpdateRequest: (p1: number, p2: number) => SaveRequest<any>): void {\n\n        makeOrderable(grid.getGrid(), function (rows, insertBefore) {\n            if (rows.length === 0) {\n                return;\n            }\n\n            var order: number;\n            var index = insertBefore;\n            if (index < 0) {\n                order = 1;\n            }\n            else if (insertBefore >= grid.getGrid().getDataLength()) {\n                order = (getDisplayOrder(grid.getGrid().getDataItem(grid.getGrid().getDataLength() - 1)) ?? 0);\n                if (order === 0) {\n                    order = insertBefore + 1;\n                }\n                else {\n                    order = order + 1;\n                }\n            }\n            else {\n                order = (getDisplayOrder(grid.getGrid().getDataItem(insertBefore)) ?? 0);\n                if (order === 0) {\n                    order = insertBefore + 1;\n                }\n            }\n\n            var i = 0;\n            var next: any = null;\n            next = function () {\n                serviceCall({\n                    service: service,\n                    request: getUpdateRequest(getId(\n                        grid.getGrid().getDataItem(rows[i])), order++),\n                    onSuccess: function (response) {\n                        i++;\n                        if (i < rows.length) {\n                            next();\n                        }\n                        else {\n                            grid.getView().populate();\n                        }\n                    }\n                });\n            };\n            next();\n        });\n    }\n}\n\nexport namespace PropertyItemSlickConverter {\n\n    export function toSlickColumns(items: PropertyItem[]): Column[] {\n        var result: Column[] = [];\n        if (items == null) {\n            return result;\n        }\n        for (var i = 0; i < items.length; i++) {\n            result.push(PropertyItemSlickConverter.toSlickColumn(items[i]));\n        }\n        return result;\n    }\n\n    export function toSlickColumn(item: PropertyItem): Column {\n        var result: Column = {\n            field: item.name,\n            sourceItem: item,\n            cssClass: item.cssClass,\n            headerCssClass: item.headerCssClass,\n            sortable: item.sortable !== false,\n            sortOrder: item.sortOrder ?? 0,\n            width: item.width != null ? item.width : 80,\n            minWidth: item.minWidth ?? 30,\n            maxWidth: (item.maxWidth == null || item.maxWidth === 0) ? null : item.maxWidth,\n            resizable: item.resizable == null || !!item.resizable\n        };\n\n        result.visible = item.visible !== false && item.filterOnly !== true &&\n            (item.readPermission == null || Authorization.hasPermission(item.readPermission));\n\n        var name = tryGetText(item.title);\n        if (name == null)\n            name = item.title;\n        result.name = name;\n\n        if (item.alignment != null && item.alignment.length > 0) {\n            if (!isEmptyOrNull(result.cssClass)) {\n                result.cssClass += ' align-' + item.alignment;\n            }\n            else {\n                result.cssClass = 'align-' + item.alignment;\n            }\n        }\n\n        if (item.formatterType != null && item.formatterType.length > 0) {\n\n            var formatterType = FormatterTypeRegistry.get(item.formatterType) as any;\n            var formatter = new formatterType() as Formatter;\n\n            if (item.formatterParams != null) {\n                ReflectionOptionsSetter.set(formatter, item.formatterParams);\n            }\n\n            var initializer = safeCast(formatter, IInitializeColumn);\n            if (initializer != null) {\n                initializer.initializeColumn(result);\n            }\n\n            result.format = (ctx) => formatter.format(ctx);\n        }\n\n        return result;\n    }\n}\n\nexport namespace SlickFormatting {\n    export function getEnumText(enumKey: string, name: string): string {\n        return EnumFormatter.getText(enumKey, name);\n    }\n\n    export function treeToggle(getView: () => RemoteView<any>, getId: (x: any) => any,\n        formatter: Format): Format {\n        return function (ctx: FormatterContext) {\n            var text = formatter(ctx);\n            var view = getView();\n            var indent = (ctx.item as any)._indent ?? 0;\n            var spacer = '<span class=\"s-TreeIndent\" style=\"width:' + 15 * indent + 'px\"></span>';\n            var id = getId(ctx.item);\n            var idx = view.getIdxById(id);\n            var next = view.getItemByIdx(idx + 1);\n            if (next != null) {\n                var nextIndent = next._indent ?? 0;\n                if (nextIndent > indent) {\n                    if (!!!!(ctx.item as any)._collapsed) {\n                        return spacer + '<span class=\"s-TreeToggle s-TreeExpand\"></span>' + text;\n                    }\n                    else {\n                        return spacer + '<span class=\"s-TreeToggle s-TreeCollapse\"></span>' + text;\n                    }\n                }\n            }\n            return spacer + '<span class=\"s-TreeToggle\"></span>' + text;\n        };\n    }\n\n    export function date(format?: string): Format {\n        if (format == null) {\n            format = Culture.dateFormat;\n        }\n\n        return function (ctx: FormatterContext) {\n            return htmlEncode(DateFormatter.format(ctx.value, format));\n        };\n    }\n\n    export function dateTime(format?: string): Format {\n        if (format == null) {\n            format = Culture.dateTimeFormat;\n        }\n        return function (ctx: FormatterContext) {\n            return htmlEncode(DateFormatter.format(ctx.value, format));\n        };\n    }\n\n    export function checkBox(): Format {\n        return function (ctx: FormatterContext) {\n            return '<span class=\"check-box no-float ' + (!!ctx.value ? ' checked' : '') + '\"></span>';\n        };\n    }\n\n    export function number(format: string): Format {\n        return function (ctx: FormatterContext) {\n            return NumberFormatter.format(ctx.value, format);\n        };\n    }\n\n    export function getItemType(link: JQuery): string {\n        return link.data('item-type');\n    }\n\n    export function getItemId(link: JQuery): string {\n        var value = link.data('item-id');\n        return value == null ? null : value.toString();\n    }\n\n    export function itemLinkText(itemType: string, id: any, text: any,\n        extraClass: string, encode: boolean): string {\n        return '<a' + (id != null ? (' href=\"#' + replaceAll(itemType, '.', '-') +\n            '/' + id + '\"') : '') + ' data-item-type=\"' +\n            htmlEncode(itemType) + '\"' + ' data-item-id=\"' +\n            htmlEncode(id) + '\"' + ' class=\"s-EditLink s-' +\n            replaceAll(itemType, '.', '-') + 'Link' +\n            (isEmptyOrNull(extraClass) ? '' : (' ' + extraClass)) + '\">' +\n            (encode ? htmlEncode(text ?? '') : text ?? '') + '</a>';\n    }\n\n    export function itemLink<TItem = any>(itemType: string, idField: string, getText: Format<TItem>,\n        cssClass?: Format<TItem>, encode?: boolean): Format<TItem> {\n        return function (ctx: FormatterContext<TItem>) {\n            var text = (getText == null ? ctx.value : getText(ctx)) ?? '';\n            if ((ctx.item as any)?.__nonDataRow) {\n                return encode ? htmlEncode(text) : text;\n            }\n\n            return itemLinkText(itemType, (ctx.item as any)[idField],\n                (getText == null ? ctx.value : getText(ctx)),\n                (cssClass == null ? '' : cssClass(ctx)), encode);\n        };\n    }\n}\n\nexport namespace SlickHelper {\n    export function setDefaults(columns: Column[], localTextPrefix?: string): any {\n        for (var col of columns) {\n            col.sortable = (col.sortable != null ? col.sortable : true);\n            var id = col.id;\n            if (id == null) {\n                id = col.field;\n            }\n            col.id = id;\n\n            if (localTextPrefix != null && col.id != null &&\n                (col.name == null || startsWith(col.name, '~'))) {\n                var key = (col.name != null ? col.name.substr(1) : col.id);\n                col.name = localText(localTextPrefix + key);\n            }\n        }\n\n        return columns;\n    }\n}\n\nexport namespace SlickTreeHelper {\n    export function filterCustom<TItem>(item: TItem, getParent: (x: TItem) => any): boolean {\n        var parent = getParent(item);\n        var loop = 0;\n        while (parent != null) {\n            if (!!parent._collapsed) {\n                return false;\n            }\n            parent = getParent(parent);\n            if (loop++ > 1000) {\n                throw new Error(\n                    'Possible infinite loop, check parents has no circular reference!');\n            }\n        }\n        return true;\n    }\n\n    export function filterById<TItem>(item: TItem, view: RemoteView<TItem>,\n        getParentId: (x: TItem) => any): boolean {\n        return filterCustom(item, function (x) {\n            var parentId = getParentId(x);\n            if (parentId == null) {\n                return null;\n            }\n            return view.getItemById(parentId);\n        });\n    }\n\n    export function setCollapsed<TItem>(items: TItem[], collapsed: boolean): void {\n        if (items != null) {\n            for (var item of items) {\n                (item as any)._collapsed = collapsed;\n            }\n        }\n    }\n\n    export function setCollapsedFlag<TItem>(item: TItem, collapsed: boolean): void {\n        (item as any)._collapsed = collapsed;\n    }\n\n    export function setIndents<TItem>(items: TItem[], getId: (x: TItem) => any,\n        getParentId: (x: TItem) => any, setCollapsed?: boolean): void {\n        var depth = 0;\n        var depths: Record<any, any> = {};\n        for (var line = 0; line < items.length; line++) {\n            var item = items[line];\n            if (line > 0) {\n                var parentId = getParentId(item);\n                if (parentId != null && parentId === getId(items[line - 1])) {\n                    depth += 1;\n                }\n                else if (parentId == null) {\n                    depth = 0;\n                }\n                else if (parentId !== getParentId(items[line - 1])) {\n                    if (depths[parentId] != null) {\n                        depth = depths[parentId] + 1;\n                    }\n                    else {\n                        depth = 0;\n                    }\n                }\n            }\n            depths[getId(item)] = depth;\n            (item as any)._indent = depth;\n            if (setCollapsed != null) {\n                (item as any)._collapsed = setCollapsed;\n            }\n        }\n    }\n\n    export function toggleClick<TItem>(e: JQueryEventObject, row: number, cell: number,\n        view: RemoteView<TItem>, getId: (x: TItem) => any): void {\n        var target = $(e.target);\n        if (!target.hasClass('s-TreeToggle')) {\n            return;\n        }\n        if (target.hasClass('s-TreeCollapse') || target.hasClass('s-TreeExpand')) {\n            var item = view.getItem(row);\n            if (item != null) {\n                if (!!!item._collapsed) {\n                    item._collapsed = true;\n                }\n                else {\n                    item._collapsed = false;\n                }\n                view.updateItem(getId(item), item);\n            }\n            if (e.shiftKey) {\n                view.beginUpdate();\n                try {\n                    setCollapsed(view.getItems(), !!item._collapsed);\n                    view.setItems(view.getItems(), true);\n                }\n                finally {\n                    view.endUpdate();\n                }\n            }\n        }\n    }\n}\n\n\nexport class ColumnsBase<TRow = any> {\n    constructor(items: Column<TRow>[]) {\n        (this as any).__items = items;\n        for (var col of items) {\n            let id = col.id;\n            if (id && !(this as any)[id])\n                (this as any)[id] = col;\n        }\n        for (var col of items) {\n            let id = col.sourceItem?.name;\n            if (id && !(this as any)[id])\n                (this as any)[id] = col;\n        }\n        for (var col of items) {\n            let id = col.field;\n            if (id && !(this as any)[id])\n                (this as any)[id] = col;\n        }\n    }\n\n    valueOf(): Column<TRow>[] {\n        return (this as any).__items;\n    }\n}\n", "\uFEFFimport { Authorization, Criteria, debounce, deepClone, endsWith, extend, getAttributes, getColumnsData, getColumnsDataAsync, getInstanceType, getTypeFullName, htmlEncode, indexOf, isEmptyOrNull, isInstanceOfType, layoutFillHeight, LayoutTimer, ListResponse, PropertyItem, PropertyItemsData, ScriptData, setEquality, startsWith, trimEnd, trimToNull, tryGetText } from \"../../q\";\nimport { Format, PagerOptions, RemoteView, RemoteViewOptions } from \"../../slick\";\nimport { AutoTooltips, Column, ColumnSort, EventEmitter, FormatterContext, Grid, GridOptions, GroupItemMetadataProvider, IPlugin, Range, SelectionModel } from \"@serenity-is/sleekgrid\";\nimport { ColumnsKeyAttribute, Decorators, FilterableAttribute, IdPropertyAttribute, IsActivePropertyAttribute, LocalTextPrefixAttribute } from \"../../decorators\";\nimport { IReadOnly } from \"../../interfaces\";\nimport { DateEditor } from \"../editors/dateeditor\";\nimport { EditorUtils } from \"../editors/editorutils\";\nimport { SelectEditor } from \"../editors/selecteditor\";\nimport { FilterDisplayBar } from \"../filtering/filterdisplaybar\";\nimport { BooleanFiltering, DateFiltering, DateTimeFiltering, FilteringTypeRegistry, IFiltering, IQuickFiltering } from \"../filtering/filtering\";\nimport { FilterLine } from \"../filtering/filterline\";\nimport { FilterOperators } from \"../filtering/filteroperator\";\nimport { FilterStore } from \"../filtering/filterstore\";\nimport { LazyLoadHelper } from \"../helpers/lazyloadhelper\";\nimport { GridUtils, PropertyItemSlickConverter, SlickFormatting, SlickHelper } from \"../helpers/slickhelpers\";\nimport { ReflectionOptionsSetter } from \"../widgets/reflectionoptionssetter\";\nimport { Toolbar, ToolButton } from \"../widgets/toolbar\";\nimport { Widget } from \"../widgets/widget\";\nimport { IDataGrid } from \"./idatagrid\";\nimport { IRowDefinition } from \"./irowdefinition\";\nimport { QuickFilter } from \"./quickfilter\";\nimport { QuickFilterBar } from \"./quickfilterbar\";\nimport { QuickSearchField, QuickSearchInput } from \"./quicksearchinput\";\nimport { SlickPager } from \"./slickpager\";\n\ntype GroupItemMetadataProviderType = typeof GroupItemMetadataProvider;\n\ndeclare global {\n    namespace Slick {\n        namespace Data {\n            /** @obsolete use the type exported from @serenity-is/sleekgrid */\n            export const GroupItemMetadataProvider: GroupItemMetadataProviderType;\n        }\n   \n        interface RowMoveManagerOptions {\n            cancelEditOnDrag: boolean;\n        }\n    \n        class RowMoveManager implements IPlugin {\n            constructor(options: RowMoveManagerOptions);\n            init(): void;\n            onBeforeMoveRows: EventEmitter;\n            onMoveRows: EventEmitter;\n        }\n\n        class RowSelectionModel implements SelectionModel {\n            init(grid: Grid): void;\n            destroy?: () => void;\n            setSelectedRanges(ranges: Range[]): void;\n            onSelectedRangesChanged: EventEmitter<Range[]>;\n            refreshSelections?(): void;\n        }        \n    }\n}\n\nexport interface SettingStorage {\n    getItem(key: string): string | Promise<string>;\n    setItem(key: string, value: string): void | Promise<void>;\n}\n\nexport interface PersistedGridColumn {\n    id: string;\n    width?: number;\n    sort?: number;\n    visible?: boolean;\n}\n\nexport interface PersistedGridSettings {\n    columns?: PersistedGridColumn[];\n    filterItems?: FilterLine[];\n    quickFilters?: { [key: string]: any };\n    quickFilterText?: string;\n    quickSearchField?: QuickSearchField;\n    quickSearchText?: string;\n    includeDeleted?: boolean;\n}\n\nexport interface GridPersistanceFlags {\n    columnWidths?: boolean;\n    columnVisibility?: boolean;\n    sortColumns?: boolean;\n    filterItems?: boolean;\n    quickFilters?: boolean;\n    quickFilterText?: boolean;\n    quickSearch?: boolean;\n    includeDeleted?: boolean;\n}\n\n@Decorators.registerClass('Serenity.DataGrid', [IReadOnly])\n@Decorators.element(\"<div/>\")\nexport class DataGrid<TItem, TOptions> extends Widget<TOptions> implements IDataGrid, IReadOnly {\n\n    private _isDisabled: boolean;\n    private _layoutTimer: number; \n    private _slickGridOnSort: any;\n    private _slickGridOnClick: any;\n    protected titleDiv: JQuery;\n    protected toolbar: Toolbar;\n    protected filterBar: FilterDisplayBar;\n    protected quickFiltersDiv: JQuery;\n    protected quickFiltersBar: QuickFilterBar;\n    protected slickContainer: JQuery;\n    protected allColumns: Column[];\n    protected propertyItemsData: PropertyItemsData;\n    protected initialSettings: PersistedGridSettings;\n    protected restoringSettings: number = 0;\n    public view: RemoteView<TItem>;\n    public slickGrid: Grid;\n    public openDialogsAsPanel: boolean;\n\n    public static defaultRowHeight: number;\n    public static defaultHeaderHeight: number;\n    public static defaultPersistanceStorage: SettingStorage;\n    public static defaultColumnWidthScale: number;\n    public static defaultColumnWidthDelta: number;\n\n    constructor(container: JQuery, options?: TOptions) {\n        super(container, options);\n\n        var self = this;\n\n        this.element.addClass('s-DataGrid').html('');\n\n        var layout = function() {\n            self.layout();\n            if (self._layoutTimer != null)\n                LayoutTimer.store(self._layoutTimer);\n        }\n        this.element.addClass('require-layout').on('layout.' + this.uniqueName, layout);\n\n        if (this.useLayoutTimer())\n            this._layoutTimer = LayoutTimer.onSizeChange(() => this.element && this.element[0], debounce(layout, 50));\n\n        this.setTitle(this.getInitialTitle());\n\n        var buttons = this.getButtons();\n        if (buttons != null) {\n            this.createToolbar(buttons);\n        }\n\n        this.slickContainer = this.createSlickContainer();\n        this.view = this.createView();\n\n        if (this.useAsync())\n            this.initAsync();\n        else \n            this.initSync();\n    }\n\n    protected internalInit() {\n        this.allColumns = this.allColumns ?? this.getColumns();\n        this.slickGrid = this.createSlickGrid();\n\n        if (this.enableFiltering()) {\n            this.createFilterBar();\n        }\n\n        if (this.usePager()) {\n            this.createPager();\n        }\n        this.bindToSlickEvents();\n        this.bindToViewEvents();\n\n        if (this.toolbar) {\n            this.createToolbarExtensions();\n        }\n\n        this.createQuickFilters();\n\n        this.updateDisabledState();\n        this.updateInterface();\n\n        this.initialSettings = this.getCurrentSettings(null);\n        \n        var restoreResult = this.restoreSettings(null, null);\n        if ((restoreResult as any)?.then)\n            (restoreResult as Promise<void>).then(() => window.setTimeout(() => this.initialPopulate(), 0));\n        else\n            window.setTimeout(() => this.initialPopulate(), 0);\n    }\n\n    protected initSync() {\n        this.propertyItemsData = this.getPropertyItemsData();\n        this.internalInit();\n        this.afterInit();\n    }\n\n    protected async initAsync() {\n        this.propertyItemsData = await this.getPropertyItemsDataAsync();\n        this.internalInit();\n        this.afterInit();\n    }\n\n    protected afterInit() {\n    }\n\n    protected useAsync() {\n        return false;\n    }\n\n    protected useLayoutTimer() {\n        return true;\n    }\n\n    protected attrs<TAttr>(attrType: { new(...args: any[]): TAttr }): TAttr[] {\n        return getAttributes(getInstanceType(this), attrType, true);\n    }\n\n    protected layout(): void {\n        if (!this.element || !this.element.is(':visible') || !this.slickContainer || !this.slickGrid)\n            return;\n\n        var responsiveHeight = this.element.hasClass('responsive-height');\n        var madeAutoHeight = this.slickGrid != null && this.slickGrid.getOptions().autoHeight;\n        var shouldAutoHeight = responsiveHeight && window.innerWidth < 768;\n\n        if (shouldAutoHeight) {\n            if (!madeAutoHeight) {\n                this.slickGrid.setOptions({ autoHeight: true });\n            }\n        }\n        else if (madeAutoHeight) {\n            this.slickContainer.css('height', '');\n            this.slickContainer.children('.slick-viewport').css('height', '');\n            this.slickGrid.setOptions({ autoHeight: false });\n        }\n\n        this.slickGrid.resizeCanvas();\n    }\n\n    protected getInitialTitle(): string {\n        return null;\n    }\n\n    protected createToolbarExtensions(): void {\n    }\n\n    protected ensureQuickFilterBar(): QuickFilterBar {\n\n        if (this.quickFiltersDiv == null)\n            this.createQuickFilters([]);\n\n        return this.quickFiltersBar;\n    }\n\n    protected createQuickFilters(filters?: QuickFilter<Widget<any>, any>[]): void {\n\n        if (this.quickFiltersDiv == null && (filters != null ||\n            ((filters = this.getQuickFilters()) && filters != null && filters.length))) {\n            this.quickFiltersDiv = $('<div/>').addClass('quick-filters-bar');\n            if (this.toolbar) {\n                $('<div/>').addClass('clear').appendTo(this.toolbar.element);\n                this.quickFiltersDiv.appendTo(this.toolbar.element);\n            }\n            else {\n                this.quickFiltersDiv.appendTo($('<div/>').addClass('s-Toolbar').insertBefore(this.slickContainer));\n            }\n\n            this.quickFiltersBar = new QuickFilterBar(this.quickFiltersDiv, {\n                filters: filters,\n                getTitle: (filter: QuickFilter<Widget<any>, any>) => this.determineText(pre => pre + filter.field),\n                idPrefix: this.uniqueName + '_QuickFilter_'\n            });\n            this.quickFiltersBar.onChange = (e) => this.quickFilterChange(e);\n        }\n    }\n\n    protected getQuickFilters(): QuickFilter<Widget<any>, any>[] {\n        return this.allColumns.filter(function (x) {\n            return x.sourceItem &&\n                x.sourceItem.quickFilter === true &&\n                (x.sourceItem.readPermission == null ||\n                    Authorization.hasPermission(x.sourceItem.readPermission));\n        }).map(x => DataGrid.propertyItemToQuickFilter(x.sourceItem))\n            .filter(x => x != null);\n    }\n\n    public static propertyItemToQuickFilter(item: PropertyItem) {\n        var quick: any = {};\n\n        var name = item.name;\n        var title = tryGetText(item.title);\n        if (title == null) {\n            title = item.title;\n            if (title == null) {\n                title = name;\n            }\n        }\n\n        var filteringType = FilteringTypeRegistry.get((item.filteringType ?? 'String'));\n        if (filteringType === DateFiltering) {\n            quick = QuickFilterBar.dateRange(name, title);\n        }\n        else if (filteringType === DateTimeFiltering) {\n            quick = QuickFilterBar.dateTimeRange(name, title, item.editorParams?.useUtc);\n        }\n        else if (filteringType === BooleanFiltering) {\n            var q = item.quickFilterParams || {};\n            var f = item.filteringParams || {};\n            var trueText = q['trueText'];\n            if (trueText == null) {\n                trueText = f['trueText'];\n            }\n            var falseText = q['falseText'];\n            if (falseText == null) {\n                falseText = f['falseText'];\n            }\n            quick = QuickFilterBar.boolean(name, title, trueText, falseText);\n        }\n        else {\n            var filtering = new (filteringType as any)() as IFiltering;\n            if (filtering && isInstanceOfType(filtering, IQuickFiltering)) {\n                ReflectionOptionsSetter.set(filtering, item.filteringParams);\n                filtering.set_field(item);\n                filtering.set_operator({ key: FilterOperators.EQ });\n                (filtering as any).initQuickFilter(quick);\n                quick.options = extend(deepClone(quick.options), item.quickFilterParams);\n            }\n            else {\n                return null;\n            }\n        }\n\n        if (!!item.quickFilterSeparator) {\n            quick.separator = true;\n        }\n\n        quick.cssClass = item.quickFilterCssClass;\n        return quick;\n    }\n\n    protected findQuickFilter<TWidget>(type: { new(...args: any[]): TWidget }, field: string): TWidget {\n        if (this.quickFiltersBar != null)\n            return this.quickFiltersBar.find(type, field);\n\n        return $('#' + this.uniqueName + '_QuickFilter_' + field).getWidget(type);\n    }\n\n    protected tryFindQuickFilter<TWidget>(type: { new(...args: any[]): TWidget }, field: string): TWidget {\n        if (this.quickFiltersBar != null)\n            return this.quickFiltersBar.tryFind(type, field);\n\n        var el = $('#' + this.uniqueName + '_QuickFilter_' + field);\n        if (!el.length)\n            return null;\n\n        return el.tryGetWidget(type);\n    }\n\n    protected createIncludeDeletedButton(): void {\n        if (!isEmptyOrNull(this.getIsActiveProperty()) ||\n            !isEmptyOrNull(this.getIsDeletedProperty())) {\n            GridUtils.addIncludeDeletedToggle(this.toolbar.element, this.view, null, false);\n        }\n    }\n\n    protected getQuickSearchFields(): QuickSearchField[] {\n        return null;\n    }\n\n    protected createQuickSearchInput(): void {\n        var input = GridUtils.addQuickSearchInput(this.toolbar.element, this.view, this.getQuickSearchFields(), () => this.persistSettings(null));\n        input?.element?.attr('id', this.idPrefix + 'QuickSearchInput');\n    }\n\n    public destroy() {\n        if (this._layoutTimer) {\n            this._layoutTimer = LayoutTimer.off(this._layoutTimer);\n        }\n        if (this.quickFiltersBar) {\n            this.quickFiltersBar.destroy();\n            this.quickFiltersBar = null;\n        }\n\n        if (this.toolbar) {\n            this.toolbar.destroy();\n            this.toolbar = null;\n        }\n\n        if (this.slickGrid) {\n            this.slickGrid.onClick.clear();\n            this.slickGrid.onSort.clear();\n            this.slickGrid.onColumnsResized.clear();\n            this.slickGrid.onColumnsReordered.clear();\n            this.slickGrid.destroy();\n            this.slickGrid = null;\n        }\n\n        if (this.view) {\n            this.view.onDataChanged.clear();\n            this.view.onSubmit = null;\n            this.view.setFilter(null);\n            this.view = null;\n        }\n\n        this.titleDiv = null;\n        super.destroy();\n    }\n\n    protected getItemCssClass(item: TItem, index: number): string {\n        var activeFieldName = this.getIsActiveProperty();\n        var deletedFieldName = this.getIsDeletedProperty();\n        if (isEmptyOrNull(activeFieldName) && isEmptyOrNull(deletedFieldName)) {\n            return null;\n        }\n\n        if (activeFieldName) {\n            var value = (item as any)[activeFieldName];\n            if (value == null) {\n                return null;\n            }\n\n            if (typeof (value) === 'number') {\n                if (value < 0) {\n                    return 'deleted';\n                }\n                else if (value === 0) {\n                    return 'inactive';\n                }\n            }\n            else if (typeof (value) === 'boolean') {\n                if (value === false) {\n                    return 'deleted';\n                }\n            }\n        }\n        else {\n            return (item as any)[deletedFieldName] ? 'deleted' : null;\n        }\n\n        return null;\n    }\n\n    protected getItemMetadata(item: TItem, index: number): any {\n        var itemClass = this.getItemCssClass(item, index);\n        if (isEmptyOrNull(itemClass)) {\n            return new Object();\n        }\n        return { cssClasses: itemClass };\n    }\n\n    protected postProcessColumns(columns: Column[]): Column[] {\n        SlickHelper.setDefaults(columns, this.getLocalTextDbPrefix());\n\n        var delta = this.getColumnWidthDelta();\n        var scale = this.getColumnWidthScale();\n        if (scale < 0)\n            scale = 1;\n        if (delta !== 0 || scale !== 1) {\n            for (var col of columns) {\n                if (typeof col.width === \"number\")\n                    col.width = Math.round(col.width * scale + delta);\n                if (typeof col.minWidth === \"number\")\n                    col.minWidth = Math.round(col.minWidth * scale + delta);\n                if (typeof col.maxWidth === \"number\")\n                    col.maxWidth = Math.round(col.maxWidth * scale + delta);\n            }\n        }\n\n        return columns;\n    }\n\n    protected getColumnWidthDelta() {\n        return DataGrid.defaultColumnWidthDelta ?? 0;\n    }\n\n    protected getColumnWidthScale() {\n        return DataGrid.defaultColumnWidthScale ?? 1;\n    }\n\n    protected initialPopulate(): void {\n        var self = this;\n        if (this.populateWhenVisible()) {\n            LazyLoadHelper.executeEverytimeWhenShown(this.element, function () {\n                self.refreshIfNeeded();\n            }, false);\n            if (this.element.is(':visible') && this.view) {\n                this.view.populate();\n            }\n        }\n        else if (this.view) {\n            this.view.populate();\n        }\n    }\n\n    protected canFilterColumn(column: Column): boolean {\n        return (column.sourceItem != null && \n            column.sourceItem.notFilterable !== true &&\n            (column.sourceItem.readPermission == null ||\n                Authorization.hasPermission(column.sourceItem.readPermission)));\n    }\n\n    protected initializeFilterBar() {\n\n        this.filterBar.set_store(new FilterStore(\n            this.allColumns\n                .filter(c => this.canFilterColumn(c))\n                .map(x => x.sourceItem)));\n\n        this.filterBar.get_store().add_changed((s: JQueryEventObject, e: any) => {\n            if (this.restoringSettings <= 0) {\n                this.persistSettings(null);\n                this.view && (this.view.seekToPage = 1);\n                this.refresh();\n            }\n        });\n    }\n\n    protected createSlickGrid(): Grid {\n\n        var visibleColumns = this.postProcessColumns(this.allColumns).filter(function (x) {\n            return x.visible !== false;\n        });\n\n        var slickOptions = this.getSlickOptions();\n        var grid = new Grid(this.slickContainer, this.view as any, visibleColumns, slickOptions) as Grid;\n        grid.registerPlugin(new AutoTooltips({\n            enableForHeaderCells: true\n        }));\n\n        this.slickGrid = grid;\n        \n        this.setInitialSortOrder();\n\n        return grid;\n    }\n\n    protected setInitialSortOrder(): void {\n        var sortBy = this.getDefaultSortBy();\n\n        if (this.view) {\n            this.view.sortBy = Array.prototype.slice.call(sortBy);\n        }\n\n        var mapped = sortBy.map(function (s): ColumnSort {\n            var x: ColumnSort;\n            if (s && endsWith(s.toLowerCase(), ' desc')) {\n                return {\n                    columnId: trimEnd(s.substr(0, s.length - 5)),\n                    sortAsc: false\n                }\n            }\n            else return {\n                columnId: s,\n                sortAsc: true\n            }\n            return x;\n        });\n\n        this.slickGrid.setSortColumns(mapped);\n    }\n\n    itemAt(row: number): TItem {\n        return this.slickGrid.getDataItem(row);\n    }\n\n    rowCount() {\n        return this.slickGrid.getDataLength();\n    }\n\n    getItems(): TItem[] {\n        return this.view.getItems();\n    }\n\n    setItems(value: TItem[]) {\n        this.view.setItems(value, true);\n    }\n\n    protected bindToSlickEvents() {\n        var self = this;\n        this._slickGridOnSort = (e: JQuery, p: any) => {\n            self.view.populateLock();\n            try {\n                var sortBy = [];\n                var col: any;\n                if (!!p.multiColumnSort) {\n                    for (var i = 0; !!(i < p.sortCols.length); i++) {\n                        var x = p.sortCols[i];\n                        col = x.sortCol;\n                        if (col == null) {\n                            col = {};\n                        }\n                        sortBy.push(col.field + (!!x.sortAsc ? '' : ' DESC'));\n                    }\n                }\n                else {\n                    var col = p.sortCol;\n                    if (col == null) {\n                        col = {};\n                    }\n                    sortBy.push(col.field + (!!p.sortAsc ? '' : ' DESC'));\n                }\n\n                self.view.seekToPage = 1;\n                self.view.sortBy = sortBy;\n            }\n            finally {\n                self.view.populateUnlock();\n            }\n\n            if (self.view.getLocalSort && self.view.getLocalSort()) {\n                self.view.sort();\n            }\n            else {\n                self.view.populate();\n            }\n            this.persistSettings(null);\n        };\n\n        this.slickGrid.onSort.subscribe(this._slickGridOnSort);\n\n        this._slickGridOnClick = (e1: JQueryEventObject, p1: any) => {\n            self.onClick(e1, p1.row, p1.cell);\n        }\n\n        this.slickGrid.onClick.subscribe(this._slickGridOnClick);\n\n        this.slickGrid.onColumnsReordered.subscribe((e2: JQueryEventObject, p2: any) => {\n            return this.persistSettings(null);\n        });\n\n        this.slickGrid.onColumnsResized.subscribe((e3: JQueryEventObject, p3: any) => {\n            return this.persistSettings(null);\n        });\n    }\n\n    protected getAddButtonCaption(): string {\n        return tryGetText('Controls.DataGrid.NewButton') ?? 'New';\n    }\n\n    protected getButtons(): ToolButton[] {\n        return [];\n    }\n\n    protected editItem(entityOrId: any): void {\n        throw new Error(\"Not Implemented!\");\n    }\n\n    protected editItemOfType(itemType: string, entityOrId: any): void {\n        if (itemType === this.getItemType()) {\n            this.editItem(entityOrId);\n            return;\n        }\n\n        throw new Error(\"Not Implemented!\");\n    }\n\n    protected onClick(e: JQueryEventObject, row: number, cell: number): void {\n        if (e.isDefaultPrevented()) {\n            return;\n        }\n\n        var target = $(e.target);\n        if (!target.hasClass('s-EditLink')) {\n            target = target.closest('a');\n        }\n\n        if (target.hasClass('s-EditLink')) {\n            e.preventDefault();\n            this.editItemOfType(SlickFormatting.getItemType(target), SlickFormatting.getItemId(target));\n        }\n    }\n\n    protected viewDataChanged(e: any, rows: TItem[]): void {\n        this.markupReady();\n        this.layout();\n    }\n\n    protected bindToViewEvents(): void {\n        var self = this;\n\n        this.view.onDataChanged.subscribe(function (e, d) {\n            return self.viewDataChanged(e, d);\n        });\n\n        this.view.onSubmit = function (view) {\n            return self.onViewSubmit();\n        };\n\n        this.view.setFilter(function (item, view1) {\n            return self.onViewFilter(item);\n        });\n\n        this.view.onProcessData = function (response, view2) {\n            return self.onViewProcessData(response);\n        }\n    }\n\n    protected onViewProcessData(response: ListResponse<TItem>): ListResponse<TItem> {\n        return response;\n    }\n\n    protected onViewFilter(item: TItem): boolean {\n        return true;\n    }\n\n    protected getIncludeColumns(include: { [key: string]: boolean }): void {\n        var columns = this.slickGrid.getColumns();\n        for (var column of columns) {\n            if (column.field) {\n                include[column.field] = true;\n            }\n\n            if (column.referencedFields) {\n                for (var x of column.referencedFields) {\n                    include[x] = true;\n                }\n            }\n        }\n    }\n\n    protected setCriteriaParameter(): void {\n        delete this.view.params['Criteria'];\n        if (this.filterBar) {\n            var criteria = this.filterBar.get_store().get_activeCriteria();\n            if (!Criteria.isEmpty(criteria)) {\n                this.view.params.Criteria = criteria;\n            }\n        }\n    }\n\n    protected setEquality(field: string, value: any): void {\n        setEquality(this.view.params, field, value);\n    }\n\n    protected setIncludeColumnsParameter(): void {\n        var include = {};\n        this.getIncludeColumns(include);\n        var array = [];\n        for (var key of Object.keys(include)) {\n            array.push(key);\n        }\n        this.view.params.IncludeColumns = array;\n    }\n\n    protected onViewSubmit(): boolean {\n        if (this._isDisabled || !this.getGridCanLoad()) {\n            return false;\n        }\n\n        this.setCriteriaParameter();\n        this.setIncludeColumnsParameter();\n        this.invokeSubmitHandlers();\n\n        return true;\n    }\n\n    protected markupReady(): void {\n    }\n\n    protected createSlickContainer(): JQuery {\n        return $('<div class=\"grid-container\"></div>').appendTo(this.element);\n    }\n\n    protected createView(): RemoteView<TItem> {\n        var opt = this.getViewOptions();\n        return new RemoteView<TItem>(opt) as any;\n    }\n\n    protected getDefaultSortBy(): any[] {\n        if (this.slickGrid) {\n\n            var columns = this.slickGrid.getColumns().filter(function (x) {\n                return x.sortOrder && x.sortOrder !== 0;\n            });\n\n            if (columns.length > 0) {\n                columns.sort(function (x1, y) {\n                    return Math.abs(x1.sortOrder) < Math.abs(y.sortOrder) ? -1 : (Math.abs(x1.sortOrder) > Math.abs(y.sortOrder) ? 1 : 0);\n                });\n\n                var list = [];\n                for (var i = 0; i < columns.length; i++) {\n                    var col = columns[i];\n                    list.push(col.field + ((col.sortOrder < 0) ? ' DESC' : ''));\n                }\n\n                return list;\n            }\n        }\n\n        return [];\n    }\n\n    protected usePager(): boolean {\n        return false;\n    }\n\n    protected enableFiltering(): boolean {\n        var attr = this.attrs(FilterableAttribute);\n        return attr.length > 0 && attr[0].value;\n    }\n\n    protected populateWhenVisible(): boolean {\n        return false;\n    }\n\n    protected createFilterBar(): void {\n        var filterBarDiv = $('<div/>').appendTo(this.element);\n        this.filterBar = new FilterDisplayBar(filterBarDiv);\n        this.initializeFilterBar();\n    }\n\n    protected getPagerOptions(): PagerOptions {\n        return {\n            view: this.view,\n            rowsPerPage: 20,\n            rowsPerPageOptions: [20, 100, 500, 2500]\n        };\n    }\n\n    protected createPager(): void {\n        var pagerDiv = $('<div></div>').appendTo(this.element);\n        new SlickPager(pagerDiv, this.getPagerOptions());\n    }\n\n    protected getViewOptions() {\n        var opt: RemoteViewOptions = {};\n        opt.idField = this.getIdProperty();\n        opt.sortBy = this.getDefaultSortBy();\n\n        if (!this.usePager()) {\n            opt.rowsPerPage = 0;\n        }\n        else if (this.element.hasClass('responsive-height')) {\n            opt.rowsPerPage = (($(window.window).width() < 768) ? 20 : 100);\n        }\n        else {\n            opt.rowsPerPage = 100;\n        }\n\n        opt.getItemMetadata = (item, index) => {\n            return this.getItemMetadata(item, index);\n        };\n\n        return opt;\n    }\n\n    protected createToolbar(buttons: ToolButton[]): void {\n        var toolbarDiv = $('<div class=\"grid-toolbar\"></div>').appendTo(this.element);\n        this.toolbar = new Toolbar(toolbarDiv, { buttons: buttons, hotkeyContext: this.element[0] });\n    }\n\n    getTitle(): string {\n        if (!this.titleDiv) {\n            return null;\n        }\n\n        return this.titleDiv.children('.title-text').text();\n    }\n\n    setTitle(value: string) {\n        if (value !== this.getTitle()) {\n            if (value == null) {\n                if (this.titleDiv) {\n                    this.titleDiv.remove();\n                    this.titleDiv = null;\n                }\n            }\n            else {\n                if (!this.titleDiv) {\n                    this.titleDiv = $('<div class=\"grid-title\"><div class=\"title-text\"></div></div>')\n                        .prependTo(this.element);\n                }\n                this.titleDiv.children('.title-text').text(value);\n            }\n\n            this.layout();\n        }\n    }\n\n    protected getItemType(): string {\n        return 'Item';\n    }\n\n    protected itemLink(itemType?: string, idField?: string, text?: (ctx: FormatterContext) => string,\n        cssClass?: (ctx: FormatterContext) => string, encode: boolean = true): Format<TItem> {\n\n        if (itemType == null) {\n            itemType = this.getItemType();\n        }\n\n        if (idField == null) {\n            idField = this.getIdProperty();\n        }\n\n        return SlickFormatting.itemLink(itemType, idField, text, cssClass, encode);\n    }\n\n    protected getColumnsKey(): string {\n        var attr = this.attrs(ColumnsKeyAttribute);\n        if (attr && attr.length > 0) {\n            return attr[0].value;\n        }\n\n        return null;\n    }\n\n    protected getPropertyItems() {\n        return this.propertyItemsData?.items || [];\n    }\n\n    protected getPropertyItemsData(): PropertyItemsData {\n        var columnsKey = this.getColumnsKey();\n\n        if (this.getColumnsKey === DataGrid.prototype.getColumnsKey &&\n            this.getPropertyItems !== DataGrid.prototype.getPropertyItems &&\n            !ScriptData.canLoad('Columns.' + columnsKey)) {\n            return {\n                items: this.getPropertyItems(),\n                additionalItems: []\n            }\n        }\n\n\n        if (!isEmptyOrNull(columnsKey)) {\n            return getColumnsData(columnsKey);\n        }\n\n        return { items: [], additionalItems: [] };\n    }\n\n    protected async getPropertyItemsDataAsync(): Promise<PropertyItemsData> {\n        var columnsKey = this.getColumnsKey();\n        if (!isEmptyOrNull(columnsKey)) {\n            return await getColumnsDataAsync(columnsKey);\n        }\n\n        return { items: [], additionalItems: [] };\n    }\n\n    protected getColumns(): Column<TItem>[] {\n        return this.propertyItemsToSlickColumns(this.getPropertyItems());\n    }\n\n    protected propertyItemsToSlickColumns(propertyItems: PropertyItem[]): Column[] {\n        var columns = PropertyItemSlickConverter.toSlickColumns(propertyItems);\n        for (var i = 0; i < propertyItems.length; i++) {\n            var item = propertyItems[i];\n            var column = columns[i];\n            if (item.editLink === true) {\n                var oldFormat = { $: column.format };\n                var css = { $: (item.editLinkCssClass) != null ? item.editLinkCssClass : null };\n                column.format = this.itemLink(\n                    item.editLinkItemType != null ? item.editLinkItemType : null,\n                    item.editLinkIdField != null ? item.editLinkIdField : null,\n                    function(ctx: FormatterContext) {\n                        if (this.oldFormat.$ != null) {\n                            return this.oldFormat.$(ctx);\n                        }\n                        return htmlEncode(ctx.value);\n                    }.bind({ oldFormat: oldFormat }),\n                    function(ctx1: FormatterContext) {\n                        return (this.css.$ ?? '');\n                    }.bind({ css: css }), false);\n\n                if (!isEmptyOrNull(item.editLinkIdField)) {\n                    column.referencedFields = column.referencedFields || [];\n                    column.referencedFields.push(item.editLinkIdField);\n                }\n            }\n        }\n        return columns;\n    }\n\n    protected getSlickOptions(): GridOptions {\n        var opt: GridOptions = {};\n        opt.multiSelect = false;\n        opt.multiColumnSort = true;\n        opt.enableCellNavigation = false;\n        if (DataGrid.defaultHeaderHeight)\n            opt.headerRowHeight = DataGrid.defaultHeaderHeight;\n        if (DataGrid.defaultRowHeight)\n            opt.rowHeight = DataGrid.defaultRowHeight;\n        return opt;\n    }\n\n    protected populateLock(): void {\n        this.view.populateLock();\n    }\n\n    protected populateUnlock(): void {\n        this.view.populateUnlock();\n    }\n\n    protected getGridCanLoad(): boolean {\n        return true;\n    }\n\n    public refresh() {\n        if (!this.populateWhenVisible()) {\n            this.internalRefresh();\n            return;\n        }\n        if (this.slickContainer.is(':visible')) {\n            this.slickContainer.data('needsRefresh', false);\n            this.internalRefresh();\n            return;\n        }\n        this.slickContainer.data('needsRefresh', true);\n    }\n\n    protected refreshIfNeeded(): void {\n        if (!!this.slickContainer.data('needsRefresh')) {\n            this.slickContainer.data('needsRefresh', false);\n            this.internalRefresh();\n        }\n    }\n\n    protected internalRefresh(): void {\n        this.view.populate();\n    }\n\n    public setIsDisabled(value: boolean): void {\n        if (this._isDisabled !== value) {\n            this._isDisabled = value;\n            if (this._isDisabled) {\n                this.view.setItems([], true);\n            }\n\n            this.updateDisabledState();\n        }\n    }\n\n    private _readonly: boolean;\n\n    public get readOnly(): boolean {\n        return this.get_readOnly();\n    }\n\n    public set readOnly(value: boolean) {\n        this.set_readOnly(value);\n    }\n\n    public get_readOnly() {\n        return !!this._readonly;\n    }\n\n    public set_readOnly(value: boolean) {\n        if (!!this._readonly != !!value) {\n            this._readonly = !!value;\n            this.updateInterface();\n        }\n    }\n\n    public updateInterface() {\n        this.toolbar && this.toolbar.updateInterface();\n    }\n\n    protected getRowDefinition(): IRowDefinition {\n        return null;\n    }\n\n    private _localTextDbPrefix: string;\n\n    protected getLocalTextDbPrefix(): string {\n\n        if (this._localTextDbPrefix != null)\n            return this._localTextDbPrefix;\n\n        this._localTextDbPrefix = this.getLocalTextPrefix() ?? '';\n        if (this._localTextDbPrefix.length > 0 && !endsWith(this._localTextDbPrefix, '.'))\n            this._localTextDbPrefix = 'Db.' + this._localTextDbPrefix + '.';\n\n        return this._localTextDbPrefix;\n    }\n\n    protected getLocalTextPrefix(): string {\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return rowDefinition.localTextPrefix;\n\n        var attr = this.attrs(LocalTextPrefixAttribute);\n\n        if (attr.length >= 1)\n            return attr[0].value;\n    }\n   \n    private _idProperty: string;\n\n    protected getIdProperty(): string {\n        if (this._idProperty != null)\n            return this._idProperty;\n\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return this._idProperty = rowDefinition.idProperty ?? '';\n\n        var attr = this.attrs(IdPropertyAttribute);\n        if (attr.length === 1)\n            return this._idProperty = attr[0].value ?? '';\n\n        return this._idProperty = 'ID';\n    }\n\n    protected getIsDeletedProperty(): string {\n        return this.getRowDefinition()?.isDeletedProperty;\n    }\n\n    private _isActiveProperty: string;\n\n    protected getIsActiveProperty(): string {\n        if (this._isActiveProperty != null)\n            return this._isActiveProperty;\n\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return this._isActiveProperty = rowDefinition.isActiveProperty ?? '';\n\n        var attr = this.attrs(IsActivePropertyAttribute);\n        if (attr.length === 1)\n            return this._isActiveProperty = attr[0].value ?? '';\n\n        return this._isActiveProperty = '';\n    }\n\n    protected updateDisabledState(): void {\n        this.slickContainer.toggleClass('ui-state-disabled', !!this._isDisabled);\n    }\n\n    protected resizeCanvas(): void {\n        this.slickGrid?.resizeCanvas();\n    }\n\n    protected subDialogDataChange(): void {\n        this.refresh();\n    }\n\n    protected addFilterSeparator(): void {\n        this.ensureQuickFilterBar().addSeparator();\n    }\n\n    protected determineText(getKey: (prefix: string) => string) {\n        var localTextPrefix = this.getLocalTextDbPrefix();\n        if (!isEmptyOrNull(localTextPrefix)) {\n            var local = tryGetText(getKey(localTextPrefix));\n            if (local != null) {\n                return local;\n            }\n        }\n\n        return null;\n    }\n\n    protected addQuickFilter<TWidget extends Widget<any>, TOptions>(opt: QuickFilter<TWidget, TOptions>): TWidget {\n        return this.ensureQuickFilterBar().add(opt);\n    }\n\n    protected addDateRangeFilter(field: string, title?: string): DateEditor {\n        return this.ensureQuickFilterBar().addDateRange(field, title);\n    }\n\n    protected dateRangeQuickFilter(field: string, title?: string) {\n        return QuickFilterBar.dateRange(field, title);\n    }\n\n    protected addDateTimeRangeFilter(field: string, title?: string) {\n        return this.ensureQuickFilterBar().addDateTimeRange(field, title);\n    }\n\n    protected dateTimeRangeQuickFilter(field: string, title?: string) {\n        return QuickFilterBar.dateTimeRange(field, title);\n    }\n\n    protected addBooleanFilter(field: string, title?: string, yes?: string, no?: string): SelectEditor {\n        return this.ensureQuickFilterBar().addBoolean(field, title, yes, no);\n    }\n\n    protected booleanQuickFilter(field: string, title?: string, yes?: string, no?: string) {\n        return QuickFilterBar.boolean(field, title, yes, no);\n    }\n\n    protected invokeSubmitHandlers() {\n        if (this.quickFiltersBar != null) {\n            this.quickFiltersBar.onSubmit(this.view.params);\n        }\n    }\n\n    protected quickFilterChange(e: JQueryEventObject) {\n        this.persistSettings(null);\n        this.view && (this.view.seekToPage = 1);\n        this.refresh();\n    }\n\n    protected getPersistanceStorage(): SettingStorage {\n        return DataGrid.defaultPersistanceStorage;\n    }\n\n    protected getPersistanceKey(): string {\n        var key = 'GridSettings:';\n        var path = window.location.pathname;\n        if (!isEmptyOrNull(path)) {\n            key += path.substr(1).split(String.fromCharCode(47)).slice(0, 2).join('/') + ':';\n        }\n\n        key += getTypeFullName(getInstanceType(this));\n        return key;\n    }\n\n    protected gridPersistanceFlags(): GridPersistanceFlags {\n        return {};\n    }\n\n    protected canShowColumn(column: Column) {\n        if (column == null) {\n            return false;\n        }\n\n        var item = column.sourceItem;\n        if (item == null) {\n            return true;\n        }\n\n        if (item.filterOnly === true) {\n            return false;\n        }\n\n        if (item.readPermission == null) {\n            return true;\n        }\n\n        return Authorization.hasPermission(item.readPermission);\n    }\n\n    protected getPersistedSettings(): PersistedGridSettings | Promise<PersistedGridSettings> {\n        var storage = this.getPersistanceStorage();\n        if (storage == null)\n            return null;\n\n        function fromJson(json: string) {\n            json = trimToNull(json as string);\n            if (json != null && startsWith(json, '{') && endsWith(json, '}'))\n                return JSON.parse(json);\n            return null;\n        }\n\n        var jsonOrPromise = storage.getItem(this.getPersistanceKey());\n        if ((jsonOrPromise as any)?.then)\n            return (jsonOrPromise as Promise<string>).then(json => fromJson(json));\n\n        return fromJson(jsonOrPromise as string);\n    }\n\n    protected restoreSettings(settings?: PersistedGridSettings, flags?: GridPersistanceFlags): void | Promise<void> {\n        if (settings != null)\n            return this.restoreSettingsFrom(settings, flags);\n\n        var settingsOrPromise = this.getPersistedSettings();\n        if ((settingsOrPromise as any)?.then)\n            return (settingsOrPromise as Promise<PersistedGridSettings>).then((s) => this.restoreSettingsFrom(s));\n\n        this.restoreSettingsFrom(settingsOrPromise as PersistedGridSettings);\n    }\n\n    protected restoreSettingsFrom(settings: PersistedGridSettings, flags?: GridPersistanceFlags): void {\n        if (!this.slickGrid || !settings)\n            return;\n\n        var columns = this.slickGrid.getColumns();\n        var colById: { [key: string]: Column } = null;\n        var updateColById = function(cl: Column[]) {\n            colById = {};\n            for (var $t1 = 0; $t1 < cl.length; $t1++) {\n                var c = cl[$t1];\n                colById[c.id] = c;\n            }\n        };\n\n        this.view.beginUpdate();\n        this.restoringSettings++;\n        try {\n            flags = flags || this.gridPersistanceFlags();\n            if (settings.columns != null) {\n                if (flags.columnVisibility !== false) {\n                    var visible = {};\n                    updateColById(this.allColumns);\n                    var newColumns = [];\n                    for (var $t2 = 0; $t2 < settings.columns.length; $t2++) {\n                        var x = settings.columns[$t2];\n                        if (x.id != null && x.visible === true) {\n                            var column = colById[x.id];\n                            if (this.canShowColumn(column)) {\n                                column.visible = true;\n                                newColumns.push(column);\n                                delete colById[x.id];\n                            }\n                        }\n                    }\n                    for (var $t3 = 0; $t3 < this.allColumns.length; $t3++) {\n                        var c1 = this.allColumns[$t3];\n                        if (colById[c1.id] != null) {\n                            c1.visible = false;\n                            newColumns.push(c1);\n                        }\n                    }\n                    this.allColumns = newColumns;\n                    columns = this.allColumns.filter(function (x1) {\n                        return x1.visible === true;\n                    });\n                }\n                if (flags.columnWidths !== false) {\n                    updateColById(columns);\n                    for (var $t4 = 0; $t4 < settings.columns.length; $t4++) {\n                        var x2 = settings.columns[$t4];\n                        if (x2.id != null && x2.width != null && x2.width !== 0) {\n                            var column1 = colById[x2.id];\n                            if (column1 != null) {\n                                column1.width = x2.width;\n                            }\n                        }\n                    }\n                }\n\n                if (flags.sortColumns !== false) {\n                    updateColById(columns);\n                    var list = [];\n                    var sortColumns = settings.columns.filter(function (x3) {\n                        return x3.id != null && (x3.sort ?? 0) !== 0;\n                    });\n\n                    sortColumns.sort(function (a, b) {\n                        // sort holds two informations:\n                        // absoulte value: order of sorting\n                        // sign: positive = ascending, negativ = descending\n                        // so we have to compare absolute values here\n                        return Math.abs(a.sort) - Math.abs(b.sort);\n                    });\n\n                    for (var $t5 = 0; $t5 < sortColumns.length; $t5++) {\n                        var x4 = sortColumns[$t5];\n                        var column2 = colById[x4.id];\n                        if (column2 != null) {\n                            list.push({\n                                columnId: x4.id,\n                                sortAsc: x4.sort > 0\n                            });\n                        }\n                    }\n                    this.view.sortBy = list.map(function (x5) {\n                        return x5.columnId + ((x5.sortAsc === false) ? ' DESC' : '');\n                    });\n                    this.slickGrid.setSortColumns(list);\n                }\n                this.slickGrid.setColumns(columns);\n                this.slickGrid.invalidate();\n            }\n\n            if (settings.filterItems != null &&\n                flags.filterItems !== false &&\n                this.filterBar != null &&\n                this.filterBar.get_store() != null) {\n                var items = this.filterBar.get_store().get_items();\n                items.length = 0;\n                items.push.apply(items, settings.filterItems);\n                this.filterBar.get_store().raiseChanged();\n            }\n\n            if (settings.includeDeleted != null &&\n                flags.includeDeleted !== false) {\n                var includeDeletedToggle = this.element.find('.s-IncludeDeletedToggle');\n                if (!!settings.includeDeleted !== includeDeletedToggle.hasClass('pressed')) {\n                    includeDeletedToggle.children('a').click();\n                }\n            }\n\n            if (settings.quickFilters != null &&\n                flags.quickFilters !== false &&\n                this.quickFiltersDiv != null &&\n                this.quickFiltersDiv.length > 0) {\n                this.quickFiltersDiv.find('.quick-filter-item').each((i, e) => {\n                    var field = $(e).data('qffield');\n\n                    if (isEmptyOrNull(field)) {\n                        return;\n                    }\n\n                    var widget = $('#' + this.uniqueName + '_QuickFilter_' + field).tryGetWidget(Widget);\n                    if (widget == null) {\n                        return;\n                    }\n\n                    var state = settings.quickFilters[field];\n                    var loadState = $(e).data('qfloadstate');\n                    if (loadState != null) {\n                        loadState(widget, state);\n                    }\n                    else {\n                        EditorUtils.setValue(widget, state);\n                    }\n                });\n            }\n\n            if (flags.quickSearch === true && (settings.quickSearchField !== undefined || settings.quickSearchText !== undefined)) {\n                var qsInput = this.toolbar.element.find('.s-QuickSearchInput').first();\n                if (qsInput.length > 0) {\n                    var qsWidget = qsInput.tryGetWidget(QuickSearchInput);\n                    qsWidget && qsWidget.restoreState(settings.quickSearchText, settings.quickSearchField);\n                }\n            }\n        }\n        finally {\n            this.restoringSettings--;\n            this.view.endUpdate();\n        }\n    }\n\n    protected persistSettings(flags?: GridPersistanceFlags): void | Promise<void> {\n        var storage = this.getPersistanceStorage();\n        if (!storage) {\n            return;\n        }\n\n        var settings = this.getCurrentSettings(flags);\n        return storage.setItem(this.getPersistanceKey(), JSON.stringify(settings));\n    }\n\n    protected getCurrentSettings(flags?: GridPersistanceFlags) {\n        flags = flags || this.gridPersistanceFlags();\n        var settings: PersistedGridSettings = {};\n        if (flags.columnVisibility !== false || flags.columnWidths !== false || flags.sortColumns !== false) {\n            settings.columns = [];\n            var sortColumns = this.slickGrid.getSortColumns() as any[];\n            var columns = this.slickGrid.getColumns();\n            for (var column of columns) {\n                var p: PersistedGridColumn = {\n                    id: column.id\n                };\n\n                if (flags.columnVisibility !== false) {\n                    p.visible = true;\n                }\n                if (flags.columnWidths !== false) {\n                    p.width = column.width;\n                }\n\n                if (flags.sortColumns !== false) {\n                    var sort = indexOf(sortColumns, x => x.columnId == column.id);\n                    p.sort = ((sort >= 0) ? ((sortColumns[sort].sortAsc !== false) ? (sort + 1) : (-sort - 1)) : 0);\n                }\n                settings.columns.push(p);\n            }\n        }\n\n        if (flags.includeDeleted !== false) {\n            settings.includeDeleted = this.element.find('.s-IncludeDeletedToggle').hasClass('pressed');\n        }\n\n        if (flags.filterItems !== false && (this.filterBar != null) && (this.filterBar.get_store() != null)) {\n            settings.filterItems = this.filterBar.get_store().get_items().slice();\n        }\n\n        if (flags.quickSearch === true) {\n            var qsInput = this.toolbar.element.find('.s-QuickSearchInput').first();\n            if (qsInput.length > 0) {\n                var qsWidget = qsInput.tryGetWidget(QuickSearchInput);\n                if (qsWidget != null) {\n                    settings.quickSearchField = qsWidget.get_field();\n                    settings.quickSearchText = qsWidget.element.val();\n                }\n            }\n        }\n\n        if (flags.quickFilters !== false && (this.quickFiltersDiv != null) && this.quickFiltersDiv.length > 0) {\n            settings.quickFilters = {};\n            this.quickFiltersDiv.find('.quick-filter-item').each((i, e) => {\n                var field = $(e).data('qffield');\n                if (isEmptyOrNull(field)) {\n                    return;\n                }\n\n                var widget = $('#' + this.uniqueName + '_QuickFilter_' + field).tryGetWidget(Widget);\n                if (widget == null) {\n                    return;\n                }\n\n                var saveState = $(e).data('qfsavestate');\n                var state = (saveState != null) ? saveState(widget) : EditorUtils.getValue(widget);\n                settings.quickFilters[field] = state;\n                if (flags.quickFilterText === true && $(e).hasClass('quick-filter-active')) {\n\n                    var getDisplayText = $(e).data('qfdisplaytext');\n                    var filterLabel = $(e).find('.quick-filter-label').text();\n\n                    var displayText;\n                    if (getDisplayText != null) {\n                        displayText = getDisplayText(widget, filterLabel);\n                    }\n                    else {\n                        displayText = filterLabel + ' = ' + EditorUtils.getDisplayText(widget);\n                    }\n\n                    if (!isEmptyOrNull(displayText)) {\n                        if (!isEmptyOrNull(settings.quickFilterText)) {\n                            settings.quickFilterText += ' ' + (tryGetText('Controls.FilterPanel.And') ?? 'and') + ' ';\n                            settings.quickFilterText += displayText;\n                        }\n                        else {\n                            settings.quickFilterText = displayText;\n                        }\n                    }\n                }\n            });\n        }\n        return settings;\n    }\n\n    getElement(): JQuery {\n        return this.element;\n    }\n\n    getGrid(): Grid {\n        return this.slickGrid;\n    }\n\n    getView(): RemoteView<TItem> {\n        return this.view;\n    }\n\n    getFilterStore(): FilterStore {\n        return (this.filterBar == null) ? null : this.filterBar.get_store();\n    }\n}\n", "\uFEFFimport { Column } from \"@serenity-is/sleekgrid\";\nimport { Decorators } from \"../../decorators\";\nimport { Authorization, centerDialog, Culture, htmlEncode, Router, localText, trimToNull } from \"../../q\";\nimport { QuickSearchInput } from \"../datagrid/quicksearchinput\";\nimport { TemplatedDialog } from \"../dialogs/templateddialog\";\nimport { ToolButton } from \"../widgets/toolbar\";\nimport { IDataGrid } from \"./idatagrid\";\n\n@Decorators.registerClass('Serenity.ColumnPickerDialog')\n@Decorators.resizable()\n@Decorators.responsive()\nexport class ColumnPickerDialog extends TemplatedDialog<any> {\n\n    private ulVisible: JQuery;\n    private ulHidden: JQuery;\n    private colById: { [key: string]: Column };\n\n    public allColumns: Column[];\n    public visibleColumns: string[];\n    public defaultColumns: string[];\n    public done: () => void;\n\n    constructor() {\n        super();\n\n        new QuickSearchInput(this.byId(\"Search\"), {\n            onSearch: (fld, txt, done) => {\n                txt = trimToNull(txt);\n                if (txt != null)\n                    txt = Select2.util.stripDiacritics(txt.toLowerCase());\n\n                this.element.find('li').each((x, e) => {\n                    $(e).toggle(!txt || Select2.util.stripDiacritics(\n                        $(e).text().toLowerCase()).indexOf(txt) >= 0);\n                });\n                done && done(true);\n            }\n        });\n\n        this.ulVisible = this.byId(\"VisibleCols\");\n        this.ulHidden = this.byId(\"HiddenCols\");\n        this.dialogTitle = localText(\"Controls.ColumnPickerDialog.Title\");\n    }\n\n    public static createToolButton(grid: IDataGrid): ToolButton {\n        function onClick() {\n            var picker = new ColumnPickerDialog();\n            picker.allColumns = (grid as any).allColumns;\n            if ((grid as any).initialSettings) {\n                var initialSettings = (grid as any).initialSettings;\n                if (initialSettings.columns && initialSettings.columns.length)\n                    picker.defaultColumns = initialSettings.columns.map((x: any) => x.id);\n            }\n            picker.visibleColumns = grid.getGrid().getColumns().map(x => x.id);\n            picker.done = () => {\n                (grid as any).allColumns = picker.allColumns;\n                var visible = picker.allColumns.filter(x => x.visible === true);\n                grid.getGrid().setColumns(visible);\n                Promise.resolve((grid as any).persistSettings()).then(() => grid.getView().populate());\n            };\n\n            Router && Router.dialog && Router.dialog((grid as any).element, picker.element, () => \"columns\");\n            picker.dialogOpen();\n        }\n\n        (grid as any).element.on('handleroute.' + (grid as any).uniqueName, (e: any, arg: any) => {\n            if (arg && !arg.handled && arg.route == \"columns\") {\n                onClick();\n            }\n        });\n\n        return {\n            hint: localText(\"Controls.ColumnPickerDialog.Title\"),\n            action: 'column-picker',\n            cssClass: \"column-picker-button\",\n            icon: 'fa-th-list text-blue',\n            onClick: onClick\n        }\n    }\n\n    protected getDialogButtons() {\n        return [\n            {\n                text: localText(\"Controls.ColumnPickerDialog.RestoreDefaults\"),\n                click: () => {\n                    let liByKey: { [key: string]: JQuery } = {};\n                    this.ulVisible.children().add(this.ulHidden.children()).each((x, e) => {\n                        let el = $(e);\n                        liByKey[el.data('key')] = el;\n                    });\n\n                    let last: JQuery = null;\n                    for (let id of this.defaultColumns) {\n                        let li = liByKey[id];\n                        if (!li)\n                            continue;\n\n                        if (last == null)\n                            li.prependTo(this.ulVisible);\n                        else\n                            li.insertAfter(last);\n\n                        last = li;\n                        let key: string = li.data('key');\n                        delete liByKey[key];\n                    }\n\n                    for (let key in liByKey)\n                        liByKey[key].appendTo(this.ulHidden);\n\n                    this.updateListStates();\n                }\n            },\n            {\n                text: localText(\"Dialogs.OkButton\"),\n                click: () => {\n                    let newColumns: Column[] = [];\n\n                    for (var col of this.allColumns)\n                        col.visible = false;\n\n                    this.visibleColumns = this.ulVisible.children().toArray().map(x => {\n                        let id = $(x).data(\"key\");\n                        var col = this.colById[id];\n                        col.visible = true;\n                        newColumns.push(col);\n                        return id;\n                    });\n\n                    for (var col of this.allColumns) {\n                        if (!col.visible)\n                            newColumns.push(col);\n                    }\n\n                    this.allColumns = newColumns;\n                    this.done && this.done();\n                    this.dialogClose()\n                }\n            },\n            {\n                text: localText(\"Dialogs.CancelButton\"),\n                click: () => {\n                    this.dialogClose()\n                }\n            }\n        ];\n    }\n\n    protected getDialogOptions() {\n        var opt = super.getDialogOptions();\n        opt.width = 600;\n        return opt;\n    }\n\n    private getTitle(col: Column) {\n        if (col.id == \"__select__\")\n            return \"[x]\";\n\n        return col.name || col.toolTip || col.id;\n    }\n\n    private allowHide(col: Column): boolean {\n        return col.sourceItem == null || col.sourceItem.allowHide == null || col.sourceItem.allowHide;\n    }\n\n    private createLI(col: Column): JQuery {\n        var allowHide = this.allowHide(col);\n        return $(`\n<li data-key=\"${col.id}\" class=\"${allowHide ? \"\" : \"cant-hide\"}\">\n<span class=\"drag-handle\">\u2630</span>\n${ htmlEncode(this.getTitle(col)) }\n${ allowHide ? `<i class=\"js-hide fa fa-eye-slash\" title=\"${htmlEncode(localText(\"Controls.ColumnPickerDialog.HideHint\"))}\"></i>` : '' }\n<i class=\"js-show fa fa-eye\" title=\"${ htmlEncode(localText(\"Controls.ColumnPickerDialog.ShowHint\")) }\"></i>\n</li>`);\n    }\n\n    private updateListStates() {\n        this.ulVisible.children().removeClass(\"bg-info\").addClass(\"bg-success\");\n        this.ulHidden.children().removeClass(\"bg-success\").addClass(\"bg-info\");\n    }\n\n    protected setupColumns(): void {\n        this.allColumns = this.allColumns || [];\n        this.visibleColumns = this.visibleColumns || [];\n\n        let visible: { [key: string]: boolean } = {};\n        for (let id of this.visibleColumns) {\n            visible[id] = true;\n        }\n\n        this.colById = {};\n        for (let c of this.allColumns) {\n            this.colById[c.id] = c;\n        }\n\n        if (this.defaultColumns == null)\n            this.defaultColumns = this.visibleColumns.slice(0);\n\n        let hidden: Column[] = [];\n\n        for (let c of this.allColumns) {\n            if (!visible[c.id] && (!c.sourceItem ||\n                (c.sourceItem.filterOnly !== true &&\n                    (c.sourceItem.readPermission == null || Authorization.hasPermission(c.sourceItem.readPermission))))) {\n                hidden.push(c);\n            }\n        }\n\n        let hiddenColumns = hidden.sort((a, b) => Culture.stringCompare(this.getTitle(a), this.getTitle(b)));\n\n        for (let id of this.visibleColumns) {\n            var c = this.colById[id];\n            if (!c)\n                continue;\n\n            this.createLI(c).appendTo(this.ulVisible);\n        }\n\n        for (let c of hiddenColumns) {\n            this.createLI(c).appendTo(this.ulHidden);\n        }\n\n        this.updateListStates();\n\n        // @ts-ignore\n        if (typeof Sortable !== \"undefined\" && Sortable.create) {\n\n            // @ts-ignore\n            Sortable.create(this.ulVisible[0], {\n                group: this.uniqueName + \"_group\",\n                filter: '.js-hide',\n                onFilter: (evt: any) => {\n                    $(evt.item).appendTo(this.ulHidden);\n                    this.updateListStates();\n                },\n                onMove: (x: any) => {\n                    if ($(x.dragged).hasClass('cant-hide') &&\n                        x.from == this.ulVisible[0] &&\n                        x.to !== x.from)\n                        return false;\n                    return true;\n                },\n                onEnd: (evt: any) => this.updateListStates()\n            });\n\n            // @ts-ignore\n            Sortable.create(this.ulHidden[0], {\n                group: this.uniqueName + \"_group\",\n                sort: false,\n                filter: '.js-show',\n                onFilter: (evt: any) => {\n                    $(evt.item).appendTo(this.ulVisible);\n                    this.updateListStates();\n                },\n                onEnd: () => this.updateListStates()\n            });\n        }\n    }\n\n    protected onDialogOpen(): void {\n        super.onDialogOpen();\n        this.element.find(\"input\").removeAttr(\"disabled\")\n        this.element.closest('.ui-dialog').children(\".ui-dialog-buttonpane\")\n            .find('button').eq(0).addClass(\"restore-defaults\")\n            .next().focus();\n\n        this.setupColumns();\n        centerDialog(this.element);\n    }\n\n    protected getTemplate() {\n        return `\n<div class=\"search\"><input id=\"~_Search\" type=\"text\" disabled /></div>\n<div class=\"columns-container\">\n<div class=\"column-list visible-list bg-success\">\n<h5><i class=\"fa fa-eye\"></i> ${htmlEncode(localText(\"Controls.ColumnPickerDialog.VisibleColumns\"))}</h5>\n<ul id=\"~_VisibleCols\"></ul>\n</div>\n<div class=\"column-list hidden-list bg-info\">\n<h5><i class=\"fa fa-eye-slash\"></i> ${htmlEncode(localText(\"Controls.ColumnPickerDialog.HiddenColumns\"))}</h5>\n<ul id=\"~_HiddenCols\"></ul>\n</div>\n</div>`;\n    }\n}\n", "\uFEFFimport { Column, FormatterContext } from \"@serenity-is/sleekgrid\";\nimport { htmlEncode, ListResponse, toGrouping, tryFirst } from \"../../q\";\nimport { SlickFormatting, SlickHelper, SlickTreeHelper } from \"../helpers/slickhelpers\";\nimport { DataGrid } from \"./datagrid\";\n\n/**\n * A mixin that can be applied to a DataGrid for tree functionality\n */\nexport class TreeGridMixin<TItem> {\n\n    private dataGrid: DataGrid<TItem, any>;\n    private getId: (item: TItem) => any;\n\n    constructor(private options: TreeGridMixinOptions<TItem>) {\n        var dg = this.dataGrid = options.grid;\n        var idProperty = (dg as any).getIdProperty();\n        var getId = this.getId = (item: TItem) => (item as any)[idProperty];\n\n        dg.element.find('.grid-container').on('click', e => {\n            if ($(e.target).hasClass('s-TreeToggle')) {\n                var src = dg.slickGrid.getCellFromEvent(e);\n                if (src.cell >= 0 &&\n                    src.row >= 0) {\n                    SlickTreeHelper.toggleClick<TItem>(e, src.row, src.row, dg.view, getId);\n                }\n            }\n        });\n\n        var oldViewFilter = (dg as any).onViewFilter;\n        (dg as any).onViewFilter = function (item: TItem) {\n            if (!oldViewFilter.apply(this, [item]))\n                return false;\n\n            return SlickTreeHelper.filterById(item, dg.view, options.getParentId);\n        };\n\n        var oldProcessData = (dg as any).onViewProcessData;\n        (dg as any).onViewProcessData = function (response: ListResponse<TItem>) {\n\n            response = oldProcessData.apply(this, [response]);\n            response.Entities = TreeGridMixin.applyTreeOrdering(response.Entities, getId, options.getParentId);\n            SlickTreeHelper.setIndents(response.Entities, getId, options.getParentId,\n                (options.initialCollapse && options.initialCollapse()) || false);\n            return response;\n        };\n\n        if (options.toggleField) {\n            var col = tryFirst(dg['allColumns'] || dg.slickGrid.getColumns() || [], x => x.field == options.toggleField) as Column<TItem>;\n            if (col) {\n                col.format = SlickFormatting.treeToggle(() => dg.view, getId,\n                    col.format || ((ctx: FormatterContext<TItem>) => htmlEncode(ctx.value)));\n            }\n        }\n    }\n\n    /**\n     * Expands / collapses all rows in a grid automatically\n     */\n    toggleAll(): void {\n        SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(),\n            !this.dataGrid.view.getItems().every(x => (x as any)._collapsed == true));\n\n        this.dataGrid.view.setItems(this.dataGrid.view.getItems(), true);\n    }\n\n    collapseAll(): void {\n        SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(), true);\n        this.dataGrid.view.setItems(this.dataGrid.view.getItems(), true);\n    }\n    \n    expandAll(): void {\n        SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(), false);\n        this.dataGrid.view.setItems(this.dataGrid.view.getItems(), true);\n    }\n    \n    /**\n     * Reorders a set of items so that parents comes before their children.\n     * This method is required for proper tree ordering, as it is not so easy to perform with SQL.\n     * @param items list of items to be ordered\n     * @param getId a delegate to get ID of a record (must return same ID with grid identity field)\n     * @param getParentId a delegate to get parent ID of a record\n     */\n    static applyTreeOrdering<TItem>(items: TItem[], getId: (item: TItem) => any, getParentId: (item: TItem) => any): TItem[] {\n        var result: TItem[] = [];\n\n        var byId = toGrouping(items, getId);\n        var byParentId = toGrouping(items, getParentId);\n        var visited: Record<string, boolean> = {};\n\n        function takeChildren(theParentId: any) {\n            if (visited[theParentId])\n                return;\n\n            visited[theParentId] = true;\n            for (var child of (byParentId[theParentId] || [])) {\n                result.push(child);\n                takeChildren(getId(child));\n            }\n        }\n\n        for (var item of items)\n        {\n            var parentId = getParentId(item);\n            if (parentId == null ||\n                !((byId[parentId] || []).length)) {\n                result.push(item);\n                takeChildren(getId(item));\n            }\n        }\n\n        return result;\n    }\n}\n\nexport interface TreeGridMixinOptions<TItem> {\n    // data grid object\n    grid: DataGrid<TItem, any>;\n    // a function to get parent id\n    getParentId: (item: TItem) => any;\n    // where should the toggle button be placed\n    toggleField: string;\n    // a delegate that should return initial collapsing state\n    initialCollapse?: () => boolean;\n}\n", "\uFEFFimport { Column, FormatterContext, Grid, GridOptions } from \"@serenity-is/sleekgrid\"\nimport { Decorators } from \"../../decorators\";\nimport { IGetEditValue, IReadOnly, ISetEditValue } from \"../../interfaces\";\nimport { Culture, getLookup, htmlEncode, isEmptyOrNull, ListResponse, Lookup, PropertyItem, ScriptData, trimToNull, tryGetText } from \"../../q\";\nimport { ReflectionUtils } from \"../../types/reflectionutils\";\nimport { DataGrid } from \"../datagrid/datagrid\";\nimport { GridSelectAllButtonHelper, GridUtils, SlickFormatting, SlickTreeHelper } from \"../helpers/slickhelpers\";\nimport { ToolButton } from \"../widgets/toolbar\";\nimport { Widget } from \"../widgets/widget\";\nimport { CascadedWidgetLink } from \"./cascadedwidgetlink\";\nimport { EditorUtils } from \"./editorutils\";\n\nexport interface CheckTreeItem<TSource> {\n    isSelected?: boolean;\n    hideCheckBox?: boolean;\n    isAllDescendantsSelected?: boolean;\n    id?: string;\n    text?: string;\n    parentId?: string;\n    children?: CheckTreeItem<TSource>[];\n    source?: TSource;\n}\n\n@Decorators.registerEditor('Serenity.CheckTreeEditor', [IGetEditValue, ISetEditValue, IReadOnly])\n@Decorators.element(\"<div/>\")\nexport class CheckTreeEditor<TItem extends CheckTreeItem<any>, TOptions> extends DataGrid<TItem, TOptions>\n    implements IGetEditValue, ISetEditValue, IReadOnly {\n\n    private byId: { [key: string]: TItem };\n\n    constructor(div: JQuery, opt?: TOptions) {\n        super(div, opt);\n\n        div.addClass('s-CheckTreeEditor');\n        this.updateItems();\n    }\n\n    protected getIdProperty() {\n        return \"id\";\n    }\n\n    protected getTreeItems(): TItem[] {\n        return [];\n    }\n\n    protected updateItems(): void {\n        var items = this.getTreeItems();\n        var itemById: Record<any, TItem> = {};\n        for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            item.children = [];\n            if (!isEmptyOrNull(item.id)) {\n                itemById[item.id] = item;\n            }\n            if (!isEmptyOrNull(item.parentId)) {\n                var parent = itemById[item.parentId];\n                if (parent != null) {\n                    parent.children.push(item);\n                }\n            }\n        }\n        this.view.addData({ Entities: items, Skip: 0, Take: 0, TotalCount: items.length });\n        this.updateSelectAll();\n        this.updateFlags();\n    }\n\n    getEditValue(property: PropertyItem, target: any): void {\n        if (this.getDelimited())\n            target[property.name] = this.get_value().join(\",\");\n        else\n            target[property.name] = this.get_value();\n    }\n\n    setEditValue(source: any, property: PropertyItem): void {\n        var value = source[property.name];\n        this.set_value(value);\n    }\n\n    protected getButtons(): ToolButton[] {\n        var selectAllText = this.getSelectAllText();\n        if (isEmptyOrNull(selectAllText)) {\n            return null;\n        }\n\n        var self = this;\n        var buttons: ToolButton[] = [];\n        buttons.push(GridSelectAllButtonHelper.define(function () {\n            return self;\n        }, function (x) {\n            return x.id;\n        }, function (x1) {\n            return x1.isSelected;\n        }, (x2, v) => {\n            if (x2.isSelected !== v) {\n                x2.isSelected = v;\n                this.itemSelectedChanged(x2);\n            }\n        }, null, () => {\n            this.updateFlags();\n        }));\n\n        return buttons;\n    }\n\n    protected itemSelectedChanged(item: TItem): void {\n    }\n\n    protected getSelectAllText(): string {\n        return tryGetText('Controls.CheckTreeEditor.SelectAll') ?? 'Select All';\n    }\n\n    protected isThreeStateHierarchy(): boolean {\n        return false;\n    }\n\n    protected createSlickGrid(): Grid {\n        this.element.addClass('slick-no-cell-border').addClass('slick-no-odd-even');\n        var result = super.createSlickGrid();\n        this.element.addClass('slick-hide-header');\n        result.resizeCanvas();\n        return result;\n    }\n\n    protected onViewFilter(item: TItem): boolean {\n        if (!super.onViewFilter(item)) {\n            return false;\n        }\n\n        var items = this.view.getItems();\n        var self = this;\n        return SlickTreeHelper.filterCustom(item, function (x) {\n            if (x.parentId == null) {\n                return null;\n            }\n\n            if (self.byId == null) {\n                self.byId = {};\n                for (var i = 0; i < items.length; i++) {\n                    var o = items[i];\n                    if (o.id != null) {\n                        self.byId[o.id] = o;\n                    }\n                }\n            }\n\n            return self.byId[x.parentId];\n        });\n    }\n\n    protected getInitialCollapse(): boolean {\n        return false;\n    }\n\n    protected onViewProcessData(response: ListResponse<TItem>): ListResponse<TItem> {\n        response = super.onViewProcessData(response);\n        this.byId = null;\n        SlickTreeHelper.setIndents(response.Entities, function (x) {\n            return x.id;\n        }, function (x1) {\n            return x1.parentId;\n        }, this.getInitialCollapse());\n        return response;\n    }\n\n    protected onClick(e: JQueryEventObject, row: number, cell: number): void {\n        super.onClick(e, row, cell);\n\n        if (!e.isDefaultPrevented()) {\n            SlickTreeHelper.toggleClick(e, row, cell, this.view, function (x) {\n                return x.id;\n            });\n        }\n\n        if (e.isDefaultPrevented()) {\n            return;\n        }\n\n        var target = $(e.target);\n        if (target.hasClass('check-box')) {\n            e.preventDefault();\n\n            if (this._readOnly)\n                return;\n\n            var checkedOrPartial = target.hasClass('checked') || target.hasClass('partial');\n            var item = this.itemAt(row);\n            var anyChanged = item.isSelected !== !checkedOrPartial;\n            this.view.beginUpdate();\n            try {\n                if (item.isSelected !== !checkedOrPartial) {\n                    item.isSelected = !checkedOrPartial;\n                    this.view.updateItem(item.id, item);\n                    this.itemSelectedChanged(item);\n                }\n                anyChanged = this.setAllSubTreeSelected(item, item.isSelected) || anyChanged;\n                this.updateSelectAll();\n                this.updateFlags();\n            }\n            finally {\n                this.view.endUpdate();\n            }\n            if (anyChanged) {\n                this.element.triggerHandler('change');\n            }\n        }\n    }\n\n    protected updateSelectAll(): void {\n        GridSelectAllButtonHelper.update(this, function (x) {\n            return x.isSelected;\n        });\n    }\n\n    protected updateFlags(): void {\n        var view = this.view;\n        var items = view.getItems();\n        var threeState = this.isThreeStateHierarchy();\n        if (!threeState) {\n            return;\n        }\n        view.beginUpdate();\n        try {\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i];\n                if (item.children == null || item.children.length === 0) {\n                    var allsel = this.getDescendantsSelected(item);\n                    if (allsel !== item.isAllDescendantsSelected) {\n                        item.isAllDescendantsSelected = allsel;\n                        view.updateItem(item.id, item);\n                    }\n                    continue;\n                }\n                var allSelected = this.allDescendantsSelected(item);\n                var selected = allSelected || this.anyDescendantsSelected(item);\n                if (allSelected !== item.isAllDescendantsSelected || selected !== item.isSelected) {\n                    var selectedChange = item.isSelected !== selected;\n                    item.isAllDescendantsSelected = allSelected;\n                    item.isSelected = selected;\n                    view.updateItem(item.id, item);\n                    if (selectedChange) {\n                        this.itemSelectedChanged(item);\n                    }\n                }\n            }\n        }\n        finally {\n            view.endUpdate();\n        }\n    }\n\n    protected getDescendantsSelected(item: TItem): boolean {\n        return true;\n    }\n\n    protected setAllSubTreeSelected(item: TItem, selected: boolean): boolean {\n        var result = false;\n        for (var i = 0; i < item.children.length; i++) {\n            var sub = item.children[i];\n            if (sub.isSelected !== selected) {\n                result = true;\n                sub.isSelected = selected;\n                this.view.updateItem(sub.id, sub as TItem);\n                this.itemSelectedChanged(sub as TItem);\n            }\n            if (sub.children.length > 0) {\n                result = this.setAllSubTreeSelected(sub as TItem, selected) || result;\n            }\n        }\n        return result;\n    }\n\n    protected allItemsSelected() {\n        for (var i = 0; i < this.rowCount(); i++) {\n            var row = this.itemAt(i);\n            if (!row.isSelected) {\n                return false;\n            }\n        }\n\n        return this.rowCount() > 0;\n    }\n\n    protected allDescendantsSelected(item: TItem): boolean {\n        if (item.children.length > 0) {\n            for (var i = 0; i < item.children.length; i++) {\n                var sub = item.children[i];\n                if (!sub.isSelected) {\n                    return false;\n                }\n\n                if (!this.allDescendantsSelected(sub as TItem)) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n\n    protected getDelimited() {\n        return !!!!(this.options as any)['delimited'];\n    }\n\n    protected anyDescendantsSelected(item: TItem): boolean {\n        if (item.children.length > 0) {\n            for (var i = 0; i < item.children.length; i++) {\n                var sub = item.children[i];\n                if (sub.isSelected) {\n                    return true;\n                }\n                if (this.anyDescendantsSelected(sub as TItem)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n\n    protected getColumns(): Column[] {\n        var self = this;\n        var columns: Column[] = [];\n        columns.push({\n            field: 'text', name: 'Kay\u0131t', width: 80, format: SlickFormatting.treeToggle(function () {\n                return self.view;\n            }, function (x) {\n                return x.id;\n            }, ctx => {\n                var cls = 'check-box';\n                var item = ctx.item;\n                if (item.hideCheckBox) {\n                    return this.getItemText(ctx);\n                }\n                var threeState = this.isThreeStateHierarchy();\n                if (item.isSelected) {\n                    if (threeState && !item.isAllDescendantsSelected) {\n                        cls += ' partial';\n                    }\n                    else {\n                        cls += ' checked';\n                    }\n                }\n                if (this._readOnly)\n                    cls += ' readonly';\n                return '<span class=\"' + cls + '\"></span>' + this.getItemText(ctx);\n            })\n        });\n        return columns;\n    }\n\n    protected getItemText(ctx: FormatterContext): string {\n        return htmlEncode(ctx.value);\n    }\n\n    protected getSlickOptions(): GridOptions {\n        var opt = super.getSlickOptions();\n        opt.forceFitColumns = true;\n        return opt;\n    }\n\n    protected sortItems(): void {\n        if (!this.moveSelectedUp()) {\n            return;\n        }\n        var oldIndexes: Record<string, number> = {};\n        var list = this.view.getItems();\n        var i = 0;\n        for (var $t1 = 0; $t1 < list.length; $t1++) {\n            var x = list[$t1];\n            oldIndexes[x.id] = i++;\n        }\n        list.sort(function (x1, y) {\n            if (x1.isSelected && !y.isSelected) {\n                return -1;\n            }\n            if (y.isSelected && !x1.isSelected) {\n                return 1;\n            }\n            var c = Culture.stringCompare(x1.text, y.text);\n            if (c !== 0) {\n                return c;\n            }\n            return oldIndexes[x1.id] < oldIndexes[y.id] ? -1 : (oldIndexes[x1.id] > oldIndexes[y.id] ? 1 : 0);\n        });\n\n        this.view.setItems(list, true);\n    }\n\n    protected moveSelectedUp(): boolean {\n        return false;\n    }\n\n    private _readOnly: boolean;\n\n    public get_readOnly() {\n        return this._readOnly;\n    }\n\n    public set_readOnly(value: boolean) {\n        if (!!this._readOnly != !!value) {\n            this._readOnly = !!value;\n            this.view.refresh();\n        }\n    }\n\n    private get_value(): string[] {\n        var list = [];\n        var items = this.view.getItems();\n        for (var i = 0; i < items.length; i++) {\n            if (items[i].isSelected) {\n                list.push(items[i].id);\n            }\n        }\n        return list;\n    }\n\n    public get value() {\n        return this.get_value();\n    }\n\n    private set_value(value: string | string[]) {\n\n        var selected: Record<string, boolean> = {};\n        if (value != null) {\n            if (typeof value == \"string\") {\n                value = value.split(',')\n                    .map(x => trimToNull(x))\n                    .filter(x => x != null);\n            }\n\n            for (var i = 0; i < value.length; i++) {\n                selected[value[i]] = true;\n            }\n        }\n\n        this.view.beginUpdate();\n        try {\n            var items = this.view.getItems();\n            for (var i1 = 0; i1 < items.length; i1++) {\n                var item = items[i1];\n                var select = selected[item.id];\n                if (select !== item.isSelected) {\n                    item.isSelected = select;\n                    this.view.updateItem(item.id, item);\n                }\n            }\n            this.updateSelectAll();\n            this.updateFlags();\n            this.sortItems();\n        }\n        finally {\n            this.view.endUpdate();\n        }\n    }\n\n    public set value(v: string[]) {\n        this.set_value(v);\n    }\n}\n\nexport interface CheckLookupEditorOptions {\n    lookupKey?: string;\n    checkedOnTop?: boolean;\n    showSelectAll?: boolean;\n    hideSearch?: boolean;\n    delimited?: boolean;\n    cascadeFrom?: string;\n    cascadeField?: string;\n    cascadeValue?: any;\n    filterField?: string;\n    filterValue?: any;\n}\n\n@Decorators.registerEditor(\"Serenity.CheckLookupEditor\")\nexport class CheckLookupEditor<TItem = any> extends CheckTreeEditor<CheckTreeItem<TItem>, CheckLookupEditorOptions> {\n\n    private searchText: string;\n    private enableUpdateItems: boolean;\n\n    constructor(div: JQuery, options: CheckLookupEditorOptions) {\n        super(div, options);\n\n        this.enableUpdateItems = true;\n        this.setCascadeFrom(this.options.cascadeFrom);\n        this.updateItems();\n        ScriptData.bindToChange('Lookup.' + this.getLookupKey(), this.uniqueName,\n            () => this.updateItems());\n    }\n\n    protected updateItems() {\n        if (this.enableUpdateItems)\n            super.updateItems();\n    }\n\n    protected getLookupKey() {\n        return this.options.lookupKey;\n    }\n\n    protected getButtons(): ToolButton[] {\n        return super.getButtons() ?? (this.options.hideSearch ? null : []);\n    }\n\n    protected createToolbarExtensions() {\n        super.createToolbarExtensions();\n\n        GridUtils.addQuickSearchInputCustom(this.toolbar.element, (field, text) => {\n            this.searchText = Select2.util.stripDiacritics(text || '').toUpperCase();\n            this.view.setItems(this.view.getItems(), true);\n        });\n    }\n\n    protected getSelectAllText(): string {\n        if (!this.options.showSelectAll)\n            return null;\n\n        return super.getSelectAllText();\n    }\n\n    protected cascadeItems(items: TItem[]) {\n\n        var val = this.get_cascadeValue();\n\n        if (val == null || val === '') {\n\n            if (!isEmptyOrNull(this.get_cascadeField())) {\n                return [];\n            }\n\n            return items;\n        }\n\n        var key = val.toString();\n        var fld = this.get_cascadeField();\n\n        return items.filter(x => {\n            var itemKey = (x as any)[fld] ?? ReflectionUtils.getPropertyValue(x, fld);\n            return !!(itemKey != null && itemKey.toString() === key);\n        });\n    }\n\n    protected filterItems(items: TItem[]) {\n        var val = this.get_filterValue();\n\n        if (val == null || val === '') {\n            return items;\n        }\n\n        var key = val.toString();\n        var fld = this.get_filterField();\n\n        return items.filter(x => {\n            var itemKey = (x as any)[fld] ?? ReflectionUtils.getPropertyValue(x, fld);\n            return !!(itemKey != null && itemKey.toString() === key);\n        });\n    }\n\n    protected getLookupItems(lookup: Lookup<TItem>): TItem[] {\n        return this.filterItems(this.cascadeItems(lookup.items));\n    }\n\n    protected getTreeItems() {\n        var lookup = getLookup<TItem>(this.options.lookupKey);\n        var items = this.getLookupItems(lookup);\n        return items.map(item => <CheckTreeItem<TItem>>{\n            id: ((item as any)[lookup.idField] ?? \"\").toString(),\n            text: ((item as any)[lookup.textField] ?? \"\").toString(),\n            source: item\n        });\n    }\n\n    protected onViewFilter(item: CheckTreeItem<TItem>) {\n        return super.onViewFilter(item) &&\n            (isEmptyOrNull(this.searchText) ||\n                Select2.util.stripDiacritics(item.text || '')\n                    .toUpperCase().indexOf(this.searchText) >= 0);\n    }\n\n    protected moveSelectedUp(): boolean {\n        return this.options.checkedOnTop;\n    }\n\n    protected get_cascadeFrom(): string {\n        return this.options.cascadeFrom;\n    }\n\n    get cascadeFrom(): string {\n        return this.get_cascadeFrom();\n    }\n\n    protected getCascadeFromValue(parent: Widget<any>) {\n        return EditorUtils.getValue(parent);\n    }\n\n    protected cascadeLink: CascadedWidgetLink<Widget<any>>;\n\n    protected setCascadeFrom(value: string) {\n\n        if (isEmptyOrNull(value)) {\n            if (this.cascadeLink != null) {\n                this.cascadeLink.set_parentID(null);\n                this.cascadeLink = null;\n            }\n            this.options.cascadeFrom = null;\n            return;\n        }\n\n        this.cascadeLink = new CascadedWidgetLink<Widget<any>>(Widget, this, p => {\n            this.set_cascadeValue(this.getCascadeFromValue(p));\n        });\n\n        this.cascadeLink.set_parentID(value);\n        this.options.cascadeFrom = value;\n    }\n\n    protected set_cascadeFrom(value: string) {\n        if (value !== this.options.cascadeFrom) {\n            this.setCascadeFrom(value);\n            this.updateItems();\n        }\n    }\n\n    set cascadeFrom(value: string) {\n        this.set_cascadeFrom(value);\n    }\n\n    protected get_cascadeField() {\n        return (this.options.cascadeField ?? this.options.cascadeFrom);\n    }\n\n    get cascadeField(): string {\n        return this.get_cascadeField();\n    }\n\n    protected set_cascadeField(value: string) {\n        this.options.cascadeField = value;\n    }\n\n    set cascadeField(value: string) {\n        this.set_cascadeField(value);\n    }\n\n    protected get_cascadeValue(): any {\n        return this.options.cascadeValue;\n    }\n\n    get cascadeValue(): any {\n        return this.get_cascadeValue();\n    }\n\n    protected set_cascadeValue(value: any) {\n        if (this.options.cascadeValue !== value) {\n            this.options.cascadeValue = value;\n            this.value = [];\n            this.updateItems();\n        }\n    }\n\n    set cascadeValue(value: any) {\n        this.set_cascadeValue(value);\n    }\n\n    protected get_filterField() {\n        return this.options.filterField;\n    }\n\n    get filterField(): string {\n        return this.get_filterField();\n    }\n\n    protected set_filterField(value: string) {\n        this.options.filterField = value;\n    }\n\n    set filterField(value: string) {\n        this.set_filterField(value);\n    }\n\n    protected get_filterValue(): any {\n        return this.options.filterValue;\n    }\n\n    get filterValue(): any {\n        return this.get_filterValue();\n    }\n\n    protected set_filterValue(value: any) {\n        if (this.options.filterValue !== value) {\n            this.options.filterValue = value;\n            this.value = null;\n            this.updateItems();\n        }\n    }\n\n    set filterValue(value: any) {\n        this.set_filterValue(value);\n    }\n}", "\uFEFFimport { Decorators, DialogTypeAttribute, DisplayNameAttribute, EntityTypeAttribute, ItemNameAttribute, ServiceAttribute } from \"../../decorators\";\nimport { IEditDialog } from \"../../interfaces\";\nimport { Authorization, endsWith, format, getInstanceType, getTypeFullName, HandleRouteEventArgs, isEmptyOrNull, LT, replaceAll, resolveUrl, Router, safeCast, localText, tryGetText } from \"../../q\";\nimport { RemoteViewOptions } from \"../../slick\";\nimport { DialogTypeRegistry } from \"../../types/dialogtyperegistry\";\nimport { EditorUtils } from \"../editors/editorutils\";\nimport { SubDialogHelper } from \"../helpers/subdialoghelper\";\nimport { ToolButton } from \"../widgets/toolbar\";\nimport { Widget, WidgetDialogClass } from \"../widgets/widget\";\nimport { ColumnPickerDialog } from \"./columnpickerdialog\";\nimport { DataGrid } from \"./datagrid\";\nimport $ from \"@optionaldeps/jquery\"\n\n@Decorators.registerClass('Serenity.EntityGrid')\nexport class EntityGrid<TItem, TOptions> extends DataGrid<TItem, TOptions> {\n\n    constructor(container: JQuery, options?: TOptions) {\n        super(container, options);\n\n        this.element.addClass('route-handler')\n            .on('handleroute.' + this.uniqueName, (_, args: any) => this.handleRoute(args));\n    }\n\n    protected handleRoute(args: HandleRouteEventArgs): void {\n        if (!!args.handled)\n            return;\n\n        if (!!(args.route === 'new')) {\n            args.handled = true;\n            this.addButtonClick();\n            return;\n        }\n\n        var oldRequests = ($ as any)?.[\"active\"];\n\n        var parts = args.route.split('/');\n        if (!!(parts.length === 2 && parts[0] === 'edit')) {\n            args.handled = true;\n            this.editItem(decodeURIComponent(parts[1]));\n        }\n        else if (!!(parts.length === 2 && parts[1] === 'new')) {\n            args.handled = true;\n            this.editItemOfType(parts[0], null);\n        }\n        else if (!!(parts.length === 3 && parts[1] === 'edit')) {\n            args.handled = true;\n            this.editItemOfType(parts[0], decodeURIComponent(parts[2]));\n        }\n        else\n            return;\n\n        if (($ as any)?.[\"active\"] > oldRequests && args.handled && args.index >= 0 && args.index < args.parts.length - 1) {\n            $(document).one('ajaxStop', () => {\n                setTimeout(() => Router.resolve('#' + args.parts.join('/+/')), 1);\n            });\n        }\n    }\n\n    protected usePager(): boolean {\n        return true;\n    }\n\n    protected createToolbarExtensions(): void {\n        this.createIncludeDeletedButton();\n        this.createQuickSearchInput();\n    }\n\n    protected getInitialTitle(): string {\n        return this.getDisplayName();\n    }\n\n    protected getLocalTextPrefix(): string {\n        var result = super.getLocalTextPrefix();\n\n        if (result != null ||\n            this.getRowDefinition())\n            return result;\n            \n        return this.getEntityType();\n    }\n\n    private _entityType: string;\n\n    protected getEntityType(): string {\n        if (this._entityType != null)\n            return this._entityType;\n\n        var attr = this.attrs(EntityTypeAttribute);\n\n        if (attr.length === 1) {\n            return (this._entityType = attr[0].value);\n        }\n\n        var name = getTypeFullName(getInstanceType(this));\n\n        var px = name.indexOf('.');\n        if (px >= 0) {\n            name = name.substring(px + 1);\n        }\n\n        if (endsWith(name, 'Grid')) {\n            name = name.substr(0, name.length - 4);\n        }\n        else if (endsWith(name, 'SubGrid')) {\n            name = name.substr(0, name.length - 7);\n        }\n\n        this._entityType = name;\n\n        return this._entityType;\n    }\n\n    private _displayName: string;\n\n    protected getDisplayName(): string {\n        if (this._displayName != null)\n            return this._displayName;\n\n        var attr = this.attrs(DisplayNameAttribute);\n        if (attr.length >= 1) {\n            this._displayName = attr[0].displayName;\n            this._displayName = LT.getDefault(this._displayName, this._displayName);\n        }\n        else {\n            this._displayName = tryGetText(this.getLocalTextDbPrefix() + 'EntityPlural');\n            if (this._displayName == null)\n                this._displayName = this.getEntityType();\n        }\n\n        return this._displayName;\n    }\n\n    private _itemName: string;\n\n    protected getItemName(): string {\n        if (this._itemName != null)\n            return this._itemName;\n\n        var attr = this.attrs(ItemNameAttribute);\n        if (attr.length >= 1) {\n            this._itemName = attr[0].value;\n            this._itemName = LT.getDefault(this._itemName, this._itemName);\n        }\n        else {\n            this._itemName = tryGetText(this.getLocalTextDbPrefix() + 'EntitySingular');\n            if (this._itemName == null)\n                this._itemName = this.getEntityType();\n        }\n\n        return this._itemName;\n    }\n\n    protected getAddButtonCaption(): string {\n        return format(localText('Controls.EntityGrid.NewButton'), this.getItemName());\n    }\n\n    protected getButtons(): ToolButton[] {\n\n        var buttons: ToolButton[] = [];\n        buttons.push({\n            title: this.getAddButtonCaption(),\n            action: 'add',\n            cssClass: 'add-button',\n            icon: 'fa-plus-circle text-green',\n            hotkey: 'alt+n',\n            onClick: () => {\n                this.addButtonClick();\n            },\n            disabled: () => !this.hasInsertPermission() || this.readOnly\n        });\n\n        buttons.push(this.newRefreshButton(true));\n        buttons.push(ColumnPickerDialog.createToolButton(this as any));\n\n        return buttons;\n    }\n\n    protected newRefreshButton(noText?: boolean): ToolButton {\n        return {\n            title: (noText ? null : localText('Controls.EntityGrid.RefreshButton')),\n            hint: (noText ? localText('Controls.EntityGrid.RefreshButton') : null),\n            icon: 'fa-refresh text-blue',\n            action: 'refresh',\n            cssClass: 'refresh-button',\n            onClick: () => {\n                this.refresh();\n            }\n        };\n    }\n\n    protected addButtonClick(): void {\n        this.editItem(new Object());\n    }\n\n    protected editItem(entityOrId: any): void {\n        this.createEntityDialog(this.getItemType(), dlg => {\n            var dialog = safeCast(dlg, IEditDialog);\n            if (dialog != null) {\n                dialog.load(entityOrId, () => {\n                    dialog.dialogOpen(this.openDialogsAsPanel);\n                });\n\n                return;\n            }\n\n            throw new Error(\n                format(\"{0} doesn't implement IEditDialog!\",\n                    getTypeFullName(getInstanceType(dlg))));\n        });\n    }\n\n    protected editItemOfType(itemType: string, entityOrId: any): void {\n\n        if (itemType === this.getItemType()) {\n            this.editItem(entityOrId);\n            return;\n        }\n\n        this.createEntityDialog(itemType, dlg => {\n            var dialog = safeCast(dlg, IEditDialog);\n            if (dialog != null) {\n                dialog.load(entityOrId, () =>\n                    dialog.dialogOpen(this.openDialogsAsPanel));\n                return;\n            }\n\n            throw new Error(\n                format(\"{0} doesn't implement IEditDialog!\",\n                    getTypeFullName(getInstanceType(dlg))));\n        });\n    }\n\n    private _service: string;\n\n    protected getService(): string {\n        if (this._service != null)\n            return this._service;\n\n        var attr = this.attrs(ServiceAttribute);\n        if (attr.length >= 1)\n            this._service = attr[0].value;\n        else\n            this._service = replaceAll(this.getEntityType(), '.', '/');\n\n        return this._service;\n    }\n\n    protected getViewOptions(): RemoteViewOptions {\n        var opt = super.getViewOptions();\n        opt.url = resolveUrl('~/Services/' + this.getService() + '/List');\n        return opt;\n    }\n\n    protected getItemType() {\n        return this.getEntityType();\n    }\n\n    protected routeDialog(itemType: string, dialog: Widget<any>) {\n        Router && Router.dialog && Router.dialog(this.element, dialog.element, () => {\n            var hash = '';\n\n            if (itemType !== this.getItemType())\n                hash = itemType + '/';\n\n            if (!!(dialog != null && (dialog as any).entityId != null))\n                hash += 'edit/' + (dialog as any).entityId.toString();\n            else\n                hash += 'new';\n\n            return hash;\n        });\n    }\n\n    protected getInsertPermission(): string {\n        return this.getRowDefinition()?.insertPermission;\n    }\n\n    protected hasInsertPermission(): boolean {\n        var insertPermission = this.getInsertPermission();\n        return insertPermission == null || Authorization.hasPermission(this.getInsertPermission());\n    }\n\n    protected transferDialogReadOnly(dialog: Widget<any>) {\n        if (this.readOnly)\n            EditorUtils.setReadOnly(dialog, true);\n    }\n\n    protected initDialog(dialog: Widget<any>): void {\n        SubDialogHelper.bindToDataChange(dialog, this, (e, dci) => {\n            this.subDialogDataChange();\n        }, true);\n\n        this.transferDialogReadOnly(dialog);\n        this.routeDialog(this.getItemType(), dialog);\n    }\n\n    protected initEntityDialog(itemType: string, dialog: Widget<any>): void {\n        if (itemType === this.getItemType()) {\n            this.initDialog(dialog);\n            return;\n        }\n\n        SubDialogHelper.bindToDataChange(dialog, this, (e, dci) => {\n            this.subDialogDataChange();\n        }, true);\n\n        this.transferDialogReadOnly(dialog);\n        this.routeDialog(itemType, dialog);\n    }\n\n    protected createEntityDialog(itemType: string, callback?: (dlg: Widget<any>) => void): Widget<any> {\n        var dialogClass = this.getDialogTypeFor(itemType);\n        var dialog = Widget.create({\n            type: dialogClass,\n            options: this.getDialogOptionsFor(itemType),\n            init: d => {\n                this.initEntityDialog(itemType, d);\n                callback && callback(d);\n            }\n        });\n\n        return dialog;\n    }\n\n    protected getDialogOptions(): any {\n        return {};\n    }\n\n    protected getDialogOptionsFor(itemType: string): any {\n        if (itemType === this.getItemType())\n            return this.getDialogOptions();\n\n        return {};\n    }\n\n    protected getDialogTypeFor(itemType: string): { new(...args: any[]): Widget<any> } {\n\n        if (itemType === this.getItemType()) {\n            return this.getDialogType();\n        }\n\n        return DialogTypeRegistry.get(itemType) as any;\n    }\n\n    private _dialogType: WidgetDialogClass;\n\n    protected getDialogType(): { new(...args: any[]): Widget<any> } {\n\n        if (this._dialogType != null)\n            return this._dialogType;\n\n        var attr = this.attrs(DialogTypeAttribute);\n        if (attr.length >= 1)\n            this._dialogType = attr[0].value;\n        else\n            this._dialogType = DialogTypeRegistry.get(this.getEntityType());\n\n        return this._dialogType;\n    }\n}\n", "\uFEFFimport { any, Authorization, confirmDialog, DeleteRequest, DeleteResponse, endsWith, Exception, extend, format, getAttributes, getFormData, getFormDataAsync, getInstanceType, getTypeFullName, isEmptyOrNull, localText, LT, notifySuccess, PropertyItem, PropertyItemsData, replaceAll, RetrieveRequest, RetrieveResponse, safeCast, SaveRequest, SaveResponse, ScriptData, serviceCall, ServiceOptions, startsWith, tryGetText, UndeleteRequest, UndeleteResponse, validatorAbortHandler } from \"../../q\";\nimport { Decorators, EntityTypeAttribute, FormKeyAttribute, IdPropertyAttribute, IsActivePropertyAttribute, ItemNameAttribute, LocalTextPrefixAttribute, NamePropertyAttribute, ServiceAttribute } from \"../../decorators\";\nimport { IEditDialog, IReadOnly } from \"../../interfaces\";\nimport { IRowDefinition } from \"../datagrid/irowdefinition\";\nimport { EditorUtils } from \"../editors/editorutils\";\nimport { SubDialogHelper } from \"../helpers/subdialoghelper\";\nimport { TabsExtensions } from \"../helpers/tabsextensions\";\nimport { ValidationHelper } from \"../helpers/validationhelper\";\nimport { PropertyGrid, PropertyGridMode, PropertyGridOptions } from \"../widgets/propertygrid\";\nimport { Toolbar, ToolButton } from \"../widgets/toolbar\";\nimport { Widget } from \"../widgets/widget\";\nimport { TemplatedDialog } from \"./templateddialog\";\n\n@Decorators.registerClass('Serenity.EntityDialog', [IEditDialog, IReadOnly])\nexport class EntityDialog<TItem, TOptions> extends TemplatedDialog<TOptions> implements IEditDialog, IReadOnly {\n\n    protected entity: TItem;\n    protected entityId: any;\n    protected propertyItemsData: PropertyItemsData;\n    protected propertyGrid: PropertyGrid;\n\n    protected toolbar: Toolbar;\n    protected saveAndCloseButton: JQuery;\n    protected applyChangesButton: JQuery;\n    protected deleteButton: JQuery;\n    protected undeleteButton: JQuery;\n    protected cloneButton: JQuery;\n    protected editButton: JQuery;\n\n    protected localizationGrid: PropertyGrid;\n    protected localizationButton: JQuery;\n    protected localizationPendingValue: any;\n    protected localizationLastValue: any;\n\n    static defaultLanguageList: () => string[][];\n\n    constructor(opt?: TOptions) {\n        super(opt);\n\n        if (this.useAsync())\n            this.initAsync();\n        else \n            this.initSync();        \n    }\n\n    internalInit() {\n        this.initPropertyGrid();\n        this.initLocalizationGrid();\n    }\n\n    protected initSync() {\n        this.propertyItemsData = this.getPropertyItemsData();\n        this.internalInit();\n        this.afterInit();\n    }\n\n    protected async initAsync() {\n        this.propertyItemsData = await this.getPropertyItemsDataAsync();\n        this.internalInit();\n        this.afterInit();\n    }\n\n    protected afterInit() {\n    }    \n\n    protected useAsync() {\n        return false;\n    }    \n\n    destroy(): void {\n\n        if (this.propertyGrid) {\n            this.propertyGrid.destroy();\n            this.propertyGrid = null;\n        }\n\n        if (this.localizationGrid) {\n            this.localizationGrid.destroy();\n            this.localizationGrid = null;\n        }\n\n        this.undeleteButton = null;\n        this.applyChangesButton = null;\n        this.deleteButton = null;\n        this.saveAndCloseButton = null;\n        this.editButton = null;\n        this.cloneButton = null;\n        this.toolbar = null;\n\n        super.destroy();\n    }\n\n    protected get_entity(): TItem {\n        return this.entity;\n    }\n\n    protected set_entity(entity: any): void {\n        this.entity = entity || new Object();\n    }\n\n    protected get_entityId(): any {\n        return this.entityId;\n    }\n\n    protected set_entityId(value: any) {\n        this.entityId = value;\n    }\n\n    protected getEntityNameFieldValue(): any {\n        return ((this.get_entity() as any)[this.getNameProperty()] ?? '').toString();\n    }\n\n    protected getEntityTitle(): string {\n        if (!this.isEditMode()) {\n            return format(localText('Controls.EntityDialog.NewRecordTitle'), this.getEntitySingular());\n        }\n        else {\n            var titleFormat = (this.isViewMode() || this.readOnly || !this.hasSavePermission()) ?\n                localText('Controls.EntityDialog.ViewRecordTitle') : localText('Controls.EntityDialog.EditRecordTitle');\n            var title = this.getEntityNameFieldValue() ?? '';\n            return format(titleFormat,\n                this.getEntitySingular(), (isEmptyOrNull(title) ? '' : (' (' + title + ')')));\n        }\n    }\n\n    protected updateTitle(): void {\n        this.dialogTitle = this.getEntityTitle();\n    }\n\n    protected isCloneMode(): boolean {\n        return false;\n    }\n\n    protected isEditMode(): boolean {\n        return this.get_entityId() != null && !this.isCloneMode();\n    }\n\n    protected isDeleted(): boolean {\n        if (this.get_entityId() == null) {\n            return false;\n        }\n\n        var isDeletedProperty = this.getIsDeletedProperty();\n        if (isDeletedProperty) {\n            return !!(this.get_entity() as any)[isDeletedProperty];\n        }\n\n        var value = (this.get_entity() as any)[this.getIsActiveProperty()];\n        if (value == null) {\n            return false;\n        }\n\n        return value < 0;\n    }\n\n    protected isNew(): boolean {\n        return this.get_entityId() == null;\n    }\n\n    protected isNewOrDeleted(): boolean {\n        return this.isNew() || this.isDeleted();\n    }\n\n    protected getDeleteOptions(callback: (response: DeleteResponse) => void): ServiceOptions<DeleteResponse> {\n        return {};\n    }\n\n    protected deleteHandler(options: ServiceOptions<DeleteResponse>, callback: (response: DeleteResponse) => void): void {\n        serviceCall(options);\n    }\n\n    protected doDelete(callback: (response: DeleteResponse) => void): void {\n        var self = this;\n\n        var request: DeleteRequest = {\n            EntityId: this.get_entityId()\n        };\n\n        var baseOptions: ServiceOptions<DeleteResponse> = {\n            service: this.getService() + '/Delete',\n            request: request,\n            onSuccess: response => {\n                self.onDeleteSuccess(response);\n                if (callback != null) {\n                    callback(response);\n                }\n                self.element.triggerHandler('ondatachange', [{\n                    entityId: request.EntityId,\n                    entity: this.entity,\n                    type: 'delete'\n                }]);\n            }\n        };\n\n        var thisOptions = this.getDeleteOptions(callback);\n        var finalOptions = extend(baseOptions, thisOptions);\n\n        this.deleteHandler(finalOptions, callback);\n    }\n\n    protected onDeleteSuccess(response: DeleteResponse): void {\n    }\n\n    protected attrs<TAttr>(attrType: { new(...args: any[]): TAttr }): TAttr[] {\n        return getAttributes(getInstanceType(this), attrType, true);\n    }\n\n    protected getRowDefinition(): IRowDefinition {\n        return null;\n    }\n\n    private _entityType: string;\n\n    protected getEntityType(): string {\n\n        if (this._entityType != null)\n            return this._entityType;\n\n        var typeAttributes = this.attrs(EntityTypeAttribute);\n\n        if (typeAttributes.length === 1)\n            return (this._entityType = typeAttributes[0].value);\n\n        // remove global namespace\n        var name = getTypeFullName(getInstanceType(this));\n        var px = name.indexOf('.');\n        if (px >= 0)\n            name = name.substring(px + 1);\n\n        // don't like this kind of convention, make it obsolete soon...\n        if (endsWith(name, 'Dialog') || endsWith(name, 'Control'))\n            name = name.substr(0, name.length - 6);\n        else if (endsWith(name, 'Panel'))\n            name = name.substr(0, name.length - 5);\n\n        return (this._entityType = name);\n    }\n\n    private _formKey: string;\n\n    protected getFormKey(): string {\n        if (this._formKey != null)\n            return this._formKey;\n\n        var attributes = this.attrs(FormKeyAttribute);\n\n        if (attributes.length >= 1)\n            return (this._formKey = attributes[0].value);\n\n        return (this._formKey = this.getEntityType());\n    }\n\n    private _localTextDbPrefix: string;\n\n    protected getLocalTextDbPrefix(): string {\n        if (this._localTextDbPrefix != null)\n            return this._localTextDbPrefix;\n\n        this._localTextDbPrefix = this.getLocalTextPrefix() ?? '';\n\n        if (this._localTextDbPrefix.length > 0 && !endsWith(this._localTextDbPrefix, '.'))\n            this._localTextDbPrefix = 'Db.' + this._localTextDbPrefix + '.';\n\n        return this._localTextDbPrefix;\n    }\n\n    protected getLocalTextPrefix(): string {\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return rowDefinition.localTextPrefix;\n\n        var attr = this.attrs(LocalTextPrefixAttribute);\n\n        if (attr.length >= 1)\n            return attr[0].value;\n\n        return this.getEntityType();\n    }\n   \n    private _entitySingular: string;\n\n    protected getEntitySingular(): string {\n        if (this._entitySingular != null)\n            return this._entitySingular;\n\n        var attributes = this.attrs(ItemNameAttribute);\n\n        if (attributes.length >= 1) {\n            this._entitySingular = attributes[0].value;\n            this._entitySingular = LT.getDefault(this._entitySingular, this._entitySingular);\n        }\n        else {\n            var es = tryGetText(this.getLocalTextDbPrefix() + 'EntitySingular');\n            if (es == null) \n                es = this.getEntityType();\n            this._entitySingular = es;\n        }\n\n        return this._entitySingular;\n    }\n\n    private _nameProperty: string;\n\n    protected getNameProperty(): string {\n        if (this._nameProperty != null)\n            return this._nameProperty;\n\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return this._nameProperty = rowDefinition.nameProperty ?? '';\n\n        var attributes = this.attrs(NamePropertyAttribute);\n\n        if (attributes.length >= 1)\n            return this._nameProperty = attributes[0].value ?? '';\n            \n        return this._nameProperty = 'Name';\n    }\n\n    private _idProperty: string;\n\n    protected getIdProperty(): string {\n        if (this._idProperty != null)\n            return this._idProperty;\n\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return this._idProperty = rowDefinition.idProperty ?? '';\n\n        var attr = this.attrs(IdPropertyAttribute);\n        if (attr.length === 1)\n            return this._idProperty = attr[0].value ?? '';\n\n        return this._idProperty = 'ID';\n    }\n\n    private _isActiveProperty: string;\n\n    protected getIsActiveProperty(): string {\n        if (this._isActiveProperty != null)\n            return this._isActiveProperty;\n\n        var rowDefinition = this.getRowDefinition();\n        if (rowDefinition)\n            return this._isActiveProperty = rowDefinition.isActiveProperty ?? '';\n\n        var attr = this.attrs(IsActivePropertyAttribute);\n        if (attr.length === 1)\n            return this._isActiveProperty = attr[0].value ?? '';\n\n        return this._isActiveProperty = '';\n    }\n\n    protected getIsDeletedProperty(): string {\n        return this.getRowDefinition()?.isDeletedProperty;\n    }\n\n    private _service: string;\n\n    protected getService() {\n        if (this._service != null)\n            return this._service;\n\n        var attributes = this.attrs(ServiceAttribute);\n        if (attributes.length >= 1)\n            this._service = attributes[0].value;\n        else\n            this._service = replaceAll(this.getEntityType(), '.', '/');\n\n        return this._service;\n    }\n\n    load(entityOrId: any, done: () => void, fail?: (ex: Exception) => void): void {\n\n        var action = () => {\n\n            if (entityOrId == null) {\n                this.loadResponse({});\n                done && done();\n                return;\n            }\n\n            var scriptType = typeof (entityOrId);\n            if (scriptType === 'string' || scriptType === 'number') {\n                var entityId = entityOrId;\n\n                this.loadById(entityId, function (response) {\n                    if (done)\n                        window.setTimeout(done, 0);\n                }, null);\n\n                return;\n            }\n\n            var entity = entityOrId || new Object();\n            this.loadResponse({ Entity: entity });\n            done && done();\n        };\n\n        if (fail == null) {\n            action();\n            return;\n        }\n\n        try {\n            action();\n        }\n        catch (ex1) {\n            var ex = (Exception as any).wrap(ex1);\n            fail(ex);\n        }\n    }\n\n    loadNewAndOpenDialog(asPanel?: boolean): void {\n        this.loadResponse({});\n        this.dialogOpen(asPanel);\n    }\n\n    loadEntityAndOpenDialog(entity: TItem, asPanel?: boolean): void {\n        this.loadResponse({ Entity: entity });\n        this.dialogOpen(asPanel);\n    }\n\n    protected loadResponse(data: any): void {\n        data = data || {};\n        this.onLoadingData(data);\n        var entity = data.Entity || new Object();\n        this.beforeLoadEntity(entity);\n        this.loadEntity(entity);\n        this.set_entity(entity);\n        this.afterLoadEntity();\n    }\n\n    protected loadEntity(entity: TItem): void {\n        var idField = this.getIdProperty();\n\n        if (idField != null)\n            this.set_entityId((entity as any)[idField]);\n        \n        this.set_entity(entity);\n\n        if (this.propertyGrid != null) {\n            this.propertyGrid.set_mode((this.isEditMode() ?\n                PropertyGridMode.update : PropertyGridMode.insert));\n            this.propertyGrid.load(entity);\n        }\n    }\n\n    protected beforeLoadEntity(entity: TItem): void {\n        this.localizationPendingValue = null;\n        this.localizationLastValue = null;\n    }\n\n    protected afterLoadEntity(): void {\n        this.updateInterface();\n        this.updateTitle();\n    }\n\n    public loadByIdAndOpenDialog(entityId: any, asPanel?: boolean) {\n        this.loadById(entityId,\n            response => window.setTimeout(() => this.dialogOpen(asPanel), 0),\n            () => {\n                if (!this.element.is(':visible')) {\n                    this.element.remove();\n                }\n            });\n    }\n\n    protected onLoadingData(data: RetrieveResponse<TItem>): void {\n    }\n\n    protected getLoadByIdOptions(id: any, callback: (response: RetrieveResponse<TItem>) => void): ServiceOptions<RetrieveResponse<TItem>> {\n        return {};\n    }\n\n    protected getLoadByIdRequest(id: any): RetrieveRequest {\n        var request: RetrieveRequest = {};\n        request.EntityId = id;\n        return request;\n    }\n\n    protected reloadById(): void {\n        this.loadById(this.get_entityId());\n    }\n\n    loadById(id: any, callback?: (response: RetrieveResponse<TItem>) => void, fail?: () => void) {\n        var baseOptions: ServiceOptions<RetrieveResponse<TItem>> = {\n            service: this.getService() + '/Retrieve',\n            blockUI: true,\n            request: this.getLoadByIdRequest(id),\n            onSuccess: response => {\n                this.loadResponse(response);\n                callback && callback(response);\n            },\n            onCleanup: () => {\n                if (this.validator != null) {\n                    validatorAbortHandler(this.validator);\n                }\n            }\n        };\n\n        var thisOptions = this.getLoadByIdOptions(id, callback);\n        var finalOptions = extend(baseOptions, thisOptions);\n        this.loadByIdHandler(finalOptions, callback, fail);\n    }\n\n    protected loadByIdHandler(options: ServiceOptions<RetrieveResponse<TItem>>, callback: (response: RetrieveResponse<TItem>) => void, fail: () => void): void {\n        var request = serviceCall(options);\n        fail && request.fail(fail);\n    }\n\n    protected initLocalizationGrid(): void {\n        var pgDiv = this.byId('PropertyGrid');\n        if (pgDiv.length <= 0) {\n            return;\n        }\n        var pgOptions = this.getPropertyGridOptions();\n        this.initLocalizationGridCommon(pgOptions);\n    }\n\n    protected initLocalizationGridCommon(pgOptions: PropertyGridOptions) {\n        var pgDiv = this.byId('PropertyGrid');\n\n        if (!any(pgOptions.items, x => x.localizable === true))\n            return;\n\n        var localGridDiv = $('<div/>')\n            .attr('id', this.idPrefix + 'LocalizationGrid')\n            .hide().insertAfter(pgDiv);\n\n        pgOptions.idPrefix = this.idPrefix + 'Localization_';\n\n        var items: PropertyItem[] = [];\n        for (var item1 of pgOptions.items) {\n            var langs = null;\n\n            if (item1.localizable === true) {\n                var copy = extend({}, item1);\n                copy.oneWay = true;\n                copy.readOnly = true;\n                copy.required = false;\n                copy.defaultValue = null;\n                items.push(copy);\n\n                if (langs == null)\n                    langs = this.getLangs();\n\n                for (var lang of langs) {\n                    copy = extend({}, item1);\n                    copy.name = lang[0] + '$' + copy.name;\n                    copy.title = lang[1];\n                    copy.cssClass = [copy.cssClass, 'translation'].join(' ');\n                    copy.insertable = true;\n                    copy.updatable = true;\n                    copy.oneWay = false;\n                    copy.required = false;\n                    copy.localizable = false;\n                    copy.defaultValue = null;\n                    items.push(copy);\n                }\n            }\n        }\n\n        pgOptions.items = items;\n\n        this.localizationGrid = (new PropertyGrid(localGridDiv, pgOptions)).init(null);\n        localGridDiv.addClass('s-LocalizationGrid');\n    }\n\n    protected isLocalizationMode(): boolean {\n        return this.localizationButton != null && this.localizationButton.hasClass('pressed');\n    }\n\n    protected isLocalizationModeAndChanged(): boolean {\n        if (!this.isLocalizationMode()) {\n            return false;\n        }\n\n        var newValue = this.getLocalizationGridValue();\n        return JSON.stringify(this.localizationLastValue) !=  JSON.stringify(newValue);\n    }\n\n    protected localizationButtonClick(): void {\n        if (this.isLocalizationMode() && !this.validateForm()) {\n            return;\n        }\n\n        if (this.isLocalizationModeAndChanged()) {\n            var newValue = this.getLocalizationGridValue();\n            this.localizationLastValue = newValue;\n            this.localizationPendingValue = newValue;\n        }\n\n        this.localizationButton.toggleClass('pressed');\n        this.updateInterface();\n        if (this.isLocalizationMode()) {\n            this.loadLocalization();\n        }\n    }\n\n    protected getLanguages(): any[] {\n        if (EntityDialog.defaultLanguageList != null)\n            return EntityDialog.defaultLanguageList() || [];\n\n        return [];\n    }\n\n    // for compatibility with older getLanguages methods written in Saltaralle\n    private getLangs(): any {\n\n        var langsTuple = this.getLanguages();\n        var langs = safeCast(langsTuple, Array);\n        if (langs == null || langs.length === 0 ||\n            langs[0] == null || !Array.isArray(langs[0])) {\n            langs = Array.prototype.slice.call(langsTuple.map(function (x: any) {\n                return [x.item1, x.item2];\n            }));\n        }\n\n        return langs;\n    }\n\n    protected loadLocalization(): void {\n        if (this.localizationLastValue == null && this.isNew()) {\n            this.localizationGrid.load({});\n            this.setLocalizationGridCurrentValues();\n            this.localizationLastValue = this.getLocalizationGridValue();\n            return;\n        }\n\n        if (this.localizationLastValue != null) {\n            this.localizationGrid.load(this.localizationLastValue);\n            this.setLocalizationGridCurrentValues();\n            return;\n        }\n\n        var opt = <ServiceOptions<any>>{\n            service: this.getService() + '/Retrieve',\n            blockUI: true,\n            request: {\n                EntityId: this.get_entityId(),\n                ColumnSelection: 'keyOnly',\n                IncludeColumns: ['Localizations']\n            },\n            onSuccess: response => {\n                var copy = extend(new Object(), this.get_entity());\n                if (response.Localizations) {\n                    for (var language of Object.keys(response.Localizations)) {\n                        var entity = response.Localizations[language];\n                        for (var key of Object.keys(entity)) {\n                            (copy as any)[language + '$' + key] = entity[key];\n                        }\n                    }\n                }\n                \n                this.localizationGrid.load(copy);\n                this.setLocalizationGridCurrentValues();\n                this.localizationPendingValue = null;\n                this.localizationLastValue = this.getLocalizationGridValue();\n            }\n        };\n\n        serviceCall(opt);\n    }\n\n    protected setLocalizationGridCurrentValues(): void {\n        var valueByName: Record<string, any> = {};\n\n        this.localizationGrid.enumerateItems((item, widget) => {\n            if (item.name.indexOf('$') < 0 && widget.element.is(':input')) {\n                valueByName[item.name] = this.byId(item.name).val();\n                widget.element.val(valueByName[item.name]);\n            }\n        });\n\n        this.localizationGrid.enumerateItems((item1, widget1) => {\n            var idx = item1.name.indexOf('$');\n            if (idx >= 0 && widget1.element.is(':input')) {\n                var hint = valueByName[item1.name.substr(idx + 1)];\n                if (hint != null && hint.length > 0) {\n                    widget1.element.attr('title', hint).attr('placeholder', hint);\n                }\n            }\n        });\n    }\n\n    protected getLocalizationGridValue(): any {\n        var value: any = {};\n        this.localizationGrid.save(value);\n\n        for (var k of Object.keys(value)) {\n            if (k.indexOf('$') < 0) {\n                delete value[k];\n            }\n        }\n\n        return value;\n    }\n\n    protected getPendingLocalizations(): any {\n        if (this.localizationPendingValue == null) {\n            return null;\n        }\n\n        var result: { [key: string]: any } = {};\n        var idField = this.getIdProperty();\n        var langs = this.getLangs();\n\n        for (var pair of langs) {\n            var language = pair[0];\n            var entity: any = {};\n\n            if (idField != null) {\n                entity[idField] = this.get_entityId();\n            }\n\n            var prefix = language + '$';\n\n            for (var k of Object.keys(this.localizationPendingValue)) {\n                if (startsWith(k, prefix)) \n                    entity[k.substr(prefix.length)] = this.localizationPendingValue[k];\n            }\n\n            result[language] = entity;\n        }\n\n        return result;\n    }\n\n    protected initPropertyGrid(): void {\n        var pgDiv = this.byId('PropertyGrid');\n        if (pgDiv.length <= 0) {\n            return;\n        }\n        var pgOptions = this.getPropertyGridOptions();\n        this.propertyGrid = (new PropertyGrid(pgDiv, pgOptions)).init(null);\n        if (this.element.closest('.ui-dialog').hasClass('s-Flexify')) {\n            this.propertyGrid.element.children('.categories').flexHeightOnly(1);\n        }\n    }\n\n    protected getPropertyItems() {\n        return this.propertyItemsData?.items || [];\n    }\n\n    protected getPropertyItemsData(): PropertyItemsData {\n        var formKey = this.getFormKey();\n\n        if (this.getFormKey === EntityDialog.prototype.getFormKey &&\n            this.getPropertyItems !== EntityDialog.prototype.getPropertyItems &&\n            !ScriptData.canLoad('Form.' + formKey)) {\n            return {\n                items: this.getPropertyItems(),\n                additionalItems: []\n            }\n        }\n\n        if (!isEmptyOrNull(formKey)) {\n            return getFormData(formKey);\n        }\n\n        return { items: [], additionalItems: [] };\n    }\n\n    protected async getPropertyItemsDataAsync(): Promise<PropertyItemsData> {\n        var formKey = this.getFormKey();\n        if (!isEmptyOrNull(formKey)) {\n            return await getFormDataAsync(formKey);\n        }\n\n        return { items: [], additionalItems: [] };\n    }    \n\n    protected getPropertyGridOptions(): PropertyGridOptions {\n        return {\n            idPrefix: this.idPrefix,\n            items: this.getPropertyItems(),\n            mode: PropertyGridMode.insert,\n            localTextPrefix: 'Forms.' + this.getFormKey() + '.',\n            useCategories: true\n        };\n    }\n\n    protected validateBeforeSave(): boolean {\n        return true;\n    }\n\n    protected getSaveOptions(callback: (response: SaveResponse) => void): ServiceOptions<SaveResponse> {\n\n        var opt: ServiceOptions<SaveResponse> = {};\n\n        opt.service = this.getService() + '/' + (this.isEditMode() ? 'Update' : 'Create'),\n\n        opt.onSuccess = response => {\n            this.onSaveSuccess(response);\n\n            callback && callback(response);\n\n            var typ = (this.isEditMode() ? 'update' : 'create');\n\n            var ent = opt.request == null ? null : opt.request.Entity;\n            var eid: any = this.isEditMode() ? this.get_entityId() :\n                (response == null ? null : response.EntityId);\n\n            var dci = {\n                type: typ,\n                entity: ent,\n                entityId: eid\n            };\n\n            this.element.triggerHandler('ondatachange', [dci]);\n        };\n\n        opt.onCleanup = () => {\n            this.validator && validatorAbortHandler(this.validator);\n        };\n\n        opt.request = this.getSaveRequest();\n\n        return opt;\n    }\n\n    protected getSaveEntity(): TItem {\n\n        var entity: TItem = new Object() as any;\n\n        if (this.propertyGrid != null) {\n            this.propertyGrid.save(entity);\n        }\n\n        if (this.isEditMode()) {\n            var idField = this.getIdProperty();\n            if (idField != null && (entity as any)[idField] == null) {\n                (entity as any)[idField] = this.get_entityId();\n            }\n        }\n\n        return entity;\n    }\n\n    protected getSaveRequest(): SaveRequest<TItem> {\n\n        var entity = this.getSaveEntity();\n        var req: SaveRequest<TItem> = {};\n        req.Entity = entity;\n\n        if (this.isEditMode()) {\n            var idField = this.getIdProperty();\n            if (idField != null) {\n                req.EntityId = this.get_entityId();\n            }\n        }\n\n        if (this.localizationPendingValue != null) {\n            req.Localizations = this.getPendingLocalizations();\n        }\n\n        return req;\n    }\n\n    protected onSaveSuccess(response: SaveResponse): void {\n    }\n\n    protected save_submitHandler(callback: (response: SaveResponse) => void): void {\n        var options = this.getSaveOptions(callback);\n        this.saveHandler(options, callback);\n    }\n\n    protected save(callback?: (response: SaveResponse) => void): void | boolean {\n        return ValidationHelper.submit(this.byId('Form'),\n            () => this.validateBeforeSave(),\n            () => this.save_submitHandler(callback));\n    }\n\n    protected saveHandler(options: ServiceOptions<SaveResponse>,\n        callback: (response: SaveResponse) => void): void {\n        serviceCall(options);\n    }\n\n    protected initToolbar(): void {\n\n        super.initToolbar();\n\n        if (!this.toolbar)\n            return;\n\n        this.saveAndCloseButton = this.toolbar.findButton('save-and-close-button');\n        this.applyChangesButton = this.toolbar.findButton('apply-changes-button');\n        this.deleteButton = this.toolbar.findButton('delete-button');\n        this.undeleteButton = this.toolbar.findButton('undo-delete-button');\n        this.editButton = this.toolbar.findButton('edit-button');\n        this.cloneButton = this.toolbar.findButton('clone-button');\n        this.localizationButton = this.toolbar.findButton('localization-button');\n    }\n\n    protected showSaveSuccessMessage(response: SaveResponse): void {\n        notifySuccess(localText('Controls.EntityDialog.SaveSuccessMessage'), '', null);\n    }\n\n    protected getToolbarButtons(): ToolButton[] {\n        var list: ToolButton[] = [];\n\n        list.push({\n            title: localText('Controls.EntityDialog.SaveButton'),\n            action: 'save-and-close',\n            cssClass: 'save-and-close-button',\n            icon: 'fa-check-circle text-purple',\n            hotkey: 'alt+s',\n            onClick: () => {\n                this.save(response => {\n                    this.dialogClose();\n                });\n            },\n            visible: () => !this.isDeleted() && !this.isViewMode(),\n            disabled: () => !this.hasSavePermission() || this.readOnly\n        });\n\n        list.push({\n            title: '',\n            hint: localText('Controls.EntityDialog.ApplyChangesButton'),\n            action: 'apply-changes',\n            cssClass: 'apply-changes-button',\n            icon: 'fa-clipboard-check text-purple',\n            hotkey: 'alt+a',\n            onClick: () => {\n                this.save(response1 => {\n\n                    if (this.isEditMode()) {\n                        var id1 = response1.EntityId;\n                        if (id1 == null) {\n                            id1 = this.get_entityId();\n                        }\n                        this.loadById(id1);\n                    }\n                    else {\n                        this.loadById(response1.EntityId);\n                    }\n\n                    this.showSaveSuccessMessage(response1);\n                });\n            },\n            visible: () => !this.isDeleted() && !this.isViewMode(),\n            disabled: () => !this.hasSavePermission() || this.readOnly\n        });\n\n        list.push({\n            title: localText('Controls.EntityDialog.DeleteButton'),\n            cssClass: 'delete-button',\n            icon: 'fa-trash-o text-red',\n            hotkey: 'alt+x',\n            onClick: () => {\n                confirmDialog(localText('Controls.EntityDialog.DeleteConfirmation'), () => {\n                    this.doDelete(() => this.dialogClose());\n                });\n            },\n            visible: () => this.isEditMode() && !this.isDeleted() && !this.isViewMode(),\n            disabled: () => !this.hasDeletePermission() || this.readOnly\n        });\n\n        list.push({\n            title: localText('Controls.EntityDialog.UndeleteButton'),\n            action: 'undo-delete',\n            cssClass: 'undo-delete-button',\n            onClick: () => {\n                if (this.isDeleted()) {\n                    confirmDialog(localText('Controls.EntityDialog.UndeleteConfirmation'), () => {\n                        this.undelete(() => this.loadById(this.get_entityId()));\n                    });\n                }\n            },\n            visible: () => this.isEditMode() && this.isDeleted() && !this.isViewMode(),\n            disabled: () => !this.hasDeletePermission() || this.readOnly\n        });\n\n        if (this.useViewMode()) {\n            list.push({\n                title: localText('Controls.EntityDialog.EditButton'),\n                action: 'delete',\n                cssClass: 'edit-button',\n                icon: 'fa-edit',\n                onClick: () => {\n                    if (!this.isEditMode())\n                        return;\n\n                    this.editClicked = true;\n                    this.updateInterface();\n                    this.updateTitle();\n                },\n                visible: () => this.isViewMode(),\n                disabled: () => !this.hasSavePermission() || this.readOnly\n            });\n        }\n\n        list.push({\n            title: localText('Controls.EntityDialog.LocalizationButton'),\n            action: 'localization',\n            cssClass: 'localization-button',\n            onClick: () => this.localizationButtonClick()\n        });\n\n        list.push({\n            title: localText('Controls.EntityDialog.CloneButton'),\n            action: 'clone',\n            cssClass: 'clone-button',\n            icon: 'fa-clone',\n            onClick: () => {\n\n                if (!this.isEditMode()) {\n                    return;\n                }\n\n                var cloneEntity = this.getCloningEntity();\n\n                Widget.create({\n                    type: getInstanceType(this),\n                    init: w => SubDialogHelper.bubbleDataChange(\n                        SubDialogHelper.cascade(w, this.element), this, true)\n                        .loadEntityAndOpenDialog(cloneEntity, null)\n                });\n            },\n            visible: () => false,\n            disabled: () => !this.hasInsertPermission() || this.readOnly\n        });\n\n        return list;\n    }\n\n    protected getCloningEntity(): TItem {\n\n        var clone: any = new Object();\n        clone = extend(clone, this.get_entity());\n\n        var idField = this.getIdProperty();\n        if (!isEmptyOrNull(idField)) {\n            delete clone[idField];\n        }\n\n        var isActiveField = this.getIsActiveProperty();\n        if (!isEmptyOrNull(isActiveField)) {\n            delete clone[isActiveField];\n        }\n\n        var isDeletedField = this.getIsDeletedProperty();\n        if (!isEmptyOrNull(isDeletedField)) {\n            delete clone[isDeletedField];\n        }\n\n        return clone;\n    }\n\n    protected updateInterface(): void {\n\n        EditorUtils.setContainerReadOnly(this.byId('Form'), false);\n\n        var isLocalizationMode = this.isLocalizationMode();\n        var hasSavePermission = this.hasSavePermission();\n        var viewMode = this.isViewMode();\n        var readOnly = this.readOnly;\n\n        this.toolbar.updateInterface();\n\n        if (this.tabs != null) {\n            TabsExtensions.setDisabled(this.tabs, 'Log', this.isNewOrDeleted());\n        }\n\n        if (this.propertyGrid != null) {\n            this.propertyGrid.element.toggle(!isLocalizationMode);\n        }\n\n        if (this.localizationGrid != null) {\n            this.localizationGrid.element.toggle(isLocalizationMode);\n        }\n\n        if (this.localizationButton != null) {\n            this.localizationButton.toggle(this.localizationGrid != null);\n            this.localizationButton.find('.button-inner')\n                .text((this.isLocalizationMode() ?\n                    localText('Controls.EntityDialog.LocalizationBack') :\n                    localText('Controls.EntityDialog.LocalizationButton')));\n        }\n\n        if (isLocalizationMode) {\n\n            if (this.toolbar != null)\n                this.toolbar.findButton('tool-button')\n                    .not('.localization-hidden')\n                    .addClass('.localization-hidden').hide();\n\n            this.localizationButton && this.localizationButton.show();\n\n            return;\n        }\n\n        this.toolbar.findButton('localization-hidden')\n            .removeClass('localization-hidden').show();\n\n        if (!hasSavePermission || viewMode || readOnly)\n            EditorUtils.setContainerReadOnly(this.byId(\"Form\"), true);\n    }\n\n    protected getUndeleteOptions(callback?: (response: UndeleteResponse) => void): ServiceOptions<UndeleteResponse> {\n        return {}\n    }\n\n    protected undeleteHandler(options: ServiceOptions<UndeleteResponse>, callback: (response: UndeleteResponse) => void): void {\n        serviceCall(options);\n    }\n\n    protected undelete(callback?: (response: UndeleteResponse) => void): void {\n        var baseOptions: ServiceOptions<UndeleteResponse> = {};\n        baseOptions.service = this.getService() + '/Undelete';\n\n        var request: UndeleteRequest = {};\n        request.EntityId = this.get_entityId();\n\n        baseOptions.request = request;\n        baseOptions.onSuccess = response => {\n            callback && callback(response);\n            this.element.triggerHandler('ondatachange', [{\n                entityId: this.get_entityId(),\n                entity: this.entity,\n                type: 'undelete'\n            }]);\n        };\n\n        var thisOptions = this.getUndeleteOptions(callback);\n        var finalOptions = extend(baseOptions, thisOptions);\n        this.undeleteHandler(finalOptions, callback);\n    }\n\n    private _readonly: boolean;\n\n    public get readOnly(): boolean {\n        return this.get_readOnly();\n    }\n\n    public set readOnly(value: boolean) {\n        this.set_readOnly(value);\n    }\n\n    public get_readOnly() {\n        return !!this._readonly;\n    }\n\n    public set_readOnly(value: boolean) {\n        if (!!this._readonly != !!value) {\n            this._readonly = !!value;\n            this.updateInterface();\n            this.updateTitle();\n        }\n    }\n\n    protected getInsertPermission(): string {\n        return this.getRowDefinition()?.insertPermission;\n    }\n\n    protected getUpdatePermission(): string {\n        return this.getRowDefinition()?.updatePermission;\n    }\n\n    protected getDeletePermission(): string {\n        return this.getRowDefinition()?.deletePermission;\n    }\n\n    protected hasDeletePermission() {\n        var deletePermission = this.getDeletePermission();\n        return deletePermission == null || Authorization.hasPermission(deletePermission);\n    }\n\n    protected hasInsertPermission() {\n        var insertPermission = this.getInsertPermission();\n        return insertPermission == null || Authorization.hasPermission(insertPermission);\n    }\n\n    protected hasUpdatePermission() {\n        var updatePermission = this.getUpdatePermission();\n        return updatePermission == null || Authorization.hasPermission(updatePermission);\n    }\n\n    protected hasSavePermission(): boolean {\n        return this.isNew() ? this.hasInsertPermission() : this.hasUpdatePermission();\n    }\n\n    protected editClicked: boolean;\n\n    protected isViewMode() {\n        return this.useViewMode() && this.isEditMode() && !this.editClicked;\n    }\n\n    protected useViewMode() {\n        return false;\n    }\n\n    protected getFallbackTemplate() {\n        return `<div class=\"s-DialogContent\">\n    <div id=\"~_Toolbar\" class=\"s-DialogToolbar\">\n    </div>\n    <div class=\"s-Form\">\n        <form id=\"~_Form\" action=\"\">\n            <div class=\"fieldset\">\n                <div id=\"~_PropertyGrid\"></div>\n                <div class=\"clear\"></div>\n            </div>\n        </form> \n    </div>\n</div>`;\n    }\n}", "\uFEFFimport { EditorUtils } from \"../editors/editorutils\";\nimport { ReflectionOptionsSetter } from \"./reflectionoptionssetter\";\nimport { Widget, WidgetComponentProps } from \"./widget\";\n\nfunction _widgetFactory(this: any, props: any) {\n\n    var widget = Widget.create({\n        type: this,\n        element: (el$) => {\n            var el = el$[0];\n            if (props.id != null)\n                el.id = props.id;\n\n            if (props.name != null)\n                el.setAttribute('name', props.name);\n\n            if (props.placeholder != null)\n                el.setAttribute(\"placeholder\", props.placeholder);\n\n            if (props.className != null)\n                el.className = props.className;\n            else if (props.class != null)\n                el.className = props.class;\n\n            if (props.oneWay)\n                el.dataset.oneWay = \"1\";\n\n            if (props.maxLength != null)\n                el.setAttribute(\"maxLength\", props.maxLength || 0);\n            else if (props.maxlength != null)\n                el.setAttribute(\"maxLength\", props.maxlength || 0);\n        }\n    });\n\n    if (props.required != null)\n        EditorUtils.setRequired(widget, props.required);\n\n    if (props.readOnly !== null)\n        EditorUtils.setReadOnly(widget, props.readOnly);\n    else if (props.readonly !== null)\n        EditorUtils.setReadOnly(widget, props.readonly);\n\n    if (props.setOptions != props.setOptions)\n        ReflectionOptionsSetter.set(widget, props.setOptions);\n\n    if (props.value !== undefined)\n        EditorUtils.setValue(widget, props.value);\n    else if (props.initialValue != undefined)\n        EditorUtils.setValue(widget, props.initialValue);\n\n    if (props.onChange != null)\n        widget.element.on('change', props.onChange);\n    else if (props.onchange != null)\n        widget.element.on('change', props.onchange);\n\n    if (props.onChangeSelect2 != null)\n        widget.changeSelect2(props.onChangeSelect2);\n\n    if (props.ref)\n        props.ref(widget);\n\n    return widget.element[0];\n}\n\ntype JsxDomWidgetProps<P> = P & WidgetComponentProps<any> & {\n    children?: any | undefined;\n    class?: string;\n}\n\nexport interface JsxDomWidget<P = {}, TElement extends Element = HTMLElement> {\n    (props: JsxDomWidgetProps<P>, context?: any): TElement | null\n}\n\nexport function jsxDomWidget<TWidget extends Widget<TOptions>, TOptions>(\n    type: new (element: JQuery, options?: TOptions) => TWidget): JsxDomWidget<TOptions & { ref?: (r: TWidget) => void }> {\n    return _widgetFactory.bind(type);\n}\n\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { postToService, PropertyItem, serviceCall, ServiceRequest, ServiceResponse, trimToNull } from \"../../q\";\nimport { QuickSearchInput } from \"../datagrid/quicksearchinput\";\nimport { TemplatedDialog } from \"../dialogs/templateddialog\";\nimport { PropertyGrid } from \"./propertygrid\";\nimport { Widget } from \"./widget\";\n\nexport namespace Reporting {\n    export interface ReportDialogOptions {\n        reportKey?: string;\n    }\n\n    @Decorators.registerClass('Serenity.Reporting.ReportDialog')\n    export class ReportDialog extends TemplatedDialog<ReportDialogOptions> {\n        constructor(opt: ReportDialogOptions) {\n            super(opt);\n\n            if (opt.reportKey) {\n                this.loadReport(opt.reportKey);\n            }\n        }\n\n        protected propertyGrid: PropertyGrid;\n        protected propertyItems: PropertyItem[];\n        protected reportKey: string;\n\n        protected createPropertyGrid(): void {\n            if (this.propertyGrid) {\n                this.byId('PropertyGrid').html('').attr('class', '');\n                this.propertyGrid = null;\n            }\n            this.propertyGrid = (new PropertyGrid(this.byId('PropertyGrid'), {\n                idPrefix: this.idPrefix,\n                useCategories: true,\n                items: this.propertyItems\n            })).init(null);\n        }\n\n        loadReport(reportKey: string): void {\n            serviceCall({\n                service: 'Report/Retrieve', request: { ReportKey: reportKey },\n                onSuccess: (response: ReportRetrieveResponse) => {\n                    this.reportKey = response.ReportKey ?? reportKey;\n                    this.propertyItems = response.Properties || [];\n                    this.dialogTitle = response.Title;\n                    this.createPropertyGrid();\n                    var set = response.InitialSettings;\n                    if (set == null) {\n                        set = new Object();\n                    }\n                    this.propertyGrid.load(set);\n                    this.toolbar.findButton('print-preview-button').toggle(!response.IsDataOnlyReport);\n                    this.toolbar.findButton('export-pdf-button').toggle(!response.IsDataOnlyReport);\n                    this.toolbar.findButton('export-docx-button').toggle(!response.IsDataOnlyReport);\n                    this.dialogOpen(null);\n                }\n            });\n        }\n\n        executeReport(targetFrame: string, exportType: string): void {\n            if (!this.validateForm()) {\n                return;\n            }\n            var parameters = new Object();\n            this.propertyGrid.save(parameters);\n            postToService({\n                service: 'Report/Execute',\n                request: {\n                    ReportKey: this.reportKey,\n                    DesignId: 'Default',\n                    ExportType: exportType,\n                    Parameters: parameters\n                }, target: targetFrame\n            });\n\n        }\n\n        protected getToolbarButtons() {\n            var buttons = [];\n            buttons.push({\n                title: '\u00D6nizleme', cssClass: 'print-preview-button', onClick: () => {\n                    this.executeReport('_blank', null);\n                }\n            });\n            buttons.push({\n                title: 'PDF', cssClass: 'export-pdf-button', onClick: () => {\n                    this.executeReport('', 'Pdf');\n                }\n            });\n            buttons.push({\n                title: 'Excel', cssClass: 'export-xlsx-button', onClick: () => {\n                    this.executeReport('', 'Xlsx');\n                }\n            });\n            buttons.push({\n                title: 'Word', cssClass: 'export-docx-button', onClick: () => {\n                    this.executeReport('', 'Docx');\n                }\n            });\n            return buttons;\n        }\n    }\n\n    export interface ReportExecuteRequest extends ServiceRequest {\n        ExportType?: string;\n        ReportKey?: string;\n        DesignId?: string;\n        Parameters?: any;\n    }\n\n    @Decorators.registerClass('Serenity.Reporting.ReportPage')\n    export class ReportPage extends Widget<any> {\n        constructor(div: JQuery) {\n            super(div);\n\n            $('.report-link').click((e) => this.reportLinkClick(e));\n            $('div.line').click((e) => this.categoryClick(e));\n            var self = this;\n            new QuickSearchInput($('#QuickSearchInput'), {\n                onSearch: function (field, text, done) {\n                    self.updateMatchFlags(text);\n                    done(true);\n                }\n            });\n        }\n\n        protected updateMatchFlags(text: string) {\n            var liList = $('#ReportList').find('li').removeClass('non-match');\n            text = trimToNull(text);\n            if (text == null) {\n                liList.children('ul').hide();\n                liList.show().removeClass('expanded');\n                return;\n            }\n            var parts = text.replace(',', ' ').split(' ');\n            for (var i = 0; i < parts.length; i++) {\n                parts[i] = trimToNull(Select2.util.stripDiacritics(parts[i]).toUpperCase());\n            }\n            var reportItems = liList.filter('.report-item');\n            reportItems.each(function (i1, e) {\n                var x = $(e);\n                var title = Select2.util.stripDiacritics((x.text() ?? '').toUpperCase());\n                for (var $t1 = 0; $t1 < parts.length; $t1++) {\n                    var p = parts[$t1];\n                    if (p != null && !(title.indexOf(p) !== -1)) {\n                        x.addClass('non-match');\n                        break;\n                    }\n                }\n            });\n            var matchingItems = reportItems.not('.non-match');\n            var visibles = matchingItems.parents('li').add(matchingItems);\n            var nonVisibles = liList.not(visibles);\n            nonVisibles.hide().addClass('non-match');\n            visibles.show();\n            if (visibles.length <= 100) {\n                liList.children('ul').show();\n                liList.addClass('expanded');\n            }\n        }\n\n        protected categoryClick(e: JQueryEventObject) {\n            var li = $(e.target).closest('li');\n            if (li.hasClass('expanded')) {\n                li.find('ul').hide('fast');\n                li.removeClass('expanded');\n                li.find('li').removeClass('expanded');\n            }\n            else {\n                li.addClass('expanded');\n                li.children('ul').show('fast');\n                if (li.children('ul').children('li').length === 1 && !li.children('ul').children('li').hasClass('expanded')) {\n                    li.children('ul').children('li').children('.line').click();\n                }\n            }\n        }\n\n        protected reportLinkClick(e: JQueryEventObject) {\n            e.preventDefault();\n            var dialog = new ReportDialog({ reportKey: $(e.target).data('key') });\n        }\n    }\n\n    export interface ReportRetrieveRequest extends ServiceRequest {\n        ReportKey?: string;\n    }\n\n    export interface ReportRetrieveResponse extends ServiceResponse {\n        ReportKey?: string;\n        Properties?: PropertyItem[];\n        Title?: string;\n        InitialSettings?: any;\n        IsDataOnlyReport?: boolean;\n    }\n}\n", "\uFEFFimport { Decorators } from \"../../decorators\";\n\nexport interface ScriptContext {\n}\n\n@Decorators.registerClass('Serenity.ScriptContext')\nexport class ScriptContext {\n}", "\uFEFFimport { Decorators } from \"../decorators\";\n\n@Decorators.registerInterface('Serenity.IAsyncInit')\nexport class IAsyncInit {\n}", "\uFEFFimport { Widget } from \"./widget\";\n\nexport namespace WX {\n    export function getWidget<TWidget>(element: JQuery, type: any) {\n        return element.getWidget<TWidget>(type);\n    }\n\n    export var getWidgetName = Widget.getWidgetName;\n\n    export function hasOriginalEvent(e: any): boolean {\n        return !!!(typeof (e.originalEvent) === 'undefined');\n    }\n\n    export function change(widget: any, handler: any): void {\n        widget.change(handler)\n    }\n    \n    export function changeSelect2(widget: any, handler: any): void {\n        widget.changeSelect2(handler);\n    }\n\n    export function getGridField(widget: Widget<any>): JQuery {\n        return widget.getGridField();\n    }\n}\n\n", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { Widget } from \"./widget\";\nimport { LazyLoadHelper } from \"../helpers/lazyloadhelper\";\n\nexport interface GoogleMapOptions {\n    latitude?: any;\n    longitude?: any;\n    zoom?: any;\n    mapTypeId?: any;\n    markerTitle?: string;\n    markerLatitude?: any;\n    markerLongitude?: any;\n}\n\n@Decorators.registerEditor('Serenity.GoogleMap', [])\n@Decorators.element('<div/>')\nexport class GoogleMap extends Widget<GoogleMapOptions> {\n\n    private map: any;\n\n    constructor(container: JQuery, opt: GoogleMapOptions) {\n        super(container, opt);\n\n        // @ts-ignore\n        var center = new google.m ?? s.LatLng(\n            this.options.latitude  ?? 0,\n            this.options.longitude ?? 0);\n\n        var mapOpt: any = new Object();\n        mapOpt.center = center;\n        mapOpt.mapTypeId = this.options.mapTypeId ?? 'roadmap';\n        mapOpt.zoom = this.options.zoom ?? 15;\n        mapOpt.zoomControl = true;\n        // @ts-ignore\n        this.map = new google.maps.Map(container[0], mapOpt);\n\n        if (this.options.markerTitle != null) {\n            var markerOpt: any = new Object();\n\n            var lat = this.options.markerLatitude;\n            if (lat == null) {\n                lat = this.options.latitude ?? 0;\n            }\n            var lon = this.options.markerLongitude;\n            if (lon == null) {\n                lon = this.options.longitude ?? 0;\n            }\n            // @ts-ignore\n            markerOpt.position = new google.maps.LatLng(lat, lon);\n            markerOpt.map = this.map;\n            markerOpt.title = this.options.markerTitle;\n            markerOpt.animation = 2;\n            // @ts-ignore\n            new google.maps.Marker(markerOpt);\n        }\n\n        LazyLoadHelper.executeOnceWhenShown(container, () => {\n            // @ts-ignore\n            google.maps.event.trigger(this.map, 'resize', []);\n            this.map.setCenter(center);\n            // in case it wasn't visible (e.g. in dialog)\n        });\n    }\n\n    get_map(): any {\n        return this.map;\n    }\n}", "\uFEFFimport { Decorators } from \"../../decorators\";\nimport { IStringValue } from \"../../interfaces\";\nimport { isEmptyOrNull, isValue, ListRequest, ListResponse, RetrieveResponse, safeCast, serviceCall, ServiceOptions, localText, trimToNull } from \"../../q\";\nimport { ValidationHelper } from \"../helpers/validationhelper\";\nimport { Widget } from \"../widgets/widget\";\nimport { WX } from \"../widgets/wx\";\n\n@Decorators.registerEditor('Serenity.Select2AjaxEditor', [IStringValue])\n@Decorators.element('<input type=\"hidden\" />')\nexport class Select2AjaxEditor<TOptions, TItem> extends Widget<TOptions> implements IStringValue {\n    pageSize: number = 50;\n\n    constructor(hidden: JQuery, opt: TOptions) {\n        super(hidden, opt);\n\n        var emptyItemText = this.emptyItemText();\n        if (emptyItemText != null)\n            hidden.attr(\"placeholder\", emptyItemText);\n\n        hidden.select2(this.getSelect2Options());\n\n        hidden.attr(\"type\", \"text\"); // jquery validate to work\n\n        hidden.on(\"change.\" + this.uniqueName, (e, x) => {\n            if (WX.hasOriginalEvent(e) || !x) {\n                if (ValidationHelper.getValidator(hidden) != null)\n                    hidden.valid();\n            }\n        });\n    }\n\n    protected emptyItemText(): string {\n        var txt = this.element.attr('placeholder');\n        if (txt == null) {\n            txt = localText('Controls.SelectEditor.EmptyItemText');\n        }\n        return txt;\n    }\n\n    protected getService(): string {\n        throw new Error(\"Not implemented!\");\n    }\n\n    protected query(request: ListRequest, callback: (p1: ListResponse<any>) => void): void {\n        var options: ServiceOptions<any> = {\n            blockUI: false,\n            service: this.getService() + '/List',\n            request: request,\n            onSuccess: function (response) {\n                callback(response);\n            }\n        };\n        this.executeQuery(options);\n    }\n\n    protected executeQuery(options: ServiceOptions<ListResponse<any>>): void {\n        serviceCall(options);\n    }\n\n    protected queryByKey(key: string, callback: (p1: any) => void): void {\n        var options: ServiceOptions<any> = {\n            blockUI: false,\n            service: this.getService() + '/Retrieve',\n            request: { EntityId: key },\n            onSuccess: function (response) {\n                callback(response.Entity);\n            }\n        };\n        this.executeQueryByKey(options);\n    }\n\n    protected executeQueryByKey(options: ServiceOptions<RetrieveResponse<any>>): void {\n        serviceCall(options);\n    }\n\n    protected getItemKey(item: any): string {\n        return null;\n    }\n\n    protected getItemText(item: any): string {\n        return null;\n    }\n\n    protected getTypeDelay(): number {\n        return 200;\n    }\n\n    protected getSelect2Options(): Select2Options {\n        var emptyItemText = this.emptyItemText();\n        var queryTimeout = 0;\n        return {\n            minimumResultsForSearch: 10,\n            placeHolder: (!isEmptyOrNull(emptyItemText) ? emptyItemText : null),\n            allowClear: isValue(emptyItemText),\n            query: query => {\n                var request = {\n                    ContainsText: trimToNull(query.term), Skip: (query.page - 1) * this.pageSize, Take: this.pageSize + 1\n                };\n\n                if (queryTimeout !== 0) {\n                    window.clearTimeout(queryTimeout);\n                }\n\n                var select2 = $(this.element).data('select2');\n                select2 && select2.search && select2.search.removeClass('select2-active').parent().removeClass('select2-active');\n\n                queryTimeout = window.setTimeout(() => {\n                    select2 && select2.search.addClass('select2-active').parent().addClass('select2-active');\n\n                    this.query(request, response => {\n                        query.callback({\n                            results: response.Entities.slice(0, this.pageSize).map(x => {\n                                return { id: this.getItemKey(x), text: this.getItemText(x), source: x };\n                            }), more: response.Entities.length >= this.pageSize\n                        });\n                    });\n                }, this.getTypeDelay());\n\n            },\n            initSelection: (element, callback) => {\n                var val = element.val();\n                if (isEmptyOrNull(val)) {\n                    callback(null);\n                    return;\n                }\n                this.queryByKey(val, result => {\n                    callback((result == null ? null : {\n                        id: this.getItemKey(result),\n                        text: this.getItemText(result),\n                        source: result\n                    }));\n                });\n            }\n        };\n    }\n\n    protected addInplaceCreate(title: string): void {\n        var self = this;\n        $('<a><b/></a>').addClass('inplace-button inplace-create')\n            .attr('title', title).insertAfter(this.element).click(function (e) {\n                self.inplaceCreateClick(e);\n            });\n\n        this.get_select2Container().add(this.element)\n            .addClass('has-inplace-button');\n    }\n\n    protected inplaceCreateClick(e: any): void {\n    }\n\n    protected get_select2Container(): JQuery {\n        return this.element.prevAll('.select2-container');\n    }\n\n    get_value(): string {\n        return safeCast(this.element.select2('val'), String);\n    }\n\n    get value(): string {\n        return this.get_value();\n    }\n\n    set_value(value: string) {\n        if (value !== this.get_value()) {\n            var el = this.element;\n            el.select2('val', value);\n            el.data('select2-change-triggered', true);\n            try {\n                el.triggerHandler('change', [true]); // valueSet: true\n            }\n            finally {\n                el.data('select2-change-triggered', false);\n            }\n        }\n    }\n\n    set value(v: string) {\n        this.set_value(v);\n    }\n}"],
  "mappings": "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",
  "names": ["any", "array", "predicate", "count", "x", "first", "groupBy", "items", "getKey", "_a", "result", "index", "item", "key", "group", "indexOf", "i", "insert", "obj", "isArray", "single", "match", "found", "toGrouping", "lookup", "d", "tryFirst", "coalesce", "a", "b", "isValue", "today", "d", "extend", "key", "deepClone", "a2", "a3", "result", "type", "value", "kv", "getRegExpFlags", "regExp", "flags", "getTypeStore", "getStateStore", "getNested", "from", "name", "i", "globalObj", "getGlobalThis", "getType", "target", "types", "getTypeNameProp", "setTypeNameProp", "getTypeFullName", "getTypeShortName", "fullName", "bIndex", "nsIndex", "getInstanceType", "instance", "ArgumentNullException", "ex", "isAssignableFrom", "isInstanceOfType", "safeCast", "cast", "InvalidCastException", "getBaseType", "p", "ownValue", "getAttributes", "attrType", "inherit", "_a", "t", "attr", "j", "MemberType", "getMembers", "memberTypes", "members", "m", "addTypeMember", "member", "md", "ensureMetadata", "existing", "merge", "getTypes", "traverse", "s", "n", "c", "clearKeys", "delegateCombine", "delegate1", "delegate2", "targets1", "targets2", "_mkdel", "fallbackStore", "store", "Enum", "enumType", "values", "parts", "delegateContains", "targets", "object", "method", "delegate", "clone", "delegateRemove", "isEnum", "initFormType", "typ", "nameWidgetPairs", "widget", "prop", "getter", "setter", "distinct", "arr", "item", "pos", "_fieldsProxy", "_", "fieldsProxy", "keyOf", "arr1", "arr2", "interfaceIsAssignableFrom", "x", "registerType", "intf", "registerClass", "registerEditor", "addAttribute", "EditorAttribute", "registerEnum", "enumKey", "registerInterface", "ISlickFormatter", "initializeTypes", "root", "pre", "limit", "k", "obj", "Exception", "message", "paramName", "endsWith", "s", "suffix", "isEmptyOrNull", "isTrimmedEmpty", "trimToNull", "padLeft", "len", "ch", "startsWith", "prefix", "toSingleLine", "str", "replaceAll", "trimToEmpty", "trimEnd", "_a", "_b", "_c", "trimStart", "trim", "find", "replace", "zeroPad", "localText", "key", "t", "getTable", "text", "dbText", "prefix", "getStateStore", "prefixedText", "startsWith", "local", "tryGetText", "isEmptyOrNull", "textKey", "value", "dbTryText", "proxyTexts", "o", "p", "x", "y", "tv", "z", "k", "_LT", "obj", "pre", "table", "actual", "LT", "type", "$t1", "$t2", "member", "lt", "defaultText", "Q", "_a", "$", "jquery_module_default", "addEmptyOption", "select", "addOption", "localText", "key", "text", "jquery_module_default", "attrEncode", "htmlEncode", "clearOptions", "findElementWithRelativeId", "element", "relativeId", "context", "_a", "isJQuery", "from", "doc", "noContext", "fromId", "res", "idx", "esc", "escFunc", "a", "s", "newBodyDiv", "outerHtml", "toggleClass", "el", "cls", "remove", "k", "x", "initialOptions", "initialInstance", "Toastr", "options", "_a", "container", "toggleClass", "target", "create", "message", "title", "opt", "callback", "args", "toastElement", "clearOptions", "parentNode", "toastsToClear", "force", "map", "opts", "exitMap", "intervalId", "$titleElement", "$messageElement", "createdElement", "closeElement", "response", "hideToast", "override", "setAria", "ariaValue", "delayedHideToast", "stickAround", "handleEvents", "event", "setTitle", "suffix", "htmlEncode", "setMessage", "setCloseButton", "setSequence", "displayToast", "toastr2_default", "toastr2_default", "defaultNotifyOptions", "getToastrOptions", "options", "extend", "positionToastContainer", "showToast", "type", "message", "title", "container", "toast", "htmlEncode", "localText", "notifyWarning", "notifySuccess", "notifyInfo", "notifyError", "create", "dialog", "position", "Config", "pathLink", "_bootstrap", "bootstrap_module_default", "_a", "_b", "_c", "jquery_module_default", "toIconClass", "icon", "startsWith", "internalUIDialog", "options", "bodyHtml", "dialogClass", "opt", "extend", "x", "btn", "dialogButtonToUI", "e", "_isBS3", "_isBS5Plus", "isBS3", "_d", "isBS5Plus", "bootstrap_module_default", "defaultTxt", "txt", "k", "htmlEncode", "tryGetText", "bsModalMarkup", "title", "body", "modalClass", "escapeHtml", "closeButton", "div", "toggleClass", "dialogButtonToBS", "html", "iconClass", "button", "internalBSModal", "modalDiv", "footer", "rawBS5", "createButton", "_useBrowserDialogs", "useBrowserDialogs", "useBSModal", "Config", "getMessageBodyHtml", "message", "encode", "preWrap", "alertDialog", "useBS", "alert", "confirmDialog", "onYes", "confirm", "iframeDialog", "doc", "onOpen", "iframe", "settings", "informationDialog", "onOk", "information", "successDialog", "success", "warningDialog", "warning", "closePanel", "element", "el", "event", "uniqueName", "layoutEvent", "rl", "openPanel", "container", "hide", "c", "cl", "i", "ErrorHandling", "showServiceError", "error", "_a", "_b", "alertDialog", "runtimeErrorHandler", "message", "filename", "lineno", "colno", "errorInfo", "htmlEncode", "notifyError", "e", "isDevelopmentMode", "hostname", "blockUICount", "blockUIWithCheck", "opt", "_a", "jquery_module_default", "div", "blockUI", "options", "blockUndo", "_b", "getCookie", "name", "ca", "i", "xhr", "opt", "token", "serviceCall", "options", "handleError", "response", "Config", "ErrorHandling", "url", "resolveUrl", "extend", "data", "textStatus", "request", "blockUndo", "status", "ev", "l", "$t1", "json", "html", "iframeDialog", "alertDialog", "blockUI", "serviceRequest", "service", "onSuccess", "setEquality", "field", "value", "parseQueryString", "s", "qs", "result", "parts", "pair", "postToService", "form", "div", "csrfToken", "postToUrl", "k", "Invariant", "a", "b", "compareStringFactory", "order", "o", "z", "c", "i", "_len", "x", "y", "ix", "iy", "Culture", "_a", "k", "trimToNull", "sc", "turkishLocaleToLower", "turkishLocaleToUpper", "turkishLocaleCompare", "insertGroupSeperator", "num", "dec", "grp", "neg", "decPart", "decIndex", "negative", "startsWith", "groupSize", "index", "s", "done", "length", "startIndex", "part", "_formatRE", "_formatString", "format", "l", "values", "from", "m", "value", "formatSpec", "formatIndex", "_formatObject", "prm", "localeFormat", "obj", "fmt", "formatNumber", "formatDate", "round", "d", "rounding", "sign", "f", "trunc", "decOrLoc", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "precision", "fs", "padLeft", "symbol", "prefix", "mid", "suffix", "endPrefix", "inQuote", "r", "dp", "df", "roundNumber", "dv", "ds", "ones", "of", "op", "oneText", "gl", "gc", "padStart", "padLen", "pos", "pc", "parseInteger", "trim", "ts", "parseDecimal", "power", "toId", "id", "_dateFormatRE", "locale", "_i", "_j", "_k", "_l", "date", "parseDate", "re", "sb", "match", "formatDayHourAndMin", "days", "txt", "mins", "zeroPad", "formatISODateTimeUTC", "zeropad", "str", "secs", "isoRegexp", "parseISODateTime", "parseHourAndMin", "v", "h", "parseDayHourAndMin", "p", "hm", "dateOrder", "datePart", "dArray", "splitDateString", "fullYear", "shortYearCutoff", "e", "getHash", "key", "reload", "k", "stateStore", "getStateStore", "trimToNull", "regs", "ScriptData", "setHash", "value", "getLoadedData", "name", "setLoadedData", "bindToChange", "regClass", "onChange", "e", "s", "triggerChange", "unbindFromChange", "loadOptions", "async", "_a", "resolveUrl", "text", "data", "textStatus", "jqXHR", "xhr", "errorThrown", "isLookup", "startsWith", "notifyError", "html", "iframeDialog", "alertDialog", "loadScriptPromises", "loadScriptAsync", "promise", "options", "blockUI", "blockUndo", "loadScriptData", "loadScriptDataAsync", "__async", "loadError", "message", "format", "ensure", "ensureAsync", "reloadAsync", "canLoad", "setRegisteredScripts", "scripts", "t", "set", "getRemoteData", "getRemoteDataAsync", "getLookup", "getLookupAsync", "reloadLookup", "reloadLookupAsync", "getColumns", "getColumnsData", "getColumnsAsync", "getColumnsDataAsync", "getForm", "getFormData", "getFormAsync", "getFormDataAsync", "getTemplate", "getTemplateAsync", "canLoadScriptData", "exported", "Q", "i", "andOrRegex", "Authorization", "hasPermission", "permission", "ud", "isPermissionInSet", "hasPermissionAsync", "__async", "permissionSet", "orParts", "r", "andParts", "anyFalse", "n", "validatePermission", "notifyError", "localText", "validatePermissionAsync", "_a", "_b", "getRemoteData", "getRemoteDataAsync", "debounce", "func", "wait", "immediate", "timeout", "args", "context", "timestamp", "result", "later", "last", "debounced", "LayoutTimer", "timeout", "nextKey", "regCount", "regs", "startTimer", "onTimeout", "clearTimer", "key", "reg", "el", "w", "h", "e", "store", "trigger", "onSizeChange", "element", "handler", "width", "height", "onWidthChange", "onHeightChange", "onShown", "off", "executeOnceWhenVisible", "callback", "timer", "executeEverytimeWhenVisible", "callNowIfVisible", "Router", "oldURL", "resolving", "autoinc", "ignoreHash", "ignoreTime", "isEqual", "url1", "url2", "navigate", "hash", "tryBack", "silent", "newURL", "ignoreChange", "prior", "replace", "replaceLast", "current", "parts", "visibleDialogs", "jquery_module_default", "a", "b", "dialogOpen", "owner", "element", "route", "isDialog", "dialog", "value", "idPrefix", "dialogs", "index", "i", "q", "id", "startsWith", "e", "prhash", "resolve", "_a", "_b", "newParts", "oldParts", "el", "same", "d", "closePanel", "routeParts", "handler", "hashChange", "o", "routerOrder", "event", "ui", "dlg", "initFullHeightGridPage", "gridDiv", "opt", "_a", "_b", "_c", "_d", "el", "jquery_module_default", "setHeight", "layout", "layoutFillHeight", "Router", "layoutFillHeightValue", "element", "h", "i", "e", "q", "n", "isMobileView", "initOnLoad", "globalObj", "getGlobalThis", "Config", "ns", "obj", "getNested", "initializeTypes", "triggerLayoutOnShow", "executeEverytimeWhenVisible", "centerDialog", "pos", "Lookup", "options", "items", "value", "k", "idField", "r", "v", "SummaryType", "registerEnum", "ColumnSelection", "RetrieveColumnSelection", "_a", "jquery_validation_module_default", "jquery_module_default", "jquery_validation_module_default", "orgShowLabel", "element", "message", "htmlEncode", "value", "result", "events", "handlers", "el", "i", "o", "e", "d", "parseDate", "z", "parseHourAndMin", "parseDayHourAndMin", "parseDecimal", "parseInteger", "oldEmail", "emailRegex", "Config", "loadValidationErrorMessages", "addMsg", "m", "k", "txt", "tryGetText", "setTooltip", "val", "show", "_a", "_b", "_c", "_d", "_e", "isBS3", "getHighlightTarget", "hl", "baseValidateOptions", "errorClass", "validClass", "elements", "error", "$el", "validateForm", "form", "opt", "extend", "addValidationRule", "eventClass", "rule", "Exception", "removeValidationRule", "oldShowLabel", "validateShowLabel", "element", "message", "i", "e", "$e", "jQueryValidationInitialization", "p", "valid", "formSubmitted", "validatorAbortHandler", "validator", "validateOptions", "options", "opt", "baseValidateOptions", "extend", "error", "field", "vx", "inner", "event", "notifyError", "localText", "x", "el", "bsPane", "bsPaneId", "$el", "hl", "getHighlightTarget", "isBS3", "label", "CriteriaBuilder", "fromInclusive", "toInclusive", "value", "values", "TOKEN_IDENTIFIER", "TOKEN_OPERATOR", "TOKEN_VALUE", "TOKEN_PARAM", "ParseError", "expression", "error", "position", "tokenize", "end", "v", "tokens", "l", "l1", "openParens", "index", "ch", "skipWhiteSpace", "readString", "foundDoubles", "readNumber", "foundDot", "readIdentifier", "readParam", "readArrayList", "w", "currentEnd", "operatorPrecedence", "shuntingYard", "result", "stack", "token", "precedence", "prev", "prevPrecedence", "tok", "rpnTokensToCriteria", "rpnTokens", "getParam", "prm", "r", "internalParse", "parseCriteria", "exprOrStrings", "name", "x", "CriteriaOperator", "Criteria", "field", "builder", "c1", "c2", "rest", "k", "c", "op", "escape", "NonDataRow", "convertCompatFormatter", "Aggregators", "Avg", "field", "item", "val", "groupTotals", "WeightedAvg", "weightedField", "valWeighted", "Min", "Max", "Sum", "AggregateFormatting", "formatMarkup", "totals", "column", "aggType", "_a", "textKey", "text", "tryGetText", "value", "formattedValue", "formatValue", "htmlEncode", "_b", "_c", "formatter", "convertCompatFormatter", "NonDataRow", "escape", "e", "displayFormat", "formatNumber", "groupTotalsFormatter", "EventEmitter", "EventData", "gridDefaults", "Group", "GroupItemMetadataProvider", "GroupTotals", "RemoteView", "options", "_a", "self", "gridDefaults", "AggregateFormatting", "idProperty", "items", "rows", "idxById", "rowsById", "filter", "updated", "suspend", "sortAsc", "fastSortField", "sortComparer", "refreshHints", "prevRefreshHints", "filterArgs", "filteredItems", "compiledFilter", "compiledFilterWithCaching", "filterCache", "groupingInfoDefaults", "a", "b", "summaryOptions", "groupingInfos", "groups", "toggledGroupsByLevel", "groupingDelimiter", "page", "totalRows", "onDataChanged", "EventEmitter", "onDataLoading", "onDataLoaded", "onGroupExpanded", "onGroupCollapsed", "onPagingInfoChanged", "onRowCountChanged", "onRowsChanged", "onRowsOrCountChanged", "loading", "errorMessage", "populateLocks", "populateCalls", "contentType", "dataType", "totalCount", "groupItemMetadataProvider", "localSort", "intf", "beginUpdate", "endUpdate", "refresh", "setRefreshHints", "hints", "setFilterArgs", "args", "updateIdxById", "startingIndex", "id", "i", "l", "msg", "ensureIdUniqueness", "getItems", "getIdPropertyName", "setItems", "data", "newIdProperty", "getSortComparer", "recalc", "setPagingOptions", "anyChange", "newPage", "populate", "getPagingInfo", "cols", "asc", "sorts", "s", "field", "sign", "value1", "value2", "result", "sort", "comparer", "ascending", "getLocalSort", "setLocalSort", "value", "fastSort", "oldToString", "reSort", "getFilteredItems", "getFilter", "setFilter", "filterFn", "compileFilter", "compileFilterWithCaching", "getGrouping", "setSummaryOptions", "summary", "idx", "compileAccumulatorLoop", "setGrouping", "getGrandTotals", "agg", "groupingInfo", "GroupItemMetadataProvider", "gi", "extend", "deepClone", "getItemByIdx", "getIdxById", "ensureRowsByIdCache", "getRowByItem", "item", "getRowById", "getItemById", "mapItemsToRows", "itemArray", "row", "mapIdsToRows", "idArray", "mapRowsToIds", "rowArray", "ids", "updateItem", "newId", "insertItem", "insertBefore", "addItem", "deleteItem", "sortedAddItem", "sortedIndex", "sortedUpdateItem", "oldItem", "searchItem", "low", "high", "mid", "getRows", "getLength", "getItem", "calculateTotals", "htmlEncode", "getItemMetadata", "expandCollapseAllGroups", "level", "collapse", "collapseAllGroups", "expandAllGroups", "resolveLevelAndGroupingKey", "arg0", "expandCollapseGroup", "opts", "collapseGroup", "varArgs", "expandGroup", "getGroups", "getOrCreateGroup", "groupsByVal", "val", "parentGroup", "group", "Group", "extractGroups", "r", "addTotals", "totals", "isLeafLevel", "addGroupTotals", "GroupTotals", "groupCollapsed", "toggledGroups", "g", "flattenGroupedRows", "groupedRows", "gl", "j", "jj", "getFunctionInfo", "fn", "fnRegex", "matches", "aggregator", "accumulatorInfo", "filterInfo", "filterBody", "tpl", "fnName", "setFunctionName", "err", "uncompiledFilter", "retval", "ii", "uncompiledFilterWithCaching", "cache", "getFilteredAndPagedItems", "batchFilter", "batchFilterWithCaching", "getRowDiffs", "newRows", "eitherIsNonData", "diff", "from", "to", "rl", "_items", "countBefore", "totalRowsBefore", "syncGridSelection", "grid", "preserveHidden", "preserveHiddenOnSelectionChange", "inHandler", "selectedRowIds", "onSelectedRowIdsChanged", "setSelectedRowIds", "rowIds", "EventData", "update", "selectedRows", "e", "newSelectedRowIds", "existing", "syncGridCellCssStyles", "key", "hashById", "storeCellCssStyles", "hash", "newHash", "subFunc", "addData", "gh", "request", "skip", "dt", "ajaxOptions", "response", "notifyError", "xhr", "status", "ev", "json", "ah", "populateLock", "populateUnlock", "getGroupItemMetadataProvider", "setGroupItemMetadataProvider", "localText", "Attr", "name", "target", "registerClass", "EnumKeyAttribute", "value", "__decorateClass", "DisplayNameAttribute", "displayName", "CategoryAttribute", "category", "ColumnsKeyAttribute", "CssClassAttribute", "cssClass", "DefaultValueAttribute", "DialogTypeAttribute", "EditorOptionAttribute", "key", "EditorTypeAttributeBase", "editorType", "editorParams", "EditorTypeAttribute", "ElementAttribute", "EntityTypeAttribute", "FilterableAttribute", "FlexifyAttribute", "FormKeyAttribute", "GeneratedCodeAttribute", "origin", "HiddenAttribute", "HintAttribute", "hint", "IdPropertyAttribute", "InsertableAttribute", "IsActivePropertyAttribute", "ItemNameAttribute", "LocalTextPrefixAttribute", "MaximizableAttribute", "MaxLengthAttribute", "maxLength", "NamePropertyAttribute", "OneWayAttribute", "OptionAttribute", "OptionsTypeAttribute", "PanelAttribute", "PlaceholderAttribute", "ReadOnlyAttribute", "RequiredAttribute", "isRequired", "ResizableAttribute", "ResponsiveAttribute", "ServiceAttribute", "UpdatableAttribute", "Decorators", "nameOrIntf", "intf2", "registerInterface", "registerEditor", "registerEnum", "enumKey", "addAttribute", "registerEnumType", "registerFormatter", "ISlickFormatter", "option", "propertyKey", "isGetSet", "startsWith", "memberName", "addTypeMember", "dialogType", "editor", "attr", "EditorAttribute", "element", "filterable", "flexify", "itemName", "maximizable", "optionsType", "panel", "resizable", "responsive", "service", "IBooleanValue", "__decorateClass", "Decorators", "IDoubleValue", "__decorateClass", "Decorators", "IDialog", "__decorateClass", "Decorators", "IEditDialog", "__decorateClass", "Decorators", "IGetEditValue", "__decorateClass", "Decorators", "IReadOnly", "__decorateClass", "Decorators", "ISetEditValue", "__decorateClass", "Decorators", "IStringValue", "__decorateClass", "Decorators", "IValidateRequired", "__decorateClass", "Decorators", "CaptureOperationType", "registerEnum", "ReflectionUtils", "getPropertyValue", "o", "property", "d", "getter", "camelCase", "makeCamelCase", "setPropertyValue", "value", "setter", "s", "isEmptyOrNull", "hasNonUppercase", "numUppercaseChars", "index", "commonTypeRegistry", "isMatch", "attrKey", "suffix", "knownTypes", "reset", "search", "key", "type", "getType", "ns", "Config", "k", "init", "getTypes", "fullName", "getTypeNameProp", "akey", "p", "tryGet", "_a", "endsWith", "DialogTypeRegistry", "registry", "commonTypeRegistry", "type", "isAssignableFrom", "IDialog", "get", "key", "isEmptyOrNull", "ArgumentNullException", "message", "htmlEncode", "notifyError", "Exception", "reset", "tryGet", "jQueryPatch", "$", "applyJQueryUIFixes", "event", "orig", "isMobileView", "elems", "events", "elem", "i", "e", "cloned", "reactPatch", "_a", "_b", "globalObj", "Widget", "element", "options", "getInstanceType", "Exception", "format", "e", "type", "classList", "fullClass", "replaceAll", "getTypeFullName", "k", "Config", "startsWith", "getTypeShortName", "v", "i", "a", "s", "editorType", "elementAttr", "getAttributes", "ElementAttribute", "elementHtml", "jquery_module_default", "eventClass", "rule", "addValidationRule", "handler", "valueSet", "params", "widget", "isAssignableFrom", "IDialog", "action", "__decorateClass", "Decorators", "w", "widgetName", "data", "key", "ArgumentNullException", "message", "notifyError", "jQueryPatch", "EditorTypeRegistry", "registry", "commonTypeRegistry", "type", "getAttributes", "EditorAttribute", "isAssignableFrom", "Widget", "get", "key", "isEmptyOrNull", "ArgumentNullException", "message", "htmlEncode", "notifyError", "Exception", "reset", "tryGet", "EnumTypeRegistry", "registry", "commonTypeRegistry", "isEnum", "type", "_a", "getAttributes", "EnumKeyAttribute", "get", "key", "message", "htmlEncode", "notifyError", "Exception", "reset", "tryGet", "LazyLoadHelper", "executeOnceWhenVisible", "executeEverytimeWhenVisible", "PrefixedContext", "idPrefix", "id", "type", "PopupMenuButton", "Widget", "div", "opt", "_a", "_b", "e", "_c", "_d", "menu", "uq", "x", "__decorateClass", "Decorators", "PopupToolButton", "Toolbar", "options", "container", "buttons", "currentCount", "i", "button", "b", "cssClass", "btn", "isEmptyOrNull", "text", "htmlEncode", "klass", "startsWith", "e1", "action", "className", "el", "TemplatedWidget", "Widget", "id", "type", "s", "dollar", "getTypeShortName", "getInstanceType", "fullName", "getTypeFullName", "templateNames", "cachedName", "name", "k", "Config", "startsWith", "canLoadScriptData", "replaceAll", "getBaseType", "templateName", "script", "template", "getTemplate", "format", "widgetMarkup", "end", "idx", "key", "txt", "localText", "useIdPrefix", "__decorateClass", "Decorators", "prefix", "idPrefixHandler", "target", "p", "flexY", "flexX", "Flexify", "Widget", "container", "options", "LazyLoadHelper", "designWidth", "designHeight", "tabs", "element", "xFactor", "yFactor", "width", "initialWidth", "height", "initialHeight", "containers", "tabPanels", "i", "e", "DialogExtensions", "dialogResizable", "dialog", "w", "h", "mw", "mh", "_a", "dlg", "dialogMaximizable", "dialogFlexify", "Flexify", "TemplatedDialog", "TemplatedWidget", "options", "newBodyDiv", "panelAttr", "getAttributes", "getInstanceType", "PanelAttribute", "Config", "ResponsiveAttribute", "element", "name", "cssSize", "endsWith", "i", "parseInteger", "opt", "dialogClass", "size", "dialog", "sizeHelper", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "modal", "e", "type", "DialogExtensions", "FlexifyAttribute", "MaximizableAttribute", "self", "title", "modalClass", "div", "bsModalMarkup", "footer", "buttons", "x", "dialogButtonToBS", "toolbarDiv", "hotkeyContext", "Toolbar", "form", "valOptions", "jquery_validation_module_default", "validateOptions", "asPanel", "uniqueName", "openPanel", "closePanel", "isMobileView", "index", "el", "positionToastContainer", "dialogButtonToUI", "ResizableAttribute", "value", "pt", "isEmptyOrNull", "oldTitle", "tabsDiv", "dlg", "uiDialog", "data", "pos", "layoutFillHeight", "d", "__decorateClass", "Decorators", "IDialog", "TemplatedPanel", "TemplatedWidget", "container", "options", "_a", "_b", "i", "e", "tabsDiv", "toolbarDiv", "opt", "Toolbar", "form", "valOptions", "validateOptions", "__decorateClass", "Decorators", "ValidationHelper", "asyncSubmit", "form", "validateBeforeSave", "submitHandler", "validator", "valSettings", "validatorAbortHandler", "submit", "getValidator", "element", "VX", "addValidationRule", "eventClass", "rule", "Exception", "removeValidationRule", "validateElement", "widget", "CascadedWidgetLink", "parentType", "widget", "parentChange", "e", "isEmptyOrNull", "parent", "findElementWithRelativeId", "notifyError", "value", "__decorateClass", "Decorators", "TabsExtensions", "setDisabled", "tabs", "tabKey", "isDisabled", "_a", "_b", "ibk", "indexByKey", "index", "toggle", "visible", "activeTabKey", "href", "prefix", "lastIndex", "el", "selectTab", "ReflectionOptionsSetter", "set", "target", "options", "type", "getInstanceType", "propByName", "fieldByName", "props", "getMembers", "propList", "x", "a", "isInstanceOfType", "OptionAttribute", "DisplayNameAttribute", "k", "ReflectionUtils", "fields", "fieldList", "x1", "$t2", "k1", "keys", "k2", "v", "cc", "p", "func", "f", "EditorUtils", "getDisplayText", "editor", "_a", "_b", "_c", "select2", "data", "value", "getValue", "tryGetText", "dummy", "target", "saveValue", "item", "getEditValue", "safeCast", "IGetEditValue", "stringValue", "IStringValue", "booleanValue", "IBooleanValue", "doubleValue", "IDoubleValue", "setValue", "source", "loadValue", "setEditValue", "ISetEditValue", "cast", "value1", "d", "isInstanceOfType", "isTrimmedEmpty", "parseDecimal", "v", "setReadonly", "elements", "isReadOnly", "index", "el", "elx", "type", "setReadOnly", "widget", "readOnly", "IReadOnly", "setRequired", "isRequired", "req", "IValidateRequired", "gridField", "hasSupItem", "localText", "setContainerReadOnly", "container", "i", "e", "w", "Widget", "PropertyGrid", "Widget", "div", "opt", "_a", "title", "animate", "intoView", "items", "useTabs", "any", "x", "isEmptyOrNull", "itemsWithoutTab", "f", "itemsWithTab", "ul", "tc", "tabIndex", "i", "tab", "trimToEmpty", "tabItems", "j", "li", "isBS3", "isBS5Plus", "tabID", "prefix", "pane", "container", "_b", "categoryIndexes", "categoriesDiv", "useCategories", "linkContainer", "fieldContainer", "priorCategory", "item", "category", "categoryDiv", "editor", "collapsed", "img", "e", "text", "getKey", "startsWith", "local", "tryGetText", "local1", "fieldDiv", "splitted", "editorId", "hint", "prefix1", "placeHolder", "prefix2", "label", "localText", "editorType", "EditorTypeRegistry", "element", "editorParams", "optionsType", "optionsAttr", "getAttributes", "OptionsTypeAttribute", "extend", "getTypeShortName", "ReflectionOptionsSetter", "order", "result", "categoryOrder", "trimToNull", "split", "s", "x1", "idx", "itemIndex", "itemCategory", "name1", "cat1", "self", "y", "c", "xcategory", "ycategory", "c1", "c2", "Culture", "index", "value", "source", "target", "EditorUtils", "widget", "isReadOnly", "elements", "isRequired", "maxLength", "val", "PropertyGridMode", "Authorization", "readOnly", "hidden", "callback", "__decorateClass", "Decorators", "PropertyPanel", "TemplatedPanel", "container", "options", "pgDiv", "pgOptions", "PropertyGrid", "attributes", "getAttributes", "getInstanceType", "FormKeyAttribute", "name", "getTypeFullName", "px", "endsWith", "formKey", "getForm", "entity", "value", "__decorateClass", "Decorators", "SubDialogHelper", "bindToDataChange", "dialog", "owner", "dataChange", "useTimeout", "widgetName", "e", "dci", "triggerDataChange", "triggerDataChanged", "element", "bubbleDataChange", "cascade", "cascadedDialog", "ofElement", "cascadedDialogOffset", "PropertyDialog", "TemplatedDialog", "opt", "__async", "localText", "pgDiv", "pgOptions", "PropertyGrid", "attributes", "getAttributes", "getInstanceType", "FormKeyAttribute", "name", "getTypeFullName", "px", "endsWith", "_a", "formKey", "ScriptData", "isEmptyOrNull", "getFormData", "getFormDataAsync", "entity", "value", "__decorateClass", "Decorators", "StringEditor", "Widget", "input", "value", "__decorateClass", "Decorators", "IStringValue", "PasswordEditor", "StringEditor", "input", "__decorateClass", "Decorators", "TextAreaEditor", "Widget", "input", "opt", "_a", "_b", "value", "__decorateClass", "Decorators", "IStringValue", "BooleanEditor", "Widget", "value", "__decorateClass", "Decorators", "IBooleanValue", "DecimalEditor", "Widget", "input", "opt", "_a", "_b", "numericOptions", "extend", "val", "parseDecimal", "value", "formatNumber", "v", "Culture", "__decorateClass", "Decorators", "IDoubleValue", "IntegerEditor", "Widget", "input", "opt", "_a", "_b", "numericOptions", "extend", "DecimalEditor", "val", "isTrimmedEmpty", "trimToNull", "parseInteger", "value", "formatNumber", "v", "__decorateClass", "Decorators", "IDoubleValue", "datePickerIconSvg", "DateEditor", "Widget", "input", "_a", "_b", "inp", "inst", "e", "today", "addValidationRule", "e1", "value", "isEmptyOrNull", "Invariant", "formatDate", "format", "localText", "Culture", "v", "parseISODateTime", "val", "replaceAll", "isNumeric", "c", "dialogIndex", "widget", "zIndex", "x", "d", "parseDate", "__decorateClass", "Decorators", "IStringValue", "IReadOnly", "jQueryDatepickerInitialization", "order", "s", "culture", "DateTimeEditor", "Widget", "input", "opt", "_a", "_b", "_c", "_d", "_e", "DateEditor", "e", "after", "e3", "timeOpt", "t", "addOption", "addValidationRule", "e1", "value", "isEmptyOrNull", "Invariant", "format", "localText", "formatDate", "before", "e2", "Culture", "result", "datePart", "timePart", "parseDate", "formatISODateTimeUTC", "parseISODateTime", "today", "val", "tryGetText", "v", "EditorUtils", "date", "minutesStep", "m", "trunc", "round", "fromHour", "fromMin", "toHour", "toMin", "stepMins", "list", "hour", "min", "__decorateClass", "Decorators", "IStringValue", "IReadOnly", "TimeEditor", "Widget", "input", "opt", "addOption", "h", "m", "hour", "toId", "minute", "value", "EditorUtils", "__decorateClass", "Decorators", "IDoubleValue", "IReadOnly", "EmailEditor", "Widget", "input", "opt", "spanAt", "domain", "validator", "isEmptyOrNull", "e", "e1", "e2", "_a", "value", "element", "tryGetText", "domainValue", "trimToNull", "parts", "v", "__decorateClass", "Decorators", "IStringValue", "IReadOnly", "EmailAddressEditor", "StringEditor", "input", "__decorateClass", "Decorators", "URLEditor", "StringEditor", "input", "validator", "value", "trimToNull", "__decorateClass", "Decorators", "IStringValue", "RadioButtonEditor", "Widget", "input", "opt", "_a", "isEmptyOrNull", "enumType", "EnumTypeRegistry", "enumKey", "enumKeyAttr", "getAttributes", "EnumKeyAttribute", "values", "Enum", "x", "name", "tryGetText", "lookup", "getLookup", "item", "textValue", "text", "idValue", "id", "value", "label", "inputs", "checks", "v", "__decorateClass", "Decorators", "IStringValue", "IReadOnly", "_Select2", "select2_module_default", "Select2Editor", "Widget", "hidden", "opt", "emptyItemText", "select2Options", "e", "valueSet", "localText", "_a", "_b", "_c", "_d", "query", "results", "item", "value", "items", "isEmptyOrNull", "pageSize", "searchQuery", "trimToNull", "select2", "_e", "result", "element", "callback", "val", "isMultiple", "idList", "x", "v", "any", "z", "isAutoComplete", "list", "item2", "it", "key", "text", "source", "disabled", "addTitle", "editTitle", "self", "inplaceButton", "isNew", "values", "e3", "q", "index", "values1", "Authorization", "getName", "s", "select2_module_default", "isTrimmedEmpty", "isAsyncSource", "x1", "property", "target", "getText", "term", "contains", "filter", "startsWith", "el", "selectedValue", "selectedValues", "str", "readOnly", "parent", "EditorUtils", "CascadedWidgetLink", "p", "fld", "itemKey", "ReflectionUtils", "dialogTypeKey", "dialogType", "DialogTypeRegistry", "entity", "dialog", "SubDialogHelper", "dci", "id", "id1", "idx1", "editItem", "trimToEmpty", "__decorateClass", "Decorators", "ISetEditValue", "IGetEditValue", "IStringValue", "IReadOnly", "SelectEditor", "Select2Editor", "hidden", "opt", "isEmptyOrNull", "_a", "items", "isStrings", "item", "key", "text", "__decorateClass", "Decorators", "DateYearEditor", "SelectEditor", "hidden", "opt", "_a", "_b", "years", "minYear", "maxYear", "startsWith", "i", "i1", "__decorateClass", "Decorators", "EnumEditor", "Select2Editor", "hidden", "opt", "_a", "enumType", "EnumTypeRegistry", "enumKey", "enumKeyAttr", "getAttributes", "EnumKeyAttribute", "values", "Enum", "x", "name", "tryGetText", "__decorateClass", "Decorators", "LookupEditorBase", "Select2Editor", "input", "opt", "self", "ScriptData", "key", "getTypeFullName", "getInstanceType", "idx", "endsWith", "getLookupAsync", "getLookup", "lookup", "item", "textValue", "items", "query", "results", "x", "getText", "dialogTypeKey", "entity", "term", "reloadLookup", "__decorateClass", "Decorators", "LookupEditor", "hidden", "ServiceLookupEditorBase", "Select2Editor", "input", "opt", "dialogTypeKey", "service", "startsWith", "url", "resolveUrl", "include", "idField", "textField", "val", "isEmptyOrNull", "fld", "Criteria", "idList", "query", "request", "results", "response", "items", "serviceCall", "__decorateClass", "Decorators", "ServiceLookupEditor", "hidden", "HtmlContentEditor", "Widget", "textArea", "opt", "id", "isTrimmedEmpty", "e", "value", "trimToNull", "localText", "LazyLoadHelper", "config", "x", "_a", "CKEDITOR", "lang", "x1", "resolveUrl", "instance", "v", "isEmptyOrNull", "path", "endsWith", "script", "__decorateClass", "Decorators", "IStringValue", "IReadOnly", "HtmlNoteContentEditor", "HtmlReportContentEditor", "MaskedEditor", "Widget", "input", "opt", "_a", "value", "__decorateClass", "Decorators", "IStringValue", "Recaptcha", "Widget", "div", "opt", "_a", "src", "lng", "valInput", "gro", "input", "self", "addValidationRule", "e", "isEmptyOrNull", "localText", "value", "__decorateClass", "Decorators", "IStringValue", "UploadHelper", "addUploadInput", "options", "uploadUrl", "uploadInput", "resolveUrl", "e", "data", "response", "notifyError", "opt", "_a", "xhr", "json", "html", "iframeDialog", "blockUI", "blockUndo", "e1", "data1", "percent", "checkImageConstraints", "file", "alertDialog", "localText", "format", "fileSizeDisplay", "fileNameSizeDisplay", "name", "bytes", "byteSize", "round", "suffix", "sizeParts", "value", "hasImageExtension", "filename", "isEmptyOrNull", "endsWith", "thumbFileName", "idx", "dbFileUrl", "replaceAll", "colorBox", "link", "htmlEncode", "populateFileSymbols", "container", "items", "displayOriginalName", "urlPrefix", "index", "item", "li", "isImage", "editLink", "thumb", "originalName", "fileName", "startsWith", "FileUploadEditor", "Widget", "div", "opt", "isEmptyOrNull", "Toolbar", "uio", "UploadHelper", "response", "name", "data", "newEntity", "validator", "localText", "displayOriginalName", "isTrimmedEmpty", "trimToNull", "addButton", "delButton", "value", "e", "copy", "extend", "stringValue", "idx", "v", "property", "target", "source", "_a", "s", "replaceAll", "__decorateClass", "Decorators", "IReadOnly", "IGetEditValue", "ISetEditValue", "IValidateRequired", "ImageUploadEditor", "MultipleFileUploadEditor", "self", "addFileButton", "i", "x", "ev", "val", "isInstanceOfType", "json", "startsWith", "endsWith", "MultipleImageUploadEditor", "QuickFilterBar", "Widget", "container", "options", "_a", "filters", "f", "filter", "opt", "ArgumentNullException", "item", "title", "tryGetText", "quickFilter", "isEmptyOrNull", "widget", "e", "submitHandler", "request", "value", "EditorUtils", "active", "args", "e1", "x", "field", "end", "DateEditor", "e2", "date1", "parseDate", "notifyWarning", "localText", "Criteria", "date2", "next", "formatDate", "w", "l", "v1", "v2", "text1", "text2", "w1", "w2", "state", "useUtc", "DateTimeEditor", "i", "x1", "yes", "no", "items", "trueText", "falseText", "SelectEditor", "toId", "action", "delegateCombine", "delegateRemove", "type", "el", "__decorateClass", "Decorators", "QuickSearchInput", "Widget", "input", "opt", "_a", "_b", "localText", "trim", "self", "isValue", "menu", "item", "field", "e", "PopupMenuButton", "e1", "value", "isEmptyOrNull", "qsf", "_c", "done", "results", "el", "__decorateClass", "Decorators", "FilterOperators", "FilterStore", "fields", "ArgumentNullException", "x", "y", "titleX", "tryGetText", "titleY", "Culture", "field", "items", "inParens", "currentBlock", "isBlockOr", "criteria", "i", "line", "Criteria", "displayText", "localText", "value", "delegateCombine", "delegateRemove", "__decorateClass", "Decorators", "IFiltering", "__decorateClass", "Decorators", "IQuickFiltering", "BaseFiltering", "value", "list", "FilterOperators", "Exception", "format", "getTypeFullName", "getInstanceType", "op", "_a", "_b", "tryGetText", "field", "values", "result", "text", "Criteria", "state", "input", "localText", "filter", "StringEditor", "deepClone", "Filtering", "name", "BaseEditorFiltering", "editorType", "Widget", "isEmptyOrNull", "opt", "extend", "EditorUtils", "DateFiltering", "DateEditor", "BooleanFiltering", "DateTimeFiltering", "DateTimeEditor", "date", "parseISODateTime", "next", "criteria", "dateValue", "formatDate", "nextValue", "DecimalFiltering", "DecimalEditor", "EditorFiltering", "EditorTypeRegistry", "e", "EnumFiltering", "EnumEditor", "IntegerFiltering", "IntegerEditor", "LookupFiltering", "LookupEditor", "ops", "ServiceLookupFiltering", "ServiceLookupEditor", "StringFiltering", "FilteringTypeRegistry", "knownTypes", "initialize", "type", "getTypes", "isAssignableFrom", "fullName", "k", "Config", "startsWith", "kx", "setTypeKeysWithoutFilterHandlerSuffix", "suffix", "endsWith", "p", "reset", "get", "key", "ArgumentNullException", "formatterType", "FilterWidgetBase", "TemplatedWidget", "div", "opt", "FilterStore", "value", "__decorateClass", "Decorators", "FilterFieldSelect", "Select2Editor", "hidden", "fields", "_a", "_b", "field", "tryGetText", "isEmptyOrNull", "localText", "opt", "__decorateClass", "Decorators", "FilterOperatorSelect", "source", "op", "title", "FilterPanel", "FilterWidgetBase", "div", "value", "items", "item", "row", "divl", "fieldSelect", "operatorSelect", "filtering", "filterLines", "errorText", "i", "line", "criteria", "ex", "result", "index", "fieldInput", "val", "popupField", "emptyRow", "isLastRowOr", "parenDiv", "e", "andor", "fieldSel", "opSelect", "select", "fieldName", "isEmpty", "operators", "cast", "IFiltering", "filteringType", "FilteringTypeRegistry", "editorDiv", "ReflectionOptionsSetter", "firstInput", "$t1", "ops", "x", "rows", "inParen", "i1", "row1", "divParen", "lp", "rp", "FilterDialog", "TemplatedDialog", "FilterPanel", "localText", "notifyError", "__decorateClass", "Decorators", "FilterDisplayBar", "FilterWidgetBase", "div", "localText", "openFilterDialog", "e", "dialog", "FilterDialog", "e1", "displayText", "trimToNull", "__decorateClass", "Decorators", "SlickPager", "Widget", "div", "o", "extend", "v", "htmlEncode", "localText", "self", "e", "opt", "sel", "nx", "ctype", "view", "info", "pages", "newp", "nv", "r1", "r2", "stat", "__decorateClass", "Decorators", "IInitializeColumn", "__decorateClass", "Decorators", "BooleanFormatter", "ctx", "_a", "_b", "text", "tryGetText", "htmlEncode", "CheckboxFormatter", "DateFormatter", "Culture", "value", "format", "date", "parseISODateTime", "formatDate", "DateTimeFormatter", "EnumFormatter", "EnumTypeRegistry", "enumType", "name", "Enum", "enumKeyAttr", "getAttributes", "EnumKeyAttribute", "enumKey", "getTypeFullName", "isEmptyOrNull", "FileDownloadFormatter", "dbFile", "safeCast", "downloadUrl", "originalName", "iconClass", "filename", "replaceAll", "resolveUrl", "column", "ISlickFormatter", "MinuteFormatter", "hour", "minute", "hourStr", "minuteStr", "NumberFormatter", "formatNumber", "dbl", "parseDecimal", "UrlFormatter", "_c", "_d", "url", "startsWith", "display", "s", "FormatterTypeRegistry", "registry", "commonTypeRegistry", "type", "isAssignableFrom", "ISlickFormatter", "get", "key", "isEmptyOrNull", "ArgumentNullException", "message", "htmlEncode", "notifyError", "Exception", "reset", "tryGet", "GridRowSelectionMixin", "grid", "options", "e", "p", "item", "id", "i", "e1", "u", "clearKeys", "items", "x", "id1", "selectAllButton", "keys", "k", "getMixin", "ctx", "mixin", "isChecked", "__decorateClass", "Decorators", "GridRadioSelectionMixin", "key", "row", "cell", "value", "column", "GridSelectAllButtonHelper", "update", "getSelected", "toolbar", "btn", "Toolbar", "define", "getGrid", "getId", "setSelected", "text", "onClick", "_a", "tryGetText", "view", "makeSelected", "GridUtils", "addToggleButton", "toolDiv", "cssClass", "callback", "hint", "initial", "div", "pressed", "addIncludeDeletedToggle", "includeDeleted", "oldSubmit", "v", "localText", "addQuickSearchInput", "fields", "onChange", "input", "searchText", "searchField", "lastDoneEvent", "addQuickSearchInputCustom", "field", "query", "done", "ui", "container", "onSearch", "QuickSearchInput", "makeOrderable", "handleMove", "moveRowsPlugin", "data", "data1", "$t1", "makeOrderableWithUpdateRequest", "getDisplayOrder", "service", "getUpdateRequest", "rows", "insertBefore", "_b", "order", "index", "next", "serviceCall", "response", "PropertyItemSlickConverter", "toSlickColumns", "result", "toSlickColumn", "Authorization", "name", "isEmptyOrNull", "formatterType", "FormatterTypeRegistry", "formatter", "ReflectionOptionsSetter", "initializer", "safeCast", "IInitializeColumn", "SlickFormatting", "getEnumText", "enumKey", "EnumFormatter", "treeToggle", "getView", "indent", "spacer", "idx", "nextIndent", "date", "format", "Culture", "htmlEncode", "DateFormatter", "dateTime", "checkBox", "number", "NumberFormatter", "getItemType", "link", "getItemId", "itemLinkText", "itemType", "extraClass", "encode", "replaceAll", "itemLink", "idField", "getText", "SlickHelper", "setDefaults", "columns", "localTextPrefix", "col", "startsWith", "SlickTreeHelper", "filterCustom", "getParent", "parent", "loop", "filterById", "getParentId", "parentId", "setCollapsed", "collapsed", "setCollapsedFlag", "setIndents", "depth", "depths", "line", "toggleClick", "target", "ColumnsBase", "AutoTooltips", "Grid", "DataGrid", "Widget", "container", "options", "self", "layout", "LayoutTimer", "debounce", "buttons", "_a", "restoreResult", "__async", "attrType", "getAttributes", "getInstanceType", "responsiveHeight", "madeAutoHeight", "shouldAutoHeight", "filters", "QuickFilterBar", "filter", "pre", "e", "x", "Authorization", "item", "_b", "quick", "name", "title", "tryGetText", "filteringType", "FilteringTypeRegistry", "DateFiltering", "DateTimeFiltering", "BooleanFiltering", "q", "f", "trueText", "falseText", "filtering", "isInstanceOfType", "IQuickFiltering", "ReflectionOptionsSetter", "FilterOperators", "extend", "deepClone", "type", "field", "el", "isEmptyOrNull", "GridUtils", "input", "index", "activeFieldName", "deletedFieldName", "value", "itemClass", "columns", "SlickHelper", "delta", "scale", "col", "LazyLoadHelper", "column", "FilterStore", "c", "s", "visibleColumns", "slickOptions", "grid", "Grid", "AutoTooltips", "sortBy", "mapped", "endsWith", "trimEnd", "row", "p", "i", "e1", "p1", "e2", "p2", "e3", "p3", "entityOrId", "itemType", "cell", "target", "SlickFormatting", "rows", "d", "view", "view1", "response", "view2", "include", "criteria", "Criteria", "setEquality", "array", "key", "opt", "RemoteView", "x1", "y", "list", "attr", "FilterableAttribute", "filterBarDiv", "FilterDisplayBar", "pagerDiv", "SlickPager", "toolbarDiv", "Toolbar", "idField", "text", "cssClass", "encode", "ColumnsKeyAttribute", "columnsKey", "ScriptData", "getColumnsData", "getColumnsDataAsync", "propertyItems", "PropertyItemSlickConverter", "oldFormat", "css", "ctx", "htmlEncode", "ctx1", "rowDefinition", "LocalTextPrefixAttribute", "IdPropertyAttribute", "IsActivePropertyAttribute", "getKey", "localTextPrefix", "local", "yes", "no", "path", "getTypeFullName", "storage", "fromJson", "json", "trimToNull", "startsWith", "jsonOrPromise", "settings", "flags", "settingsOrPromise", "colById", "updateColById", "cl", "$t1", "visible", "newColumns", "$t2", "$t3", "c1", "$t4", "x2", "column1", "sortColumns", "x3", "a", "b", "$t5", "x4", "column2", "x5", "items", "includeDeletedToggle", "widget", "state", "loadState", "EditorUtils", "qsInput", "qsWidget", "QuickSearchInput", "sort", "indexOf", "saveState", "getDisplayText", "filterLabel", "displayText", "__decorateClass", "Decorators", "IReadOnly", "ColumnPickerDialog", "TemplatedDialog", "QuickSearchInput", "fld", "txt", "done", "trimToNull", "x", "e", "localText", "grid", "onClick", "picker", "initialSettings", "visible", "Router", "arg", "liByKey", "el", "last", "id", "li", "key", "newColumns", "col", "opt", "allowHide", "htmlEncode", "c", "hidden", "Authorization", "hiddenColumns", "a", "b", "Culture", "evt", "centerDialog", "__decorateClass", "Decorators", "TreeGridMixin", "options", "dg", "idProperty", "getId", "item", "e", "src", "SlickTreeHelper", "oldViewFilter", "oldProcessData", "response", "col", "tryFirst", "x", "SlickFormatting", "ctx", "htmlEncode", "items", "getParentId", "result", "byId", "toGrouping", "byParentId", "visited", "takeChildren", "theParentId", "child", "parentId", "CheckTreeEditor", "DataGrid", "div", "opt", "items", "itemById", "item", "isEmptyOrNull", "parent", "property", "target", "source", "value", "selectAllText", "self", "buttons", "GridSelectAllButtonHelper", "x", "x1", "x2", "v", "_a", "tryGetText", "result", "SlickTreeHelper", "i", "o", "response", "row", "cell", "checkedOrPartial", "anyChanged", "view", "threeState", "allsel", "allSelected", "selected", "selectedChange", "sub", "columns", "SlickFormatting", "ctx", "cls", "htmlEncode", "oldIndexes", "list", "$t1", "y", "c", "Culture", "trimToNull", "i1", "select", "__decorateClass", "Decorators", "IGetEditValue", "ISetEditValue", "IReadOnly", "CheckLookupEditor", "options", "ScriptData", "GridUtils", "field", "text", "val", "key", "fld", "itemKey", "ReflectionUtils", "lookup", "getLookup", "_b", "EditorUtils", "CascadedWidgetLink", "Widget", "p", "EntityGrid", "DataGrid", "container", "options", "_", "args", "_a", "_b", "oldRequests", "jquery_module_default", "parts", "Router", "result", "attr", "EntityTypeAttribute", "name", "getTypeFullName", "getInstanceType", "px", "endsWith", "DisplayNameAttribute", "LT", "tryGetText", "ItemNameAttribute", "format", "localText", "buttons", "ColumnPickerDialog", "noText", "entityOrId", "dlg", "dialog", "safeCast", "IEditDialog", "itemType", "ServiceAttribute", "replaceAll", "opt", "resolveUrl", "hash", "insertPermission", "Authorization", "EditorUtils", "SubDialogHelper", "e", "dci", "callback", "dialogClass", "Widget", "d", "DialogTypeRegistry", "DialogTypeAttribute", "__decorateClass", "Decorators", "EntityDialog", "TemplatedDialog", "opt", "__async", "entity", "value", "_a", "titleFormat", "localText", "title", "format", "isEmptyOrNull", "isDeletedProperty", "callback", "options", "serviceCall", "self", "request", "baseOptions", "response", "thisOptions", "finalOptions", "extend", "attrType", "getAttributes", "getInstanceType", "typeAttributes", "EntityTypeAttribute", "name", "getTypeFullName", "px", "endsWith", "attributes", "FormKeyAttribute", "rowDefinition", "attr", "LocalTextPrefixAttribute", "ItemNameAttribute", "LT", "es", "tryGetText", "_b", "NamePropertyAttribute", "IdPropertyAttribute", "IsActivePropertyAttribute", "ServiceAttribute", "replaceAll", "entityOrId", "done", "fail", "action", "scriptType", "entityId", "ex1", "ex", "Exception", "asPanel", "data", "idField", "id", "validatorAbortHandler", "pgDiv", "pgOptions", "any", "x", "localGridDiv", "items", "item1", "langs", "copy", "lang", "PropertyGrid", "newValue", "langsTuple", "safeCast", "language", "key", "valueByName", "item", "widget", "widget1", "idx", "hint", "k", "result", "pair", "prefix", "startsWith", "formKey", "ScriptData", "getFormData", "getFormDataAsync", "typ", "ent", "eid", "dci", "req", "ValidationHelper", "notifySuccess", "list", "response1", "id1", "confirmDialog", "cloneEntity", "Widget", "w", "SubDialogHelper", "clone", "isActiveField", "isDeletedField", "EditorUtils", "isLocalizationMode", "hasSavePermission", "viewMode", "readOnly", "TabsExtensions", "deletePermission", "Authorization", "insertPermission", "updatePermission", "__decorateClass", "Decorators", "IEditDialog", "IReadOnly", "_widgetFactory", "props", "widget", "Widget", "el$", "el", "EditorUtils", "ReflectionOptionsSetter", "jsxDomWidget", "type", "Reporting", "ReportDialog", "TemplatedDialog", "opt", "PropertyGrid", "reportKey", "serviceCall", "response", "_a", "set", "targetFrame", "exportType", "parameters", "postToService", "buttons", "__decorateClass", "Decorators", "ReportPage", "Widget", "div", "e", "self", "QuickSearchInput", "field", "text", "done", "liList", "trimToNull", "parts", "i", "reportItems", "i1", "title", "$t1", "p", "matchingItems", "visibles", "nonVisibles", "li", "dialog", "ScriptContext", "__decorateClass", "Decorators", "IAsyncInit", "__decorateClass", "Decorators", "WX", "getWidget", "element", "type", "Widget", "hasOriginalEvent", "e", "change", "widget", "handler", "changeSelect2", "getGridField", "GoogleMap", "Widget", "container", "opt", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "center", "mapOpt", "markerOpt", "lat", "lon", "LazyLoadHelper", "__decorateClass", "Decorators", "Select2AjaxEditor", "Widget", "hidden", "opt", "emptyItemText", "e", "x", "WX", "ValidationHelper", "txt", "localText", "request", "callback", "options", "response", "serviceCall", "key", "item", "queryTimeout", "isEmptyOrNull", "isValue", "query", "trimToNull", "select2", "element", "val", "result", "title", "self", "safeCast", "value", "el", "v", "__decorateClass", "Decorators", "IStringValue"]
}
